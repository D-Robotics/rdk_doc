"use strict";(self.webpackChunkrdk_doc=self.webpackChunkrdk_doc||[]).push([[43646],{28453:(e,r,n)=>{n.d(r,{R:()=>l,x:()=>t});var i=n(96540);const s={},d=i.createContext(s);function l(e){const r=i.useContext(d);return i.useMemo(function(){return"function"==typeof e?e(r):{...r,...e}},[r,e])}function t(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:l(e.components),i.createElement(d.Provider,{value:r},e.children)}},75163:(e,r,n)=>{n.r(r),n.d(r,{assets:()=>c,contentTitle:()=>t,default:()=>a,frontMatter:()=>l,metadata:()=>i,toc:()=>o});const i=JSON.parse('{"id":"Advanced_development/multimedia_development/performance_debug","title":"7.3.12 \u591a\u5a92\u4f53\u6027\u80fd\u8c03\u8bd5","description":"\u6982\u8ff0","source":"@site/docs/07_Advanced_development/03_multimedia_development/performance_debug.md","sourceDirName":"07_Advanced_development/03_multimedia_development","slug":"/Advanced_development/multimedia_development/performance_debug","permalink":"/rdk_doc/Advanced_development/multimedia_development/performance_debug","draft":false,"unlisted":false,"tags":[],"version":"current","lastUpdatedAt":1753238795000,"sidebarPosition":12,"frontMatter":{"sidebar_position":12},"sidebar":"tutorialSidebar","previous":{"title":"7.3.11 \u67e5\u8be2\u591a\u5a92\u4f53\u6a21\u5757\u8c03\u8bd5\u4fe1\u606f","permalink":"/rdk_doc/Advanced_development/multimedia_development/debug_info"},"next":{"title":"7.4 \u7b97\u6cd5\u5de5\u5177\u94fe\u5f00\u53d1\u6307\u5357","permalink":"/rdk_doc/04_toolchain_development"}}');var s=n(74848),d=n(28453);const l={sidebar_position:12},t="7.3.12 \u591a\u5a92\u4f53\u6027\u80fd\u8c03\u8bd5",c={},o=[{value:"\u6982\u8ff0",id:"\u6982\u8ff0",level:2},{value:"DDR Master\u7684QoS",id:"ddr-master\u7684qos",level:2},{value:"AXI QOS\u63a7\u5236",id:"axi-qos\u63a7\u5236",level:2},{value:"VIO\u5b50\u6a21\u5757\u914d\u7f6e",id:"vio\u5b50\u6a21\u5757\u914d\u7f6e",level:2},{value:"SIF\u7684hblank\u8bbe\u7f6e",id:"sif\u7684hblank\u8bbe\u7f6e",level:2},{value:"IPU\u7684\u8bbe\u7f6e",id:"ipu\u7684\u8bbe\u7f6e",level:2},{value:"IPU Line_delay wr_ddr_fifo_thred",id:"ipu-line_delay-wr_ddr_fifo_thred",level:3},{value:"IPU Clock",id:"ipu-clock",level:3},{value:"IPU \u5b89\u5168\u5c3a\u5bf8",id:"ipu-\u5b89\u5168\u5c3a\u5bf8",level:3},{value:"\u5178\u578b\u573a\u666f\u7684\u8bbe\u7f6e",id:"\u5178\u578b\u573a\u666f\u7684\u8bbe\u7f6e",level:2},{value:"\u5355\u8def4K\u8f93\u5165\u591a\u901a\u9053\u7f16\u7801",id:"\u5355\u8def4k\u8f93\u5165\u591a\u901a\u9053\u7f16\u7801",level:3},{value:"\u53cc\u8def1080P\u8f93\u5165",id:"\u53cc\u8def1080p\u8f93\u5165",level:3},{value:"\u5355\u8def1080P\u8f93\u5165",id:"\u5355\u8def1080p\u8f93\u5165",level:3},{value:"\u591a\u8fdb\u7a0b\u5171\u4eab\u914d\u7f6e",id:"\u591a\u8fdb\u7a0b\u5171\u4eab\u914d\u7f6e",level:2},{value:"VIO\u5ef6\u65f6\u67e5\u770b",id:"vio\u5ef6\u65f6\u67e5\u770b",level:2},{value:"\u65b9\u6cd5\u4e00",id:"\u65b9\u6cd5\u4e00",level:3},{value:"\u65b9\u6cd5\u4e8c",id:"\u65b9\u6cd5\u4e8c",level:3}];function h(e){const r={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",img:"img",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,d.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(r.header,{children:(0,s.jsx)(r.h1,{id:"7312-\u591a\u5a92\u4f53\u6027\u80fd\u8c03\u8bd5",children:"7.3.12 \u591a\u5a92\u4f53\u6027\u80fd\u8c03\u8bd5"})}),"\n",(0,s.jsx)(r.h2,{id:"\u6982\u8ff0",children:"\u6982\u8ff0"}),"\n",(0,s.jsx)(r.p,{children:"Camera\u662f\u56fe\u50cf\u6570\u636e\u7684\u4e3b\u8981\u5916\u90e8\u6765\u6e90\uff0cVIO\u90e8\u5206\u8f6f\u4ef6\u662f\u4e00\u4e2a\u76f8\u5bf9\u4e0d\u900f\u660e\u7684\u5185\u90e8\u8f6f\u4ef6\uff0c\u4e3b\u8981\u9762\u5411\u63d0\u4f9b\u5185\u90e8\u5e94\u7528\u8f6f\u4ef6\u63d0\u4f9b\u76f8\u5173\u7684\u56fe\u50cf\u4ee5\u53ca\u4fe1\u606f\uff0cXJ3\u82af\u7247\u5185\u90e8\u56fe\u50cf\u5904\u7406IP\u4fe1\u606f\u5927\u81f4\u5982\u4e0b\uff1a"}),"\n",(0,s.jsx)(r.p,{children:(0,s.jsx)(r.img,{src:"https://rdk-doc.oss-cn-beijing.aliyuncs.com/doc/img/07_Advanced_development/03_multimedia_development/performance_debug/multimedia_all.png",alt:"image-20220329205706352"})}),"\n",(0,s.jsxs)(r.table,{children:[(0,s.jsx)(r.thead,{children:(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.th,{children:"\u8f93\u5165\u65b9\u5f0f"}),(0,s.jsx)(r.th,{children:"IP"}),(0,s.jsx)(r.th,{children:"\u8f93\u51fa\u65b9\u5f0f"})]})}),(0,s.jsxs)(r.tbody,{children:[(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:"Online"}),(0,s.jsx)(r.td,{children:"MIPI"}),(0,s.jsx)(r.td,{children:"Online"})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:"Online/Offline"}),(0,s.jsx)(r.td,{children:"SIF"}),(0,s.jsx)(r.td,{children:"Online/Offline"})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:"Online"}),(0,s.jsx)(r.td,{children:"ISP"}),(0,s.jsx)(r.td,{children:"Online/Offline"})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:"Online"}),(0,s.jsx)(r.td,{children:"LDC"}),(0,s.jsx)(r.td,{children:"Online"})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:"Offline"}),(0,s.jsx)(r.td,{children:"GDC"}),(0,s.jsx)(r.td,{children:"Offline"})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:"Online/Offline"}),(0,s.jsx)(r.td,{children:"IPU"}),(0,s.jsx)(r.td,{children:"Online/Offline"})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:"Online/Offline"}),(0,s.jsx)(r.td,{children:"PYM"}),(0,s.jsx)(r.td,{children:"Offline"})]})]})]}),"\n",(0,s.jsx)(r.p,{children:"\u6ce8\uff1aOnline \u6307\u786c\u4ef6\u901a\u8fc7\u7247\u5185RAM\u4ea4\u6362\u6570\u636e\uff0cOffline\u6307\u786c\u4ef6\u901a\u8fc7DDR\u4ea4\u6362\u6570\u636e\u3002"}),"\n",(0,s.jsx)(r.p,{children:"\u672c\u7ae0\u8282\u4e3b\u8981\u63cf\u8ff0X3\u82af\u7247\u5173\u4e8e\u56fe\u50cf\u6570\u636e\u5904\u7406\u901a\u8def\u7b49\u6a21\u5757\u5728\u5b9e\u9645\u4f7f\u7528\u7684\u5e38\u7528\u573a\u666f\u4e2d\uff0c\u6839\u636eDDR\u5e26\u5bbd\u548c\u5ef6\u8fdf\u8fdb\u884c\u5404\u5904\u7406\u6a21\u5757DDR\u4f18\u5148\u7ea7\u548c\u5176\u5b83\u4e00\u4e9b\u76f8\u5173\u53c2\u6570\u7684\u8c03\u6574\u3002"}),"\n",(0,s.jsx)(r.p,{children:"\u5728DDR\u77ac\u65f6\u5e26\u5bbd\u4e0d\u8db3\u65f6\u4f1a\u9020\u6210\u89c6\u9891\u4e22\u5e27\uff0c\u5728\u5e27\u7387\u548c\u4e22\u5e27\u8fd9\u4e24\u4e2a\u95ee\u9898\u4e4b\u95f4\uff0c\u53ef\u4ee5\u6839\u636e\u672c\u7ae0\u8282\u7684\u63cf\u8ff0\uff0c\u9009\u62e9\u4e00\u4e2a\u5408\u9002\u7684\u914d\u7f6e\u503c\u6765\u5e73\u8861\u3002"}),"\n",(0,s.jsx)(r.h2,{id:"ddr-master\u7684qos",children:"DDR Master\u7684QoS"}),"\n",(0,s.jsx)(r.p,{children:"XJ3 \u5404\u6a21\u5757\u901a\u8fc7AXI\u63a5\u53e3\u8bbf\u95eeDDR\uff0cXJ3\u67098\u4e2aAXI\u63a5\u53e3\uff0c\u5206\u522b\u4e3aAXI_0 ~ AXI_7\uff0cXJ3\u7684\u6a21\u5757\u4f7f\u7528AXI\u63a5\u53e3\u5173\u7cfb\u5982\u4e0b\u8868\uff1a"}),"\n",(0,s.jsxs)(r.table,{children:[(0,s.jsx)(r.thead,{children:(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.th,{children:"\u7aef\u53e3\u53f7"}),(0,s.jsx)(r.th,{children:"AXI_0"}),(0,s.jsx)(r.th,{children:"AXI_1"}),(0,s.jsx)(r.th,{children:"AXI_2"}),(0,s.jsx)(r.th,{children:"AXI_3"}),(0,s.jsx)(r.th,{children:"AXI_4"}),(0,s.jsx)(r.th,{children:"AXI_5"}),(0,s.jsx)(r.th,{children:"AXI_6"}),(0,s.jsx)(r.th,{children:"AXI_7"})]})}),(0,s.jsx)(r.tbody,{children:(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:"\u6a21\u5757\u540d"}),(0,s.jsx)(r.td,{children:"CPU/R5"}),(0,s.jsx)(r.td,{children:"NOC"}),(0,s.jsx)(r.td,{children:"CNN0"}),(0,s.jsx)(r.td,{children:"CNN1"}),(0,s.jsx)(r.td,{children:"VIO0"}),(0,s.jsx)(r.td,{children:"VPU/JPU"}),(0,s.jsx)(r.td,{children:"VIO1"}),(0,s.jsx)(r.td,{children:"PERI"})]})})]}),"\n",(0,s.jsx)(r.p,{children:"AXI_4\u548cAXI_6\u53ef\u914d\u7f6e\uff0c\u53ef\u4ee5\u901a\u8fc7\u5bc4\u5b58\u5668\u914d\u7f6eVIO\u5b50\u6a21\u5757\u5230AXI_4\u6216\u8005AXI_6\uff0cAXI_6\u6709\u66f4\u9ad8\u7684\u4f18\u5148\u7ea7\u3002"}),"\n",(0,s.jsx)(r.p,{children:"XJ3 VIO\u5305\u62ec\u5982\u4e0b\u5b50\u6a21\u5757\uff1aSIF_W\u3001ISP0_M0\u3001ISP0_M2\u3001GDC0\u3001DIS\u3001SIF_R\u3001IPU0\u3001PYM\u3001IAR\u3002"}),"\n",(0,s.jsx)(r.h2,{id:"axi-qos\u63a7\u5236",children:"AXI QOS\u63a7\u5236"}),"\n",(0,s.jsx)(r.p,{children:"AXI Qos\u4f18\u5148\u7ea7\u8303\u56f40~15\uff0c\u503c\u8d8a\u5927\u4f18\u5148\u7ea7\u8d8a\u9ad8\u3002XJ3\u7cfb\u7edf\u542f\u52a8\u540e\u8bfb\u5199QoS\u9ed8\u8ba4\u914d\u7f6e\u4e3a0x2021100\u3002"}),"\n",(0,s.jsx)(r.p,{children:"\u6bcf\u4e2aPort\u7684\u4f18\u5148\u7ea7\u503c\u901a\u8fc7Perf Monitor\u7684DDR_PORT_READ/WRITE_QOS_CTRL\u5bc4\u5b58\u5668\u8bbe\u7f6e\uff0cPerf\nMontior\u518d\u901a\u8fc7\u786c\u4ef6\u7684\u65b9\u5f0f\u8bbe\u7f6e\u5230DDR\u63a7\u5236\u5668\u4e2d\u3002\u8f6f\u4ef6\u65e0\u9700\u8bbe\u7f6eDDR\u63a7\u5236\u5668\u3002"}),"\n",(0,s.jsx)(r.p,{children:"DDR QoS\u7684\u503c\u5728DDR_Monitor\u9a71\u52a8\u4e2d\u901a\u8fc7Sysfs\u7684\u5c5e\u6027\u6587\u4ef6\u7684\u65b9\u5f0f\u8bbe\u7f6e\u548c\u67e5\u8be2\u3002"}),"\n",(0,s.jsx)(r.p,{children:"\u53ef\u4ee5\u901a\u8fc7all\u5c5e\u6027\u6587\u4ef6\u4e00\u6b21\u6027\u8bbe\u7f6e\uff0c\u6700\u4f4e\u76844bit\u5bf9\u5e94P0_CPU\uff0c\u6700\u9ad84bit\u5bf9\u5e94P7_PERI\u3002"}),"\n",(0,s.jsx)(r.p,{children:"\u4e5f\u53ef\u4ee5\u901a\u8fc7cpu\u3001bifdma\u3001bpu0\u3001bpu1\u3001vio0\u3001vpu\u3001vio1\u3001peri\u5355\u72ec\u8bbe\u7f6e\u548c\u67e5\u8be2\u5404\u4e2a\u7aef\u53e3\u7684\u4f18\u5148\u7ea7\uff0c\u5982\u4e0b\uff1a"}),"\n",(0,s.jsx)(r.p,{children:(0,s.jsx)(r.strong,{children:"QoS sysfs\u63a5\u53e3"})}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-bash",children:"#\u67e5\u8be2\u8bfbQoS\uff1a\ncat /sys/bus/platform/drivers/ddr_monitor/read_qos_ctrl/all\n\nCPU port is not allowed to be configured in runtime.\nYou can run chmod +w as root for debugging purpose.\n****************************************************\n\n04032221:\nP0_CPU:    1\nP1_BIFDMA: 2\nP2_CNN0:   2\nP3_CNN1:   2\nP4_VIO0:   3\nP5_VPU:    0\nP6_VIO1:   4\nP7_PERI:   0\n"})}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-bash",children:"cat /sys/bus/platform/drivers/ddr_monitor/write_qos_ctrl/all\n\n****************************************************\nCPU port is not allowed to be configured in runtime.\nYou can run chmod +w as root for debugging purpose.\n****************************************************\n\n04032211:\nP0_CPU:    1\nP1_BIFDMA: 1\nP2_CNN0:   2\nP3_CNN1:   2\nP4_VIO0:   3\nP5_VPU:    0\nP6_VIO1:   4\nP7_PERI:   0\n"})}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-bash",children:"#\u8bbe\u7f6ebifdma\u8bfbQoS\u4e3a2\uff1a\necho 2 > /sys/bus/platform/drivers/ddr_monitor/read_qos_ctrl/bifdma\n#\u8bbe\u7f6ebpu0\u8bfbQoS\u4e3a1\uff1a\necho 1 > /sys/bus/platform/drivers/ddr_monitor/read_qos_ctrl/bpu0\n#\u8bbe\u7f6ebpu1\u8bfbQoS\u4e3a1\uff1a\necho 1 > /sys/bus/platform/drivers/ddr_monitor/read_qos_ctrl/bpu1\n#\u8bbe\u7f6evio0\u8bfbQoS\u4e3a2\uff1a\necho 2 > /sys/bus/platform/drivers/ddr_monitor/read_qos_ctrl/vio0\n#\u8bbe\u7f6evpu\u8bfbQoS\u4e3a0\uff1a\necho 0 > /sys/bus/platform/drivers/ddr_monitor/read_qos_ctrl/vpu\n#\u8bbe\u7f6evio1\u8bfbQoS\u4e3a3\uff1a\necho 3 > /sys/bus/platform/drivers/ddr_monitor/read_qos_ctrl/vio1\n#\u8bbe\u7f6eperi\u8bfbQoS\u4e3a0\uff1a\necho 0 > /sys/bus/platform/drivers/ddr_monitor/read_qos_ctrl/peri \n#\u8bbe\u7f6ebifdma\u5199QoS\u4e3a2\uff1a\necho 2 > /sys/bus/platform/drivers/ddr_monitor/write_qos_ctrl/bifdma\n#\u8bbe\u7f6ebpu0\u5199QoS\u4e3a1\uff1a\necho 1 > /sys/bus/platform/drivers/ddr_monitor/write_qos_ctrl/bpu0\n#\u8bbe\u7f6ebpu1\u5199QoS\u4e3a1\uff1a\necho 1 > /sys/bus/platform/drivers/ddr_monitor/write_qos_ctrl/bpu1\n#\u8bbe\u7f6evio0\u5199QoS\u4e3a2\uff1a\necho 2 > /sys/bus/platform/drivers/ddr_monitor/write_qos_ctrl/vio0\n#\u8bbe\u7f6evpu\u5199QoS\u4e3a0\uff1a\necho 0 > /sys/bus/platform/drivers/ddr_monitor/write_qos_ctrl/vpu\n#\u8bbe\u7f6evio1\u5199QoS\u4e3a3\uff1a\necho 3 > /sys/bus/platform/drivers/ddr_monitor/write_qos_ctrl/vio1\n#\u8bbe\u7f6eperi\u5199QoS\u4e3a0\uff1a\necho 0 > /sys/bus/platform/drivers/ddr_monitor/write_qos_ctrl/peri\n"})}),"\n",(0,s.jsx)(r.h2,{id:"vio\u5b50\u6a21\u5757\u914d\u7f6e",children:"VIO\u5b50\u6a21\u5757\u914d\u7f6e"}),"\n",(0,s.jsx)(r.p,{children:"XJ3 VIO\u5b50\u6a21\u5757\u5305\u62ecSIF_W\u3001ISP0_M0\u3001ISP0_M2\u3001GDC0\u3001DIS\u3001SIF_R\u3001IPU0\u3001PYM\u3001IAR\uff0c\u5206\u522b\u5bf9\u5e94SIF\u6a21\u5757\u5199\u3001ISP\u5199\u3001ISP Temper\u8bfb\u5199\u3001GDC0\u8bfb\u5199\u3001DIS\u5199\u3001SIF\u6a21\u5757\u8bfb\u3001IPU0\u6a21\u5757\u8bfb\u5199\u3001PYM\u6a21\u5757\u8bfb\u5199\u3001IAR\u6a21\u5757\u8bfb\u5199\u3002"}),"\n",(0,s.jsx)(r.p,{children:"\u53ef\u4ee5\u901a\u8fc7AXIBUS\u5bc4\u5b58\u5668\u5c06\u8fd9\u4e9b\u5b50\u6a21\u5757\u914d\u7f6e\u5230VIO0\u6216\u8005VIO1\u4e0a\uff0cXJ3\u7cfb\u7edf\u542f\u52a8\u540e\u9ed8\u8ba4\u914d\u7f6eIAR\u548cSIF_W\u5230VIO1\uff0c\u5176\u4f59\u6a21\u5757\u914d\u7f6e\u5230VIO0\u3002AXIBUS\u5bc4\u5b58\u5668bit31~bit16\u5bf9\u5e94\u5b50\u6a21\u5757\u5982\u4e0b\u56fe\uff1a"}),"\n",(0,s.jsx)(r.p,{children:(0,s.jsx)(r.img,{src:"https://rdk-doc.oss-cn-beijing.aliyuncs.com/doc/img/07_Advanced_development/03_multimedia_development/performance_debug/vio_config.png",alt:""})}),"\n",(0,s.jsx)(r.p,{children:"\u5176\u4e2d\u7070\u8272\u90e8\u5206\u6a21\u5757\u4e0d\u5b58\u5728\uff0c\u5bf9\u5e94bit\u8bbe\u7f6e\u4e3a1\uff0c\u8be5\u5b50\u6a21\u5757\u88ab\u914d\u7f6e\u5230VIO1\u4e0a\uff0c\u5426\u5219\u914d\u7f6e\u5230VIO0\u4e0a\u3002\u53ef\u4ee5\u901a\u8fc7all\u5c5e\u6027\u4e00\u6b21\u6027\u914d\u7f6e\u6216\u67e5\u8be2\uff0c\u67e5\u8be2\u8fd4\u56devio1\u4e0a\u7684\u6a21\u5757\uff0c\u522b\u7684\u6a21\u5757\u5728vio0\u4e0a\u3002\u4e5f\u53ef\u4ee5\u901a\u8fc7\u5b50\u6a21\u5757\u5c5e\u6027\u5355\u72ec\u914d\u7f6e\u6216\u67e5\u8be2\u3002"}),"\n",(0,s.jsx)(r.p,{children:"AXIBUS sys\u63a5\u53e3"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-bash",children:"# \u8bbe\u7f6e\uff0c\u503c\u4e3a1\u914d\u7f6e\u5230vio1\uff0c\u503c\u4e3a0\u914d\u7f6e\u5230vio0\necho 0xc0020000 > /sys/bus/platform/drivers/ddr_monitor/axibus_ctrl/all\necho 0 > /sys/bus/platform/drivers/ddr_monitor/axibus_ctrl/sifr\necho 0 > /sys/bus/platform/drivers/ddr_monitor/axibus_ctrl/isp0m0\necho 0 > /sys/bus/platform/drivers/ddr_monitor/axibus_ctrl/isp0m1\necho 0 > /sys/bus/platform/drivers/ddr_monitor/axibus_ctrl/isp0m2\necho 0 > /sys/bus/platform/drivers/ddr_monitor/axibus_ctrl/t21\necho 0 > /sys/bus/platform/drivers/ddr_monitor/axibus_ctrl/gdc0\necho 0 > /sys/bus/platform/drivers/ddr_monitor/axibus_ctrl/gdc1\necho 1 > /sys/bus/platform/drivers/ddr_monitor/axibus_ctrl/iar\necho 1 > /sys/bus/platform/drivers/ddr_monitor/axibus_ctrl/pym\necho 1 > /sys/bus/platform/drivers/ddr_monitor/axibus_ctrl/sifw\necho 0 > /sys/bus/platform/drivers/ddr_monitor/axibus_ctrl/ipu0 \n#\u8bfb\u53d6\uff0c\u6253\u5370\u6240\u6709\u914d\u7f6e\u5728vio1\u4e0a\u7684\u6a21\u5757\uff0c\u5176\u4f59\u6a21\u5757\u4e3avio0\ncat /sys/bus/platform/drivers/ddr_monitor/axibus_ctrl/all axibus: 0xc0020000: sifw: vio1 pym: vio1 iar: vio1\n#\u6a21\u5757\u8bfb\u53d6\ncat /sys/bus/platform/drivers/ddr_monitor/axibus_ctrl/sifr axibus: 0xc0020000: sifr: vio0\ncat /sys/bus/platform/drivers/ddr_monitor/axibus_ctrl/sifw axibus: 0xc0020000: sif: vio1\ncat /sys/bus/platform/drivers/ddr_monitor/axibus_ctrl/isp0m0 axibus: 0xc0020000: isp_0_m0: vio0\ncat /sys/bus/platform/drivers/ddr_monitor/axibus_ctrl/isp0m1 axibus: 0xc0020000: isp_0_m1: vio0\ncat /sys/bus/platform/drivers/ddr_monitor/axibus_ctrl/isp0m2 axibus: 0xc0020000: isp_0_m2: vio0\ncat /sys/bus/platform/drivers/ddr_monitor/axibus_ctrl/gdc0 axibus: 0xc0020000: gdc_0: vio0\ncat /sys/bus/platform/drivers/ddr_monitor/axibus_ctrl/gdc1 axibus: 0xc0020000: gdc_1: vio0\ncat /sys/bus/platform/drivers/ddr_monitor/axibus_ctrl/t21 axibus: 0xc0020000: t21: vio0\ncat /sys/bus/platform/drivers/ddr_monitor/axibus_ctrl/ipu0 axibus: 0xc0020000: ipu0: vio0\ncat /sys/bus/platform/drivers/ddr_monitor/axibus_ctrl/pym axibus: 0xc0020000: pym: vio1\ncat /sys/bus/platform/drivers/ddr_monitor/axibus_ctrl/iar axibus: 0xc0020000: iar: vio1\n"})}),"\n",(0,s.jsx)(r.h2,{id:"sif\u7684hblank\u8bbe\u7f6e",children:"SIF\u7684hblank\u8bbe\u7f6e"}),"\n",(0,s.jsx)(r.p,{children:"SIF\u5c06\u8bfb\u53d6\u5230\u7684\u56fe\u50cf\u9010\u884c\u9001\u7ed9ISP\u5904\u7406\uff0c\u53ef\u4ee5\u901a\u8fc7\u589e\u52a0\u884c\u95f4\u9694hblank\u6765\u5ef6\u8fdf\u4e0b\u4e00\u884c\u7684\u9001\u51fa\uff0c\u4ee5\u7f6e\u6362\u66f4\u591a\u65f6\u95f4\u7ed9ISP\u6216\u540e\u8fb9\u7684\u6a21\u5757\u505a\u5904\u7406\u3002"}),"\n",(0,s.jsx)(r.p,{children:"XJ3 SIF\u9ed8\u8ba4\u7684hblank\u4e3a10\u3002"}),"\n",(0,s.jsx)(r.p,{children:"hblank\u4f1a\u5f71\u54cd\u5e27\u7387\uff0c\u4e0e\u5e27\u7387\u7684\u5173\u7cfb\u4e3a\uff1a"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-shell",children:"time = ((width + hblank * 32) * hight\uff09/ (clock * 1000) \n# clock\u4e3aISP\u9891\u7387\uff0c\u9ed8\u8ba4\u4e3a544M\u3002\n"})}),"\n",(0,s.jsx)(r.p,{children:"\u4ee54K\u4e3a\u4f8b\u8ba1\u7b97\u5982\u4e0b\uff1a"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-shell",children:"time = ((width + hblank * 32) * high) / (clock * 1000)\n"})}),"\n",(0,s.jsxs)(r.table,{children:[(0,s.jsx)(r.thead,{children:(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.th,{children:"image width"}),(0,s.jsx)(r.th,{children:"hblank(register)"}),(0,s.jsx)(r.th,{children:"image high"}),(0,s.jsx)(r.th,{children:"clock(MHz)"}),(0,s.jsx)(r.th,{children:"time(ms)"}),(0,s.jsx)(r.th,{children:"fps"})]})}),(0,s.jsxs)(r.tbody,{children:[(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:"3840"}),(0,s.jsx)(r.td,{children:"10"}),(0,s.jsx)(r.td,{children:"2160"}),(0,s.jsx)(r.td,{children:"544"}),(0,s.jsx)(r.td,{children:"16.5176"}),(0,s.jsx)(r.td,{children:"60.54"})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:"3840"}),(0,s.jsx)(r.td,{children:"40"}),(0,s.jsx)(r.td,{children:"2160"}),(0,s.jsx)(r.td,{children:"544"}),(0,s.jsx)(r.td,{children:"20.3294"}),(0,s.jsx)(r.td,{children:"49.19"})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:"3840"}),(0,s.jsx)(r.td,{children:"70"}),(0,s.jsx)(r.td,{children:"2160"}),(0,s.jsx)(r.td,{children:"544"}),(0,s.jsx)(r.td,{children:"24.1412"}),(0,s.jsx)(r.td,{children:"41.42"})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:"3840"}),(0,s.jsx)(r.td,{children:"120"}),(0,s.jsx)(r.td,{children:"2160"}),(0,s.jsx)(r.td,{children:"544"}),(0,s.jsx)(r.td,{children:"30.4941"}),(0,s.jsx)(r.td,{children:"32.79"})]})]})]}),"\n",(0,s.jsx)(r.p,{children:"\u63d0\u4f9bSysfs\u63a5\u53e3\u8bbe\u7f6e\u67e5\u8be2hblank\uff0c\u5982\u4e0b\uff1a"}),"\n",(0,s.jsx)(r.p,{children:"\u8bbe\u7f6ehblank\uff1aecho 120 > /sys/devices/platform/soc/a4001000.sif/hblank"}),"\n",(0,s.jsx)(r.p,{children:"\u67e5\u8be2hblank\uff1acat /sys/devices/platform/soc/a4001000.sif/hblank"}),"\n",(0,s.jsx)(r.h2,{id:"ipu\u7684\u8bbe\u7f6e",children:"IPU\u7684\u8bbe\u7f6e"}),"\n",(0,s.jsx)(r.h3,{id:"ipu-line_delay-wr_ddr_fifo_thred",children:"IPU Line_delay wr_ddr_fifo_thred"}),"\n",(0,s.jsx)(r.p,{children:"IPU\u6709\u4e2aline_delay\u8bbe\u7f6e\uff0c\u5355\u4f4d\u4e3a1\u884c\u3002\u503c\u8d8a\u5927\uff0c\u4ee3\u8868IPU\u53ef\u4ee5\u5fcd\u53d7\u7684\u603b\u7ebf\u5ef6\u8fdf\u66f4\u5927\uff0c\u5bf9offline\u6a21\u5f0f\u4e0b\u964d\u4f4eframe drop\u6709\u5e2e\u52a9\u3002"}),"\n",(0,s.jsx)(r.p,{children:"\u540c\u65f6wr_ddr_fifo_thred\u7684\u503c\u8d8a\u5c0f\u8d8a\u80fd\u591f\u964d\u4f4eframe drop\u3002"}),"\n",(0,s.jsx)(r.p,{children:"\u5f53ipu\u8f93\u51fa\u591a\u4e2a\u901a\u9053\u540c\u65f6\u5230DDR\u7684\u65f6\u5019\uff0c\u5efa\u8bae\u5c06line_delay\u8bbe\u7f6e\u4e3a255\uff0cwr_ddr_fifo_thred\u8bbe\u7f6e\u4e3a0\u3002"}),"\n",(0,s.jsx)(r.p,{children:"line_delay\u9ed8\u8ba4\u503c\u662f16\uff0cwr_fifo_thred0\u9ed8\u8ba4\u503c\u662f0x30323020\uff0cwr_fifo_thred1\u9ed8\u8ba4\u503c\u662f0x00003220\u3002"}),"\n",(0,s.jsx)(r.p,{children:"\u63d0\u4f9bsysfs\u63a5\u53e3\u8bbe\u7f6e\u5982\u4e0b:"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{children:"echo 0x0 > /sys/devices/platform/soc/a4040000.ipu/wr_fifo_thred0\necho 0x0 > /sys/devices/platform/soc/a4040000.ipu/wr_fifo_thred1\necho 255 > /sys/devices/platform/soc/a4040000.ipu/line_delay\n"})}),"\n",(0,s.jsx)(r.h3,{id:"ipu-clock",children:"IPU Clock"}),"\n",(0,s.jsx)(r.p,{children:"IPU\u7684clock\u7531SIF mclk\u63d0\u4f9b\uff0c\u53ef\u4ee5\u901a\u8fc7sysfs\u914d\u7f6eSIF clock\u6765\u6539\u53d8IPU\u7684\u9891\u7387\uff0cIPU\u9891\u7387\u9ed8\u8ba4\u4e3a544MHz\uff0c\u53ef\u4ee5\u914d\u7f6e\u7684\u9891\u7387\u6709544M\u3001408M\u3001326M\u3001272M\u3002"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{children:"echo 544000000 > /sys/module/hobot_dev_ips/parameters/sif_mclk_freq\n"})}),"\n",(0,s.jsx)(r.h3,{id:"ipu-\u5b89\u5168\u5c3a\u5bf8",children:"IPU \u5b89\u5168\u5c3a\u5bf8"}),"\n",(0,s.jsx)(r.p,{children:"IPU\u591a\u4e2a\u901a\u9053\u7684FIFO\u6df1\u5ea6\u4e0d\u540c\uff0c\u5b89\u5168\u5c3a\u5bf8\u5982\u4e0b"}),"\n",(0,s.jsxs)(r.table,{children:[(0,s.jsx)(r.thead,{children:(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.th,{children:(0,s.jsx)(r.strong,{children:"IPU Scaler #"})}),(0,s.jsx)(r.th,{children:(0,s.jsx)(r.strong,{children:"Full \u6df1\u5ea6\u9650\u5236 (Bytes)"})}),(0,s.jsx)(r.th,{children:(0,s.jsx)(r.strong,{children:"\u5efa\u8bae\u5206\u8fa8\u7387(\u50cf\u7d20)"})})]})}),(0,s.jsxs)(r.tbody,{children:[(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:"Scaler 5(IPU US)"}),(0,s.jsx)(r.td,{children:"4096"}),(0,s.jsx)(r.td,{children:"8M"})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:"Scaler 2(DS2)"}),(0,s.jsx)(r.td,{children:"4096"}),(0,s.jsx)(r.td,{children:"8M"})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:"Scaler 1(DS1)"}),(0,s.jsx)(r.td,{children:"2048"}),(0,s.jsx)(r.td,{children:"2M"})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:"Scaler 3(DS3)"}),(0,s.jsx)(r.td,{children:"2048"}),(0,s.jsx)(r.td,{children:"2M"})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:"Scaler 4(DS4)"}),(0,s.jsx)(r.td,{children:"1280"}),(0,s.jsx)(r.td,{children:"1M"})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:"Scaler 0(DS0)"}),(0,s.jsx)(r.td,{children:"1280"}),(0,s.jsx)(r.td,{children:"1M"})]})]})]}),"\n",(0,s.jsx)(r.p,{children:"Scaler0~4\u5bf9\u5e94IPU\u7684ds0~5\uff0cScaler5\u5bf9\u5e94IPU\u7684us\u3002\u5982\u679c\u8f93\u51fa\u5c3a\u5bf8\u8d85\u8fc7\u5b89\u5168\u5c3a\u5bf8\uff0c\u53ef\u80fd\u4f1a\u9020\u6210\u786c\u4ef6\u4e22\u5e27\u6982\u7387\u53d8\u5927\u3001\u8f93\u51fa\u6570\u636e\u4e2d\u8fde\u7eed\u4e8c\u4e09\u5341\u5b57\u8282\u51fa\u9519\u7684\u98ce\u9669\u3002"}),"\n",(0,s.jsx)(r.h2,{id:"\u5178\u578b\u573a\u666f\u7684\u8bbe\u7f6e",children:"\u5178\u578b\u573a\u666f\u7684\u8bbe\u7f6e"}),"\n",(0,s.jsx)(r.h3,{id:"\u5355\u8def4k\u8f93\u5165\u591a\u901a\u9053\u7f16\u7801",children:"\u5355\u8def4K\u8f93\u5165\u591a\u901a\u9053\u7f16\u7801"}),"\n",(0,s.jsx)(r.p,{children:"\u5178\u578b\u573a\u666f\u5982\u4e0b\uff1a4k DOL2\u8f93\u5165\uff0cSIF - offline - ISP - GDC - IPU\uff0cIPU\u51fa1\u8def4k\uff0c2\u8def1080P\uff0c2\u8defD1 \u51715\u8def\u9001\u7f16\u7801\u5668\u7f16\u7801\u3002\u540c\u65f6IPU ds2 online \u5230PYM\uff0cPYM\u51fa720P\u3002"}),"\n",(0,s.jsx)(r.p,{children:"SIF hblank\u548cQoS\u5efa\u8bae\u914d\u7f6e\u5982\u4e0b\uff1a"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{children:"echo 120 > /sys/devices/platform/soc/a4001000.sif/hblank\necho 0x10100000 > /sys/bus/platform/drivers/ddr_monitor/axibus_ctrl/all\necho 0x03120000 > /sys/bus/platform/drivers/ddr_monitor/read_qos_ctrl/all\necho 0x03120000 > /sys/bus/platform/drivers/ddr_monitor/write_qos_ctrl/all\n"})}),"\n",(0,s.jsx)(r.h3,{id:"\u53cc\u8def1080p\u8f93\u5165",children:"\u53cc\u8def1080P\u8f93\u5165"}),"\n",(0,s.jsx)(r.p,{children:"\u5178\u578b\u573a\u666f\u5982\u4e0b\uff1a\u4e24\u8def1080P\u8f93\u5165\uff0cSIF-offline-ISP-online-IPU-online-PYM->DDR(\u57fa\u7840\u5c42)\u3002"}),"\n",(0,s.jsx)(r.p,{children:"\u4e00\u8defpym\u51fa\u6765\u7684\u53bb\u7f16\u7801\uff081080P\uff09+\u663e\u793a\uff081080P\uff09\uff0c\u53e6\u4e00\u8def\u5f00BPU\u3002"}),"\n",(0,s.jsx)(r.p,{children:"SIF hblank\u548cQoS\u5efa\u8bae\u914d\u7f6e\u5982\u4e0b\uff1a"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{children:"echo 120 > /sys/devices/platform/soc/a4001000.sif/hblank  \necho 0x40000000 > /sys/bus/platform/drivers/ddr_monitor/axibus_ctrl/all\n"})}),"\n",(0,s.jsx)(r.h3,{id:"\u5355\u8def1080p\u8f93\u5165",children:"\u5355\u8def1080P\u8f93\u5165"}),"\n",(0,s.jsx)(r.p,{children:"\u5178\u578b\u573a\u666f\u5982\u4e0b\uff1a\u5355\u8def1080P\u8f93\u5165\uff0cSIF-offline-ISP-online-IPU\uff0cIPU 6\u901a\u9053roi\u6253\u5f00\u3002"}),"\n",(0,s.jsx)(r.p,{children:"SIF hblank\u5efa\u8bae\u914d\u7f6e\u5982\u4e0b\uff1a"}),"\n",(0,s.jsx)(r.p,{children:"echo 64 > /sys/devices/platform/soc/a4001000.sif/hblank"}),"\n",(0,s.jsx)(r.h2,{id:"\u591a\u8fdb\u7a0b\u5171\u4eab\u914d\u7f6e",children:"\u591a\u8fdb\u7a0b\u5171\u4eab\u914d\u7f6e"}),"\n",(0,s.jsx)(r.p,{children:"\u591a\u8fdb\u7a0b\u5171\u4eab\u76ee\u524d\u6700\u591a\u652f\u63018\u4e2a\u8fdb\u7a0b\u5171\u4eab\u4e00\u8defcamera\u6570\u636e\uff0c\u652f\u6301\u4eceIPU\u548cPYM\u83b7\u53d6\u8f93\u51fa\u6570\u636e\uff0c\u591a\u8fdb\u7a0b\u5171\u4eab\u9700\u8981\u6ee1\u8db3\uff1a"}),"\n",(0,s.jsxs)(r.ul,{children:["\n",(0,s.jsx)(r.li,{children:"\u5fc5\u987b\u662f\u5168online\u7684\u573a\u666f\uff1aSIF-online-ISP-online-IPU-online-PYM\uff1b"}),"\n",(0,s.jsx)(r.li,{children:"\u8f93\u51fa\u901a\u9053\u914d\u7f6eBUF\u4e2a\u6570\u9700\u8981\u5927\u4e8e\u7b49\u4e8e4\uff0c\u5426\u5219\u4f1a\u6709\u5e27\u7387\u8f83\u4f4e\u7684\u98ce\u9669\uff1b"}),"\n"]}),"\n",(0,s.jsx)(r.h2,{id:"vio\u5ef6\u65f6\u67e5\u770b",children:"VIO\u5ef6\u65f6\u67e5\u770b"}),"\n",(0,s.jsx)(r.h3,{id:"\u65b9\u6cd5\u4e00",children:"\u65b9\u6cd5\u4e00"}),"\n",(0,s.jsx)(r.p,{children:"1.\u6b63\u5e38\u8dd1vio\u5e94\u7528\uff0cls /tmp\uff0c\u53ef\u4ee5\u770b\u5230\u5982\u4e0b\u5728/tmp\u76ee\u5f55\u4e0b\u6709vio_group_info_pidxxx\uff0c\u5176\u4e2dxxx\u662f\u8fdb\n\u7a0b\u53f7\u3002"}),"\n",(0,s.jsx)(r.p,{children:'2.\u5728\u677f\u5b50\u547d\u4ee4\u884c\u8f93\u5165echo "frame_state" > /tmp/vio_group_info_pidxxx\u547d\u4ee4\uff0c\u5176\u4e2dxxx\u5bf9\u5e94\u6b65\u9aa41\n\u7684\u8fdb\u7a0b\u53f7\u3002'}),"\n",(0,s.jsx)(r.p,{children:"3.\u6b65\u9aa42\u4e4b\u540e\uff0c\u4f1a\u5728/userdata/log/usr/\u76ee\u5f55\u4e0b\u9762\u751f\u6210dump\u7684\u4fe1\u606f\nvio_frame_state_pipe[pipeline]_[time].log"}),"\n",(0,s.jsx)(r.p,{children:"4.\u7528Notepad++\uff0c\u901a\u8fc7\u641c\u7d22Frmid xxxxx\uff0c\u5176\u4e2dxxxxx\u662f\u5e27\u53f7\uff0c\u4f1a\u628aISP\uff0cIPU\uff0cPYM\u7684TimeStp\u641c\u7d22\u51fa\n\u6765\uff0c\u901a\u8fc7\u628aPYM out free\u524d\u9762\u5bf9\u5e94\u7684xxx\u65f6\u95f4-ISP out dq\u524d\u9762\u5bf9\u5e94\u7684xxx\u65f6\u95f4\u5f97\u51fa\u6a21\u5757\u5f97\u5904\u7406\u65f6\u95f4\u3002"}),"\n",(0,s.jsx)(r.p,{children:"\u5982\u4e0b\u622a\u56fe\uff1a"}),"\n",(0,s.jsx)(r.p,{children:(0,s.jsx)(r.img,{src:"https://rdk-doc.oss-cn-beijing.aliyuncs.com/doc/img/07_Advanced_development/03_multimedia_development/performance_debug/vio_delay_view.png",alt:"image-20220929113655983"})}),"\n",(0,s.jsx)(r.h3,{id:"\u65b9\u6cd5\u4e8c",children:"\u65b9\u6cd5\u4e8c"}),"\n",(0,s.jsx)(r.p,{children:"\u901a\u8fc7HB_VPS_GetChnFrame(int VpsGrp, int VpsChn, void *videoFrame, int ms)\u63a5\u53e3\u83b7\u53d6\u5230\u91d1\u5b57\u5854\u5f97videoFrame\uff0c\u6b64\u7ed3\u6784\u4f53\u6307\u9488\u5f3a\u5236\u8f6c\u6362\u6210pym_buffer_t\u6307\u9488\uff0c\u901a\u8fc7pym_buffer_t\u627e\u5230pym_img_info\uff0cpym_img_info\u5305\u542b\u4e86struct timeval tv\uff0c\u8fd9\u4e2atv\u662fsif\u5f97frame start\u586b\u5145\u5f97\u7cfb\u7edf\u65f6\u95f4\uff0c\u4f7f\u7528gettimeofday\u63a5\u53e3\u83b7\u53d6\u5230\u7cfb\u7edf\u5f53\u524d\u65f6\u95f4\u51cf\u53bbtv\u65f6\u95f4\u5c31\u662fsif\u7684frame start->pym\u83b7\u53d6\u5230\u6570\u636e\u7684\u5ef6\u65f6\u3002"})]})}function a(e={}){const{wrapper:r}={...(0,d.R)(),...e.components};return r?(0,s.jsx)(r,{...e,children:(0,s.jsx)(h,{...e})}):h(e)}}}]);