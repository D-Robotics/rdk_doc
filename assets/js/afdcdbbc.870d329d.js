"use strict";(self.webpackChunkrdk_doc=self.webpackChunkrdk_doc||[]).push([[85226],{28453:(e,n,d)=>{d.d(n,{R:()=>r,x:()=>l});var s=d(96540);const i={},t=s.createContext(i);function r(e){const n=s.useContext(t);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:r(e.components),s.createElement(t.Provider,{value:n},e.children)}},98125:(e,n,d)=>{d.r(n),d.d(n,{assets:()=>c,contentTitle:()=>l,default:()=>_,frontMatter:()=>r,metadata:()=>s,toc:()=>o});const s=JSON.parse('{"id":"Advanced_development/linux_development/driver_development_x5/driver_lcd","title":"LCD\u9a71\u52a8\u8c03\u8bd5\u6307\u5357","description":"1.\u89c4\u683c\u53c2\u6570","source":"@site/docs/07_Advanced_development/02_linux_development/driver_development_x5/driver_lcd.md","sourceDirName":"07_Advanced_development/02_linux_development/driver_development_x5","slug":"/Advanced_development/linux_development/driver_development_x5/driver_lcd","permalink":"/rdk_doc/Advanced_development/linux_development/driver_development_x5/driver_lcd","draft":false,"unlisted":false,"tags":[],"version":"current","lastUpdatedAt":1752312863000,"sidebarPosition":11,"frontMatter":{"sidebar_position":11},"sidebar":"tutorialSidebar","previous":{"title":"\u4f4e\u529f\u8017\u6a21\u5f0f\u8c03\u8bd5\u6307\u5357","permalink":"/rdk_doc/Advanced_development/linux_development/driver_development_x5/driver_lowpower"},"next":{"title":"7.2.3 \u786c\u4ef6\u5355\u5143\u6d4b\u8bd5","permalink":"/rdk_doc/Advanced_development/linux_development/hardware_unit_test/"}}');var i=d(74848),t=d(28453);const r={sidebar_position:11},l="LCD\u9a71\u52a8\u8c03\u8bd5\u6307\u5357",c={},o=[{value:"1.\u89c4\u683c\u53c2\u6570",id:"1\u89c4\u683c\u53c2\u6570",level:2},{value:"2.\u8c03\u8bd5\u6d41\u7a0b",id:"2\u8c03\u8bd5\u6d41\u7a0b",level:2},{value:"Kernel \u9a71\u52a8\u5c42\u9762",id:"kernel-\u9a71\u52a8\u5c42\u9762",level:3},{value:"Kernel \u8bbe\u5907\u6811\u5c42\u9762",id:"kernel-\u8bbe\u5907\u6811\u5c42\u9762",level:3},{value:"3.\u7f16\u8bd1",id:"3\u7f16\u8bd1",level:2},{value:"4.\u6d4b\u8bd5",id:"4\u6d4b\u8bd5",level:2},{value:"5.\u5907\u6ce8",id:"5\u5907\u6ce8",level:2}];function p(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",img:"img",li:"li",p:"p",pre:"pre",ul:"ul",...(0,t.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"lcd\u9a71\u52a8\u8c03\u8bd5\u6307\u5357",children:"LCD\u9a71\u52a8\u8c03\u8bd5\u6307\u5357"})}),"\n",(0,i.jsx)(n.h2,{id:"1\u89c4\u683c\u53c2\u6570",children:"1.\u89c4\u683c\u53c2\u6570"}),"\n",(0,i.jsx)(n.p,{children:"X5\u7684MIPI-DSI\u63a5\u53e3\u89c4\u683c\u5982\u4e0b\uff1a"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"\u6700\u5927\u652f\u6301\u56db\u8def\u6570\u636e\u901a\u8def"}),"\n",(0,i.jsxs)(n.li,{children:["\u6bcf\u4e00\u8def\u6700\u9ad8\u901f\u7387\u4e3a",(0,i.jsx)("font",{color:"red",children:"2.5Gbps"})]}),"\n",(0,i.jsxs)(n.li,{children:["\u652f\u6301",(0,i.jsx)("font",{color:"red",children:"Non-Burst-Sync-Pulse"}),"\u540c\u6b65\u8109\u51b2\u6a21\u5f0f\u548c",(0,i.jsx)("font",{color:"red",children:"Non-Burst-Sync-Even"}),"\u540c\u6b65\u4e8b\u4ef6\u6a21\u5f0f\u4ee5\u53caBurst\u7a81\u53d1\u6a21\u5f0f"]}),"\n",(0,i.jsxs)(n.li,{children:["\u652f\u6301",(0,i.jsx)("font",{color:"red",children:"MIPI_DSI_CLOCK_NON_CONTINUOUS"}),"\u975e\u8fde\u7eed\u65f6\u949f\u6a21\u5f0f\u548c",(0,i.jsx)("font",{color:"red",children:"MIPI_DSI_CLOCK_CONTINUOUS"}),"\u8fde\u7eed\u65f6\u949f\u6a21\u5f0f"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"2\u8c03\u8bd5\u6d41\u7a0b",children:"2.\u8c03\u8bd5\u6d41\u7a0b"}),"\n",(0,i.jsx)(n.p,{children:"\u5728\u6dfb\u52a0\u65b0\u5c4f\u5e55\u9a71\u52a8\u4e4b\u524d\uff0c\u9700\u8981\u786e\u5b9a\u4ee5\u4e0b\u4fe1\u606f\uff1a"}),"\n",(0,i.jsx)(n.p,{children:"\u5c4f\u5e55\u7684\u65f6\u5e8f\uff0c\u5373hbp\u3001hfp\u3001hsa\u3001vbp\u3001vfp\u3001vsa"}),"\n",(0,i.jsx)(n.p,{children:"\u5c4f\u5e55\u7684\u521d\u59cb\u5316\u5e8f\u5217"}),"\n",(0,i.jsx)(n.p,{children:"\u5c4f\u5e55\u652f\u6301\u7684\u4f20\u8f93\u6a21\u5f0f\uff0c\u662fburst\u8fd8\u662fnon-burst"}),"\n",(0,i.jsx)(n.p,{children:"\u5c4f\u5e55\u652f\u6301\u7684\u65f6\u949f\u6a21\u5f0f\uff0c\u662fcontinuous\u8fd8\u662fnon-continuous"}),"\n",(0,i.jsxs)(n.p,{children:["\u4ee5",(0,i.jsx)(n.code,{children:"JC050HD134"}),"\u8fd9\u6b3e\u5c4f\u5e55\u4e3a\u4f8b\uff0c\u4ece\u5382\u5bb6\u63d0\u4f9b\u7684\u914d\u7f6e\u4e2d\u5f97\u77e5\u4ee5\u4e0b\u4fe1\u606f\uff1a"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"#define Width 720\n#define Height 1280\n\n#define VFP 20\n#define VBP 20\n#define VSA 4\n\n#define HFP 32\n#define HBP 20\n#define HSA 20\n"})}),"\n",(0,i.jsx)(n.h3,{id:"kernel-\u9a71\u52a8\u5c42\u9762",children:"Kernel \u9a71\u52a8\u5c42\u9762"}),"\n",(0,i.jsx)(n.p,{children:"kernel\u91cc\u9762\u6709\u4e00\u4efd\u5df2\u7ecf\u8c03\u8bd5\u597d\u7684\u53c2\u8003\u4ee3\u7801\uff1apanel-atk-md0550.c\uff0c\u540e\u7eed\u7684\u5c4f\u5e55\u9a71\u52a8\u53ef\u4ee5\u4ece\u8fd9\u4efd\u9a71\u52a8\u4e0a\u9762\u6d3e\u751f\u51fa\u6765\u3002"}),"\n",(0,i.jsx)(n.p,{children:"\u5c06kernel/drivers/gpu/drm/panel/panel-atk-md0550.c\u62f7\u8d1d\u4e00\u4efd\uff0c\u5e76\u91cd\u547d\u540d\u4e3apanel-jc-050hd134.c\u3002"}),"\n",(0,i.jsx)(n.p,{children:"\u4ee5\u4e0b\u4fee\u6539\u90fd\u662f\u57fa\u4e8epanel-jc-050hd134.c\u3002"}),"\n",(0,i.jsx)(n.p,{children:"\u4fee\u6539\u7684panel_simple_dsi_driver\u7684name\u5c5e\u6027\u5b57\u6bb5\u4e3apanel-jc-050hd134\uff1a"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:'static struct mipi_dsi_driver panel_simple_dsi_driver = {\n\t.driver =\n\t\t{\n\t\t\t.name\t\t= "panel-jc-050hd134",\n\t\t\t.of_match_table = dsi_of_match,\n\t\t},\n\t.probe\t  = panel_simple_dsi_probe,\n\t.remove\t  = panel_simple_dsi_remove,\n\t.shutdown = panel_simple_dsi_shutdown,\n};\n'})}),"\n",(0,i.jsx)(n.p,{children:"\u4fee\u6539drm_display_mode\u7ed3\u6784\u4f53\uff1a"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"static const struct drm_display_mode jc_050hd134_mode = { // \u4fee\u6539\u7ed3\u6784\u4f53\u540d\u5b57\u4e3a jc_050hd134_mode\n\t.clock\t     = 65000, //\u50cf\u7d20\u65f6\u949f \u5355\u4f4d\u4e3akhz\uff0c\u8ba1\u7b97\u516c\u5f0f\u4e3a\uff1afps * (htotal + vtotal)\n\t.hdisplay    = 720, //\u53ef\u89c6\u533a\u57df\u5bbd\n\t.hsync_start = 720 + 32, //hdisplay + hfp\n\t.hsync_end   = 720 + 32 + 20, //hsync_start + hsa\n\t.htotal\t     = 720 + 32 + 20 + 20, //hsync_end + hbp\n\t.vdisplay    = 1280, // \u53ef\u89c6\u533a\u57df\u9ad8\n\t.vsync_start = 1280 + 20, //vdisplay + vfp\n\t.vsync_end   = 1280 + 20 + 4, // vsync_start + vsa\n\t.vtotal\t     = 1280 + 20 + 4 + 20, // vsync_end + vbp\n\t.flags\t     = DRM_MODE_FLAG_NHSYNC | DRM_MODE_FLAG_NVSYNC, //\u6781\u6027\n};\n"})}),"\n",(0,i.jsx)(n.p,{children:"\u4fee\u6539panel_desc_dsi\u7ed3\u6784\u4f53\uff1a"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"static const struct panel_desc_dsi jc_050hd134 = { //\u7ed3\u6784\u4f53\u91cd\u547d\u540d\u4e3a jc_050hd134\n\t.desc =\n\t\t{\n\t\t\t.modes\t   = &jc_050hd134_mode, // \u6307\u5411\u65f6\u5e8f\u7ed3\u6784\u4f53\n\t\t\t.num_modes = 1, // \u8fd9\u4e2a\u9762\u677f\u6709\u591a\u5c11\u7ec4\u65f6\u5e8f\uff0c\u4e00\u822c\u6765\u8bb2\u53ea\u6709\u4e00\u7ec4\n\t\t\t.bpc\t   = 8, // \u6bcf\u79cd\u8272\u5f69\u5360\u591a\u5c11bit\uff1fRGB888 \u5373\u6bcf\u4e2a\u989c\u8272\u53608bit\uff0cRGB666 \u5373\u6bcf\u4e2a\u989c\u8272\u53606bit\n\t\t\t.size = // \u53ef\u89c6\u533a\u57df\u7684\u7269\u7406\u5927\u5c0f\uff0c\u4ee5mm\uff08\u6beb\u7c73\uff09\u4e3a\u5355\u4f4d\n\t\t\t\t{\n\t\t\t\t\t.width\t= 62,\n\t\t\t\t\t.height = 110,\n\t\t\t\t},\n\t\t\t.connector_type = DRM_MODE_CONNECTOR_DSI,\n\t\t},\n\t.flags\t= MIPI_DSI_MODE_VIDEO | MIPI_DSI_MODE_VIDEO_SYNC_PULSE, // DSI\u6a21\u5f0f\u6807\u5fd7\u4f4d\uff0c\u8fd9\u91cc\u8868\u660e\u8be5\u9762\u677f\u5de5\u4f5c\u5728video\u6a21\u5f0f\u4e0b\uff0c\u5e76\u4e14\u662fnon-burst\u6a21\u5f0f\n    //\u66f4\u591a\u6807\u5fd7\u4f4d\uff0c\u8bf7\u53c2\u89c1kernel/include/drm/drm_mipi_dsi.h\n\t.format = MIPI_DSI_FMT_RGB888,// \u9762\u677f\u8272\u5f69\u7c7b\u578b\n\t.lanes\t= 4, //\u6570\u636elane\u6570\n};\n"})}),"\n",(0,i.jsx)(n.p,{children:"\u4fee\u6539dsi_of_match\uff0c\u4e3a\u4e86\u7ed1\u5b9a\u8bbe\u5907\u6811\u505a\u51c6\u5907\uff1a"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:'static const struct of_device_id dsi_of_match[] = {\n\t{.compatible = "jc-050hd134", .data = &jc_050hd134},\n\t{\n\t\t/* sentinel */\n\t}};\nMODULE_DEVICE_TABLE(of, dsi_of_match);\n'})}),"\n",(0,i.jsx)(n.p,{children:"\u4fee\u6539panel_simple_dsi_init\u51fd\u6570\uff0c\u8fd9\u4e2a\u51fd\u6570\u5b9e\u9645\u4e0a\u8c03\u7528dsi_dcs_write_seq\u8fd9\u4e2a\u51fd\u6570\u5f80\u9762\u677f\u91cc\u9762\u5199\u5165mipi\u521d\u59cb\u5316\u5e8f\u5217\u3002"}),"\n",(0,i.jsx)(n.p,{children:"\u5982\u679c\u60a8\u4ece\u5c4f\u5e55\u5382\u5546\u62ff\u5230\u7684\u521d\u59cb\u5316\u53c2\u6570\u5f62\u5982\u4e0b\u9762\u8fd9\u79cd\uff1a"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"DSI_CMD(0x04);DSI_PA(0xB9);\nDSI_PA(0xF1);\nDSI_PA(0x12);\nDSI_PA(0x83);\n\nDSI_CMD(0x1C);DSI_PA(0xBA);\nDSI_PA(0x33); // 1\nDSI_PA(0x81); // 2\nDSI_PA(0x05); // 3\nDSI_PA(0xF9); // 4\nDSI_PA(0x0E); // 5\nDSI_PA(0x0E); // 6\nDSI_PA(0x20); // 7\nDSI_PA(0x00); // 8\nDSI_PA(0x00); // 9\nDSI_PA(0x00); //10\nDSI_PA(0x00); //11\nDSI_PA(0x00); //12\nDSI_PA(0x00); //13\nDSI_PA(0x00); //14\nDSI_PA(0x44); //15\nDSI_PA(0x25); //16\nDSI_PA(0x00); //17\nDSI_PA(0x91); //18\nDSI_PA(0x0A); //19\nDSI_PA(0x00); //20\nDSI_PA(0x00); //21\nDSI_PA(0x02); //22\nDSI_PA(0x4F); //23\nDSI_PA(0xD1); //24\nDSI_PA(0x00); //25\nDSI_PA(0x00); //26\nDSI_PA(0x37); //27\n\n......\n"})}),"\n",(0,i.jsx)(n.p,{children:"\u8f6c\u6362\u4e3a\u9a71\u52a8\u4ee3\u7801\uff1a"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"dsi_dcs_write_seq(dsi, 0xb9, 0xF1, 0x12, 0x83);\ndsi_dcs_write_seq(dsi, 0xBA, 0x33, 0x81, 0x05, 0xF9, 0x0E, 0x0E, 0x20, 0x00, 0x00, 0x00,\n\t\t\t  0x00, 0x00, 0x00, 0x00, 0x44, 0x25, 0x00, 0x91, 0x0A, 0x00, 0x00, 0x02,\n\t\t\t  0x4F, 0xD1, 0x00, 0x00, 0x37);\n......\n"})}),"\n",(0,i.jsx)(n.p,{children:"\u53ef\u4ee5\u770b\u5230\u5382\u5546\u63d0\u4f9b\u7684\u4e24\u7ec4\u521d\u59cb\u5316\u5e8f\u5217\u91cc\uff0c\u7b2c\u4e00\u4e2a\u5199\u5165\u7684\u662f\u8fd9\u7ec4\u521d\u59cb\u5316\u5e8f\u5217\u7684\u957f\u5ea6\uff0c\u8f6c\u6362\u4e3a\u9a71\u52a8\u4ee3\u7801\u65f6\u4e0d\u7528\u5e26\u4e0a\uff0c\u4f1a\u5728\u5199\u5165\u65f6\u81ea\u52a8\u8ba1\u7b97\u3002"}),"\n",(0,i.jsx)(n.p,{children:"\u5982\u679c\u60a8\u4ece\u5c4f\u5e55\u5382\u5546\u62ff\u5230\u7684\u521d\u59cb\u5316\u5e8f\u5217\u5f62\u5982\u4e0b\u5217\u8fd9\u79cd\uff1a"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"panel-init-sequence-zero = [\n 39 00 04 B9 FF 83 94\n 15 00 02 36 01\n 39 00 07 BA 63 03 68 6B B2 C0\n 39 00 0B B1 48 12 72 09 32 54 71 71 57 47\n......\n]\n"})}),"\n",(0,i.jsx)(n.p,{children:"\u8f6c\u6362\u4e3a\u9a71\u52a8\u4ee3\u7801\uff1a"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"\tdsi_dcs_write_seq(dsi, 0xb9, 0xff, 0x83, 0x94);\n\tdsi_dcs_write_seq(dsi, 0x36, 0x01);\n\tdsi_dcs_write_seq(dsi, 0xba, 0x63, 0x03, 0x68, 0x6b, 0xb2, 0xc0);\n\tdsi_dcs_write_seq(dsi, 0xb1, 0x48, 0x12, 0x72, 0x09, 0x32, 0x54, 0x71, 0x71, 0x57, 0x47);\n"})}),"\n",(0,i.jsx)(n.p,{children:"\u5728\u8fd9\u91cc\uff0c\u6211\u4eec\u4ee5\u7b2c\u4e00\u7ec4\u5e8f\u521739 00 04 B9 FF 83 94\u4e3a\u4f8b\uff0c\u8fdb\u884c\u89e3\u91ca\uff1a"}),"\n",(0,i.jsx)(n.p,{children:"39 \u8868\u793a\u672c\u7ec4\u521d\u59cb\u5316\u5e8f\u5217\u662f\u6309\u7167MIPI_DSI_DCS_LONG_WRITE (0x39)\u6570\u636e\u7c7b\u578b\u5199\u5165\uff0c\u8f6c\u6362\u4e3a\u9a71\u52a8\u4ee3\u7801\u65f6\u4e0d\u9700\u8981\u586b\u5199\uff0c\u4f1a\u6839\u636e\u672c\u7ec4\u53c2\u6570\u957f\u5ea6\u81ea\u52a8\u751f\u6210\n00 \u8868\u793a\u672c\u6b21\u5199\u5165\u4e4b\u540e\uff0c\u7761\u77200ms\uff0c\u53ef\u4ee5\u8c03\u7528msleep(ms)\u51fd\u6570\u5b9e\u73b0\n04 \u6807\u8bc6\u672c\u6b21\u5199\u5165\u5e8f\u5217\u7684\u957f\u5ea6\uff0c\u4f1a\u81ea\u52a8\u751f\u6210\u4e0d\u7528\u586b\u5199\n\u540e\u7eed\u7684\u5c31\u662f\u521d\u59cb\u5316\u5e8f\u5217\u4e86"}),"\n",(0,i.jsx)(n.p,{children:"\u5bf9\u4e8e\u4e0a\u7535-\u590d\u4f4d\u65f6\u5e8f\u6709\u8981\u6c42\u7684\u5c4f\u5e55\uff0c\u53ef\u4ee5\u4fee\u6539panel_simple_prepare\u548cpanel_simple_unprepare\u8fd9\u4e24\u4e2a\u51fd\u6570\u4e2d\u7684gpio\u884c\u4e3a\uff0c\u8fd9\u4e24\u4e2a\u51fd\u6570\u5206\u522b\u5bf9\u5e94\u521d\u59cb\u5316\u548c\u53cd\u521d\u59cb\u5316\u72b6\u6001\u3002"}),"\n",(0,i.jsx)(n.p,{children:"\u4fee\u6539kernel/drivers/gpu/drm/panel/Kconfig\u548ckernel/drivers/gpu/drm/panel/Makefile"}),"\n",(0,i.jsx)(n.p,{children:"Kconfig:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:'config DRM_PANEL_JC_050HD134\n\ttristate "JC 050HD134 panel"\n\tdepends on OF\n\tdepends on DRM_MIPI_DSI\n\tdepends on BACKLIGHT_CLASS_DEVICE\n\tselect VIDEOMODE_HELPERS\n\thelp\n\t  Say Y here if you want to enable support for the JC050HD134\n\t  panel with 720x1280 resolution. This panel support\n\t  MIPI DSI interface.\n'})}),"\n",(0,i.jsx)(n.p,{children:"Makefile:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"obj-$(CONFIG_DRM_PANEL_JC_050HD134) += panel-jc-050hd134.o\n"})}),"\n",(0,i.jsx)(n.h3,{id:"kernel-\u8bbe\u5907\u6811\u5c42\u9762",children:"Kernel \u8bbe\u5907\u6811\u5c42\u9762"}),"\n",(0,i.jsx)(n.p,{children:"\u5728\u677f\u7ea7\u8bbe\u5907\u6811\uff0c\u6b64\u5904\u4ee5kernel/arch/arm64/boot/dts/hobot/x5-evb.dts\u4e3a\u4f8b"}),"\n",(0,i.jsx)(n.p,{children:"\u5728mipi_dsi0\u8282\u70b9\u6dfb\u52a0\u4e0b\u5217\u5c5e\u6027\uff1a"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:'&mipi_dsi0 {\n\n\tstatus = "okay";\n\tdsi_panel0@0 {\n\t\tcompatible = "jc-050hd134";//\u6b64\u5904\u4e0e dsi_of_match \u4e00\u81f4\n\t\treg = <0>;\n\n\t\tpinctrl-names = "default";\n\t\tpinctrl-0 = <&lsio_gpio0_14>; // \u4e0e\u590d\u4f4d\u7ba1\u811a\u76f8\u5173\n\t\treset-gpios = <&ls_gpio0_porta 14 GPIO_ACTIVE_HIGH>; // \u4e0e\u590d\u4f4d\u7ba1\u811a\u76f8\u5173 \u4e0e\u4ec0\u4e48\u7535\u5e73\u6709\u6548\u9700\u8981\u6839\u636e\u60a8\u7684\u5c4f\u5e55\u6765\u51b3\u5b9a\n\t\tbacklight = <&dsi_backlight>; // \u80cc\u5149\u76f8\u5173\n\n\t\tport {\n\t\t\tpanel_in: endpoint {\n\t\t\t\tremote-endpoint =\n\t\t\t\t\t<&mipi_dsi_out>;\n\t\t\t};\n\t\t};\n\t};\n\n};\n'})}),"\n",(0,i.jsx)(n.p,{children:"\u6dfb\u52a0dsi_backlight\u8282\u70b9\uff1a"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:'&dsi_backlight {\n\tstatus = "okay";\n\tpwms = <&lpwm1 1 1000000>; //\u4e0e\u786c\u4ef6PCB\u6709\u5173\uff0c\u68c0\u67e5\u60a8\u7684\u80cc\u5149\u65b9\u6ce2\u4fe1\u53f7\u6765\u6e90\u4e8e\u54ea\u91cc \u8fd9\u91cc\u8868\u793a\u80cc\u5149\u4fe1\u53f7\u6765\u6e90\u4e8eLPWM1_1\n    // \u5176\u4f59\u5c5e\u6027\u548c\u4fe1\u606f\uff0c\u8bf7\u53c2\u8003 kernel/Documentation/devicetree/bindings/leds/backlight/pwm-backlight.yaml\n};\n'})}),"\n",(0,i.jsx)(n.h2,{id:"3\u7f16\u8bd1",children:"3.\u7f16\u8bd1"}),"\n",(0,i.jsx)(n.p,{children:"\u8bf7\u5148\u53c2\u80037.2.1\u7ae0\u642d\u5efa\u597d\u7f16\u8bd1\u73af\u5883\uff0c\u5e76\u80fd\u6210\u529f\u7f16\u8bd1\u51fa\u955c\u50cf\u4e4b\u540e\u518d\u505a\u4e0b\u9762\u64cd\u4f5c\uff01"}),"\n",(0,i.jsxs)(n.p,{children:["\u6267\u884c",(0,i.jsx)(n.code,{children:"./mk_kernel.sh menuconfig"}),"\u8fdb\u5165\u5185\u6838\u7684\u914d\u7f6e\u83dc\u5355\uff0c\u6309\u7167\u4ee5\u4e0b\u8def\u5f84\u8fdb\u5165Panels\u7f16\u8bd1\u9009\u9879\uff1a"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"Device Drivers  ---\x3e\n    Graphics support  ---\x3e\n        Display Panels  ---\x3e\n"})}),"\n",(0,i.jsx)(n.p,{children:"\u627e\u5230JC 050HD134 panel\uff0c\u6309\u4e0b\u7a7a\u683c\uff0c\u5c06\u5176\u4f5c\u4e3a\u6a21\u5757\u7f16\u8bd1\u3002\u7136\u540e\u4fdd\u5b58\u914d\u7f6e\u5e76\u9000\u51fa\u3002"}),"\n",(0,i.jsxs)(n.p,{children:["\u6267\u884c",(0,i.jsx)(n.code,{children:"./mk_kernel.sh"}),"\u7f16\u8bd1\u5185\u6838\uff0c\u5728",(0,i.jsx)(n.code,{children:"deploy/kernel/modules/lib/modules/6.1.83/kernel/drivers/gpu/drm/panel"}),"\u76ee\u5f55\u4e0b\u53ef\u4ee5\u627e\u5230\u5bf9\u5e94\u7684\u9a71\u52a8\u6587\u4ef6",(0,i.jsx)(n.code,{children:"panel-jc-050hd134.ko"})]}),"\n",(0,i.jsxs)(n.p,{children:["\u6267\u884c",(0,i.jsx)(n.code,{children:"./mk_deb.sh hobot-dtb"}),",",(0,i.jsx)(n.code,{children:"./mk_deb.sh hobot-boot"}),",",(0,i.jsx)(n.code,{children:"./mk_deb.shhobot-kernel-headers"}),"\u5728",(0,i.jsx)(n.code,{children:"deploy/deb_pkgs/"}),"\u76ee\u5f55\u4e0b\u5f97\u5230",(0,i.jsx)(n.code,{children:"hobot-dtb*.dtb"}),"\uff0c",(0,i.jsx)(n.code,{children:"hobot-boot*.dtb"}),"\uff0c",(0,i.jsx)(n.code,{children:"hobot-kernel-headers*.dtb"})]}),"\n",(0,i.jsxs)(n.p,{children:["\u8fd9\u4e09\u4e2adeb\u5305\u53ef\u4ee5\u76f4\u63a5\u4f20\u7ed9\u8bbe\u5907\u5b89\u88c5\uff0c\u66f4\u65b0\u8bbe\u5907\u4e0a\u7684\u8bbe\u5907\u6811\uff0c\u5185\u6838\u53ca\u9a71\u52a8\u6587\u4ef6\uff0c\u5185\u6838\u5934\u6587\u4ef6\uff0c\u4e5f\u53ef\u4ee5\u6267\u884c",(0,i.jsx)(n.code,{children:"./pack_image.sh"}),"\u7f16\u8fdb\u6587\u4ef6\u7cfb\u7edf\u4e2d"]}),"\n",(0,i.jsx)(n.h2,{id:"4\u6d4b\u8bd5",children:"4.\u6d4b\u8bd5"}),"\n",(0,i.jsxs)(n.p,{children:["RDK X5\u4e0a\u7535\u540e\u4f1a\u52a0\u8f7d\u663e\u793a\u76f8\u5173\u9a71\u52a8\uff0c\u663e\u793aubuntu\u684c\u9762\uff0c\u9700\u8981\u6253\u5f00",(0,i.jsx)(n.code,{children:"/etc/init.d/S70loadko"}),"\uff0c\u628a",(0,i.jsx)(n.code,{children:"modprobe panel-jc-050hd134"}),"\u52a0\u5230",(0,i.jsx)(n.code,{children:"modprobe vio_n2d"}),"\u524d"]}),"\n",(0,i.jsx)(n.p,{children:"\u7531\u4e8eRDK X5 \u7cfb\u7edf\u9ed8\u8ba4\u91c7\u7528HDMI\u8f93\u51fa\uff0c\u9700\u8981\u901a\u8fc7\u547d\u4ee4\u5207\u6362\u5230MIPI DSI\u663e\u793a\u65b9\u5f0f\u3002"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"mv /etc/X11/xorg.conf.d/xorg_dsi_ignore.conf /etc/X11/xorg.conf.d/xorg_dsi_ignore.conf.disable\nmv /etc/X11/xorg.conf.d/xorg_hdmi_ignore.conf.disable /etc/X11/xorg.conf.d/xorg_hdmi_ignore.conf\n"})}),"\n",(0,i.jsxs)(n.p,{children:["\u4e5f\u53ef\u4ee5\u901a\u8fc7srpi-config\u6765\u9009\u62e9\u8f93\u51fa\u65b9\u5f0f\uff0c\u53ef\u4ee5\u53c2\u8003 ",(0,i.jsx)(n.a,{href:"../../../System_configuration/srpi-config#display-options",children:"Dsiplay Chose DSI or HDMI"})," \u7ae0\u8282"]}),"\n",(0,i.jsx)(n.p,{children:"\u91cd\u542f\u8bbe\u5907\uff0c\u5c31\u53ef\u4ee5\u5728LCD\u5c4f\u4e0a\u770b\u5230\u7cfb\u7edf\u684c\u9762\u684c\u9762\u4e86"}),"\n",(0,i.jsx)(n.p,{children:"\u5982\u679cLCD\u672a\u663e\u793a\uff0c\u8bf7\u9010\u6b65\u786e\u8ba4\u4ee5\u4e0b\u5185\u5bb9"}),"\n",(0,i.jsx)(n.p,{children:"1\uff0c\u8be5\u6b3e\u5c4f\u5e55\u662f\u5426\u6709\u80cc\u5149\u6216\u8005\u63a7\u5236\u82af\u7247\uff0c\u76f8\u5173\u7684\u9a71\u52a8\u6709\u6ca1\u6709\u52a0\u8f7d\u6210\u529f\uff1b"}),"\n",(0,i.jsxs)(n.p,{children:["2\uff0c\u786e\u8ba4DRM\uff0cMIPI\u9a71\u52a8\u662f\u5426\u52a0\u8f7d\u6210\u529f\uff0c\u4f7f\u7528",(0,i.jsx)(n.code,{children:"dmesg | grep drm"}),"\uff1b"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"root@ubuntu:~# dmesg | grep drm\n[    6.717478] systemd[1]: Starting Load Kernel Module drm...\n[   13.676055] vs-drm 3e000000.disp_apb:display-subsystem: bound 3e080000.vs-sif (ops sif_component_ops [vs_drm])\n[   13.676374] vs-drm 3e000000.disp_apb:display-subsystem: bound 3e000000.dc8000Nano (ops dc_component_ops [vs_drm])\n[   13.676514] vs-drm 3e000000.disp_apb:display-subsystem: bound 3e010000.bt1120 (ops bt1120_component_ops [vs_drm])\n[   13.676553] vs-drm 3e000000.disp_apb:display-subsystem: bound 3e000000.disp_apb:bt1120_bridge (ops bt1120_bridge_component_ops [vs_drm])\n[   13.676595] vs-drm 3e000000.disp_apb:display-subsystem: bound 3e000000.disp_apb:bt1120_bridge_wb (ops bt1120_bridge_component_ops [vs_drm])\n[   13.676710] vs-drm 3e000000.disp_apb:display-subsystem: bound 3e060000.mipi_dsi0 (ops dsi_component_ops [vs_drm])\n[   13.676834] vs-drm 3e000000.disp_apb:display-subsystem: bound 3e000000.disp_apb:dsi-encoder (ops encoder_component_ops [vs_drm])\n[   13.676940] vs-drm 3e000000.disp_apb:display-subsystem: bound 3e000000.disp_apb:hdmi-encoder (ops encoder_component_ops [vs_drm])\n[   13.678810] [drm] Initialized vs-drm 1.0.0 20191101 for 3e000000.disp_apb:display-subsystem on minor 0\n"})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"vs-drm 3e000000.disp_apb:display-subsystem: bound 3e060000.mipi_dsi0 (ops dsi_component_ops [vs_drm])"}),"\u8868\u793amipi_dsi\u52a0\u8f7d\u6210\u529f\u3002"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"[drm] Initialized vs-drm 1.0.0 20191101 for 3e000000.disp_apb:display-subsystem on minor 0"}),"\u8868\u793a\u663e\u793a\u9a71\u52a8\u52a0\u8f7d\u6210\u529f\u3002"]}),"\n",(0,i.jsxs)(n.p,{children:["3\uff0c\u6267\u884c",(0,i.jsx)(n.code,{children:"modetest -M vs-drm -c"}),"\u67e5\u770bconnectors\u7684\u72b6\u6001\uff1a"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"root@ubuntu:~# modetest -M vs-drm -c\nConnectors:\nid      encoder status          name            size (mm)       modes   encoders\n73      72      connected       DSI-1           800x480         1       72\n  modes:\n        index name refresh (Hz) hdisp hss hse htot vdisp vss vse vtot\n  #0 800x480 60.00 800 890 892 950 480 487 489 510 29070 flags: nhsync, nvsync; type: preferred, driver\n  props:\n        1 EDID:\n                flags: immutable blob\n                blobs:\n\n                value:\n        2 DPMS:\n                flags: enum\n                enums: On=0 Standby=1 Suspend=2 Off=3\n                value: 0\n        5 link-status:\n                flags: enum\n                enums: Good=0 Bad=1\n                value: 0\n        6 non-desktop:\n                flags: immutable range\n                values: 0 1\n                value: 0\n        4 TILE:\n                flags: immutable blob\n                blobs:\n\n                value:\n"})}),"\n",(0,i.jsxs)(n.p,{children:["4\uff0c\u4f7f\u7528",(0,i.jsx)(n.code,{children:"modetest"}),"\u8f93\u51fa\u6d4b\u8bd5\u56fe\u955c\u50cf\u6d4b\u8bd5\u547d\u4ee4\u8fdb\u884c\u6d4b\u8bd5"]}),"\n",(0,i.jsxs)(n.p,{children:["\u4f7f\u7528",(0,i.jsx)(n.code,{children:"sudo systemctl stop lightdm"}),"\u5173\u95edlightdm\u684c\u9762"]}),"\n",(0,i.jsxs)(n.p,{children:["\u4f7f\u7528",(0,i.jsx)(n.code,{children:"modetest -M vs-drm -a -s 73@31:800x480 -P 33@31:800x480@NV12"}),"\u547d\u4ee4\u8fdb\u884c\u6d4b\u8bd5"]}),"\n",(0,i.jsx)(n.p,{children:"\u5982\u679c\u4e00\u5207\u987a\u5229\uff0c\u8fde\u63a5\u7684\u5c4f\u5e55\u5c06\u4f1a\u4eae\u8d77\u5e76\u663e\u793a\u4e0b\u56fe\u7684pattern\uff1a"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{src:"https://rdk-doc.oss-cn-beijing.aliyuncs.com/doc/img/07_Advanced_development/02_linux_development/driver_development_x5/screenshot-20241125-162524.png",alt:"image-20220518111319607"})}),"\n",(0,i.jsx)(n.h2,{id:"5\u5907\u6ce8",children:"5.\u5907\u6ce8"}),"\n",(0,i.jsxs)(n.p,{children:["\u76ee\u524d\uff0cRDK X5\u5df2\u7ecf\u652f\u63017\u6b3e\u5fae\u96ea LCD\u5c4f\u5e55\uff0c\u4f7f\u7528\u65b9\u6cd5\u53ef\u4ee5\u53c2\u8003 ",(0,i.jsx)(n.a,{href:"../../hardware_development/rdk_x5/display",children:"\u663e\u793a\u5c4f\u4f7f\u7528"})," \u7ae0\u8282"]}),"\n",(0,i.jsx)(n.p,{children:"\u9a71\u52a8\u5df2\u7ecf\u96c6\u6210\u5230\u5185\u6838\u4e2d"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"kernel/drivers/gpu/drm/panel/panel-wh-cm480.c\nkernel/drivers/gpu/drm/panel/panel-waveshare-dsi.c\n"})}),"\n",(0,i.jsxs)(n.p,{children:["\u8bbe\u5907\u6811\u7684\u4fee\u6539\u901a\u8fc7dtoverlay\u6765\u5b9e\u73b0\uff0c\u8be6\u60c5\u524d\u53c2\u8003",(0,i.jsx)(n.code,{children:"source/hobot-display"})]}),"\n",(0,i.jsx)(n.p,{children:"\u60a8\u4e5f\u53ef\u4ee5\u53c2\u8003\u8fd9\u79cd\u65b9\u5f0f\u652f\u6301\u66f4\u591aLCD\u5c4f\u5e55"})]})}function _(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(p,{...e})}):p(e)}}}]);