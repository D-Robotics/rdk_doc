"use strict";(self.webpackChunkrdk_doc=self.webpackChunkrdk_doc||[]).push([[49363],{28453:(e,d,n)=>{n.d(d,{R:()=>o,x:()=>l});var i=n(96540);const s={},r=i.createContext(s);function o(e){const d=i.useContext(r);return i.useMemo(function(){return"function"==typeof e?e(d):{...d,...e}},[d,e])}function l(e){let d;return d=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:o(e.components),i.createElement(r.Provider,{value:d},e.children)}},91452:(e,d,n)=>{n.r(d),n.d(d,{assets:()=>c,contentTitle:()=>l,default:()=>t,frontMatter:()=>o,metadata:()=>i,toc:()=>a});const i=JSON.parse('{"id":"Advanced_development/hardware_development/rdk_x5/V4l2","title":"V4L2\u4f7f\u7528","description":"RDK X5\u652f\u6301V4L2\u63a5\u53e3\uff0c\u7528\u6237\u53ef\u4ee5\u901a\u8fc7V4L2\u63a5\u53e3\u8bbf\u95eeRDK X5\u7684mipi\u63a5\u53e3\u6444\u50cf\u5934\uff0c\u83b7\u53d6VIN\u3001ISP\u3001VSE\u7b49\u9636\u6bb5\u7684\u56fe\u50cf\u6570\u636e\u3002","source":"@site/docs/07_Advanced_development/01_hardware_development/rdk_x5/V4l2.md","sourceDirName":"07_Advanced_development/01_hardware_development/rdk_x5","slug":"/Advanced_development/hardware_development/rdk_x5/V4l2","permalink":"/rdk_doc/Advanced_development/hardware_development/rdk_x5/V4l2","draft":false,"unlisted":false,"tags":[],"version":"current","lastUpdatedAt":1750509720000,"sidebarPosition":6,"frontMatter":{"sidebar_position":6},"sidebar":"tutorialSidebar","previous":{"title":"PoE\u4f9b\u7535\u4f7f\u7528","permalink":"/rdk_doc/Advanced_development/hardware_development/rdk_x5/POE"},"next":{"title":"7.2 Linux\u5f00\u53d1\u6307\u5357","permalink":"/rdk_doc/linux_development"}}');var s=n(74848),r=n(28453);const o={sidebar_position:6},l="V4L2\u4f7f\u7528",c={},a=[{value:"\u6a21\u5f0f\u5207\u6362",id:"\u6a21\u5f0f\u5207\u6362",level:2},{value:"\u6a21\u5f0f\u4ecb\u7ecd",id:"\u6a21\u5f0f\u4ecb\u7ecd",level:2},{value:"\u914d\u7f6eCamera",id:"\u914d\u7f6ecamera",level:2},{value:"\u8bbe\u5907\u62d3\u6251",id:"\u8bbe\u5907\u62d3\u6251",level:2},{value:"\u4f7f\u7528\u8bf4\u660e",id:"\u4f7f\u7528\u8bf4\u660e",level:2},{value:"V4L2-CTL\u6307\u4ee4",id:"v4l2-ctl\u6307\u4ee4",level:3},{value:"V4L2 \u793a\u4f8b\u4ee3\u7801",id:"v4l2-\u793a\u4f8b\u4ee3\u7801",level:3},{value:"\u591a\u5a92\u4f53\u5e94\u7528",id:"\u591a\u5a92\u4f53\u5e94\u7528",level:3},{value:"\u5df2\u77e5\u95ee\u9898",id:"\u5df2\u77e5\u95ee\u9898",level:2}];function v(e){const d={a:"a",br:"br",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",img:"img",p:"p",pre:"pre",strong:"strong",...(0,r.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(d.header,{children:(0,s.jsx)(d.h1,{id:"v4l2\u4f7f\u7528",children:"V4L2\u4f7f\u7528"})}),"\n",(0,s.jsx)(d.p,{children:"RDK X5\u652f\u6301V4L2\u63a5\u53e3\uff0c\u7528\u6237\u53ef\u4ee5\u901a\u8fc7V4L2\u63a5\u53e3\u8bbf\u95eeRDK X5\u7684mipi\u63a5\u53e3\u6444\u50cf\u5934\uff0c\u83b7\u53d6VIN\u3001ISP\u3001VSE\u7b49\u9636\u6bb5\u7684\u56fe\u50cf\u6570\u636e\u3002"}),"\n",(0,s.jsx)(d.h2,{id:"\u6a21\u5f0f\u5207\u6362",children:"\u6a21\u5f0f\u5207\u6362"}),"\n",(0,s.jsxs)(d.p,{children:["\u4f7f\u7528",(0,s.jsx)(d.code,{children:"srpi-config"}),"\u914d\u7f6ecamera\u91c7\u96c6\u6a21\u5f0f",(0,s.jsx)(d.br,{}),"\n","\u8fdb\u5165",(0,s.jsx)(d.code,{children:"3 Interface Options"}),"->",(0,s.jsx)(d.code,{children:"I7 V4L2"}),(0,s.jsx)(d.br,{}),"\n","\u9009\u62e9",(0,s.jsx)(d.code,{children:"I1 V4L2 Enable/disable V4L2 interface for camera"}),"\n",(0,s.jsx)(d.img,{src:"https://rdk-doc.oss-cn-beijing.aliyuncs.com/doc/img/07_Advanced_development/01_hardware_development/rdk_x5/img-20250523-191348.png",alt:"img-20250523-191348"})]}),"\n",(0,s.jsx)(d.h2,{id:"\u6a21\u5f0f\u4ecb\u7ecd",children:"\u6a21\u5f0f\u4ecb\u7ecd"}),"\n",(0,s.jsxs)(d.p,{children:[(0,s.jsx)(d.code,{children:"HBN"})," ",(0,s.jsx)(d.strong,{children:"\u5e38\u89c4\u6a21\u5f0f"}),(0,s.jsx)(d.br,{}),"\n","Camera\u662f\u5355\u72ec\u4e00\u5957API\uff0cCamera\u4e4b\u540e\u7684\u6a21\u5757\u7528vnode\u6765\u62bd\u8c61\uff0cvnode\u62bd\u8c61\u7684\u6a21\u5757\u5305\u62ecVIN\u3001ISP\u3001VSE\u3001GDC\u3001Codec\u3002 \u591a\u4e2avnode\u7ec4\u6210\u4e00\u6761vflow\uff08\u7c7b\u4f3c\u4e8e\u4e00\u6761pipeline\uff09\u3002Camera\u548cVIN\u901a\u8fc7attach\u63a5\u53e3\u7ed1\u5b9a\u8d77\u6765\u3002 \u7528\u6237\u53ea\u9700\u8981\u8c03\u7528HBN\u63a5\u53e3\u5b8c\u6210\u6a21\u5757\u7684\u521d\u59cb\u5316\u548c\u7ed1\u5b9a\uff0cvflow\u5efa\u7acb\u5e76\u542f\u52a8\u540e\uff0c\u7528\u6237\u65e0\u987b\u5173\u5fc3\u6570\u636e\u5e27\u7684\u4f20\u9012\uff0cX5\u5185\u90e8\u4f1a\u5c06\u6570\u636e\u5e27\u7531\u4e0a\u6e38\u4f20\u9012\u5230\u4e0b\u6e38\u3002"]}),"\n",(0,s.jsxs)(d.p,{children:[(0,s.jsx)(d.code,{children:"V4L2 sif-isp-vse"})," ",(0,s.jsx)(d.strong,{children:"V4L2\u6570\u636e\u6d41\u6a21\u5f0f"}),(0,s.jsx)(d.br,{}),"\n","camera \u901a\u8fc7 V4l2 snesor \u9a71\u52a8\u6dfb\u52a0\uff0cVIN\u3001ISP\u3001VSE\u90fd\u63d0\u4f9b\u4e86\u5bf9\u5e94\u7684v4l2 video\u8bbe\u5907\u8282\u70b9\uff0c\u7528\u6237\u53ef\u4ee5\u76f4\u63a5\u901a\u8fc7v4l2 api\u83b7\u53d6\u76f8\u5e94\u7684\u6570\u636e\u3002"]}),"\n",(0,s.jsxs)(d.p,{children:[(0,s.jsx)(d.code,{children:"V4L2 vse alone"})," ",(0,s.jsx)(d.strong,{children:"V4L2 VSE \u5355\u72ec\u4f7f\u7528\u6a21\u5f0f"}),(0,s.jsx)(d.br,{}),"\n","\u63d0\u4f9bVSE\u901a\u9053\u7684v4l2 video\u8bbe\u5907\u8282\u70b9\uff0c\u7528\u6237\u53ef\u4ee5\u76f4\u63a5\u901a\u8fc7v4l2 api\u56de\u704c\u56fe\u50cf\u7ed9VSE\u6a21\u5757\u8fdb\u884c\u5904\u7406\u3002"]}),"\n",(0,s.jsx)(d.h2,{id:"\u914d\u7f6ecamera",children:"\u914d\u7f6eCamera"}),"\n",(0,s.jsxs)(d.p,{children:["\u5982\u679c\u9009\u62e9",(0,s.jsx)(d.code,{children:"sif-isp-vse"})," \u4f1a\u5f39\u51faCAM0\uff0cCAM1\u6444\u50cf\u5934\u9009\u62e9",(0,s.jsx)(d.br,{}),"\n","X5 RDK cam0 \u9760\u8fd1\u7f51\u53e3\uff0ccam1 \u8fdc\u79bb\u7f51\u53e3\uff1b",(0,s.jsx)(d.br,{}),"\n","X5 MD \u53ef\u4ee5\u89c2\u5bdf\u8f7d\u677f\u7684\u4e1d\u5370\uff1b"]}),"\n",(0,s.jsx)(d.p,{children:(0,s.jsx)(d.img,{src:"https://rdk-doc.oss-cn-beijing.aliyuncs.com/doc/img/07_Advanced_development/01_hardware_development/rdk_x5/img-20250523-191636.png",alt:"img-20250523-191636"})}),"\n",(0,s.jsx)(d.p,{children:(0,s.jsx)(d.img,{src:"https://rdk-doc.oss-cn-beijing.aliyuncs.com/doc/img/07_Advanced_development/01_hardware_development/rdk_x5/img-20250523-191648.png",alt:"img-20250523-191648"})}),"\n",(0,s.jsxs)(d.p,{children:["\u914d\u7f6e\u5b8c\u6210\u540e\uff0c\u91cd\u542f\u677f\u5361\uff1b",(0,s.jsx)(d.br,{}),"\n","\u786e\u8ba4V4L2\u6a21\u5f0f\u751f\u6548\uff1a",(0,s.jsx)(d.br,{}),"\n","\u4f7f\u7528lsmod \u67e5\u770b\u9a71\u52a8\uff0c\u53ef\u4ee5\u770b\u5230v4l\u76f8\u5173\u9a71\u52a8\uff0c\u548csensor\u76f8\u5173\u9a71\u52a8"]}),"\n",(0,s.jsx)(d.p,{children:(0,s.jsx)(d.img,{src:"https://rdk-doc.oss-cn-beijing.aliyuncs.com/doc/img/07_Advanced_development/01_hardware_development/rdk_x5/img-20250523-1918.png",alt:"img-20250523-1918"})}),"\n",(0,s.jsx)(d.h2,{id:"\u8bbe\u5907\u62d3\u6251",children:"\u8bbe\u5907\u62d3\u6251"}),"\n",(0,s.jsxs)(d.p,{children:["\u5728",(0,s.jsx)(d.code,{children:"V4L2 sif-isp-vse"}),"\u6a21\u5f0f\u751f\u6548\u540e\uff0c\u53ef\u4ee5\u901a\u8fc7\u4ee5\u4e0b\u547d\u4ee4\u67e5\u770b\u8bbe\u5907\u62d3\u6251\u56fe\uff0c\u5b83\u5c55\u793a\u4e86 /dev/media0 \u8bbe\u5907\u7684 \u5a92\u4f53\u7ba1\u9053\uff08Media Pipeline\uff09 \u7ed3\u6784\uff0c\u5305\u62ec \u4f20\u611f\u5668\u3001ISP\u3001\u89c6\u9891\u8282\u70b9\u3001\u6570\u636e\u6d41\u8def\u5f84 \u7b49\u4fe1\u606f\u3002"]}),"\n",(0,s.jsx)(d.pre,{children:(0,s.jsx)(d.code,{className:"language-bash",children:"media-ctl -d /dev/media0 --print-dot > media0.dot\ndot -Tpng media0.dot -o media0.png\n"})}),"\n",(0,s.jsx)(d.p,{children:(0,s.jsx)(d.img,{src:"https://rdk-doc.oss-cn-beijing.aliyuncs.com/doc/img/07_Advanced_development/01_hardware_development/rdk_x5/img-media0.png",alt:"img-media0"})}),"\n",(0,s.jsx)(d.p,{children:"\u4e5f\u53ef\u4ee5\u76f4\u63a5\u5728\u4e0b\u8868\u4e2d\u67e5\u8be2\uff1a"}),"\n",(0,s.jsx)(d.pre,{children:(0,s.jsx)(d.code,{className:"language-bash",children:'VIDEO_DEV_CSI0_SIF "/dev/video0"\nVIDEO_DEV_CSI0_ISP "/dev/video4"\nVIDEO_DEV_CSI0_VSE0 "/dev/video8"\nVIDEO_DEV_CSI0_VSE1 "/dev/video9"\nVIDEO_DEV_CSI0_VSE2 "/dev/video10"\nVIDEO_DEV_CSI0_VSE3 "/dev/video11"\nVIDEO_DEV_CSI0_VSE4 "/dev/video12"\nVIDEO_DEV_CSI0_VSE5 "/dev/video13"\n\nVIDEO_DEV_CSI1_SIF "/dev/video1"\nVIDEO_DEV_CSI1_ISP "/dev/video5"\nVIDEO_DEV_CSI1_VSE0 "/dev/video14"\nVIDEO_DEV_CSI1_VSE1 "/dev/video15"\nVIDEO_DEV_CSI1_VSE2 "/dev/video16"\nVIDEO_DEV_CSI1_VSE3 "/dev/video17"\nVIDEO_DEV_CSI1_VSE4 "/dev/video18"\nVIDEO_DEV_CSI1_VSE5 "/dev/video19"\n\nVIDEO_DEV_CSI2_SIF "/dev/video2"\nVIDEO_DEV_CSI2_ISP "/dev/video6"\nVIDEO_DEV_CSI2_VSE0 "/dev/video20"\nVIDEO_DEV_CSI2_VSE1 "/dev/video21"\nVIDEO_DEV_CSI2_VSE2 "/dev/video22"\nVIDEO_DEV_CSI2_VSE3 "/dev/video23"\nVIDEO_DEV_CSI2_VSE4 "/dev/video24"\nVIDEO_DEV_CSI2_VSE5 "/dev/video25"\n\nVIDEO_DEV_CSI3_SIF "/dev/video3"\nVIDEO_DEV_CSI3_ISP "/dev/video7"\nVIDEO_DEV_CSI3_VSE0 "/dev/video26"\nVIDEO_DEV_CSI3_VSE1 "/dev/video27"\nVIDEO_DEV_CSI3_VSE2 "/dev/video28"\nVIDEO_DEV_CSI3_VSE3 "/dev/video29"\nVIDEO_DEV_CSI3_VSE4 "/dev/video30"\nVIDEO_DEV_CSI3_VSE5 "/dev/video31"\n'})}),"\n",(0,s.jsx)(d.h2,{id:"\u4f7f\u7528\u8bf4\u660e",children:"\u4f7f\u7528\u8bf4\u660e"}),"\n",(0,s.jsx)(d.h3,{id:"v4l2-ctl\u6307\u4ee4",children:"V4L2-CTL\u6307\u4ee4"}),"\n",(0,s.jsxs)(d.p,{children:["1\uff0c\u4f7f\u7528v4l2-ctl --list-formats-ext \u67e5\u8be2\u652f\u6301\u7684\u5206\u8fa8\u7387\uff0c\u7f16\u7801\u65b9\u5f0f\uff0c\u4e5f\u8ba9\u9a71\u52a8\u5b8c\u6210\u521d\u59cb\u5316\uff1b",(0,s.jsx)(d.br,{}),"\n","2\uff0c\u4f7f\u7528v4l2-ctl -d /dev/video4\u83b7\u53d6\u89c6\u9891\u6570\u636e;"]}),"\n",(0,s.jsx)(d.pre,{children:(0,s.jsx)(d.code,{className:"language-bash",children:"v4l2-ctl --list-formats-ext --device /dev/video4\nv4l2-ctl -d /dev/video4 \\\n        --set-fmt-video=width=640,height=480,pixelformat=NV12 \\\n        --stream-mmap=3 \\\n        --stream-skip=3 \\\n--stream-to=/tmp/nv12.yuv \\\n        --stream-count=1 \\\n        --stream-poll\n"})}),"\n",(0,s.jsx)(d.h3,{id:"v4l2-\u793a\u4f8b\u4ee3\u7801",children:"V4L2 \u793a\u4f8b\u4ee3\u7801"}),"\n",(0,s.jsxs)(d.p,{children:["\u793a\u4f8b\u4ee3\u7801\u4f4d\u4e8e ",(0,s.jsx)(d.a,{href:"https://github.com/D-Robotics/x5-hobot-sp-samples/blob/main/debian/app/cdev_demo/v4l2/v4l2_demo.c",children:"v4l2_demo.c"})]}),"\n",(0,s.jsx)(d.p,{children:(0,s.jsx)(d.strong,{children:"\u53c2\u6570\u8bf4\u660e"})}),"\n",(0,s.jsx)(d.pre,{children:(0,s.jsx)(d.code,{className:"language-bash",children:"-w sensor\u8f93\u51fa\u5bbd\n-h sensor\u8f93\u51fa\u9ad8\n-c \u91c7\u96c6\u56fe\u7247\u6570\u91cf\n-n sensor\u91c7\u96c6video\u8282\u70b9\n-o \u8f93\u5165NV12\u56fe\u50cfvideo\u8282\u70b9\n-i \u8f93\u5165NV12\u56fe\u50cf\u8def\u5f84\n"})}),"\n",(0,s.jsxs)(d.p,{children:["1,",(0,s.jsx)(d.code,{children:"V4L2 sif-isp-vse"}),"\u6a21\u5f0f \u91c7\u96c6\u56fe\u50cf\uff0c\u4fdd\u5b58\u4e3a\u6587\u4ef6"]}),"\n",(0,s.jsx)(d.pre,{children:(0,s.jsx)(d.code,{className:"language-bash",children:"./v4l2 -w 1920 -h 1080 -c 10 -n 4\n"})}),"\n",(0,s.jsxs)(d.p,{children:["2,",(0,s.jsx)(d.code,{children:"V4L2 vse alone"}),"\u6a21\u5f0f,\u5355\u72ec\u4f7f\u7528VSE\u8282\u70b9\uff0c1080p.yuv\u4f5c\u4e3a\u8f93\u5165\u56fe\u50cf\uff0c\u7f29\u653e\u540e\u7684\u56fe\u7247\u4fdd\u5b58\u4e3a\u6587\u4ef6"]}),"\n",(0,s.jsx)(d.pre,{children:(0,s.jsx)(d.code,{className:"language-bash",children:"./v4l2 -w 1920 -h 1080 -c 10 -n 2 -o 2 -i ./1080p.yuv\n"})}),"\n",(0,s.jsx)(d.h3,{id:"\u591a\u5a92\u4f53\u5e94\u7528",children:"\u591a\u5a92\u4f53\u5e94\u7528"}),"\n",(0,s.jsxs)(d.p,{children:[(0,s.jsx)(d.code,{children:"hbn"}),"\u6a21\u5f0f\u548c",(0,s.jsx)(d.code,{children:"V4L2 sif-isp-vse"}),"\u6a21\u5f0f\u4f7f\u7528\u540c\u4e00\u5957\u793a\u4f8b\u7a0b\u5e8f\uff0chobot-spdev\u4f1a\u6839\u636e\u5f53\u524d\u7684\u9a71\u52a8\u81ea\u52a8\u9009\u62e9\u5de5\u4f5c\u6a21\u5f0f\uff0c\u4e24\u8005\u7684\u6253\u5370\u4fe1\u606f\u7565\u6709\u4e0d\u540c"]}),"\n",(0,s.jsx)(d.p,{children:(0,s.jsx)(d.strong,{children:"\u652f\u6301\u7684\u4f8b\u7a0b"})}),"\n",(0,s.jsx)(d.p,{children:"\u6d89\u53ca\u5230hdmi\u663e\u793a\uff0c\u9700\u8981\u5148\u5173\u95ed\u684c\u9762"}),"\n",(0,s.jsx)(d.pre,{children:(0,s.jsx)(d.code,{className:"language-bash",children:"sudo systemctl stop lightdm\n"})}),"\n",(0,s.jsx)(d.pre,{children:(0,s.jsx)(d.code,{className:"language-bash",children:"/app/cdev_demo/vio2display\n/app/cdev_demo/vio_capture\n/app/cdev_demo/vio2encoder\n/app/cdev_demo/bpu ./sample -f /app/model/basic/yolov5s_672x672_nv12.bin -m 0\n/app/pydev_demo/03_mipi_camera_sample\n"})}),"\n",(0,s.jsx)(d.h2,{id:"\u5df2\u77e5\u95ee\u9898",children:"\u5df2\u77e5\u95ee\u9898"}),"\n",(0,s.jsxs)(d.p,{children:["1\uff0c\u53d6VSE\u6d41\u65f6\uff0c\u5f3a\u5236\u9009\u62e91920x1080\u5206\u8fa8\u7387\u7684ISP sensor \u914d\u7f6e\u6587\u4ef6\uff1b",(0,s.jsx)(d.br,{}),"\n","2\uff0c",(0,s.jsx)(d.code,{children:"V4L2 vse alone"}),"\u6a21\u5f0f\uff0c\u4ec5\u652f\u6301\u4f7f\u7528VSE\u901a\u90532\uff0c\u56de\u704c\u56fe\u50cf\uff0c\u83b7\u53d6\u5904\u7406\u7ed3\u679c\uff1b"]})]})}function t(e={}){const{wrapper:d}={...(0,r.R)(),...e.components};return d?(0,s.jsx)(d,{...e,children:(0,s.jsx)(v,{...e})}):v(e)}}}]);