<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-Application_case/amr" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.8.1">
<title data-rh="true">6.2 AMR | RDK DOC</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://developer.d-robotics.cc/rdk_doc/en/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://developer.d-robotics.cc/rdk_doc/en/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://developer.d-robotics.cc/rdk_doc/en/Application_case/amr"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" property="og:locale:alternate" content="zh_Hans"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="6.2 AMR | RDK DOC"><meta data-rh="true" name="description" content="Autonomous Mobile Robot (AMR) is a type of robot that can autonomously navigate and perform tasks in an environment. AMR is different from Automated Guided Vehicles (AGVs), which rely on tracks or pre-defined routes and typically require operator supervision. AMR uses various technologies such as multi-sensor fusion, artificial intelligence, and machine learning to understand the environment and navigate within it, without being limited by wired power sources. Due to its highly flexible mobility and intelligent navigation system, AMR has been widely used in industrial automation, logistics, healthcare, and other fields."><meta data-rh="true" property="og:description" content="Autonomous Mobile Robot (AMR) is a type of robot that can autonomously navigate and perform tasks in an environment. AMR is different from Automated Guided Vehicles (AGVs), which rely on tracks or pre-defined routes and typically require operator supervision. AMR uses various technologies such as multi-sensor fusion, artificial intelligence, and machine learning to understand the environment and navigate within it, without being limited by wired power sources. Due to its highly flexible mobility and intelligent navigation system, AMR has been widely used in industrial automation, logistics, healthcare, and other fields."><link data-rh="true" rel="icon" href="/rdk_doc/en/img/logo.png"><link data-rh="true" rel="canonical" href="https://developer.d-robotics.cc/rdk_doc/en/Application_case/amr"><link data-rh="true" rel="alternate" href="https://developer.d-robotics.cc/rdk_doc/Application_case/amr" hreflang="zh-Hans"><link data-rh="true" rel="alternate" href="https://developer.d-robotics.cc/rdk_doc/en/Application_case/amr" hreflang="en"><link data-rh="true" rel="alternate" href="https://developer.d-robotics.cc/rdk_doc/Application_case/amr" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"6. Application Development Guide","item":"https://developer.d-robotics.cc/rdk_doc/en/Application_case"},{"@type":"ListItem","position":2,"name":"6.2 AMR","item":"https://developer.d-robotics.cc/rdk_doc/en/Application_case/amr"}]}</script><script src="https://hm.baidu.com/hm.js?24dd63cad43b63889ea6bede5fd1ab9e" async></script><link rel="stylesheet" href="/rdk_doc/en/assets/css/styles.cd83b4b4.css">
<script src="/rdk_doc/en/assets/js/runtime~main.c0d9cdbc.js" defer="defer"></script>
<script src="/rdk_doc/en/assets/js/main.a71e8821.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t="light";var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",e||t),document.documentElement.setAttribute("data-theme-choice",e||t)}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a href="https://d-robotics.cc/" target="_blank" rel="noopener noreferrer" class="navbar__brand"><div class="navbar__logo"><img src="/rdk_doc/en/img/logo.png" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/rdk_doc/en/img/logo.png" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">D-Robotics</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/rdk_doc/en/RDK">RDK X3 / X5</a><a class="navbar__item navbar__link" href="/rdk_doc/en/rdk_s/RDK">RDK S100</a><a href="https://developer.d-robotics.cc/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Community<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a href="https://github.com/D-Robotics" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link"><svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" class="iconLanguage_nlXk"><path fill="currentColor" d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></svg>EN</a><ul class="dropdown__menu"><li><a href="/rdk_doc/Application_case/amr" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="zh-Hans">CN</a></li><li><a href="/rdk_doc/en/Application_case/amr" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" lang="en">EN</a></li></ul></div><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><div class="navbar__search searchBarContainer_NW3z" dir="ltr"><input placeholder="Search" aria-label="Search" class="navbar__search-input" value=""><div class="loadingRing_RJI3 searchBarLoadingRing_YnHq"><div></div><div></div><div></div><div></div></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/rdk_doc/en/RDK">D-Robotics RDK Suite</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/rdk_doc/en/Quick_start">1. Quick Start</a><button aria-label="Expand sidebar category &#x27;1. Quick Start&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/rdk_doc/en/System_configuration">2. System Configuration</a><button aria-label="Expand sidebar category &#x27;2. System Configuration&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/rdk_doc/en/Basic_Application">3. Basic Application Development</a><button aria-label="Expand sidebar category &#x27;3. Basic Application Development&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/rdk_doc/en/Basic_Development">4. Algorithm Application Development</a><button aria-label="Expand sidebar category &#x27;4. Algorithm Application Development&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/rdk_doc/en/Robot_development">5. Robotics Application Development</a><button aria-label="Expand sidebar category &#x27;5. Robotics Application Development&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" href="/rdk_doc/en/Application_case">6. Application Development Guide</a><button aria-label="Collapse sidebar category &#x27;6. Application Development Guide&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/rdk_doc/en/Application_case/line_follower">6.1 Line Following</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/rdk_doc/en/Application_case/amr">6.2 AMR</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/rdk_doc/en/Advanced_development">7. Advanced Development</a><button aria-label="Expand sidebar category &#x27;7. Advanced Development&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/rdk_doc/en/FAQ">8. FAQs</a><button aria-label="Expand sidebar category &#x27;8. FAQs&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/rdk_doc/en/Appendix">9. Appendix</a><button aria-label="Expand sidebar category &#x27;9. Appendix&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/rdk_doc/en/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/rdk_doc/en/Application_case"><span>6. Application Development Guide</span></a></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">6.2 AMR</span></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>6.2 AMR</h1></header>
<p>Autonomous Mobile Robot (AMR) is a type of robot that can autonomously navigate and perform tasks in an environment. AMR is different from Automated Guided Vehicles (AGVs), which rely on tracks or pre-defined routes and typically require operator supervision. AMR uses various technologies such as multi-sensor fusion, artificial intelligence, and machine learning to understand the environment and navigate within it, without being limited by wired power sources. Due to its highly flexible mobility and intelligent navigation system, AMR has been widely used in industrial automation, logistics, healthcare, and other fields.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="1--example-introduction">1.  Example Introduction<a href="#1--example-introduction" class="hash-link" aria-label="Direct link to 1.  Example Introduction" title="Direct link to 1.  Example Introduction">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="11-appearance">1.1 Appearance<a href="#11-appearance" class="hash-link" aria-label="Direct link to 1.1 Appearance" title="Direct link to 1.1 Appearance">​</a></h3>
<p><img decoding="async" loading="lazy" src="https://rdk-doc.oss-cn-beijing.aliyuncs.com/doc/img/06_Application_case/amr/appearance.png" alt="" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="12-functional-framework">1.2 Functional framework<a href="#12-functional-framework" class="hash-link" aria-label="Direct link to 1.2 Functional framework" title="Direct link to 1.2 Functional framework">​</a></h3>
<p><img decoding="async" loading="lazy" src="https://rdk-doc.oss-cn-beijing.aliyuncs.com/doc/img/06_Application_case/amr/amr_framework_en.jpg" alt="" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="2-assembly-example">2. Assembly Example<a href="#2-assembly-example" class="hash-link" aria-label="Direct link to 2. Assembly Example" title="Direct link to 2. Assembly Example">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="21-component-list">2.1 Component List<a href="#21-component-list" class="hash-link" aria-label="Direct link to 2.1 Component List" title="Direct link to 2.1 Component List">​</a></h3>
<table><thead><tr><th>Name</th><th>Number</th><th>notes</th></tr></thead><tbody><tr><td>RDK X5</td><td>1</td><td>D-robotics</td></tr><tr><td>AMR chassis（Steering wheel）+ Screws and Parts</td><td>1</td><td>YUHESEN</td></tr><tr><td>Single line LiDAR</td><td>1</td><td>KRUISEE</td></tr><tr><td>TOFcamera</td><td>1</td><td>DEPTRUM</td></tr><tr><td>Binocular camera（230ai）</td><td>1</td><td>D-robotics</td></tr><tr><td>IMU（BMI088  ）</td><td>1</td><td>D-robotics</td></tr><tr><td>Network cable(0.3m)</td><td>1</td><td></td></tr><tr><td>12v to 5V4A(MAX 5A)</td><td>1</td><td></td></tr><tr><td>TOF camera stand（3D Printing）</td><td>1</td><td></td></tr><tr><td>Binocular camera stand（3D Printing）</td><td>1</td><td></td></tr><tr><td>Cover board（3D Printing）</td><td>1</td><td></td></tr><tr><td>M2*16 Screws + M2 nuts</td><td>1</td><td></td></tr></tbody></table>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="22-assembly-steps-explanation">2.2 Assembly steps explanation<a href="#22-assembly-steps-explanation" class="hash-link" aria-label="Direct link to 2.2 Assembly steps explanation" title="Direct link to 2.2 Assembly steps explanation">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="221-assemble-upper-shell">2.2.1 Assemble upper shell<a href="#221-assemble-upper-shell" class="hash-link" aria-label="Direct link to 2.2.1 Assemble upper shell" title="Direct link to 2.2.1 Assemble upper shell">​</a></h4>
<p>The native chassis cannot install cameras or store various cables, so a separate installation is needed to connect to the chassis. Simply align the two holes at the bottom of the installation with the parts on the chassis mounting rail, and tighten the screws</p>
<p><img decoding="async" loading="lazy" src="https://rdk-doc.oss-cn-beijing.aliyuncs.com/doc/img/06_Application_case/amr/upper_shell.jpg" alt="" class="img_ev3q"></p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="222-wiring-of-rdk-x5">2.2.2 Wiring of RDK X5<a href="#222-wiring-of-rdk-x5" class="hash-link" aria-label="Direct link to 2.2.2 Wiring of RDK X5" title="Direct link to 2.2.2 Wiring of RDK X5">​</a></h4>
<p>All sensors and chassis are directly connected to RDK X5. It should be noted that the binocular camera uses two 22 pin ribbon cables on the same surface. Please install them in the direction shown in the following figure</p>
<p><img decoding="async" loading="lazy" src="https://rdk-doc.oss-cn-beijing.aliyuncs.com/doc/img/06_Application_case/amr/RDK-X5_connection.jpg" alt="" class="img_ev3q"></p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="223-assemble-cover-board">2.2.3 Assemble cover board<a href="#223-assemble-cover-board" class="hash-link" aria-label="Direct link to 2.2.3 Assemble cover board" title="Direct link to 2.2.3 Assemble cover board">​</a></h4>
<p>The cover plate is a 3D printed part (see the attached drawing at the end of the text), mainly used for installing RDK X5 and storing other cables. The four mounting holes in the yellow frame are used to install RDK X5, located on the back of the upper cover plate. Align the installation holes at the red box position with the parts on the chassis mounting rail, and tighten the screws.</p>
<p><img decoding="async" loading="lazy" src="https://rdk-doc.oss-cn-beijing.aliyuncs.com/doc/img/06_Application_case/amr/cover_board.jpg" alt="" class="img_ev3q"></p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="224-lidar-access">2.2.4 Lidar access<a href="#224-lidar-access" class="hash-link" aria-label="Direct link to 2.2.4 Lidar access" title="Direct link to 2.2.4 Lidar access">​</a></h4>
<p>First, install the LiDAR onto the carrier board, screw it onto the back of the carrier board, and then connect the wiring through the holes on the overload board (shown in the yellow box on the right) to the power manager. The power manager is installed on the back of the carrier board, and the screws are installed from the front of the carrier board (as shown in the red box on the left). After installation, the network cable and 12V power supply are connected, and the network cable and power cord pass through the holes on the top (as shown in the red box on the right).</p>
<p><img decoding="async" loading="lazy" src="https://rdk-doc.oss-cn-beijing.aliyuncs.com/doc/img/06_Application_case/amr/lidar.jpg" alt="" class="img_ev3q"></p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="225-install-camera">2.2.5 Install camera<a href="#225-install-camera" class="hash-link" aria-label="Direct link to 2.2.5 Install camera" title="Direct link to 2.2.5 Install camera">​</a></h4>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="1-install-tof-camera">1. Install TOF camera<a href="#1-install-tof-camera" class="hash-link" aria-label="Direct link to 1. Install TOF camera" title="Direct link to 1. Install TOF camera">​</a></h5>
<p>Firstly, connect the TOF camera, 3D printed part, and sheet metal bracket together, paying attention to the groove of the 3D printed part facing downwards. After the connection is completed, insert the entire device into the groove above the upper part, and pass the power and signal wires through the internal holes of the upper part (yellow box in Figure 3). Align the screw holes of the sheet metal parts (red box in Figure 1) with the internal screw holes of the upper assembly (red box in Figure 3), and tighten the screws.</p>
<p><img decoding="async" loading="lazy" src="https://rdk-doc.oss-cn-beijing.aliyuncs.com/doc/img/06_Application_case/amr/tof_cam.jpg" alt="" class="img_ev3q"></p>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="2-install-binocular-camera">2. Install Binocular camera<a href="#2-install-binocular-camera" class="hash-link" aria-label="Direct link to 2. Install Binocular camera" title="Direct link to 2. Install Binocular camera">​</a></h5>
<p>First, connect the binocular camera to the 3D printed part, and then connect it to the sheet metal bracket at the rear of the chassis</p>
<p><img decoding="async" loading="lazy" src="https://rdk-doc.oss-cn-beijing.aliyuncs.com/doc/img/06_Application_case/amr/mipi_cam.jpg" alt="" class="img_ev3q"></p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="226-power-supply-instructions">2.2.6 Power supply instructions<a href="#226-power-supply-instructions" class="hash-link" aria-label="Direct link to 2.2.6 Power supply instructions" title="Direct link to 2.2.6 Power supply instructions">​</a></h4>
<p>A 12V power supply is provided on the chassis. 12V is provided to the radar, TOF camera, and transformer, and the transformer outputs 5V to the RDK X5</p>
<p><img decoding="async" loading="lazy" src="https://rdk-doc.oss-cn-beijing.aliyuncs.com/doc/img/06_Application_case/amr/power.jpg" alt="" class="img_ev3q"></p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="227-installation-of-other-components">2.2.7 Installation of other components<a href="#227-installation-of-other-components" class="hash-link" aria-label="Direct link to 2.2.7 Installation of other components" title="Direct link to 2.2.7 Installation of other components">​</a></h4>
<p><img decoding="async" loading="lazy" src="https://rdk-doc.oss-cn-beijing.aliyuncs.com/doc/img/06_Application_case/amr/other.jpg" alt="" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="3-preparation-of-operating-environment">3. Preparation of operating environment<a href="#3-preparation-of-operating-environment" class="hash-link" aria-label="Direct link to 3. Preparation of operating environment" title="Direct link to 3. Preparation of operating environment">​</a></h2>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>attention</div><div class="admonitionContent_BuS1"><p>Please obtain the code or function package for TOF camera, LiDAR, chassis, and IMU based on the actual device model. Only the source code for the sweet potato accessory IMU is provided here.</p></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="31-sensors-check">3.1 Sensors check<a href="#31-sensors-check" class="hash-link" aria-label="Direct link to 3.1 Sensors check" title="Direct link to 3.1 Sensors check">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="311-binocular-camera">3.1.1 Binocular camera<a href="#311-binocular-camera" class="hash-link" aria-label="Direct link to 3.1.1 Binocular camera" title="Direct link to 3.1.1 Binocular camera">​</a></h4>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">#Check the i2c device</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">root@ubuntu:~# i2cdetect -y -r 4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     0  1  2  3  4  5  6  7  8  9  a  b  c  d  e  f</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">00:                         -- -- -- -- -- -- -- --</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">10: -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">20: -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">30: -- -- 32 -- -- -- -- -- -- -- -- -- -- -- -- --</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">40: -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">50: 50 -- -- -- -- -- -- -- 58 -- -- -- -- -- -- --</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">60: -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">70: -- -- -- -- -- -- -- --</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">root@ubuntu:~# i2cdetect -y -r 6</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     0  1  2  3  4  5  6  7  8  9  a  b  c  d  e  f</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">00:                         -- -- -- -- -- -- -- --</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">10: -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">20: -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">30: 30 -- -- -- -- -- -- -- -- -- -- -- -- -- -- --</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">40: -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">50: 50 -- -- -- -- -- -- -- 58 -- -- -- -- -- -- --</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">60: -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">70: -- -- -- -- -- -- -- --</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="312-lidar">3.1.2 Lidar<a href="#312-lidar" class="hash-link" aria-label="Direct link to 3.1.2 Lidar" title="Direct link to 3.1.2 Lidar">​</a></h4>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">#Ensure that the gateway and mask of the Lidar and board are consistent, and confirm if they can be pinged</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ping ip of Lidar</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="313-chassis">3.1.3 Chassis<a href="#313-chassis" class="hash-link" aria-label="Direct link to 3.1.3 Chassis" title="Direct link to 3.1.3 Chassis">​</a></h4>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">#Start the CAN device, please set it according to the specific CAN device number and baud rate</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ip link set can1 up type can bitrate 500000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#Checking the equipment will result in the following outputs：can1: &lt;NOARP,UP,LOWER_UP&gt; mtu 16 qdisc mq state UP mode DEFAULT group default qlen 10link/can </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ip link show can1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#Check if CAN data can be obtained, please set according to the specific CAN device number</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">candump can1</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="314-imu">3.1.4 IMU<a href="#314-imu" class="hash-link" aria-label="Direct link to 3.1.4 IMU" title="Direct link to 3.1.4 IMU">​</a></h4>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">#Check the i2c device</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">root@ubuntu:~# i2cdetect -y -r 5</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     0  1  2  3  4  5  6  7  8  9  a  b  c  d  e  f</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">00:                         -- -- -- -- -- -- -- --</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">10: -- -- -- -- -- -- -- -- -- 19 -- -- -- -- -- --</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">20: -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">30: -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">40: -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">50: -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">60: -- -- -- -- -- -- -- -- -- 69 -- -- -- -- -- --</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">70: -- -- -- -- -- -- -- --</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Obtain IMU data (will print three numbers and change with IMU pose)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cat /sys/devices/virtual/input/input2/acc_bal</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cat /sys/devices/virtual/input/input2/gry_bal</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="32-function-installation">3.2 Function installation<a href="#32-function-installation" class="hash-link" aria-label="Direct link to 3.2 Function installation" title="Direct link to 3.2 Function installation">​</a></h3>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sudo apt -y tros-hobot-nav2 libsuitesparse-dev libblas-dev liblapack-dev libeigen3-dev libopencv-dev libspdlog-dev libconsole-bridge-dev libpcl-dev libgoogle-glog-dev libtf2-dev  ros-humble-cv-bridge  ros-humble-nav-msgs ros-humble-image-transport ros-humble-tf2-ros ros-humble-pcl-conversions ros-humble-navigation2 libceres-dev</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="33-source-code-acquisition-without-installation-package-function-requires-source-code-compilation">3.3 Source code acquisition (without installation package function, requires source code compilation)<a href="#33-source-code-acquisition-without-installation-package-function-requires-source-code-compilation" class="hash-link" aria-label="Direct link to 3.3 Source code acquisition (without installation package function, requires source code compilation)" title="Direct link to 3.3 Source code acquisition (without installation package function, requires source code compilation)">​</a></h3>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">mkdir -p ~/amr_ws/src &amp;&amp; cd src</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#tofSLAM </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">git clone https://github.com/wunuo1/Tofslam.git -b humble</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#point cloud filter</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">git clone https://github.com/wunuo1/voxel_filter.git</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#Specify location navigation</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">git clone https://github.com/wunuo1/pose_setter.git</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#双目深度</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">git clone https://github.com/D-Robotics/hobot_stereonet.git</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="34-compile-code">3.4 Compile code<a href="#34-compile-code" class="hash-link" aria-label="Direct link to 3.4 Compile code" title="Direct link to 3.4 Compile code">​</a></h3>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">#It is recommended to enable swap memory before compilation</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sudo fallocate -l 4G /swapfile</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sudo chmod 600 /swapfile</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sudo mkswap /swapfile</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">swapon /swapfile</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#Before compilation, the g2o feature package needs to be compiled, and the code can be obtained from the attachment at the end of the article</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#The compilation method is as follows</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cd g2o</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mkdir build &amp;&amp; cd build</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cmake ..</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">make</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">make install</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#After compiling g2o, you can compile various feature packages of ros2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cd ~/amr_ws</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">source /opt/tros/humble/setup.bash</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">colcon build</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="35-sensor-calibrate">3.5 Sensor calibrate<a href="#35-sensor-calibrate" class="hash-link" aria-label="Direct link to 3.5 Sensor calibrate" title="Direct link to 3.5 Sensor calibrate">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="351-preparation-before-sensor-calibration">3.5.1 Preparation before sensor calibration<a href="#351-preparation-before-sensor-calibration" class="hash-link" aria-label="Direct link to 3.5.1 Preparation before sensor calibration" title="Direct link to 3.5.1 Preparation before sensor calibration">​</a></h4>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="1-calibration-environment-preparation-calibration-tool-is-kalibr-here-we-provide-dokcer-containing-kalibr-and-other-calibration-scripts">1. Calibration environment preparation (calibration tool is kalibr, here we provide dokcer containing kalibr and other calibration scripts)<a href="#1-calibration-environment-preparation-calibration-tool-is-kalibr-here-we-provide-dokcer-containing-kalibr-and-other-calibration-scripts" class="hash-link" aria-label="Direct link to 1. Calibration environment preparation (calibration tool is kalibr, here we provide dokcer containing kalibr and other calibration scripts)" title="Direct link to 1. Calibration environment preparation (calibration tool is kalibr, here we provide dokcer containing kalibr and other calibration scripts)">​</a></h5>
<h6 class="anchor anchorWithStickyNavbar_LWe7" id="i-download-docker-filesbaidu-netdisk">i. Download Docker files(Baidu Netdisk)<a href="#i-download-docker-filesbaidu-netdisk" class="hash-link" aria-label="Direct link to i. Download Docker files(Baidu Netdisk)" title="Direct link to i. Download Docker files(Baidu Netdisk)">​</a></h6>
<p>Link: <a href="https://pan.baidu.com/s/1oXegKORgWi8Kzf4kdQXL2g?pwd=ur2z" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1oXegKORgWi8Kzf4kdQXL2g?pwd=ur2z</a></p>
<p>Extracted code：ur2z</p>
<h6 class="anchor anchorWithStickyNavbar_LWe7" id="ii-create-environment">ii. Create environment<a href="#ii-create-environment" class="hash-link" aria-label="Direct link to ii. Create environment" title="Direct link to ii. Create environment">​</a></h6>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">#Load Docker</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">docker load -i ubuntu18.04_calibration.tar</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#Check if Docker loads successfully (images with TAG as calibration appear)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">docker images</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#Generate a contact from an image</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">docker run -it --privileged -v /home/nuo.wu/share_dir:/share_dir -e DISPLAY=$DISPLAY -e GDK_SCALE -e GDK_DPI_SCALE --net=host ubuntu18.04:calibration /bin/bash</span><br></span></code></pre></div></div>
<h6 class="anchor anchorWithStickyNavbar_LWe7" id="iiidocker-supports-interface-display">iii.Docker supports interface display<a href="#iiidocker-supports-interface-display" class="hash-link" aria-label="Direct link to iii.Docker supports interface display" title="Direct link to iii.Docker supports interface display">​</a></h6>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># Run on the host side</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">xhost +local:docker</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Run the following command on the host side</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo $DISPLAY</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Run the following command in Docker</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo $DISPLAY</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Check if the outputs of the two are the same</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># If the outputs of the two are different, and the result displayed on the host side is 0, then run the following command in Docker</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">export DISPLAY=:0</span><br></span></code></pre></div></div>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="2-prepare-calibration-board-and-configure-parameters">2. Prepare calibration board and configure parameters<a href="#2-prepare-calibration-board-and-configure-parameters" class="hash-link" aria-label="Direct link to 2. Prepare calibration board and configure parameters" title="Direct link to 2. Prepare calibration board and configure parameters">​</a></h5>
<p>Both checkerboard and aprilgrid are acceptable (see attachment for aprilgrid file). The size of the checkerboard should be at least 10cm in length, and to avoid errors in extracting or connecting the corners of the checkerboard during calibration, the rows and columns of the checkerboard should be different. The Aprilgrid calibration board is relatively convenient for data acquisition and easy to operate, but it requires high image quality. Therefore, at this stage, it is still recommended to use a checkerboard. The outer dimensions of the calibration board are greater than 1m.</p>
<p><img decoding="async" loading="lazy" src="https://rdk-doc.oss-cn-beijing.aliyuncs.com/doc/img/06_Application_case/amr/cal_board.jpg" alt="" class="img_ev3q"></p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">#Set aprilgrid.yaml file</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">target_type: &#x27;aprilgrid&#x27; #gridtype</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">tagCols: 6               #number of apriltags</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">tagRows: 6               #number of apriltags</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">tagSize: 0.024           #size of apriltag, edge to edge [m]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">tagSpacing: 0.3083          #ratio of space between tags to tagSize</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">codeOffset: 0            #code offset for the first tag in the aprilboard</span><br></span></code></pre></div></div>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">#Set the parameters of the chessboard calibration board, where targetCols and targetRows are the number of inliers in each column and row, respectively. If the number of squares is 9 columns x8 columns, then the number of inliers is 8 columns x7 columns.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">target_type: &#x27;checkboard&#x27; </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">targetCols: 8 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">targetRows: 7  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">rawSpacingMeters: 0.1        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">colSpacingMeters: 0.1    </span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="352-binocular-camera-internal-parameter-calibration-using-binocular-depth-algorithm">3.5.2 Binocular camera internal parameter calibration (using binocular depth algorithm)<a href="#352-binocular-camera-internal-parameter-calibration-using-binocular-depth-algorithm" class="hash-link" aria-label="Direct link to 3.5.2 Binocular camera internal parameter calibration (using binocular depth algorithm)" title="Direct link to 3.5.2 Binocular camera internal parameter calibration (using binocular depth algorithm)">​</a></h4>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="1-calibration-data-collection">1. Calibration data collection<a href="#1-calibration-data-collection" class="hash-link" aria-label="Direct link to 1. Calibration data collection" title="Direct link to 1. Calibration data collection">​</a></h5>
<p>Move the camera or calibration board at different distances to ensure that the calibration board covers the FOV range of the image as much as possible. During the movement, do not move the checkerboard calibration board out of the frame. Slowly and steadily move the camera or calibration board to avoid image blurring caused by motion.</p>
<h6 class="anchor anchorWithStickyNavbar_LWe7" id="i-activate-the-binocular-camera">i. Activate the binocular camera<a href="#i-activate-the-binocular-camera" class="hash-link" aria-label="Direct link to i. Activate the binocular camera" title="Direct link to i. Activate the binocular camera">​</a></h6>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">source /opt/tros/humble/setup.bash</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ros2 run mipi_cam mipi_cam --ros-args -p device_mode:=&quot;dual&quot; -p out_format:=&quot;nv12&quot; -p dual_combine:=2 -p framerate:=10.0 --log-level warn</span><br></span></code></pre></div></div>
<h6 class="anchor anchorWithStickyNavbar_LWe7" id="ii-ros1-and-ros2-message-conversion-and-saving-of-image-dataset-ubuntu-2004-system-ros1-and-ros2-installed">ii. Ros1 and Ros2 message conversion and saving of image dataset (Ubuntu 20.04 system, Ros1 and Ros2 installed)<a href="#ii-ros1-and-ros2-message-conversion-and-saving-of-image-dataset-ubuntu-2004-system-ros1-and-ros2-installed" class="hash-link" aria-label="Direct link to ii. Ros1 and Ros2 message conversion and saving of image dataset (Ubuntu 20.04 system, Ros1 and Ros2 installed)" title="Direct link to ii. Ros1 and Ros2 message conversion and saving of image dataset (Ubuntu 20.04 system, Ros1 and Ros2 installed)">​</a></h6>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># Install ros1_bridge</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sudo apt update</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sudo apt install ros-humble-ros1-bridge</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#Start Terminal</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">source /opt/ros/noetic/setup.bash</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">roscore</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#Start a new terminal</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">source /opt/ros/noetic/setup.bash</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">source /opt/ros/humble/setup.bash</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ros2 run ros1_bridge dynamic_bridge --bridge-all-topics=false --bridge-topic sensor_msgs/msg/Image /image_combine_raw</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#Start a new terminal to record image data (move the camera to different positions)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">source /opt/ros/noetic/setup.bash</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">rosbag record image_combine_raw</span><br></span></code></pre></div></div>
<h6 class="anchor anchorWithStickyNavbar_LWe7" id="iii-call-the-calibration-program-for-calibration-specify-the-path-of-the-recorded-bag-package-and-the-path-of-the-calibration-configuration-file">iii. Call the calibration program for calibration (specify the path of the recorded bag package and the path of the calibration configuration file)<a href="#iii-call-the-calibration-program-for-calibration-specify-the-path-of-the-recorded-bag-package-and-the-path-of-the-calibration-configuration-file" class="hash-link" aria-label="Direct link to iii. Call the calibration program for calibration (specify the path of the recorded bag package and the path of the calibration configuration file)" title="Direct link to iii. Call the calibration program for calibration (specify the path of the recorded bag package and the path of the calibration configuration file)">​</a></h6>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$1=path_to_bag</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$2=path_to_calib_yaml(checkbord.yaml or aprilgrid.yaml)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">rosrun kalibr kalibr_calibrate_cameras --bag $1 --topics /camera/left/image_raw /camera/right/image_raw --models pinhole-radtan pinhole-radtan --target $2 --show-extraction</span><br></span></code></pre></div></div>
<h6 class="anchor anchorWithStickyNavbar_LWe7" id="iv-after-calibration-is-completed-the-calibration-file-is-as-follows">iv. After calibration is completed, the calibration file is as follows<a href="#iv-after-calibration-is-completed-the-calibration-file-is-as-follows" class="hash-link" aria-label="Direct link to iv. After calibration is completed, the calibration file is as follows" title="Direct link to iv. After calibration is completed, the calibration file is as follows">​</a></h6>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">cam0</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">cam_overlaps</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">camera_model</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> pinhole</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">distortion_coeffs</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">-0.30512368344314034</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0.06869074995752597</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">-0.0007768971335288749</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">-0.0018077365618742228</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">distortion_model</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> radtan</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">intrinsics</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">874.7756769752957</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">876.9016366753913</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">988.9147013767086</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">574.9147170323885</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">resolution</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">1920</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1080</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">rostopic</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> /camera/left/image_raw</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">cam1</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">T_cn_cnm1</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0.9998783828690954</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">-0.0007967376839525958</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0.015575130180209843</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">-0.06826569753821157</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0.0008025928358794327</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0.9999996095896897</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">-0.0003696825565397285</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">8.695548926243514e-05</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">-0.01557482955949466</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0.0003821380847083855</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0.9998786319622305</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0.0011080079883866683</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0.0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0.0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0.0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1.0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">cam_overlaps</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">camera_model</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> pinhole</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">distortion_coeffs</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">-0.30647450034075296</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0.06904546877578269</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">-0.0015178028297652521</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">-0.00016199661118514476</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">distortion_model</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> radtan</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">intrinsics</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">875.6405166670517</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">877.1839943792446</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">963.0392879775055</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">519.3086364230766</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">resolution</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">1920</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1080</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">rostopic</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> /camera/right/image_raw</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="353-monocular-camera-internal-parameter-calibration-used-for-external-parameter-calibration-of-imu-and-rgb-cam-in-the-future-if-the-module-already-provides-internal-parameters-ignore-this-step">3.5.3 Monocular camera internal parameter calibration (used for external parameter calibration of IMU and RGB CAM in the future. If the module already provides internal parameters, ignore this step)<a href="#353-monocular-camera-internal-parameter-calibration-used-for-external-parameter-calibration-of-imu-and-rgb-cam-in-the-future-if-the-module-already-provides-internal-parameters-ignore-this-step" class="hash-link" aria-label="Direct link to 3.5.3 Monocular camera internal parameter calibration (used for external parameter calibration of IMU and RGB CAM in the future. If the module already provides internal parameters, ignore this step)" title="Direct link to 3.5.3 Monocular camera internal parameter calibration (used for external parameter calibration of IMU and RGB CAM in the future. If the module already provides internal parameters, ignore this step)">​</a></h4>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="1-run-the-camera-please-execute-the-command-according-to-the-actual-module-used">1. Run the camera (please execute the command according to the actual module used)<a href="#1-run-the-camera-please-execute-the-command-according-to-the-actual-module-used" class="hash-link" aria-label="Direct link to 1. Run the camera (please execute the command according to the actual module used)" title="Direct link to 1. Run the camera (please execute the command according to the actual module used)">​</a></h5>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="2-run-the-bag-recorded-as-ros1-the-conversion-between-ros1-and-ros2-can-refer-to-binocular-intrinsic-calibration">2. Run the bag recorded as ros1 (the conversion between ros1 and ros2 can refer to binocular intrinsic calibration)<a href="#2-run-the-bag-recorded-as-ros1-the-conversion-between-ros1-and-ros2-can-refer-to-binocular-intrinsic-calibration" class="hash-link" aria-label="Direct link to 2. Run the bag recorded as ros1 (the conversion between ros1 and ros2 can refer to binocular intrinsic calibration)" title="Direct link to 2. Run the bag recorded as ros1 (the conversion between ros1 and ros2 can refer to binocular intrinsic calibration)">​</a></h5>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="3-run-calibration-instructions-in-docker-image">3. Run calibration instructions (in Docker image)<a href="#3-run-calibration-instructions-in-docker-image" class="hash-link" aria-label="Direct link to 3. Run calibration instructions (in Docker image)" title="Direct link to 3. Run calibration instructions (in Docker image)">​</a></h5>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">#cam.bag records the bag file/image camera topic pinhole radtan camera model checkborad.yaml calibration board description file</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">rosrun kalibr kalibr_calibrate_cameras --bag cam.bag --topic /image --model pinhole-radtan --target checkboard.yaml</span><br></span></code></pre></div></div>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="4-after-calibration-is-completed-the-content-is-as-follows-distortion_comffs-distortion-coefficients-intrinsic-internal-parameters">4. After calibration is completed, the content is as follows (distortion_comffs: distortion coefficients intrinsic: internal parameters)<a href="#4-after-calibration-is-completed-the-content-is-as-follows-distortion_comffs-distortion-coefficients-intrinsic-internal-parameters" class="hash-link" aria-label="Direct link to 4. After calibration is completed, the content is as follows (distortion_comffs: distortion coefficients intrinsic: internal parameters)" title="Direct link to 4. After calibration is completed, the content is as follows (distortion_comffs: distortion coefficients intrinsic: internal parameters)">​</a></h5>
<p><img decoding="async" loading="lazy" src="https://rdk-doc.oss-cn-beijing.aliyuncs.com/doc/img/06_Application_case/amr/mipi_int.jpg" alt="" class="img_ev3q"></p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="354-imu-parameter-calibration-used-for-external-parameter-calibration-of-imu-and-rgb-cam">3.5.4 IMU parameter calibration (used for external parameter calibration of IMU and RGB CAM)<a href="#354-imu-parameter-calibration-used-for-external-parameter-calibration-of-imu-and-rgb-cam" class="hash-link" aria-label="Direct link to 3.5.4 IMU parameter calibration (used for external parameter calibration of IMU and RGB CAM)" title="Direct link to 3.5.4 IMU parameter calibration (used for external parameter calibration of IMU and RGB CAM)">​</a></h4>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="1-data-acquisition">1. Data acquisition<a href="#1-data-acquisition" class="hash-link" aria-label="Direct link to 1. Data acquisition" title="Direct link to 1. Data acquisition">​</a></h5>
<h6 class="anchor anchorWithStickyNavbar_LWe7" id="i-run-imu">i. Run imu<a href="#i-run-imu" class="hash-link" aria-label="Direct link to i. Run imu" title="Direct link to i. Run imu">​</a></h6>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">source ~/amr_ws/install/setup.bash </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ros2 launch imu_sensor imu_sensor.launch.py</span><br></span></code></pre></div></div>
<h6 class="anchor anchorWithStickyNavbar_LWe7" id="ii-ros1-and-ros2-message-conversion-and-saving-of-image-dataset-ubuntu-2004-system-ros1-and-ros2-installed-1">ii. Ros1 and Ros2 message conversion and saving of image dataset (Ubuntu 20.04 system, Ros1 and Ros2 installed)<a href="#ii-ros1-and-ros2-message-conversion-and-saving-of-image-dataset-ubuntu-2004-system-ros1-and-ros2-installed-1" class="hash-link" aria-label="Direct link to ii. Ros1 and Ros2 message conversion and saving of image dataset (Ubuntu 20.04 system, Ros1 and Ros2 installed)" title="Direct link to ii. Ros1 and Ros2 message conversion and saving of image dataset (Ubuntu 20.04 system, Ros1 and Ros2 installed)">​</a></h6>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">#Start Terminal</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">source /opt/ros/noetic/setup.bash</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">roscore</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#Start a new Terminal</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">source /opt/ros/noetic/setup.bash</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">source /opt/ros/humble/setup.bash</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ros2 run ros1_bridge dynamic_bridge --bridge-all-topics=false --bridge-topic sensor_msgs/msg/Imu /imu_data</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#Start a new terminal to record IMU data (IMU needs to be left idle for more than 30 minutes to store data)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">source /opt/ros/noetic/setup.bash</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">rosbag record imu_data</span><br></span></code></pre></div></div>
<h6 class="anchor anchorWithStickyNavbar_LWe7" id="iii-modify-script-file-parameters-in-docker-environment">iii. Modify script file parameters (in Docker environment)<a href="#iii-modify-script-file-parameters-in-docker-environment" class="hash-link" aria-label="Direct link to iii. Modify script file parameters (in Docker environment)" title="Direct link to iii. Modify script file parameters (in Docker environment)">​</a></h6>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">vim /root/catkin_ws/src/imu_utils/launch/oal.launch</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#imu_topic         IMU&#x27;s topic</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#data_save_path    Save path of calibration file</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#max_time_min      The duration of collecting IMU data</span><br></span></code></pre></div></div>
<h6 class="anchor anchorWithStickyNavbar_LWe7" id="iv-run-calibration-script-calibration-results-will-be-printed-after-imu-bag-data-playback-is-complete">iv. Run calibration script (calibration results will be printed after imu bag data playback is complete)<a href="#iv-run-calibration-script-calibration-results-will-be-printed-after-imu-bag-data-playback-is-complete" class="hash-link" aria-label="Direct link to iv. Run calibration script (calibration results will be printed after imu bag data playback is complete)" title="Direct link to iv. Run calibration script (calibration results will be printed after imu bag data playback is complete)">​</a></h6>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">roslaunch imu_utils oal.lauch</span><br></span></code></pre></div></div>
<p><img decoding="async" loading="lazy" src="https://rdk-doc.oss-cn-beijing.aliyuncs.com/doc/img/06_Application_case/amr/imu_output.jpg" alt="" class="img_ev3q"></p>
<h6 class="anchor anchorWithStickyNavbar_LWe7" id="vplay-imus-bag-data">v.Play IMU&#x27;s bag data<a href="#vplay-imus-bag-data" class="hash-link" aria-label="Direct link to v.Play IMU&#x27;s bag data" title="Direct link to v.Play IMU&#x27;s bag data">​</a></h6>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">rosbag play imu.bag</span><br></span></code></pre></div></div>
<h6 class="anchor anchorWithStickyNavbar_LWe7" id="vi-modify-the-parameter-configuration-file-of-imu">vi. Modify the parameter configuration file of IMU<a href="#vi-modify-the-parameter-configuration-file-of-imu" class="hash-link" aria-label="Direct link to vi. Modify the parameter configuration file of IMU" title="Direct link to vi. Modify the parameter configuration file of IMU">​</a></h6>
<p><img decoding="async" loading="lazy" src="https://rdk-doc.oss-cn-beijing.aliyuncs.com/doc/img/06_Application_case/amr/cal_product.jpg" alt="" class="img_ev3q"></p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># Copy a new copy of the BMI088_imu_ param. yaml file generated in the previous text as a backup for future use. Execute the following command:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cp -r BMI088_imu_param.yaml imu.yaml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">vim imu.yaml</span><br></span></code></pre></div></div>
<p>After opening the configuration file, as shown in the following figure:
<img decoding="async" loading="lazy" src="https://rdk-doc.oss-cn-beijing.aliyuncs.com/doc/img/06_Application_case/amr/imu_config.jpg" alt="" class="img_ev3q"></p>
<p>Rewrite the content of the original BMI088_imu_maram.ml file and modify it to the following format:</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">#Accelerometers</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">accelerometer_noise_density</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">3.0219972277096316e-02</span><span class="token plain">   </span><span class="token comment" style="color:#999988;font-style:italic">#Noise density (continuous-time): Corresponding to Acc -&gt;avg axis -&gt;acc_n in the screenshot above</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">accelerometer_random_walk</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">   </span><span class="token number" style="color:#36acaa">1.9955401630133244e-04</span><span class="token plain">   </span><span class="token comment" style="color:#999988;font-style:italic">#Bias random walk: Corresponding to Acc -&gt;avg axis -&gt;accw_ in the screenshot above</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">#Gyroscopes</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">gyroscope_noise_density</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">     </span><span class="token number" style="color:#36acaa">2.8131368978892658e-03</span><span class="token plain">   </span><span class="token comment" style="color:#999988;font-style:italic">#Noise density (continuous-time): Corresponding to Gyr -&gt;avg axis -&gt;gyr-n in the screenshot above</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">gyroscope_random_walk</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">       </span><span class="token number" style="color:#36acaa">1.9705283783356781e-05</span><span class="token plain">   </span><span class="token comment" style="color:#999988;font-style:italic">#Bias random walk: Corresponding to Gyr -&gt;avg axis -&gt;gyr-w in the screenshot above</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">rostopic</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">                    /imu_data     </span><span class="token comment" style="color:#999988;font-style:italic">#The IMU ROS topic corresponds to the/imu_data in the topic of the data bag generated in rosbag format in the previous section</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">update_rate</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">                 </span><span class="token number" style="color:#36acaa">400.0</span><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic">#Hz (for discretization of the values above) corresponds to the actual IMU frequency used</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="355-rgb_cam-imu-extrinsic-calibration-used-to-obtain-the-transformation-of-tof_cam-imu">3.5.5 Rgb_cam imu extrinsic calibration (used to obtain the transformation of tof_cam imu)<a href="#355-rgb_cam-imu-extrinsic-calibration-used-to-obtain-the-transformation-of-tof_cam-imu" class="hash-link" aria-label="Direct link to 3.5.5 Rgb_cam imu extrinsic calibration (used to obtain the transformation of tof_cam imu)" title="Direct link to 3.5.5 Rgb_cam imu extrinsic calibration (used to obtain the transformation of tof_cam imu)">​</a></h4>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="1-activates-binocular-cameras">1. Activates binocular cameras<a href="#1-activates-binocular-cameras" class="hash-link" aria-label="Direct link to 1. Activates binocular cameras" title="Direct link to 1. Activates binocular cameras">​</a></h5>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">source /opt/tros/humble/setup.bash</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ros2 run mipi_cam mipi_cam --ros-args -p device_mode:=&quot;dual&quot; -p out_format:=&quot;nv12&quot; -p dual_combine:=2 -p framerate:=10.0 --log-level warn</span><br></span></code></pre></div></div>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="2-start-imu">2. Start imu<a href="#2-start-imu" class="hash-link" aria-label="Direct link to 2. Start imu" title="Direct link to 2. Start imu">​</a></h5>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">source ~/amr_ws/install/setup.bash </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ros2 launch imu_sensor imu_sensor.launch.py</span><br></span></code></pre></div></div>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="3-ros1-and-ros2-message-conversion-and-saving-of-image-dataset-ubuntu-2004-system-ros1-and-ros2-installed">3. Ros1 and Ros2 message conversion and saving of image dataset (Ubuntu 20.04 system, Ros1 and Ros2 installed)<a href="#3-ros1-and-ros2-message-conversion-and-saving-of-image-dataset-ubuntu-2004-system-ros1-and-ros2-installed" class="hash-link" aria-label="Direct link to 3. Ros1 and Ros2 message conversion and saving of image dataset (Ubuntu 20.04 system, Ros1 and Ros2 installed)" title="Direct link to 3. Ros1 and Ros2 message conversion and saving of image dataset (Ubuntu 20.04 system, Ros1 and Ros2 installed)">​</a></h5>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">#Install ros1_bridge</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sudo apt update</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sudo apt install ros-humble-ros1-bridge</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#Start terminal</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">source /opt/ros/noetic/setup.bash</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">roscore</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#Start a new terminal</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">source /opt/ros/noetic/setup.bash</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">source /opt/ros/humble/setup.bash</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ros2 run ros1_bridge dynamic_bridge --bridge-all-topics</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#Start a new terminal to record image data (move the camera to different positions)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">source /opt/ros/noetic/setup.bash</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">rosbag record /image_combine_raw /imu_data</span><br></span></code></pre></div></div>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="4-run-the-calibration-program">4. Run the calibration program<a href="#4-run-the-calibration-program" class="hash-link" aria-label="Direct link to 4. Run the calibration program" title="Direct link to 4. Run the calibration program">​</a></h5>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">rosrun kalibr kalibr_calibrate_imu_camera --bag cam_imu.bag --target april.yaml --cam cam.yaml --imu imu.yaml</span><br></span></code></pre></div></div>
<p><img decoding="async" loading="lazy" src="https://rdk-doc.oss-cn-beijing.aliyuncs.com/doc/img/06_Application_case/amr/imu_cam_cal.jpg" alt="" class="img_ev3q"></p>
<p>After calibration, check the calibration results (when dJ converges and drops below 0.1, it indicates accurate calibration)</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># storage-results-imucam.txt </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">vim storage-results-imucam.txt</span><br></span></code></pre></div></div>
<p>The external reference results are as follows：
<img decoding="async" loading="lazy" src="https://rdk-doc.oss-cn-beijing.aliyuncs.com/doc/img/06_Application_case/amr/imu_cam_trans.jpg" alt="" class="img_ev3q"></p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="356-other">3.5.6 Other<a href="#356-other" class="hash-link" aria-label="Direct link to 3.5.6 Other" title="Direct link to 3.5.6 Other">​</a></h4>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="1--the-rgb-cam-tof_cam-transformation-is-provided-by-the-module-and-the-tof_cam-bask-lonk-transformation-is-provided-by-the-equipment-assembly-drawing">1.  The rgb-cam-tof_cam transformation is provided by the module, and the tof_cam-bask-lonk transformation is provided by the equipment assembly drawing.<a href="#1--the-rgb-cam-tof_cam-transformation-is-provided-by-the-module-and-the-tof_cam-bask-lonk-transformation-is-provided-by-the-equipment-assembly-drawing" class="hash-link" aria-label="Direct link to 1.  The rgb-cam-tof_cam transformation is provided by the module, and the tof_cam-bask-lonk transformation is provided by the equipment assembly drawing." title="Direct link to 1.  The rgb-cam-tof_cam transformation is provided by the module, and the tof_cam-bask-lonk transformation is provided by the equipment assembly drawing.">​</a></h5>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="2--the-transformation-of-tof_cam-imu-used-for-tofslam-can-be-obtained-by-multiplying-the-transformation-matrices-of-rgb-cam-imu-and-rgb-cam-tof_cam">2.  The transformation of tof_cam imu (used for tofSLAM) can be obtained by multiplying the transformation matrices of rgb-cam imu and rgb-cam tof_cam<a href="#2--the-transformation-of-tof_cam-imu-used-for-tofslam-can-be-obtained-by-multiplying-the-transformation-matrices-of-rgb-cam-imu-and-rgb-cam-tof_cam" class="hash-link" aria-label="Direct link to 2.  The transformation of tof_cam imu (used for tofSLAM) can be obtained by multiplying the transformation matrices of rgb-cam imu and rgb-cam tof_cam" title="Direct link to 2.  The transformation of tof_cam imu (used for tofSLAM) can be obtained by multiplying the transformation matrices of rgb-cam imu and rgb-cam tof_cam">​</a></h5>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="3--the-transformation-of-bask_link-imu-for-tofslam-can-be-obtained-by-multiplying-the-transformation-matrices-of-tof_cam-imu-and-tof_cam-bask_link">3.  The transformation of bask_link imu (for tofSLAM) can be obtained by multiplying the transformation matrices of tof_cam imu and tof_cam bask_link<a href="#3--the-transformation-of-bask_link-imu-for-tofslam-can-be-obtained-by-multiplying-the-transformation-matrices-of-tof_cam-imu-and-tof_cam-bask_link" class="hash-link" aria-label="Direct link to 3.  The transformation of bask_link imu (for tofSLAM) can be obtained by multiplying the transformation matrices of tof_cam imu and tof_cam bask_link" title="Direct link to 3.  The transformation of bask_link imu (for tofSLAM) can be obtained by multiplying the transformation matrices of tof_cam imu and tof_cam bask_link">​</a></h5>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="36-change-configuration-file-for-tofslam">3.6 Change configuration file (for tofSLAM)<a href="#36-change-configuration-file-for-tofslam" class="hash-link" aria-label="Direct link to 3.6 Change configuration file (for tofSLAM)" title="Direct link to 3.6 Change configuration file (for tofSLAM)">​</a></h3>
<p>Modify the mapping.yaml file in the config folder and pay attention to the parameters with explanations，the output file is obtained from the attachment at the end of the article</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">YAML</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1.0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">preprocess</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">point_filter_num</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">3</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">#Point cloud downsampling</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">lidar_type</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">7</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># 1-AVIA 2-velodyne 3-ouster  4-robosense 5-pandar 6-dtof 7-mtof</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">blind</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0.01</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">common</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">imu_topic</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> /imu </span><span class="token comment" style="color:#999988;font-style:italic">#imu message name </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">lid_topic</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> /nebula/mtof_points2 </span><span class="token comment" style="color:#999988;font-style:italic">#point cloud or lidar message name </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">odom_topic</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> /odom  </span><span class="token comment" style="color:#999988;font-style:italic"># odometer message name </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">img_topic</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> /camera/color/image_raw/compressed </span><span class="token comment" style="color:#999988;font-style:italic">#rgb image message, can be compressed or original image</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">Localization_mode</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#36acaa">False</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">#Whether to locate, otherwise it is mapping</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">output_path</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> /home/slam_ws_2/output </span><span class="token comment" style="color:#999988;font-style:italic">#Path to store mapping products</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">model_path</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> /home/slam_ws_2/output/hfnet.onnx </span><span class="token comment" style="color:#999988;font-style:italic">#Specify the hfnet model path</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">imuhz</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">400</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">#IMU&#x27;s frequency</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">mapping</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">extrinsic_est_en</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#36acaa">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">#The change from TOF to IMU can be obtained by referring to the calibration instructions</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">tof2imu_extrinsic_T</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">-0.0039799203111821468</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">-0.027189542185995823831</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">-0.14001955020902342461</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">tof2imu_extrinsic_R</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">-0.993063627638373553564</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">0.052518963674774226572</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">-0.01498737732389914978</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        </span><span class="token number" style="color:#36acaa">-0.033814436045461613632</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">-0.016796566829113524293</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">-0.99928717438014507495</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        </span><span class="token number" style="color:#36acaa">-0.00801808196977665167</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">-0.99847864521832871386</span><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">0.03465425204866725379</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">#The change from bsak_link to IMU can be obtained by referring to the calibration instructions</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">robot2imu_extrinsic_T</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0.12588064308116462841</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0.008162559660163853708</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0.20705414746130172184</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">robot2imu_extrinsic_R</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0.052268869631951098023</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">-0.93852017660344945467</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0.033846560965168889575</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                          </span><span class="token number" style="color:#36acaa">0.93808656435923075909</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">-0.051737213472478319612</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0.015014368436287678477</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                          </span><span class="token number" style="color:#36acaa">0.033019704102458273174</span><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0.01675474093936925155</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0.99931446977489903968</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">delay_time</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0.3</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">odometry</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">wheelmode</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">#0-relativepose 1-velocity</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">max_trans_diff</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0.1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">max_drift_num</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">15</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">surf_res</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0.1</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">#0.4</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">log_print</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#36acaa">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">max_num_iteration</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">5</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># ct_icp</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">icpmodel</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> CT_POINT_TO_PLANE  </span><span class="token comment" style="color:#999988;font-style:italic"># CT_POINT_TO_PLANE  #CT_POINT_TO_PLANE                    # Options: [CT_POINT_TO_PLANE, POINT_TO_PLANE]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">size_voxel_map</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0.1</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">#0.4                         # The voxel size of in the voxel map</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">min_distance_points</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0.05</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">max_num_points_in_voxel</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">20</span><span class="token plain">                 </span><span class="token comment" style="color:#999988;font-style:italic"># The maximum number of points per voxel of the map</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">max_distance</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">50.0</span><span class="token plain">                        </span><span class="token comment" style="color:#999988;font-style:italic"># The threshold of the distance to suppress voxels from the map</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">weight_alpha</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0.9</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">weight_neighborhood</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0.1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">max_dist_to_plane_icp</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0.1</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">#0.3</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">init_num_frames</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">20</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">voxel_neighborhood</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">max_number_neighbors</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">20</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">threshold_voxel_occupancy</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">estimate_normal_from_neighborhood</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#36acaa">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">min_number_neighbors</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">20</span><span class="token plain">                    </span><span class="token comment" style="color:#999988;font-style:italic"># The minimum number of neighbor points to define a valid neighborhood</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">power_planarity</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2.0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">num_closest_neighbors</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">sampling_rate</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1.0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">ratio_of_nonground</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># max_num_residuals: 1000</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">max_num_residuals</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2000</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">min_num_residuals</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">100</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">motion_compensation</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> CONSTANT_VELOCITY </span><span class="token comment" style="color:#999988;font-style:italic">#NONE #CONSTANT_VELOCITY  #CONTINUOUS #NONE, CONSTANT_VELOCITY, ITERATIVE, CONTINUOUS</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">beta_location_consistency</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1.0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">beta_orientation_consistency</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1.0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">beta_constant_velocity</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1.0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">beta_small_velocity</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0.0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">thres_translation_norm</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0.03</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">thres_orientation_norm</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0.05</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">use_ground_constraint</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">#The following are the positioning function parameters</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">reloc</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">mapfile</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> /home/slam_ws_2/output/final</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">voxel.pcd </span><span class="token comment" style="color:#999988;font-style:italic">#PCD point cloud map path, the product of completed mapping</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">reloc_mode</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">#0-scancontext 1-hfnet  2-no   #Relocation detection method, 0 is point cloud detection, 1 is feature point detection</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">scancontext_dbfile</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> /home/slam_ws_2/output/ScanContext.bin </span><span class="token comment" style="color:#999988;font-style:italic">#Point cloud detection model path</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">hfnet_dbfile</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> /home/slam_ws_2/output/HFNet.bin </span><span class="token comment" style="color:#999988;font-style:italic">#Feature point detection model path</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">icp_threshold</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0.03</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="4-functional-experience">4. Functional Experience<a href="#4-functional-experience" class="hash-link" aria-label="Direct link to 4. Functional Experience" title="Direct link to 4. Functional Experience">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="41-tofslam-creates-3d-maps">4.1 TofSLAM creates 3D maps<a href="#41-tofslam-creates-3d-maps" class="hash-link" aria-label="Direct link to 4.1 TofSLAM creates 3D maps" title="Direct link to 4.1 TofSLAM creates 3D maps">​</a></h3>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">#Ensure the completion of all items mentioned in the preparation of the operating environment</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#Please ensure that the camera can see the complete apriltag at the beginning of the mapping process, and that all topic parameters match. After running, the map coordinate system will be transformed to apriltag in the output folder</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">source ~/amr_ws/install/setup.bash</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ros2 run demo demo --ros-args -p build_map:=true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#The Localization mode parameter in the config configuration file is set to False, and various topic parameters match</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">source ~/amr_ws/install/setup.bash</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ros2 run ct_lio ct_lio_eskf</span><br></span></code></pre></div></div>
<p>After startup, it is necessary to let the IMU initialize successfully for 3-4 seconds. Then, the mobile robot can be used for mapping. After the mapping is completed, the program should be closed. After completion, as shown in the following figure:
<img decoding="async" loading="lazy" src="https://rdk-doc.oss-cn-beijing.aliyuncs.com/doc/img/06_Application_case/amr/buld_map_output.jpg" alt="" class="img_ev3q"></p>
<p>The path specified in the mapping. yaml file will generate the following products
<img decoding="async" loading="lazy" src="https://rdk-doc.oss-cn-beijing.aliyuncs.com/doc/img/06_Application_case/amr/build_map_product.jpg" alt="" class="img_ev3q"></p>
<p>Use the pcl_viewer tool to view point cloud maps:
<img decoding="async" loading="lazy" src="https://rdk-doc.oss-cn-beijing.aliyuncs.com/doc/img/06_Application_case/amr/pcl_viewer.jpg" alt="" class="img_ev3q"></p>
<p>Architectural effect video: <a href="https://www.youtube.com/watch?v=TKRYnEfsEoQ&amp;list=PLSxjn4YS2IuFUWcLGj2_uuCfLYnNYw6Ld&amp;index=20" target="_blank" rel="noopener noreferrer">https://www.youtube.com/watch?v=TKRYnEfsEoQ&amp;list=PLSxjn4YS2IuFUWcLGj2_uuCfLYnNYw6Ld&amp;index=20</a></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="42-tofslam-positioning">4.2 TofSLAM-positioning<a href="#42-tofslam-positioning" class="hash-link" aria-label="Direct link to 4.2 TofSLAM-positioning" title="Direct link to 4.2 TofSLAM-positioning">​</a></h3>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">#Ensure that all items mentioned in the preparation of the running environment are completed, the Localization_made parameter in the config configuration file is set to True, and all types of topic parameters match</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">source ~/amr_ws/install/setup.bash</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ros2 run ct_lio ct_lio_eskf</span><br></span></code></pre></div></div>
<p>After startup, if the display frame number remains at 1, it means that the relocation has not been successful yet
<img decoding="async" loading="lazy" src="https://rdk-doc.oss-cn-beijing.aliyuncs.com/doc/img/06_Application_case/amr/reloc_fail.jpg" alt="" class="img_ev3q">
When the frame number is greater than 1, it indicates successful relocation, and rviz2 can be opened to view the path
<img decoding="async" loading="lazy" src="https://rdk-doc.oss-cn-beijing.aliyuncs.com/doc/img/06_Application_case/amr/reloc_success.png" alt="" class="img_ev3q">
<img decoding="async" loading="lazy" src="https://rdk-doc.oss-cn-beijing.aliyuncs.com/doc/img/06_Application_case/amr/path.png" alt="" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="43-convert-3d-point-cloud-map-to-2d-grid-map">4.3 Convert 3D point cloud map to 2D grid map<a href="#43-convert-3d-point-cloud-map-to-2d-grid-map" class="hash-link" aria-label="Direct link to 4.3 Convert 3D point cloud map to 2D grid map" title="Direct link to 4.3 Convert 3D point cloud map to 2D grid map">​</a></h3>
<p>This feature pack is an open-source feature pack for ros1. Please use it in an environment where ros1 is already installed. The usage method is as follows:</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="1-source-code-download-and-compilation">1. Source code download and compilation<a href="#1-source-code-download-and-compilation" class="hash-link" aria-label="Direct link to 1. Source code download and compilation" title="Direct link to 1. Source code download and compilation">​</a></h4>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">mkdir -p ~/pcd3d-2d/src &amp;&amp; cd ~/pcd3d-2d/src</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">git clone https://github.com/Hinson-A/pcd2pgm_package</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cd ..</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">source /opt/ros/noetic/setup.bash</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">catkin_make</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="2-operation-function">2. Operation function<a href="#2-operation-function" class="hash-link" aria-label="Direct link to 2. Operation function" title="Direct link to 2. Operation function">​</a></h4>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">source /opt/ros/noetic/setup.bash</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">source ~/pcd3d-2d/devel/setup.bash</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#Replace the pcd file path in the launch file with the actual path</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">roslaunch pcd2pgm run.launch</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="3-save-map">3. Save map<a href="#3-save-map" class="hash-link" aria-label="Direct link to 3. Save map" title="Direct link to 3. Save map">​</a></h4>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">#Open a new terminal (requiring installation of ros nometic map server)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">source /opt/ros/noetic/setup.bash</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">rosrun map_server map_saver</span><br></span></code></pre></div></div>
<p>After execution, map.pgm and map.yaml files will be generated in the current path. These two files can be used for Nav2, but when using them, the files in the maps folder of hobot_nav2 need to be replaced. The general path is/opt/dros/humble/share/hobot_nav2/maps. The point cloud map and raster map effects are as follows:
<img decoding="async" loading="lazy" src="https://rdk-doc.oss-cn-beijing.aliyuncs.com/doc/img/06_Application_case/amr/map.jpg" alt="" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="44-fixed-point-navigation">4.4 Fixed-point navigation<a href="#44-fixed-point-navigation" class="hash-link" aria-label="Direct link to 4.4 Fixed-point navigation" title="Direct link to 4.4 Fixed-point navigation">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="1-activate-tof-camera-lidar-chassis-imu">1. Activate TOF camera, LiDAR, chassis, IMU<a href="#1-activate-tof-camera-lidar-chassis-imu" class="hash-link" aria-label="Direct link to 1. Activate TOF camera, LiDAR, chassis, IMU" title="Direct link to 1. Activate TOF camera, LiDAR, chassis, IMU">​</a></h4>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">#Please start each sensor according to the actual device operation instructions. Only the IMU start instruction is provided here</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">source /opt/tros/humble/setup.bash</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ros2 launch imu_sensor imu_sensor.launch.py</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#Open a new terminal and start point cloud filtering</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ros2 run point_cloud_processing point_cloud_sparsification</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="2-activate-nav2-navigation-function">2. Activate Nav2 navigation function<a href="#2-activate-nav2-navigation-function" class="hash-link" aria-label="Direct link to 2. Activate Nav2 navigation function" title="Direct link to 2. Activate Nav2 navigation function">​</a></h4>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">source /opt/tros/humble/setup.bash</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ros2 launch hobot_nav2 hobot_nav2_bringup.launch.py</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="3-activate-the-fixed-point-navigation-function-ensure-that-the-complete-apriltag-can-be-seen-in-the-camera-image-after-activation">3. Activate the fixed-point navigation function (ensure that the complete AprilTag can be seen in the camera image after activation)<a href="#3-activate-the-fixed-point-navigation-function-ensure-that-the-complete-apriltag-can-be-seen-in-the-camera-image-after-activation" class="hash-link" aria-label="Direct link to 3. Activate the fixed-point navigation function (ensure that the complete AprilTag can be seen in the camera image after activation)" title="Direct link to 3. Activate the fixed-point navigation function (ensure that the complete AprilTag can be seen in the camera image after activation)">​</a></h4>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">source ~/amr_ws/install/setup.bash</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ros2 run demo demo</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="4-open-rviz-on-pc-to-view-navigation-effects">4. Open rviz on PC to view navigation effects<a href="#4-open-rviz-on-pc-to-view-navigation-effects" class="hash-link" aria-label="Direct link to 4. Open rviz on PC to view navigation effects" title="Direct link to 4. Open rviz on PC to view navigation effects">​</a></h4>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ros2 launch nav2_bringup rviz_launch.py</span><br></span></code></pre></div></div>
<p>Video: <a href="https://www.youtube.com/watch?v=IYsS2bADpeQ&amp;list=PLSxjn4YS2IuFUWcLGj2_uuCfLYnNYw6Ld&amp;index=21" target="_blank" rel="noopener noreferrer">https://www.youtube.com/watch?v=IYsS2bADpeQ&amp;list=PLSxjn4YS2IuFUWcLGj2_uuCfLYnNYw6Ld&amp;index=21</a></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="45-object-detection-and-segmentation">4.5 Object detection and segmentation<a href="#45-object-detection-and-segmentation" class="hash-link" aria-label="Direct link to 4.5 Object detection and segmentation" title="Direct link to 4.5 Object detection and segmentation">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="1-copy-the-launch-script-to-the-board-and-change-the-corresponding-parameters">1. Copy the launch script to the board and change the corresponding parameters:<a href="#1-copy-the-launch-script-to-the-board-and-change-the-corresponding-parameters" class="hash-link" aria-label="Direct link to 1. Copy the launch script to the board and change the corresponding parameters:" title="Direct link to 1. Copy the launch script to the board and change the corresponding parameters:">​</a></h4>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">import os</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from launch import LaunchDescription</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from launch_ros.actions import Node</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from launch.actions import IncludeLaunchDescription</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from launch.launch_description_sources import PythonLaunchDescriptionSource, AnyLaunchDescriptionSource</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from ament_index_python import get_package_share_directory</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">def generate_launch_description():</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    #Encode the BGR8 images released by the TOF camera into JPEG format for web display</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    bgr2jpeg =  Node(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        package=&#x27;hobot_codec&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        executable=&#x27;hobot_codec_republish&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        output=&#x27;screen&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        parameters=[{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &#x27;in_mode&#x27;: &#x27;ros&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &#x27;in_format&#x27;: &#x27;bgr8&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &#x27;out_mode&#x27;: &#x27;ros&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &#x27;out_format&#x27;: &#x27;jpeg&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &#x27;sub_topic&#x27;: &#x27;/nebula200/stof_rgb/image_raw&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &#x27;dump_output&#x27;: False</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        arguments=[&#x27;--ros-args&#x27;, &#x27;--log-level&#x27;, &#x27;warn&#x27;]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    #Decoding JPEG images into NV12 for YOLOV8 inference</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    jpeg2nv12 =  Node(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        package=&#x27;hobot_codec&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        executable=&#x27;hobot_codec_republish&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        output=&#x27;screen&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        parameters=[{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &#x27;in_mode&#x27;: &#x27;ros&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &#x27;in_format&#x27;: &#x27;jpeg&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &#x27;out_mode&#x27;: &#x27;ros&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &#x27;out_format&#x27;: &#x27;nv12&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &#x27;channel&#x27;: 1,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &#x27;sub_topic&#x27;: &#x27;/image_raw/compressed&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &#x27;dump_output&#x27;: False,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &#x27;pub_topic&#x27;: &#x27;/image&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        arguments=[&#x27;--ros-args&#x27;, &#x27;--log-level&#x27;, &#x27;warn&#x27;]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    #Run YOLOV8 to detect segmentation</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    yolov8 =  Node(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        package=&#x27;dnn_node_example&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        executable=&#x27;example&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        output=&#x27;screen&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        parameters=[{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &#x27;feed_type&#x27;: 1,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &#x27;is_shared_mem_sub&#x27;: 0,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &#x27;config_file&#x27;: &#x27;config/yolov8segworkconfig.json&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        arguments=[&#x27;--ros-args&#x27;, &#x27;--log-level&#x27;, &#x27;warn&#x27;]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    #Activate the web display function</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    web_node = IncludeLaunchDescription(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        PythonLaunchDescriptionSource(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            os.path.join(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                get_package_share_directory(&#x27;websocket&#x27;),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                &#x27;launch/websocket.launch.py&#x27;)),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        launch_arguments={</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &#x27;websocket_image_topic&#x27;: &#x27;/image_raw/compressed&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &#x27;websocket_image_type&#x27;: &#x27;mjpeg&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &#x27;websocket_smart_topic&#x27;: &#x27;/hobot_dnn_detection&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }.items()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return LaunchDescription([</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        bgr2jpeg,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        jpeg2nv12,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        yolov8,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        web_node</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ])</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="2-replace-path_of_launchfile-in-the-command-with-your-own-launch-file-path-and-run-the-command">2. Replace path_of_launchFILE in the command with your own launch file path and run the command<a href="#2-replace-path_of_launchfile-in-the-command-with-your-own-launch-file-path-and-run-the-command" class="hash-link" aria-label="Direct link to 2. Replace path_of_launchFILE in the command with your own launch file path and run the command" title="Direct link to 2. Replace path_of_launchFILE in the command with your own launch file path and run the command">​</a></h4>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">source /opt/tros/humble/setup.bash</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ros2 launch &lt;path_of_launch_file&gt;</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="3-open-a-browser-on-a-pc-within-the-same-local-area-network-and-enter-board-ip-8000-in-the-website-to-view-the-recognition-effect">3. Open a browser on a PC within the same local area network and enter &quot;board ip: 8000&quot; in the website to view the recognition effect<a href="#3-open-a-browser-on-a-pc-within-the-same-local-area-network-and-enter-board-ip-8000-in-the-website-to-view-the-recognition-effect" class="hash-link" aria-label="Direct link to 3. Open a browser on a PC within the same local area network and enter &quot;board ip: 8000&quot; in the website to view the recognition effect" title="Direct link to 3. Open a browser on a PC within the same local area network and enter &quot;board ip: 8000&quot; in the website to view the recognition effect">​</a></h4>
<p><img decoding="async" loading="lazy" src="https://rdk-doc.oss-cn-beijing.aliyuncs.com/doc/img/06_Application_case/amr/yolov8seg_web.jpg" alt="" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="5--code-introduction">5.  Code Introduction<a href="#5--code-introduction" class="hash-link" aria-label="Direct link to 5.  Code Introduction" title="Direct link to 5.  Code Introduction">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="51-tofslam">5.1 tofSLAM<a href="#51-tofslam" class="hash-link" aria-label="Direct link to 5.1 tofSLAM" title="Direct link to 5.1 tofSLAM">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="511-code-repository">5.1.1 Code repository:<a href="#511-code-repository" class="hash-link" aria-label="Direct link to 5.1.1 Code repository:" title="Direct link to 5.1.1 Code repository:">​</a></h4>
<p><a href="https://github.com/wunuo1/TofSLAM_ros2" target="_blank" rel="noopener noreferrer">https://github.com/wunuo1/TofSLAM_ros2</a></p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="512-engineering-framework-logic">5.1.2 Engineering framework logic:<a href="#512-engineering-framework-logic" class="hash-link" aria-label="Direct link to 5.1.2 Engineering framework logic:" title="Direct link to 5.1.2 Engineering framework logic:">​</a></h4>
<p><img decoding="async" loading="lazy" src="https://rdk-doc.oss-cn-beijing.aliyuncs.com/doc/img/06_Application_case/amr/tofslam_framework_en.jpg" alt="" class="img_ev3q"></p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="513-detailed-description">5.1.3 detailed description:<a href="#513-detailed-description" class="hash-link" aria-label="Direct link to 5.1.3 detailed description:" title="Direct link to 5.1.3 detailed description:">​</a></h4>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="1-eskferror-state-kalman-filter">1. ESKF（Error State Kalman Filter）<a href="#1-eskferror-state-kalman-filter" class="hash-link" aria-label="Direct link to 1. ESKF（Error State Kalman Filter）" title="Direct link to 1. ESKF（Error State Kalman Filter）">​</a></h5>
<p>The error state Kalman filter is an algorithm for sensor fusion. It is based on the classical Kalman Filter (KF) principle and has been improved to better handle error propagation in nonlinear systems</p>
<p><em>state quantity</em>：p、R、v、bg、ba、g</p>
<p><em>prediction model</em>：IMU
<img decoding="async" loading="lazy" src="https://rdk-doc.oss-cn-beijing.aliyuncs.com/doc/img/06_Application_case/amr/imu_model.png" alt="" class="img_ev3q"></p>
<p>*Observation (update) model 1 *: Chassis wheel speed&amp;chassis IMU pose calculated through EKF - loose coupling (R, p update)</p>
<p>*Observation (update) model 2 *: pose obtained from point cloud ICP calculation - loose coupling (R, p update)
<img decoding="async" loading="lazy" src="https://rdk-doc.oss-cn-beijing.aliyuncs.com/doc/img/06_Application_case/amr/model2.png" alt="" class="img_ev3q"></p>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="2-imu-static-initialization">2. IMU static initialization<a href="#2-imu-static-initialization" class="hash-link" aria-label="Direct link to 2. IMU static initialization" title="Direct link to 2. IMU static initialization">​</a></h5>
<p>IMU initialization remains static, estimating the direction of gravity, gyroscope bias, and accelerometer bias based on the accelerometer. Set the initial pose as the origin and the initial velocity as 0</p>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="3-map-format-ha-style-voxel-map">3. Map format: Ha style voxel map<a href="#3-map-format-ha-style-voxel-map" class="hash-link" aria-label="Direct link to 3. Map format: Ha style voxel map" title="Direct link to 3. Map format: Ha style voxel map">​</a></h5>
<p>Use a Ha series table to store voxel maps, with several points stored in each voxel (0.1 × 0.1 × 0.1) and a certain distance (0.05) maintained between each point.</p>
<p><img decoding="async" loading="lazy" src="https://rdk-doc.oss-cn-beijing.aliyuncs.com/doc/img/06_Application_case/amr/voxel.png" alt="" class="img_ev3q"></p>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="4--point-cloud-icp">4.  Point Cloud ICP<a href="#4--point-cloud-icp" class="hash-link" aria-label="Direct link to 4.  Point Cloud ICP" title="Direct link to 4.  Point Cloud ICP">​</a></h5>
<h6 class="anchor anchorWithStickyNavbar_LWe7" id="1--key-point-extraction-use-gridsample-method-to-downsample-the-point-cloud-of-each-frame-and-extract-key-points">1.  Key point extraction: Use gridsample method to downsample the point cloud of each frame and extract key points.<a href="#1--key-point-extraction-use-gridsample-method-to-downsample-the-point-cloud-of-each-frame-and-extract-key-points" class="hash-link" aria-label="Direct link to 1.  Key point extraction: Use gridsample method to downsample the point cloud of each frame and extract key points." title="Direct link to 1.  Key point extraction: Use gridsample method to downsample the point cloud of each frame and extract key points.">​</a></h6>
<p>For each key point:</p>
<ol>
<li>Find nearest neighbors: Using voxelmap, search for the N nearest points qi in adjacent voxels as neighbor points.</li>
<li>Calculate the normal n, covariance matrix, and smoothness weight a of neighboring points</li>
<li>Calculate the distance between key points and the plane where neighboring points are located, and add ICP optimization for point pairs with distances less than the threshold.
<img decoding="async" loading="lazy" src="https://rdk-doc.oss-cn-beijing.aliyuncs.com/doc/img/06_Application_case/amr/point_icp.jpg" alt="" class="img_ev3q"></li>
</ol>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="5-ct_scp-algorithmct-icp-real-time-elastic-lidar-odometry-with-loop-closure">5. CT_SCP algorithm（CT-ICP: Real-time Elastic LiDAR Odometry with Loop Closure）<a href="#5-ct_scp-algorithmct-icp-real-time-elastic-lidar-odometry-with-loop-closure" class="hash-link" aria-label="Direct link to 5. CT_SCP algorithm（CT-ICP: Real-time Elastic LiDAR Odometry with Loop Closure）" title="Direct link to 5. CT_SCP algorithm（CT-ICP: Real-time Elastic LiDAR Odometry with Loop Closure）">​</a></h5>
<h6 class="anchor anchorWithStickyNavbar_LWe7" id="1-front-end-pose-estimation">1. Front end pose estimation<a href="#1-front-end-pose-estimation" class="hash-link" aria-label="Direct link to 1. Front end pose estimation" title="Direct link to 1. Front end pose estimation">​</a></h6>
<p>The overall framework of the front-end part of the CTICP algorithm uses two poses to describe each frame:
<img decoding="async" loading="lazy" src="https://rdk-doc.oss-cn-beijing.aliyuncs.com/doc/img/06_Application_case/amr/ct_icp_pose.jpg" alt="" class="img_ev3q">
There is no need to separately remove motion distortion for each frame of point cloud in advance, but rather to directly remove distortion during the optimization process. This algorithm is more robust for high-speed motion.</p>
<p>Optimization equation:
<img decoding="async" loading="lazy" src="https://rdk-doc.oss-cn-beijing.aliyuncs.com/doc/img/06_Application_case/amr/equation.jpg" alt="" class="img_ev3q"></p>
<h6 class="anchor anchorWithStickyNavbar_LWe7" id="2-backend-loop-optimization">2. Backend Loop Optimization<a href="#2-backend-loop-optimization" class="hash-link" aria-label="Direct link to 2. Backend Loop Optimization" title="Direct link to 2. Backend Loop Optimization">​</a></h6>
<p>Scan Nmap frames each time to form a point cloud, and insert each point into a 2D elevation grid. Then generate a 2D elevation map from the 2D elevation grid, with each pixel corresponding to the point with the largest Z-axis. Extract features from 2D elevation maps, and store the extracted features in memory along with the 2D elevation grid along with keyframes. When the elevation map features are extracted each time and matched with the features in memory; For successfully matched elevation maps, first estimate the 2D transformation matrix using RANSAC, and verify the matching reliability based on the number of inliers; Using the 2D transformation matrix as the initial value, perform ICP on the point cloud in the 2D elevation grid, and finally add an edge to the successfully matched keyframes. Use g2o to optimize the pose map. (This method is only applicable to planar motion)
<img decoding="async" loading="lazy" src="https://rdk-doc.oss-cn-beijing.aliyuncs.com/doc/img/06_Application_case/amr/loop_optimization.jpg" alt="" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="52-binocular-depth">5.2 Binocular depth<a href="#52-binocular-depth" class="hash-link" aria-label="Direct link to 5.2 Binocular depth" title="Direct link to 5.2 Binocular depth">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="521-repositories">5.2.1 Repositories:<a href="#521-repositories" class="hash-link" aria-label="Direct link to 5.2.1 Repositories:" title="Direct link to 5.2.1 Repositories:">​</a></h4>
<p><a href="https://github.com/D-Robotics/hobot_stereonet.git" target="_blank" rel="noopener noreferrer">https://github.com/D-Robotics/hobot_stereonet.git</a></p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="522-engineering-logic-framework">5.2.2 Engineering Logic Framework:<a href="#522-engineering-logic-framework" class="hash-link" aria-label="Direct link to 5.2.2 Engineering Logic Framework:" title="Direct link to 5.2.2 Engineering Logic Framework:">​</a></h4>
<p><img decoding="async" loading="lazy" src="https://rdk-doc.oss-cn-beijing.aliyuncs.com/doc/img/06_Application_case/amr/stereonet_framework_en.jpg" alt="" class="img_ev3q"></p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="523-detailed-description">5.2.3 detailed description:<a href="#523-detailed-description" class="hash-link" aria-label="Direct link to 5.2.3 detailed description:" title="Direct link to 5.2.3 detailed description:">​</a></h4>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="1-detailed-principle-of-binocular-depth-perception">1. Detailed principle of binocular depth perception:<a href="#1-detailed-principle-of-binocular-depth-perception" class="hash-link" aria-label="Direct link to 1. Detailed principle of binocular depth perception:" title="Direct link to 1. Detailed principle of binocular depth perception:">​</a></h5>
<p><img decoding="async" loading="lazy" src="https://rdk-doc.oss-cn-beijing.aliyuncs.com/doc/img/06_Application_case/amr/perception_principle.jpg" alt="" class="img_ev3q"></p>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="2-steps-of-binocular-stereo-matching-algorithm">2. Steps of binocular stereo matching algorithm:<a href="#2-steps-of-binocular-stereo-matching-algorithm" class="hash-link" aria-label="Direct link to 2. Steps of binocular stereo matching algorithm:" title="Direct link to 2. Steps of binocular stereo matching algorithm:">​</a></h5>
<p><img decoding="async" loading="lazy" src="https://rdk-doc.oss-cn-beijing.aliyuncs.com/doc/img/06_Application_case/amr/stereonet_step.jpg" alt="" class="img_ev3q"></p>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="3-model-introduction">3. Model Introduction<a href="#3-model-introduction" class="hash-link" aria-label="Direct link to 3. Model Introduction" title="Direct link to 3. Model Introduction">​</a></h5>
<ol>
<li>Backbone: MixVarGENet+UNet. Efficient backbone+UNet recovery details optimized for X5;</li>
<li>Cost Volume: Groupwise Correlation Cost Volume. Calculate the correlation between left and right image features to construct a cost volume;</li>
<li>Cost Aggregation: UNet. Aggregate cost volume through UNet to achieve more refined integration of cost volume;</li>
<li>Refinement: GRU. The use of GRU module brings performance improvement in edge details.</li>
<li>Spatial Upsampling: Using Conv instead of Unfold operation for tensor segmentation, generating a full resolution disparity map through weighted combination
<img decoding="async" loading="lazy" src="https://rdk-doc.oss-cn-beijing.aliyuncs.com/doc/img/06_Application_case/amr/stereonet_model.jpg" alt="" class="img_ev3q"></li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="53-object-detection-and-segmentation">5.3 Object detection and segmentation<a href="#53-object-detection-and-segmentation" class="hash-link" aria-label="Direct link to 5.3 Object detection and segmentation" title="Direct link to 5.3 Object detection and segmentation"> ​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="531-repositories">5.3.1 Repositories:<a href="#531-repositories" class="hash-link" aria-label="Direct link to 5.3.1 Repositories:" title="Direct link to 5.3.1 Repositories:">​</a></h4>
<p><a href="https://github.com/D-Robotics/hobot_dnn/tree/" target="_blank" rel="noopener noreferrer">https://github.com/D-Robotics/hobot_dnn/tree/</a></p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="532-code-engineering-logic-framework">5.3.2 Code Engineering Logic Framework:<a href="#532-code-engineering-logic-framework" class="hash-link" aria-label="Direct link to 5.3.2 Code Engineering Logic Framework:" title="Direct link to 5.3.2 Code Engineering Logic Framework:">​</a></h4>
<p><img decoding="async" loading="lazy" src="https://rdk-doc.oss-cn-beijing.aliyuncs.com/doc/img/06_Application_case/amr/detection_framework_en.jpg" alt="" class="img_ev3q"></p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="533-detailed-description">5.3.3 detailed description:<a href="#533-detailed-description" class="hash-link" aria-label="Direct link to 5.3.3 detailed description:" title="Direct link to 5.3.3 detailed description:">​</a></h4>
<ol>
<li>Use the official version YOLOV8 SEG model, source code repository link <a href="https://github.com/ultralytics/ultralytics" target="_blank" rel="noopener noreferrer">https://github.com/ultralytics/ultralytics</a></li>
<li>The encoding and decoding functions are accelerated by the hardware unit on RDK X5, significantly reducing CPU usage while improving format conversion efficiency</li>
<li>The project uses the hobot-dnn_deample with the code tros, which supports inference for multiple models in addition to yolov8-seg</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="54-navigation-and-task-scheduling">5.4 Navigation and task scheduling<a href="#54-navigation-and-task-scheduling" class="hash-link" aria-label="Direct link to 5.4 Navigation and task scheduling" title="Direct link to 5.4 Navigation and task scheduling">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="541-repositories">5.4.1 Repositories:<a href="#541-repositories" class="hash-link" aria-label="Direct link to 5.4.1 Repositories:" title="Direct link to 5.4.1 Repositories:">​</a></h4>
<p><a href="https://github.com/wunuo1/pose_setter.git" target="_blank" rel="noopener noreferrer">https://github.com/wunuo1/pose_setter.git</a></p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="542-engineering-logic-framework">5.4.2 Engineering Logic Framework:<a href="#542-engineering-logic-framework" class="hash-link" aria-label="Direct link to 5.4.2 Engineering Logic Framework:" title="Direct link to 5.4.2 Engineering Logic Framework:">​</a></h4>
<p><img decoding="async" loading="lazy" src="https://rdk-doc.oss-cn-beijing.aliyuncs.com/doc/img/06_Application_case/amr/pose_setter_en.jpg" alt="" class="img_ev3q"></p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="543-detailed-description">5.4.3 detailed description:<a href="#543-detailed-description" class="hash-link" aria-label="Direct link to 5.4.3 detailed description:" title="Direct link to 5.4.3 detailed description:">​</a></h4>
<ol>
<li>The program performs AprilTag detection at startup. After successful detection, it will cache ten frames of transformations and take the average value. Obtain the transformation from RGB to AprilTag, read the transformation from map to AprilTag recorded during mapping, and calculate the transformation from RGB to map. In the early calibration process, the transformation from RGB to robot can already be calculated, so the transformation from robot to map can be obtained to publish the initial position of the robot in the map coordinate system.</li>
<li>After the initial position is published, the activation thread starts requesting navigation to the target position. If the request is rejected, it indicates that the posture initialization has failed and the initial position is republished.</li>
<li>Request navigation to multiple target locations. Only after the previous target location is successfully navigated, will the thread be activated for the next request</li>
<li>After the initial position, AprilTag detection will be performed and the previous steps will be repeated in a loop</li>
<li>In the Nav2 navigation plugin, point cloud information has been added to the obstacle layer to avoid obstacles with heights lower than the LiDAR. However, due to the noise in the native point cloud data and the large amount of point cloud data, point cloud filtering nodes have been added to sparsify and filter the point cloud.</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="6-annex">6. Annex<a href="#6-annex" class="hash-link" aria-label="Direct link to 6. Annex" title="Direct link to 6. Annex">​</a></h2>
<p>Link：<a href="https://pan.baidu.com/s/14A4mqJvqzfp-MZaQkGpvLg?pwd=8VpL" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/14A4mqJvqzfp-MZaQkGpvLg?pwd=8VpL</a>
Extracted code：8VpL</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"></div><div class="col lastUpdated_JAkA"><span class="theme-last-updated">Last updated<!-- --> on <b><time datetime="2025-06-18T07:16:07.000Z" itemprop="dateModified">Jun 18, 2025</time></b></span></div></div></footer></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/rdk_doc/en/Application_case/line_follower"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">6.1 Line Following</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/rdk_doc/en/Advanced_development"><div class="pagination-nav__sublabel">Next </div><div class="pagination-nav__label">7. 进阶开发</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#1--example-introduction" class="table-of-contents__link toc-highlight">1.  Example Introduction</a><ul><li><a href="#11-appearance" class="table-of-contents__link toc-highlight">1.1 Appearance</a></li><li><a href="#12-functional-framework" class="table-of-contents__link toc-highlight">1.2 Functional framework</a></li></ul></li><li><a href="#2-assembly-example" class="table-of-contents__link toc-highlight">2. Assembly Example</a><ul><li><a href="#21-component-list" class="table-of-contents__link toc-highlight">2.1 Component List</a></li><li><a href="#22-assembly-steps-explanation" class="table-of-contents__link toc-highlight">2.2 Assembly steps explanation</a></li></ul></li><li><a href="#3-preparation-of-operating-environment" class="table-of-contents__link toc-highlight">3. Preparation of operating environment</a><ul><li><a href="#31-sensors-check" class="table-of-contents__link toc-highlight">3.1 Sensors check</a></li><li><a href="#32-function-installation" class="table-of-contents__link toc-highlight">3.2 Function installation</a></li><li><a href="#33-source-code-acquisition-without-installation-package-function-requires-source-code-compilation" class="table-of-contents__link toc-highlight">3.3 Source code acquisition (without installation package function, requires source code compilation)</a></li><li><a href="#34-compile-code" class="table-of-contents__link toc-highlight">3.4 Compile code</a></li><li><a href="#35-sensor-calibrate" class="table-of-contents__link toc-highlight">3.5 Sensor calibrate</a></li><li><a href="#36-change-configuration-file-for-tofslam" class="table-of-contents__link toc-highlight">3.6 Change configuration file (for tofSLAM)</a></li></ul></li><li><a href="#4-functional-experience" class="table-of-contents__link toc-highlight">4. Functional Experience</a><ul><li><a href="#41-tofslam-creates-3d-maps" class="table-of-contents__link toc-highlight">4.1 TofSLAM creates 3D maps</a></li><li><a href="#42-tofslam-positioning" class="table-of-contents__link toc-highlight">4.2 TofSLAM-positioning</a></li><li><a href="#43-convert-3d-point-cloud-map-to-2d-grid-map" class="table-of-contents__link toc-highlight">4.3 Convert 3D point cloud map to 2D grid map</a></li><li><a href="#44-fixed-point-navigation" class="table-of-contents__link toc-highlight">4.4 Fixed-point navigation</a></li><li><a href="#45-object-detection-and-segmentation" class="table-of-contents__link toc-highlight">4.5 Object detection and segmentation</a></li></ul></li><li><a href="#5--code-introduction" class="table-of-contents__link toc-highlight">5.  Code Introduction</a><ul><li><a href="#51-tofslam" class="table-of-contents__link toc-highlight">5.1 tofSLAM</a></li><li><a href="#52-binocular-depth" class="table-of-contents__link toc-highlight">5.2 Binocular depth</a></li><li><a href="#53-object-detection-and-segmentation" class="table-of-contents__link toc-highlight">5.3 Object detection and segmentation</a></li><li><a href="#54-navigation-and-task-scheduling" class="table-of-contents__link toc-highlight">5.4 Navigation and task scheduling</a></li></ul></li><li><a href="#6-annex" class="table-of-contents__link toc-highlight">6. Annex</a></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Links</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://www.guyuehome.com/" target="_blank" rel="noopener noreferrer" class="footer__link-item">GuYueHome<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Contact US</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/D-Robotics" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://www.youtube.com/@D-Robotics" target="_blank" rel="noopener noreferrer" class="footer__link-item">Youtube<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2024 D-Robotics.</div></div></div></footer></div>
</body>
</html>