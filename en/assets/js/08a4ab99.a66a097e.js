"use strict";(self.webpackChunkrdk_doc=self.webpackChunkrdk_doc||[]).push([[84359],{10731:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>c,contentTitle:()=>l,default:()=>a,frontMatter:()=>o,metadata:()=>t,toc:()=>d});const t=JSON.parse('{"id":"Advanced_development/linux_development/driver_development_x5/driver_thermal_dev","title":"Thermal System","description":"Temperature Sensors","source":"@site/i18n/en/docusaurus-plugin-content-docs/current/07_Advanced_development/02_linux_development/driver_development_x5/driver_thermal_dev.md","sourceDirName":"07_Advanced_development/02_linux_development/driver_development_x5","slug":"/Advanced_development/linux_development/driver_development_x5/driver_thermal_dev","permalink":"/rdk_doc/en/Advanced_development/linux_development/driver_development_x5/driver_thermal_dev","draft":false,"unlisted":false,"tags":[],"version":"current","lastUpdatedAt":1756492991000,"sidebarPosition":9,"frontMatter":{"sidebar_position":9},"sidebar":"tutorialSidebar","previous":{"title":"SPI Debugging Guide","permalink":"/rdk_doc/en/Advanced_development/linux_development/driver_development_x5/driver_spi_dev"},"next":{"title":"Low Power Mode Debugging Guide","permalink":"/rdk_doc/en/Advanced_development/linux_development/driver_development_x5/driver_lowpower"}}');var s=r(74848),i=r(28453);const o={sidebar_position:9},l="Thermal System",c={},d=[{value:"Temperature Sensors",id:"temperature-sensors",level:2},{value:"Thermal",id:"thermal",level:2},{value:"Thermal Reference Documentation",id:"thermal-reference-documentation",level:2}];function h(e){const n={code:"code",h1:"h1",h2:"h2",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"thermal-system",children:"Thermal System"})}),"\n",(0,s.jsx)(n.h2,{id:"temperature-sensors",children:"Temperature Sensors"}),"\n",(0,s.jsxs)(n.p,{children:["The X5 has three temperature sensors used to display the temperatures of the DDR, BPU, and CPU. These sensors' parameters can be found under the ",(0,s.jsx)(n.code,{children:"/sys/class/hwmon/"})," directory. Specifically, in the ",(0,s.jsx)(n.code,{children:"hwmon0"})," directory, the following temperature readings are provided:"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"temp1_input"}),": DDR temperature"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"temp2_input"}),": BPU temperature"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"temp3_input"}),": CPU temperature"]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"The temperature accuracy is 0.001\xb0C."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"cat /sys/class/hwmon/hwmon0/temp1_input\n46643\n"})}),"\n",(0,s.jsx)(n.p,{children:"Note: The BPU temperature sensor is located in the BPU subsystem, which is powered on only when the BPU is running. Therefore, the BPU temperature can only be monitored when the BPU is active."}),"\n",(0,s.jsx)(n.h2,{id:"thermal",children:"Thermal"}),"\n",(0,s.jsx)(n.p,{children:"Linux Thermal is a module in the Linux system related to temperature control. It is primarily used to manage the heat generated by the chip during system operation, ensuring that the chip temperature and the device casing temperature remain within a safe and comfortable range."}),"\n",(0,s.jsx)(n.p,{children:"To achieve reasonable temperature control, we need to understand the following three modules:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Temperature Sensing Devices"}),": In the Thermal framework, these are abstracted as Thermal Zone Devices. The X5 has two thermal zones, namely ",(0,s.jsx)(n.code,{children:"thermal_zone0"})," and ",(0,s.jsx)(n.code,{children:"thermal_zone1"}),"."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Cooling Devices"}),": In the Thermal framework, these are abstracted as Thermal Cooling Devices, such as CPU, BPU, GPU, and DDR."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Temperature Control Policy"}),": In the Thermal framework, this is abstracted as the Thermal Governor."]}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:["Information and control for these modules can be found under the ",(0,s.jsx)(n.code,{children:"/sys/class/thermal"})," directory."]}),"\n",(0,s.jsx)(n.p,{children:"In the X5, there are four cooling devices:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"cooling_device0"}),": CPU"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"cooling_device1"}),": BPU"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"cooling_device2"}),": GPU"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"cooling_device3"}),": DDR"]}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:["Among these, the DDR cooling device is associated with ",(0,s.jsx)(n.code,{children:"thermal_zone0"}),", while the CPU/BPU/GPU cooling devices are associated with ",(0,s.jsx)(n.code,{children:"thermal_zone1"}),". The default policy, as identified by the following command, is ",(0,s.jsx)(n.strong,{children:"step_wise"}),"."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"cat /sys/class/thermal/thermal_zone0/policy\n"})}),"\n",(0,s.jsxs)(n.p,{children:["You can see the supported policies through the following command: ",(0,s.jsx)(n.code,{children:"user_space"})," and ",(0,s.jsx)(n.code,{children:"step_wise"}),", a total of two options."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"cat /sys/class/thermal/thermal_zone0/available_policies\n"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"user_space"}),": This policy reports the current temperature of the thermal zone, as well as the thermal trigger points, to user space via uevent. The user space software then defines the thermal control strategy."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"step_wise"}),": This policy gradually increases the cooling state in each polling cycle. It is a relatively mild thermal control strategy."]}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:["The choice of which strategy to use depends on the product requirements. It can be specified during compilation or dynamically switched via sysfs. For example, to dynamically switch the strategy for ",(0,s.jsx)(n.code,{children:"thermal_zone0"})," to ",(0,s.jsx)(n.code,{children:"user_space"})," mode, use the following command:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"echo user_space > /sys/class/thermal/thermal_zone0/policy\n"})}),"\n",(0,s.jsxs)(n.p,{children:["In ",(0,s.jsx)(n.code,{children:"thermal_zone0"}),", there is 1 trip point used to control the frequency scaling of the DDR cooling device."]}),"\n",(0,s.jsx)(n.p,{children:"You can check the DDR frequency scaling temperature through sysfs. The current configured value is 95\xb0C."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"cat /sys/devices/virtual/thermal/thermal_zone0/trip_point_0_temp\n"})}),"\n",(0,s.jsx)(n.p,{children:"If you want to adjust the DDR frequency scaling temperature to 85\xb0C, you can use the following command:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"echo 85000 > /sys/devices/virtual/thermal/thermal_zone0/trip_point_0_temp\n"})}),"\n",(0,s.jsxs)(n.p,{children:["In ",(0,s.jsx)(n.code,{children:"thermal_zone1"}),", there are 3 trip points:"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"trip_point_0_temp"}),": Reserved for future use."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"trip_point_1_temp"}),": The frequency scaling temperature for this thermal zone, which controls the CPU/BPU/GPU frequency. The current setting is 95\xb0C."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"trip_point_2_temp"}),": The shutdown temperature, which is currently set to 105\xb0C.\nTo set the temperature at which the CPU/BPU/GPU should start frequency scaling to 85\xb0C, you can adjust ",(0,s.jsx)(n.strong,{children:"trip_point_1_temp"})," in ",(0,s.jsx)(n.code,{children:"thermal_zone1"}),". Use the following command:"]}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"echo 85000 > /sys/devices/virtual/thermal/thermal_zone1/trip_point_1_temp\n"})}),"\n",(0,s.jsxs)(n.p,{children:["If you want to adjust the shutdown temperature to 105\xb0C in ",(0,s.jsx)(n.code,{children:"thermal_zone1"}),", you can modify ",(0,s.jsx)(n.strong,{children:"trip_point_2_temp"}),". Use the following command:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"echo 105000 > /sys/devices/virtual/thermal/thermal_zone1/trip_point_2_temp\n"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)("font",{color:"red",children:"Note:"})," The above settings will need to be re-applied after a power cycle or reboot."]}),"\n",(0,s.jsx)(n.h2,{id:"thermal-reference-documentation",children:"Thermal Reference Documentation"}),"\n",(0,s.jsx)(n.p,{children:"The following paths are based on the kernel source directory:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"./Documentation/devicetree/bindings/thermal\n./Documentation/driver-api/thermal\n"})})]})}function a(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(h,{...e})}):h(e)}},28453:(e,n,r)=>{r.d(n,{R:()=>o,x:()=>l});var t=r(96540);const s={},i=t.createContext(s);function o(e){const n=t.useContext(i);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:o(e.components),t.createElement(i.Provider,{value:n},e.children)}}}]);