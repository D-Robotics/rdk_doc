"use strict";(self.webpackChunkrdk_doc=self.webpackChunkrdk_doc||[]).push([[91405],{28453:(e,i,n)=>{n.d(i,{R:()=>t,x:()=>d});var s=n(96540);const r={},a=s.createContext(r);function t(e){const i=s.useContext(a);return s.useMemo(function(){return"function"==typeof e?e(i):{...i,...e}},[i,e])}function d(e){let i;return i=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:t(e.components),s.createElement(a.Provider,{value:i},e.children)}},97894:(e,i,n)=>{n.r(i),n.d(i,{assets:()=>o,contentTitle:()=>d,default:()=>p,frontMatter:()=>t,metadata:()=>s,toc:()=>l});const s=JSON.parse('{"id":"Advanced_development/multimedia_development/multimedia_application/sample_isp","title":"sample_isp Usage Guide","description":"Function Overview","source":"@site/i18n/en/docusaurus-plugin-content-docs-docs_s/current/07_Advanced_development/03_multimedia_development/02_multimedia_application/03_sample_isp.md","sourceDirName":"07_Advanced_development/03_multimedia_development/02_multimedia_application","slug":"/Advanced_development/multimedia_development/multimedia_application/sample_isp","permalink":"/rdk_doc/en/rdk_s/Advanced_development/multimedia_development/multimedia_application/sample_isp","draft":false,"unlisted":false,"tags":[],"version":"current","lastUpdatedAt":1770785005000,"sidebarPosition":3,"frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"sample_vin Usage Instructions","permalink":"/rdk_doc/en/rdk_s/Advanced_development/multimedia_development/multimedia_application/sample_vin"},"next":{"title":"sample_pym Usage Instructions","permalink":"/rdk_doc/en/rdk_s/Advanced_development/multimedia_development/multimedia_application/sample_pym"}}');var r=n(74848),a=n(28453);const t={},d="sample_isp Usage Guide",o={},l=[{value:"Function Overview",id:"function-overview",level:2},{value:"sample_isp Architecture Description",id:"sample_isp-architecture-description",level:3},{value:"get_isp_data",id:"get_isp_data",level:2},{value:"Code Location and Directory Structure",id:"code-location-and-directory-structure",level:4},{value:"Compilation",id:"compilation",level:3},{value:"Execution",id:"execution",level:3},{value:"How to Run the Program",id:"how-to-run-the-program",level:4},{value:"Program Parameter Options",id:"program-parameter-options",level:4},{value:"Execution Output",id:"execution-output",level:4},{value:"isp_feedback",id:"isp_feedback",level:2},{value:"Code Location and Directory Structure",id:"code-location-and-directory-structure-1",level:4},{value:"Compilation",id:"compilation-1",level:3},{value:"Execution",id:"execution-1",level:3},{value:"How to Run the Program",id:"how-to-run-the-program-1",level:4},{value:"Program Parameter Options",id:"program-parameter-options-1",level:4},{value:"Execution Output",id:"execution-output-1",level:4},{value:"Common Issues with isp_feedback",id:"common-issues-with-isp_feedback",level:3}];function c(e){const i={a:"a",br:"br",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,a.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(i.header,{children:(0,r.jsx)(i.h1,{id:"sample_isp-usage-guide",children:"sample_isp Usage Guide"})}),"\n",(0,r.jsx)(i.h2,{id:"function-overview",children:"Function Overview"}),"\n",(0,r.jsxs)(i.p,{children:[(0,r.jsx)(i.code,{children:"sample_isp"})," initializes the Camera Sensor, MIPI CSI, CIM, and ISP modules, enabling the retrieval of video frame data from the ISP module. It supports obtaining YUV-formatted images from the ISP module."]}),"\n",(0,r.jsx)(i.h3,{id:"sample_isp-architecture-description",children:"sample_isp Architecture Description"}),"\n",(0,r.jsxs)(i.p,{children:[(0,r.jsx)(i.code,{children:"sample_isp"})," contains multiple examples, each located as a subdirectory under ",(0,r.jsx)(i.code,{children:"/app/multimedia_samples/sample_isp"}),". Each subdirectory is described below:"]}),"\n",(0,r.jsxs)(i.table,{children:[(0,r.jsx)(i.thead,{children:(0,r.jsxs)(i.tr,{children:[(0,r.jsx)(i.th,{children:"Directory"}),(0,r.jsx)(i.th,{children:"Description"})]})}),(0,r.jsxs)(i.tbody,{children:[(0,r.jsxs)(i.tr,{children:[(0,r.jsx)(i.td,{children:(0,r.jsx)(i.a,{href:"#get_isp_data",children:"get_isp_data"})}),(0,r.jsx)(i.td,{children:"Example for single-sensor YUV video frame acquisition"})]}),(0,r.jsxs)(i.tr,{children:[(0,r.jsx)(i.td,{children:(0,r.jsx)(i.a,{href:"#isp_feedback",children:"isp_feedback"})}),(0,r.jsx)(i.td,{children:"Example for ISP video frame feedback"})]})]})]}),"\n",(0,r.jsx)(i.h2,{id:"get_isp_data",children:"get_isp_data"}),"\n",(0,r.jsx)(i.h4,{id:"code-location-and-directory-structure",children:"Code Location and Directory Structure"}),"\n",(0,r.jsxs)(i.p,{children:["The source code for ",(0,r.jsx)(i.code,{children:"get_isp_data"})," is located at ",(0,r.jsx)(i.code,{children:"/app/multimedia_samples/sample_isp/get_isp_data"}),", with the following structure:"]}),"\n",(0,r.jsx)(i.pre,{children:(0,r.jsx)(i.code,{className:"language-shell",children:"\u2500\u2500 get_isp_data\n   \u251c\u2500\u2500 get_isp_data.c\n   \u2514\u2500\u2500 Makefile\n"})}),"\n",(0,r.jsxs)(i.ul,{children:["\n",(0,r.jsx)(i.li,{children:"Makefile: Makefile used to compile the program."}),"\n",(0,r.jsx)(i.li,{children:"get_isp_data.c: Main source code file of the program."}),"\n"]}),"\n",(0,r.jsx)(i.h3,{id:"compilation",children:"Compilation"}),"\n",(0,r.jsxs)(i.p,{children:["Run the ",(0,r.jsx)(i.code,{children:"make"})," command in the source directory to compile:"]}),"\n",(0,r.jsx)(i.pre,{children:(0,r.jsx)(i.code,{className:"language-Shell",children:"cd /app/multimedia_samples/sample_isp/get_isp_data\nmake\n"})}),"\n",(0,r.jsx)(i.h3,{id:"execution",children:"Execution"}),"\n",(0,r.jsx)(i.h4,{id:"how-to-run-the-program",children:"How to Run the Program"}),"\n",(0,r.jsxs)(i.p,{children:["Execute the program directly with ",(0,r.jsx)(i.code,{children:"./get_isp_data -h"})," to display help information:"]}),"\n",(0,r.jsx)(i.h4,{id:"program-parameter-options",children:"Program Parameter Options"}),"\n",(0,r.jsxs)(i.p,{children:["Running ",(0,r.jsx)(i.code,{children:"./get_isp_data -h"})," displays help information and a list of supported Camera Sensors."]}),"\n",(0,r.jsx)(i.pre,{children:(0,r.jsx)(i.code,{className:"language-shell",children:"root@ubuntu:/app/multimedia_samples/sample_isp/get_isp_data# ./get_isp_data -h\nUsage: get_isp_data [OPTIONS]\nOptions:\n  -s <sensor_index>      Specify sensor index\n  -o <online>            Specify the connection method from VIN to ISP, 1: online 0: offline\n  -l <link_port>         Specify the port for connecting serdes sensors, 0:A 1:B 2:C 3:D\n  -h                     Show this help message\nindex: 0  sensor_name: imx219-30fps             config_file:linear_1920x1080_raw10_30fps_1lane.c\nindex: 1  sensor_name: sc1336_gmsl-30fps        config_file:linear_1280x720_raw10_30fps_2lane.c\nindex: 2  sensor_name: ar0820std-30fps          config_file:linear_3840x2160_30fps_1lane.c\nindex: 3  sensor_name: ar0820std-1080p30        config_file:linear_1920x1080_yuv_30fps_1lane.c\n"})}),"\n",(0,r.jsx)(i.p,{children:(0,r.jsx)(i.strong,{children:"Command Parameter Descriptions:"})}),"\n",(0,r.jsxs)(i.ul,{children:["\n",(0,r.jsxs)(i.li,{children:[(0,r.jsx)(i.code,{children:"s <sensor_index>"}),": Specifies the sensor index to use. The user must provide a valid index value."]}),"\n",(0,r.jsxs)(i.li,{children:[(0,r.jsx)(i.code,{children:"o <online>"}),": Specifies the connection method from VIN to ISP: 1 for online, 0 for offline. Optional; defaults to offline mode."]}),"\n",(0,r.jsxs)(i.li,{children:[(0,r.jsx)(i.code,{children:"l <link_port>"}),": Specifies the port used to connect SerDes sensors. Required for SerDes sensors."]}),"\n",(0,r.jsxs)(i.li,{children:[(0,r.jsx)(i.code,{children:"h"}),": Displays help information."]}),"\n"]}),"\n",(0,r.jsx)(i.h4,{id:"execution-output",children:"Execution Output"}),"\n",(0,r.jsxs)(i.p,{children:["Taking the imx219 sensor as an example, run ",(0,r.jsx)(i.code,{children:"./get_isp_data -s 0"}),"."]}),"\n",(0,r.jsx)(i.pre,{children:(0,r.jsx)(i.code,{className:"language-shell",children:"root@ubuntu:/app/multimedia_samples/sample_isp/get_isp_data# ./get_isp_data -s 0\nUsing index:0  sensor_name:imx219-30fps  config_file:linear_1920x1080_raw10_30fps_1lane.c\nmipi mclk is not configed.\nSearching camera sensor on device: /proc/device-tree/soc/vcon@0 i2c bus: 1 mipi rx phy: 0\nmipi rx used phy: 00000000\nINFO: Found sensor_name:imx219-30fps on mipi rx csi 0, i2c addr 0x10, config_file:linear_1920x1080_raw10_30fps_1lane.c\n\nINFO: ISP channel info:\n        input info: [mipi_rx: 0] [is_online: 0]\n        isp channel info: [hw_id: 0] [slot_id: 4]\n\n***************  Command Lists  ***************\n g      -- get single frame\n l      -- get a set frames\n q      -- quit\n h      -- print help message\n\nCommand: g\nhandle 100197 isp dump yuv 1920x1080(stride:1920), buffer size: 2073600 + 1036800 frame id: 27, timestamp: 20832399744000\n\nCommand: q\nquit\n"})}),"\n",(0,r.jsxs)(i.ul,{children:["\n",(0,r.jsxs)(i.li,{children:[(0,r.jsx)(i.strong,{children:"g"}),": Acquires a single frame. Multiple 'g' inputs can be used to continuously acquire frames (e.g., input \"gggg\")."]}),"\n"]}),"\n",(0,r.jsx)(i.pre,{children:(0,r.jsx)(i.code,{className:"language-shell",children:"Command: g\nhandle 100197 isp dump yuv 1920x1080(stride:1920), buffer size: 2073600 + 1036800 frame id: 0, timestamp: 197145649052\n"})}),"\n",(0,r.jsxs)(i.ul,{children:["\n",(0,r.jsxs)(i.li,{children:[(0,r.jsx)(i.strong,{children:"l"}),": Continuously acquires 12 frames (equivalent to entering 12 'g' commands)."]}),"\n"]}),"\n",(0,r.jsx)(i.pre,{children:(0,r.jsx)(i.code,{className:"language-shell",children:"Command: l\nhandle 100197 isp dump yuv 1920x1080(stride:1920), buffer size: 2073600 + 1036800 frame id: 1, timestamp: 197178981635\nhandle 100197 isp dump yuv 1920x1080(stride:1920), buffer size: 2073600 + 1036800 frame id: 355, timestamp: 208978985224\n... (omitted; total of 12 frames dumped) ...\nhandle 100197 isp dump yuv 1920x1080(stride:1920), buffer size: 2073600 + 1036800 frame id: 394, timestamp: 210278982766\nhandle 100197 isp dump yuv 1920x1080(stride:1920), buffer size: 2073600 + 1036800 frame id: 395, timestamp: 210312316183\n"})}),"\n",(0,r.jsxs)(i.ul,{children:["\n",(0,r.jsxs)(i.li,{children:[(0,r.jsx)(i.strong,{children:"q"}),": Quits the program."]}),"\n"]}),"\n",(0,r.jsx)(i.pre,{children:(0,r.jsx)(i.code,{className:"language-shell",children:"Command: q\nquit\n"})}),"\n",(0,r.jsxs)(i.p,{children:["After execution, YUV images will be saved with filenames following the format:",(0,r.jsx)(i.br,{}),"\n",(0,r.jsx)(i.code,{children:"handle_100197_isp_chn0_1920x1080_stride_1920_frameid_27_ts_20832399744000.yuv"}),"."]}),"\n",(0,r.jsx)(i.h2,{id:"isp_feedback",children:"isp_feedback"}),"\n",(0,r.jsx)(i.h4,{id:"code-location-and-directory-structure-1",children:"Code Location and Directory Structure"}),"\n",(0,r.jsxs)(i.p,{children:["The source code for ",(0,r.jsx)(i.code,{children:"isp_feedback"})," is located at ",(0,r.jsx)(i.code,{children:"/app/multimedia_samples/sample_isp/isp_feedback"}),", with the following structure:"]}),"\n",(0,r.jsx)(i.pre,{children:(0,r.jsx)(i.code,{className:"language-shell",children:"\u2500\u2500 isp_feedback\n   \u251c\u2500\u2500 isp_feedback.c\n   \u2514\u2500\u2500 Makefile\n"})}),"\n",(0,r.jsxs)(i.ul,{children:["\n",(0,r.jsx)(i.li,{children:"Makefile: Makefile used to compile the program."}),"\n",(0,r.jsx)(i.li,{children:"isp_feedback.c: Main source code file of the program."}),"\n"]}),"\n",(0,r.jsx)(i.h3,{id:"compilation-1",children:"Compilation"}),"\n",(0,r.jsxs)(i.p,{children:["Run the ",(0,r.jsx)(i.code,{children:"make"})," command in the source directory to compile:"]}),"\n",(0,r.jsx)(i.pre,{children:(0,r.jsx)(i.code,{className:"language-Shell",children:"cd /app/multimedia_samples/sample_isp/isp_feedback\nmake\n"})}),"\n",(0,r.jsx)(i.h3,{id:"execution-1",children:"Execution"}),"\n",(0,r.jsx)(i.h4,{id:"how-to-run-the-program-1",children:"How to Run the Program"}),"\n",(0,r.jsxs)(i.p,{children:["Execute the program directly with ",(0,r.jsx)(i.code,{children:"./isp_feedback -h"})," to display help information:"]}),"\n",(0,r.jsx)(i.h4,{id:"program-parameter-options-1",children:"Program Parameter Options"}),"\n",(0,r.jsxs)(i.p,{children:["Running ",(0,r.jsx)(i.code,{children:"./isp_feedback -h"})," displays help information."]}),"\n",(0,r.jsx)(i.pre,{children:(0,r.jsx)(i.code,{className:"language-shell",children:"root@ubuntu:/app/multimedia_samples/sample_isp/isp_feedback# ./isp_feedback -h\nUsage: isp_feedback [OPTIONS]\nOptions:\n  -f <file>              Specify Raw filename\n  -F <format>            Specify Raw format eg: raw8 raw10 raw12\n  -W <width>             Specify Raw width\n  -H <height>            Specify Raw height\n  -l <loop>              Specify feedback Raw loop\n  -h                     Show this help message\n"})}),"\n",(0,r.jsx)(i.p,{children:(0,r.jsx)(i.strong,{children:"Command Parameter Descriptions:"})}),"\n",(0,r.jsxs)(i.ul,{children:["\n",(0,r.jsxs)(i.li,{children:[(0,r.jsx)(i.code,{children:"f <file>"}),": Specifies the filename of the RAW image to use."]}),"\n",(0,r.jsxs)(i.li,{children:[(0,r.jsx)(i.code,{children:"F <format>"}),": Specifies the format of the RAW image (e.g., raw8, raw10, raw12)."]}),"\n",(0,r.jsxs)(i.li,{children:[(0,r.jsx)(i.code,{children:"W <width>"}),": Specifies the width of the RAW image."]}),"\n",(0,r.jsxs)(i.li,{children:[(0,r.jsx)(i.code,{children:"H <height>"}),": Specifies the height of the RAW image."]}),"\n",(0,r.jsxs)(i.li,{children:[(0,r.jsx)(i.code,{children:"l <loop>"}),": Specifies the number of times to loop the RAW feedback. Default is 10."]}),"\n",(0,r.jsxs)(i.li,{children:[(0,r.jsx)(i.code,{children:"h"}),": Displays help information."]}),"\n"]}),"\n",(0,r.jsx)(i.h4,{id:"execution-output-1",children:"Execution Output"}),"\n",(0,r.jsxs)(i.ul,{children:["\n",(0,r.jsxs)(i.li,{children:["First, use ",(0,r.jsx)(i.code,{children:"get_vin_data -s 0"})," to capture a RAW image from the imx219 sensor. For detailed usage of ",(0,r.jsx)(i.code,{children:"get_vin_data"}),", refer to ",(0,r.jsx)(i.a,{href:"sample_vin.html",children:"sample_vin"}),"."]}),"\n",(0,r.jsx)(i.li,{children:"Next, perform ISP feedback by specifying parameters such as format, width, and height for the prepared RAW image. During ISP feedback, the corresponding dummy sensor's ISP tuning library will be applied."}),"\n"]}),"\n",(0,r.jsx)("div",{class:"note",children:(0,r.jsxs)(i.p,{children:[(0,r.jsx)("strong",{children:"Note:"})," ",(0,r.jsx)("br",{}),"\nWhen using a dummy sensor for feedback, no physical hardware connection is required. The program feeds the RAW image into the ISP and applies the corresponding ISP tuning library.",(0,r.jsx)("br",{}),"\nPath to dummy sensor configuration parameters: ",(0,r.jsx)(i.code,{children:"/app/multimedia_samples/vp_sensors/dummy_sensor/dummy_sensor.c"}),(0,r.jsx)("br",{}),"\nWhen debugging images or performing ISP feedback with a dummy sensor, correctly configure the ",(0,r.jsx)(i.code,{children:"bayer_start"})," and ",(0,r.jsx)(i.code,{children:"bayer_pattern"})," fields in ",(0,r.jsx)(i.code,{children:"sensor_param"})," according to the actual captured RAW image. Incorrect configuration may cause color inversion or abnormal colors.",(0,r.jsx)("br",{})]})}),"\n",(0,r.jsxs)(i.p,{children:["Taking the imx219 sensor as an example, execute:",(0,r.jsx)(i.br,{}),"\n",(0,r.jsx)(i.code,{children:"./isp_feedback -f handle_34661_chn0_1920x1080_stride_2400_frameid_1_ts_5752227762025.raw -F raw10 -H 1080 -W 1920"}),"."]}),"\n",(0,r.jsx)(i.pre,{children:(0,r.jsx)(i.code,{className:"language-shell",children:"root@ubuntu:/app/multimedia_samples/sample_isp/isp_feedback# ./isp_feedback  -f handle_34661_chn0_1920x1080_stride_2400_frameid_1_ts_5752227762025.raw -F raw10 -H 1080 -W 1920\nUsing index:5  sensor_name:dummy  config_file:dummy_sensor.c\nCreating camera with config: width=1920, height=1080, format=10\n[INFO] Create isp node handle: 100197\nisp process one frame cost:  2187075 ns\nisp(100197) dump yuv 1920x1080(stride:1920), buffer size: 2073600 + 1036800 frame id: 0, timestamp: 0  \nisp process one frame cost:  2128900 ns  \nisp(100197) dump yuv 1920x1080(stride:1920), buffer size: 2073600 + 1036800 frame id: 0, timestamp: 0  \nisp process one frame cost:  2115925 ns  \nisp(100197) dump yuv 1920x1080(stride:1920), buffer size: 2073600 + 1036800 frame id: 0, timestamp: 0  \nisp process one frame cost:  2112825 ns  \nisp(100197) dump yuv 1920x1080(stride:1920), buffer size: 2073600 + 1036800 frame id: 0, timestamp: 0  \nisp process one frame cost:  2112700 ns  \nisp(100197) dump yuv 1920x1080(stride:1920), buffer size: 2073600 + 1036800 frame id: 0, timestamp: 0  \nisp process one frame cost:  2115200 ns  \nisp(100197) dump yuv 1920x1080(stride:1920), buffer size: 2073600 + 1036800 frame id: 0, timestamp: 0  \nisp process one frame cost:  2116475 ns  \nisp(100197) dump yuv 1920x1080(stride:1920), buffer size: 2073600 + 1036800 frame id: 0, timestamp: 0  \nisp process one frame cost:  2112700 ns  \nisp(100197) dump yuv 1920x1080(stride:1920), buffer size: 2073600 + 1036800 frame id: 0, timestamp: 0  \nisp process one frame cost:  2112775 ns  \nisp(100197) dump yuv 1920x1080(stride:1920), buffer size: 2073600 + 1036800 frame id: 0, timestamp: 0  \nisp process one frame cost:  2114200 ns  \nisp(100197) dump yuv 1920x1080(stride:1920), buffer size: 2073600 + 1036800 frame id: 0, timestamp: 0  \n"})}),"\n",(0,r.jsx)(i.p,{children:"The program starts running and saves the following calibrated YUV images in the current directory by default, looping back 10 times and calculating the processing time for each loop:"}),"\n",(0,r.jsxs)(i.ul,{children:["\n",(0,r.jsx)(i.li,{children:'Using index / sensor_name / config_file: Indicates that the current sensor index is 5, the sensor name is "dummy", and the corresponding sensor configuration file is dummy_sensor.c.'}),"\n",(0,r.jsx)(i.li,{children:'For each RAW frame processed, the following ISP processing time information is output: "isp process one frame cost: 2170275 ns."'}),"\n"]}),"\n",(0,r.jsx)(i.h3,{id:"common-issues-with-isp_feedback",children:"Common Issues with isp_feedback"}),"\n",(0,r.jsxs)(i.ul,{children:["\n",(0,r.jsx)(i.li,{children:"If the specified image resolution or format parameters do not match the actual loopback image, it may cause image anomalies."}),"\n"]})]})}function p(e={}){const{wrapper:i}={...(0,a.R)(),...e.components};return i?(0,r.jsx)(i,{...e,children:(0,r.jsx)(c,{...e})}):c(e)}}}]);