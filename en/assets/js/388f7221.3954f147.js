"use strict";(self.webpackChunkrdk_doc=self.webpackChunkrdk_doc||[]).push([[58368],{19440:(e,n,d)=>{d.r(n),d.d(n,{assets:()=>_,contentTitle:()=>l,default:()=>p,frontMatter:()=>s,metadata:()=>i,toc:()=>t});const i=JSON.parse('{"id":"Advanced_development/linux_development/driver_development_s100/driver_pcie/s100x_pcie_sw_setup","title":"S100X PCIe\u6a21\u5757\u529f\u80fd\u5728kernel\u4e0b\u7684\u914d\u7f6e","description":"\u5728Kernel\u4e2d\uff0cPCIe\u7684\u914d\u7f6e\u5206\u4e3adefconfig\u548cDTS\u4e24\u90e8\u5206\uff1a","source":"@site/docs_s/07_Advanced_development/02_linux_development/04_driver_development_s100/13_driver_pcie/03_s100x_pcie_sw_setup.md","sourceDirName":"07_Advanced_development/02_linux_development/04_driver_development_s100/13_driver_pcie","slug":"/Advanced_development/linux_development/driver_development_s100/driver_pcie/s100x_pcie_sw_setup","permalink":"/rdk_doc/en/rdk_s/Advanced_development/linux_development/driver_development_s100/driver_pcie/s100x_pcie_sw_setup","draft":false,"unlisted":false,"tags":[],"version":"current","lastUpdatedAt":1750258914000,"sidebarPosition":3,"frontMatter":{"sidebar_position":3},"sidebar":"tutorialSidebar","previous":{"title":"S100X PCIe\u8f6f\u4ef6\u67b6\u6784\u4e0e\u6a21\u5757\u5212\u5206","permalink":"/rdk_doc/en/rdk_s/Advanced_development/linux_development/driver_development_s100/driver_pcie/s100x_pcie_sw_arch"},"next":{"title":"PCIe \u7528\u6237\u6001 High Level API\u4ecb\u7ecd","permalink":"/rdk_doc/en/rdk_s/Advanced_development/linux_development/driver_development_s100/driver_pcie/s100x_pcie_libhbpciehal"}}');var c=d(74848),r=d(28453);const s={sidebar_position:3},l="S100X PCIe\u6a21\u5757\u529f\u80fd\u5728kernel\u4e0b\u7684\u914d\u7f6e",_={},t=[{value:"defconfig",id:"defconfig",level:2},{value:"DTS",id:"dts",level:2},{value:"RC\u6a21\u5f0f",id:"rc\u6a21\u5f0f",level:3},{value:"EP\u6a21\u5f0f",id:"ep\u6a21\u5f0f",level:3},{value:"PCIE\u94fe\u8def\u914d\u7f6e",id:"pcie\u94fe\u8def\u914d\u7f6e",level:3}];function o(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,r.R)(),...e.components};return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(n.header,{children:(0,c.jsx)(n.h1,{id:"s100x-pcie\u6a21\u5757\u529f\u80fd\u5728kernel\u4e0b\u7684\u914d\u7f6e",children:"S100X PCIe\u6a21\u5757\u529f\u80fd\u5728kernel\u4e0b\u7684\u914d\u7f6e"})}),"\n",(0,c.jsx)(n.p,{children:"\u5728Kernel\u4e2d\uff0cPCIe\u7684\u914d\u7f6e\u5206\u4e3adefconfig\u548cDTS\u4e24\u90e8\u5206\uff1a"}),"\n",(0,c.jsx)(n.h2,{id:"defconfig",children:"defconfig"}),"\n",(0,c.jsx)(n.p,{children:"\u5728\u5185\u6838\u7684defconfig\u6587\u4ef6\u4e2d\uff0c\u9700\u8981\u5305\u542b\u5982\u4e0b\u57fa\u7840\u914d\u7f6e\uff1a"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-shell",children:"CONFIG_PCI=y\nCONFIG_PCI_DOMAINS=y\nCONFIG_PCI_DOMAINS_GENERIC=y\nCONFIG_PCI_SYSCALL=y\nCONFIG_PCIEAER=y\nCONFIG_PCIE_PTM=y\nCONFIG_PCI_MSI=y\nCONFIG_PCI_MSI_IRQ_DOMAIN=y\nCONFIG_PCI_QUIRKS=y\nCONFIG_PCI_DEBUG=y\nCONFIG_PCI_REALLOC_ENABLE_AUTO=y\nCONFIG_PCI_IOV=y\nCONFIG_PCIE_BUS_DEFAULT=y\nCONFIG_PCIEPORTBUS=y\n"})}),"\n",(0,c.jsx)(n.p,{children:"\u4f7f\u80fdRC\u6a21\u5f0f\u9700\u8981\u7684\u914d\u7f6e\u5982\u4e0b\uff1a"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-shell",children:"CONFIG_PCIE_HOBOT=m\nCONFIG_PCIE_HOBOT_RC=m\nCONFIG_PCIE_HOBOT_EP_DEV=m\nCONFIG_PCIE_HOBOT_EP_DEV_MAN=m\n"})}),"\n",(0,c.jsx)(n.p,{children:"RC\u6a21\u5f0f\u652f\u6301NVME\u9700\u8981\u7684\u914d\u7f6e\u5982\u4e0b\uff1a"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-shell",children:"CONFIG_BLK_DEV_NVME=m\n"})}),"\n",(0,c.jsx)(n.p,{children:"\u4f7f\u80fdEP\u6a21\u5f0f\u9700\u8981\u7684\u914d\u7f6e\u5982\u4e0b\uff1a"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-shell",children:"CONFIG_PCIE_HOBOT=m\nCONFIG_PCIE_HOBOT_EP=m\nCONFIG_PCIE_HOBOT_EP_FUN=m\n"})}),"\n",(0,c.jsx)(n.p,{children:"\u5176\u4e2dhybrid\u4e3a\u5fc5\u987b\u4f7f\u80fd\u7684\u529f\u80fd\uff0c\u5df2\u7ecf\u88ab\u4e0a\u8ff0\u914d\u7f6e\u5305\u542b\uff0c\u5176\u4ed6\u529f\u80fd\u53ef\u4ee5\u6309\u9700\u914d\u7f6e\u3002"}),"\n",(0,c.jsx)(n.p,{children:"\u5982\u679c\u6709debug\u7684\u9700\u6c42\uff08\u5177\u4f53\u4f7f\u7528\u53c2\u8003\uff1aS100 PCIe\u9a71\u52a8debug\u4fe1\u606f\u6c47\u603b\uff09\uff1a"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-shell",children:"CONFIG_PCIE_HOBOT_DEBUG=y\n"})}),"\n",(0,c.jsx)(n.h2,{id:"dts",children:"DTS"}),"\n",(0,c.jsx)(n.p,{children:"\u8981\u6ce8\u610f\u540c\u4e00\u4e2a\u63a7\u5236\u5668\u53ea\u80fd\u914d\u7f6e\u4e3aRC\u6216\u8005EP\u6a21\u5f0f\u3002"}),"\n",(0,c.jsx)(n.h3,{id:"rc\u6a21\u5f0f",children:"RC\u6a21\u5f0f"}),"\n",(0,c.jsxs)(n.p,{children:["\u63a7\u5236\u5668\u7684\u914d\u7f6e\u8282\u70b9\u4e3a\uff1a ",(0,c.jsx)(n.code,{children:"hobot_pcie_rc0"})," \u548c ",(0,c.jsx)(n.code,{children:"hobot_pcie_rc1"})," \u3002"]}),"\n",(0,c.jsxs)(n.p,{children:["\u4e00\u822c\u60c5\u51b5\u4e0b\u53ea\u9700\u8981\u4fee\u6539 ",(0,c.jsx)(n.code,{children:"status"})," \u5b57\u6bb5\u7531 ",(0,c.jsx)(n.code,{children:"disable"})," \u4e3a ",(0,c.jsx)(n.code,{children:"okay"})," \u5373\u53ef\u4f7f\u80fd\u5bf9\u5e94\u63a7\u5236\u5668\u7684RC\u6a21\u5f0f\uff0c\u53cd\u4e4b\u5173\u95ed\u3002"]}),"\n",(0,c.jsx)(n.h3,{id:"ep\u6a21\u5f0f",children:"EP\u6a21\u5f0f"}),"\n",(0,c.jsxs)(n.p,{children:["\u63a7\u5236\u5668\u7684\u914d\u7f6e\u8282\u70b9\u4e3a\uff1a ",(0,c.jsx)(n.code,{children:"hobot_pcie_ep0"})," \u548c ",(0,c.jsx)(n.code,{children:"hobot_pcie_ep1"})," \u3002"]}),"\n",(0,c.jsxs)(n.p,{children:["\u9664\u4e86\u63a7\u5236\u5668\u672c\u8eab\u9700\u8981\u914d\u7f6e\uff0c\u5176\u5b50\u8282\u70b9 ",(0,c.jsx)(n.code,{children:"funX"})," \u4e5f\u9700\u8981\u8fdb\u884c\u914d\u7f6e\u3002\n",(0,c.jsx)(n.code,{children:"fun0"})," \u5fc5\u987b\u914d\u7f6e\u4e3a\u4f7f\u80fd\u72b6\u6001\u3002"]}),"\n",(0,c.jsx)(n.h3,{id:"pcie\u94fe\u8def\u914d\u7f6e",children:"PCIE\u94fe\u8def\u914d\u7f6e"}),"\n",(0,c.jsx)(n.p,{children:"PCIE\u7684\u94fe\u8def\u652f\u63013\u79cd\u6a21\u5f0f\uff1a"}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsx)(n.li,{children:"PCIE0 x4 Lane;"}),"\n",(0,c.jsx)(n.li,{children:"PCIE0 x2 Lane + GMAC0 + GMAC1;"}),"\n",(0,c.jsx)(n.li,{children:"PCIE0 x1 Lane + PCIE1 x1 Lane + GMAC0 + GMAC1;"}),"\n"]}),"\n",(0,c.jsx)(n.p,{children:"\u94fe\u8def\u914d\u7f6e\u5728dts\u5185\u5982\u4e0b\uff1a"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-dts",children:"/* rdk-v0p5.dtsi */\n...\n\n    &hsis0 {\n        hsi-mode = <0x4>;  /* 0x1: pcie x4, 0x4: pcie x2 + gmac0 + gmac1, 0x8: pcie0 x1 + pcie1 x1 + gmac0 + gmac1 */\n    };\n\n...\n"})})]})}function p(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,c.jsx)(n,{...e,children:(0,c.jsx)(o,{...e})}):o(e)}},28453:(e,n,d)=>{d.d(n,{R:()=>s,x:()=>l});var i=d(96540);const c={},r=i.createContext(c);function s(e){const n=i.useContext(r);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(c):e.components||c:s(e.components),i.createElement(r.Provider,{value:n},e.children)}}}]);