"use strict";(self.webpackChunkrdk_doc=self.webpackChunkrdk_doc||[]).push([[39014],{10145:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>d,contentTitle:()=>o,default:()=>p,frontMatter:()=>a,metadata:()=>i,toc:()=>c});const i=JSON.parse('{"id":"Basic_Application/03_40pin_user_guide/uart","title":"3.3.4 UART Application","description":"The RDK S100 supports UART2 on the 40-pin header, which is disabled by default. The physical pin numbers are 8 and 10, with an I/O voltage of 3.3V.","source":"@site/i18n/en/docusaurus-plugin-content-docs-docs_s/current/03_Basic_Application/03_40pin_user_guide/04_uart.md","sourceDirName":"03_Basic_Application/03_40pin_user_guide","slug":"/Basic_Application/03_40pin_user_guide/uart","permalink":"/rdk_doc/en/rdk_s/Basic_Application/03_40pin_user_guide/uart","draft":false,"unlisted":false,"tags":[],"version":"current","lastUpdatedAt":1770014688000,"sidebarPosition":4,"frontMatter":{"sidebar_position":4},"sidebar":"tutorialSidebar","previous":{"title":"3.3.3 PWM Application","permalink":"/rdk_doc/en/rdk_s/Basic_Application/03_40pin_user_guide/pwm"},"next":{"title":"3.3.5 I2C Application","permalink":"/rdk_doc/en/rdk_s/Basic_Application/03_40pin_user_guide/i2c"}}');var s=t(74848),r=t(28453);const a={sidebar_position:4},o="3.3.4 UART Application",d={},c=[{value:"Loopback Test",id:"loopback-test",level:2},{value:"Hardware Connection",id:"hardware-connection",level:3},{value:"Test Procedure",id:"test-procedure",level:3},{value:"Test Code",id:"test-code",level:2}];function l(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",img:"img",li:"li",p:"p",pre:"pre",ul:"ul",...(0,r.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"334-uart-application",children:"3.3.4 UART Application"})}),"\n",(0,s.jsx)(n.p,{children:"The RDK S100 supports UART2 on the 40-pin header, which is disabled by default. The physical pin numbers are 8 and 10, with an I/O voltage of 3.3V."}),"\n",(0,s.jsxs)(n.admonition,{type:"info",children:[(0,s.jsx)(n.p,{children:"On the 40-pin header, you need to toggle the DIP switch to select between UART2 and I2C5. For specific details, please refer to the figure below:"}),(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"http://rdk-doc.oss-cn-beijing.aliyuncs.com/doc/img/01_Quick_start/image/hardware_interface/image-rdk_100_funcreuse_40pin-en.jpg",alt:"image-rdk_100_funcreuse_40pin"})}),(0,s.jsx)(n.p,{children:"After toggling the DIP switch, you also need to modify the device tree file. The modification path and method are as follows:"}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-{.text}",children:'/*kernel/arch/arm64/boot/dts/hobot/drobot-s100-soc.dtsi*/\nuart2: uart@394C0000 {\n        power-domains = <&scmi_smc_pd PD_IDX_LSPERI_TOP>;\n        compatible = "snps,dw-apb-uart";\n        reg = <0x0 0x394C0000 0x0 0x10000>;\n        reg-shift = <2>;\n        reg-io-width = <4>;\n        interrupts = <GIC_SPI PERISYS_UART2_INTR PERISYS_UART2_INTR_TRIG_TYPE>;\n        clock-frequency = <200000000>;\n        pinctrl-names = "default";\n        pinctrl-0 = <&peri_uart2>;\n        status = "okay";\n};\n'})}),(0,s.jsxs)(n.p,{children:["For pin definitions, please refer to ",(0,s.jsx)(n.a,{href:"/rdk_doc/en/rdk_s/Basic_Application/03_40pin_user_guide/01_40pin_define#40pin_define",children:"Pin Configuration and Definitions"}),"."]})]}),"\n",(0,s.jsxs)(n.p,{children:["Please refer to ",(0,s.jsx)(n.code,{children:"/app/40pin_samples/test_serial.py"})," for detailed instructions on how to use the UART interface."]}),"\n",(0,s.jsx)(n.admonition,{type:"tip",children:(0,s.jsxs)(n.p,{children:["The pins mentioned below are provided for illustrative purposes only. Port values may differ across platforms; always verify against your actual hardware setup. Alternatively, you can directly use the code under the ",(0,s.jsx)(n.code,{children:"/app/40pin_samples/"})," directory, which has already been verified on the board."]})}),"\n",(0,s.jsx)(n.h2,{id:"loopback-test",children:"Loopback Test"}),"\n",(0,s.jsx)(n.p,{children:"Connect TXD and RXD together physically, then run the test program to perform write and read operations. The expected result is that the received data should be identical to the transmitted data."}),"\n",(0,s.jsx)(n.h3,{id:"hardware-connection",children:"Hardware Connection"}),"\n",(0,s.jsx)(n.p,{children:"Directly connect TXD and RXD together using a jumper wire:"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"https://rdk-doc.oss-cn-beijing.aliyuncs.com/doc/img/03_Basic_Application/03_40pin_user_guide/image/40pin_user_guide/image-rdk_s100_uart.png",alt:"image-20220512101820743"})}),"\n",(0,s.jsx)(n.h3,{id:"test-procedure",children:"Test Procedure"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Run ",(0,s.jsx)(n.code,{children:"python3 /app/40pin_samples/test_serial.py"}),"."]}),"\n",(0,s.jsxs)(n.li,{children:["From the printed list of UART devices (note: ",(0,s.jsx)(n.code,{children:"/dev/ttyS0"})," is the system debug console; testing it is not recommended unless you fully understand its function), select the appropriate bus and chip select number as input options. For example:","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["On RDK X3, test ",(0,s.jsx)(n.code,{children:"/dev/ttyS3"})]}),"\n",(0,s.jsxs)(n.li,{children:["On RDK X5, test ",(0,s.jsx)(n.code,{children:"/dev/ttyS1"})]}),"\n",(0,s.jsxs)(n.li,{children:["On RDK Ultra, test ",(0,s.jsx)(n.code,{children:"/dev/ttyS2"})]}),"\n",(0,s.jsxs)(n.li,{children:["On RDK S100, test ",(0,s.jsx)(n.code,{children:"/dev/ttyS2"})]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"Press Enter to confirm your selection, then input the baud rate:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"root@ubuntu:/app/40pin_samples# ./test_serial.py\nList of enabled UART:\n/dev/ttyS0  /dev/ttyS1  /dev/ttyS2  /dev/ttyS3\n\nPlease enter the UART device name to test: /dev/ttyS2\nPlease enter the baud rate (9600,19200,38400,57600,115200,921600): 921600\nSerial<id=0x7f819dcac0, open=True>(port='/dev/ttyS3', baudrate=921600, bytesize=8, parity='N', stopbits=1, timeout=1, xonxoff=False, rtscts=False, dsrdtr=False)\n"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Once the program runs correctly, it will continuously print ",(0,s.jsx)(n.code,{children:"Send: AA55"})," and ",(0,s.jsx)(n.code,{children:"Recv: AA55"}),":"]}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"Starting demo now! Press CTRL+C to exit\nSend:  AA55\nRecv:  AA55\n"})}),"\n",(0,s.jsx)(n.h2,{id:"test-code",children:"Test Code"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:'#!/usr/bin/env python3\n\nimport sys\nimport signal\nimport os\nimport time\n\n# Import Python serial library\nimport serial\nimport serial.tools.list_ports\n\ndef signal_handler(signal, frame):\n    sys.exit(0)\n\ndef serialTest():\n    print("List of enabled UART:")\n    os.system(\'ls /dev/tty[a-zA-Z]*\')\n    uart_dev = input("Please enter the UART device name to test: ")\n\n    baudrate = input("Please enter the baud rate (9600,19200,38400,57600,115200,921600): ")\n    try:\n        ser = serial.Serial(uart_dev, int(baudrate), timeout=1)  # 1s timeout\n    except Exception as e:\n        print("Failed to open serial port!\\n")\n\n    print(ser)\n\n    print("Starting demo now! Press CTRL+C to exit")\n\n    while True:\n        test_data = "AA55"\n        write_num = ser.write(test_data.encode(\'UTF-8\'))\n        print("Send: ", test_data)\n\n        received_data = ser.read(write_num).decode(\'UTF-8\')\n        print("Recv: ", received_data)\n\n        time.sleep(1)\n\n    ser.close()\n    return 0\n\n\nif __name__ == \'__main__\':\n    signal.signal(signal.SIGINT, signal_handler)\n    if serialTest() != 0:\n        print("Serial test failed!")\n    else:\n        print("Serial test success!")\n'})})]})}function p(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(l,{...e})}):l(e)}},28453:(e,n,t)=>{t.d(n,{R:()=>a,x:()=>o});var i=t(96540);const s={},r=i.createContext(s);function a(e){const n=i.useContext(r);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:a(e.components),i.createElement(r.Provider,{value:n},e.children)}}}]);