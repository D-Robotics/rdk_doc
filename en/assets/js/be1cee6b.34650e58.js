"use strict";(self.webpackChunkrdk_doc=self.webpackChunkrdk_doc||[]).push([[45514],{28453:(e,n,t)=>{t.d(n,{R:()=>l,x:()=>o});var i=t(96540);const s={},r=i.createContext(s);function l(e){const n=i.useContext(r);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:l(e.components),i.createElement(r.Provider,{value:n},e.children)}},50683:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>o,default:()=>h,frontMatter:()=>l,metadata:()=>i,toc:()=>a});const i=JSON.parse('{"id":"Algorithm_Application/Python_Sample/UNetMobileNet","title":"Semantic Segmentation - UNetMobileNet","description":"This example demonstrates how to run the UNet-MobileNet semantic segmentation model on the BPU using hbmruntime, supporting functionalities such as image preprocessing, inference, and post-processing (parsing outputs and overlaying colored segmentation masks). The example code is located in the /app/pydevdemo/03instancesegmentationsample/01unetmobilenet/ directory.","source":"@site/i18n/en/docusaurus-plugin-content-docs-docs_s/current/04_Algorithm_Application/02_Python_Sample/06_UNetMobileNet.md","sourceDirName":"04_Algorithm_Application/02_Python_Sample","slug":"/Algorithm_Application/Python_Sample/UNetMobileNet","permalink":"/rdk_doc/en/rdk_s/Algorithm_Application/Python_Sample/UNetMobileNet","draft":false,"unlisted":false,"tags":[],"version":"current","lastUpdatedAt":1770709590000,"sidebarPosition":6,"frontMatter":{"sidebar_position":6},"sidebar":"tutorialSidebar","previous":{"title":"Object Detection - Ultralytics YOLO11","permalink":"/rdk_doc/en/rdk_s/Algorithm_Application/Python_Sample/Ultralytics_YOLO11"},"next":{"title":"Instance Segmentation - Ultralytics YOLO11","permalink":"/rdk_doc/en/rdk_s/Algorithm_Application/Python_Sample/Ultralytics_YOLO11_Seg"}}');var s=t(74848),r=t(28453);const l={sidebar_position:6},o="Semantic Segmentation - UNetMobileNet",c={},a=[{value:"Model Description",id:"model-description",level:2},{value:"Functionality Overview",id:"functionality-overview",level:2},{value:"Environment Dependencies",id:"environment-dependencies",level:2},{value:"Directory Structure",id:"directory-structure",level:2},{value:"Parameter Description",id:"parameter-description",level:2},{value:"Quick Start",id:"quick-start",level:2}];function d(e){const n={code:"code",h1:"h1",h2:"h2",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"semantic-segmentation---unetmobilenet",children:"Semantic Segmentation - UNetMobileNet"})}),"\n",(0,s.jsxs)(n.p,{children:["This example demonstrates how to run the UNet-MobileNet semantic segmentation model on the BPU using ",(0,s.jsx)(n.code,{children:"hbm_runtime"}),", supporting functionalities such as image preprocessing, inference, and post-processing (parsing outputs and overlaying colored segmentation masks). The example code is located in the ",(0,s.jsx)(n.code,{children:"/app/pydev_demo/03_instance_segmentation_sample/01_unetmobilenet/"})," directory."]}),"\n",(0,s.jsx)(n.h2,{id:"model-description",children:"Model Description"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Introduction"}),":"]}),"\n",(0,s.jsx)(n.p,{children:"UNet is a classic semantic segmentation network architecture featuring an encoder-decoder structure, widely recognized for its excellent performance in medical image analysis and similar fields. In this example, MobileNet is used as the encoder backbone to reduce model complexity and accelerate inference speed, making it suitable for real-time segmentation tasks on edge devices. The model outputs a class label for each pixel, enabling applications such as urban street scene segmentation."}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"HBM Model Name"}),": ",(0,s.jsx)(n.code,{children:"unet_mobilenet_1024x2048_nv12.hbm"})]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Input Format"}),": NV12, with resolution 1024x2048 (separate Y and UV planes)"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Output"}),": A segmentation map matching the input dimensions, where each pixel corresponds to a class label ranging from 0 to 18 (19 classes in total)"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"functionality-overview",children:"Functionality Overview"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Model Loading"})}),"\n",(0,s.jsxs)(n.p,{children:["The quantized semantic segmentation model is loaded using ",(0,s.jsx)(n.code,{children:"hbm_runtime"}),", extracting metadata such as model name, input/output tensor names, shapes, and quantization parameters."]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Input Preprocessing"})}),"\n",(0,s.jsx)(n.p,{children:"The original image is loaded in BGR format, resized to 1024\xd72048, converted to NV12 format (with separated Y/UV planes), and packaged into the input dictionary structure required by the inference interface."}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Inference Execution"})}),"\n",(0,s.jsxs)(n.p,{children:["Model forward inference is executed using the ",(0,s.jsx)(n.code,{children:".run()"})," method, supporting scheduling parameters such as BPU core assignment and priority. The output is a logits tensor representing class scores."]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Result Post-processing"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Apply argmax to the output tensor to obtain the predicted class for each pixel;"}),"\n",(0,s.jsx)(n.li,{children:"Resize the prediction map to match the original input image size;"}),"\n",(0,s.jsx)(n.li,{children:"Restore it to the original image dimensions and map classes to a specified color palette;"}),"\n",(0,s.jsx)(n.li,{children:"Blend the segmentation mask with the original image using a configurable alpha blending coefficient to generate a visualization;"}),"\n",(0,s.jsx)(n.li,{children:"The final image contains an intuitive overlay of the segmentation result, which can be saved or displayed."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"environment-dependencies",children:"Environment Dependencies"}),"\n",(0,s.jsx)(n.p,{children:"This example has no special environment requirements\u2014only the dependencies installed in the pydev environment are needed."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"pip install -r ../../requirements.txt\n"})}),"\n",(0,s.jsx)(n.h2,{id:"directory-structure",children:"Directory Structure"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-text",children:".\n\u251c\u2500\u2500 unet_mobilenet.py           # Main inference script\n\u2514\u2500\u2500 README.md                   # Usage instructions\n"})}),"\n",(0,s.jsx)(n.h2,{id:"parameter-description",children:"Parameter Description"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Parameter"}),(0,s.jsx)(n.th,{children:"Description"}),(0,s.jsx)(n.th,{children:"Default Value"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"--model-path"})}),(0,s.jsx)(n.td,{children:"Path to the model file (.hbm format)"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"/opt/hobot/model/s100/basic/unet_mobilenet_1024x2048_nv12.hbm"})})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"--test-img"})}),(0,s.jsx)(n.td,{children:"Path to the input test image"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"/app/res/assets/segmentation.png"})})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"--img-save-path"})}),(0,s.jsx)(n.td,{children:"Path to save the inference result image"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"result.jpg"})})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"--priority"})}),(0,s.jsx)(n.td,{children:"Model priority (0\u2013255; higher value = higher priority)"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"0"})})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"--bpu-cores"})}),(0,s.jsxs)(n.td,{children:["List of BPU core IDs to run the model on (e.g., ",(0,s.jsx)(n.code,{children:"--bpu-cores 0 1"}),")"]}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"[0]"})})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"--alpha-f"})}),(0,s.jsxs)(n.td,{children:["Visualization blending factor: ",(0,s.jsx)(n.code,{children:"0.0=mask only"}),", ",(0,s.jsx)(n.code,{children:"1.0=original image only"})]}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"0.75"})})]})]})]}),"\n",(0,s.jsx)(n.h2,{id:"quick-start",children:"Quick Start"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Run the Model"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Using default parameters:","\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"python unet_mobilenet.py\n"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["Running with custom parameters:","\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"python unet_mobilenet.py \\\n--model-path /opt/hobot/model/s100/basic/unet_mobilenet_1024x2048_nv12.hbm \\\n--test-img /app/res/assets/segmentation.png \\\n--img-save-path result.jpg \\\n--alpha-f 0.75 \\\n--priority 0 \\\n--bpu-cores 0\n"})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"View Results"})}),"\n",(0,s.jsxs)(n.p,{children:["Upon successful execution, the segmentation result will be overlaid on the original image and saved to the path specified by ",(0,s.jsx)(n.code,{children:"--img-save-path"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"[Saved] Result saved to: result.jpg\n"})}),"\n"]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}}}]);