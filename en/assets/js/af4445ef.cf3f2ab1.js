"use strict";(self.webpackChunkrdk_doc=self.webpackChunkrdk_doc||[]).push([[91770],{28453:(e,t,s)=>{s.d(t,{R:()=>o,x:()=>c});var n=s(96540);const i={},r=n.createContext(i);function o(e){const t=n.useContext(r);return n.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function c(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:o(e.components),n.createElement(r.Provider,{value:t},e.children)}},95630:(e,t,s)=>{s.r(t),s.d(t,{assets:()=>a,contentTitle:()=>c,default:()=>h,frontMatter:()=>o,metadata:()=>n,toc:()=>l});const n=JSON.parse('{"id":"Advanced_development/linux_development/hardware_unit_test/the_auto_test","title":"AutoTest Usage Guide","description":"AutoTest provides a flexible automated testing solution that supports customizing stress test duration and test iterations via the configuration file config.ini. It also allows users to extend test cases according to their specific requirements, thereby fulfilling diverse testing needs. Developed on top of driver unit tests, this tool implements automated testing functionality while remaining independent from functional unit tests and fully reusing existing code resources.","source":"@site/i18n/en/docusaurus-plugin-content-docs-docs_s/current/07_Advanced_development/02_linux_development/05_hardware_unit_test/00-the_auto_test.md","sourceDirName":"07_Advanced_development/02_linux_development/05_hardware_unit_test","slug":"/Advanced_development/linux_development/hardware_unit_test/the_auto_test","permalink":"/rdk_doc/en/rdk_s/Advanced_development/linux_development/hardware_unit_test/the_auto_test","draft":false,"unlisted":false,"tags":[],"version":"current","lastUpdatedAt":1769771781000,"sidebarPosition":0,"frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"Overview","permalink":"/rdk_doc/en/rdk_s/Advanced_development/linux_development/hardware_unit_test/overview"},"next":{"title":"CPU-BPU-DDR Stress Test","permalink":"/rdk_doc/en/rdk_s/Advanced_development/linux_development/hardware_unit_test/bpu_cpu_ddr_stress"}}');var i=s(74848),r=s(28453);const o={},c="AutoTest Usage Guide",a={},l=[{value:"AutoTest Directory Structure",id:"autotest-directory-structure",level:2},{value:"Description of the config.ini Configuration File",id:"description-of-the-configini-configuration-file",level:2},{value:"Configuration File Structure",id:"configuration-file-structure",level:3},{value:"Configuration File Example",id:"configuration-file-example",level:3},{value:"Usage Instructions",id:"usage-instructions",level:3},{value:"Launching Tests with startup.sh",id:"launching-tests-with-startupsh",level:2},{value:"Viewing Test Logs",id:"viewing-test-logs",level:2},{value:"Changing the Log Storage Path",id:"changing-the-log-storage-path",level:3},{value:"Adding New Test Items",id:"adding-new-test-items",level:2},{value:"Writing a Test Script",id:"writing-a-test-script",level:3},{value:"Configuring the <code>config.ini</code> File",id:"configuring-the-configini-file",level:3},{value:"Launching the Test",id:"launching-the-test",level:3},{value:"Verifying the Test Item",id:"verifying-the-test-item",level:3}];function d(e){const t={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(t.header,{children:(0,i.jsx)(t.h1,{id:"autotest-usage-guide",children:"AutoTest Usage Guide"})}),"\n",(0,i.jsxs)(t.p,{children:["AutoTest provides a flexible automated testing solution that supports customizing stress test duration and test iterations via the configuration file ",(0,i.jsx)(t.code,{children:"config.ini"}),". It also allows users to extend test cases according to their specific requirements, thereby fulfilling diverse testing needs. Developed on top of driver unit tests, this tool implements automated testing functionality while remaining independent from functional unit tests and fully reusing existing code resources."]}),"\n",(0,i.jsx)(t.h2,{id:"autotest-directory-structure",children:"AutoTest Directory Structure"}),"\n",(0,i.jsxs)(t.p,{children:["AutoTest uses the ",(0,i.jsx)(t.code,{children:"startup.sh"})," script to read the ",(0,i.jsx)(t.code,{children:"config/config.ini"})," configuration file to launch tests. Users can customize test content by modifying the ",(0,i.jsx)(t.code,{children:"config/config.ini"})," file. When performing stability or stress tests across multiple functionalities, this approach significantly reduces repetitive configuration efforts. Currently, AutoTest has already reused the following test items from driver functional unit tests:"]}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-bash",children:"#:~/sdk/source/hobot-multimedia-samples/debian/app/multimedia_samples/chip_base_test$ tree\n.\n\u251c\u2500\u2500 01_cpu_bpu_ddr\n\u2502   \u2514\u2500\u2500 scripts\n\u2502       \u2514\u2500\u2500 stress_test.sh         # CPU-BPU-DDR stress test\n\u251c\u2500\u2500 02_emmc\n\u2502   \u2514\u2500\u2500 emmc_stability_test.sh     # eMMC stability test\n\u251c\u2500\u2500 03_uart_test\n\u2502   \u2514\u2500\u2500 uartstress.sh              # UART stress test\n\u251c\u2500\u2500 04_spi_test\n\u2502   \u2514\u2500\u2500 spistress.sh               # SPI stress test\n\u251c\u2500\u2500 config\n\u2502   \u2514\u2500\u2500 config.ini                 # Configuration file for automated testing\n\u2514\u2500\u2500 startup.sh                     # Script for auto-start configuration\n"})}),"\n",(0,i.jsx)(t.h2,{id:"description-of-the-configini-configuration-file",children:"Description of the config.ini Configuration File"}),"\n",(0,i.jsxs)(t.p,{children:["The ",(0,i.jsx)(t.code,{children:"config.ini"})," file is used to configure and manage AutoTest test items. By adjusting parameters within this file, users can quickly select desired tests and specify test parameters. Below is the file structure and configuration instructions:"]}),"\n",(0,i.jsx)(t.h3,{id:"configuration-file-structure",children:"Configuration File Structure"}),"\n",(0,i.jsxs)(t.p,{children:["Each test item starts with ",(0,i.jsx)(t.code,{children:"[Test Item Name]"})," and includes the following fields:"]}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.strong,{children:"Status"}),": Enable status, which can be set to ",(0,i.jsx)(t.code,{children:"enabled"})," (active) or ",(0,i.jsx)(t.code,{children:"disabled"})," (inactive)."]}),"\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.strong,{children:"Description"}),": A brief description of the test item, explaining its purpose."]}),"\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.strong,{children:"ExecStart"}),": Path to the test script along with execution parameters, defining how the specific test is run."]}),"\n"]}),"\n",(0,i.jsx)(t.h3,{id:"configuration-file-example",children:"Configuration File Example"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-bash",children:"[CpuAndBpu]\nStatus=enabled\nDescription=CPU, BPU, and DDR stress test\nExecStart=/app/chip_base_test/01_cpu_bpu_ddr/scripts/stress_test.sh -t 24h\n\n[EmmcStablity]\nStatus=enabled\nDescription=eMMC stability test\nExecStart=/app/chip_base_test/02_emmc/emmc_stability_test.sh -t 24h\n\n[UART]\nStatus=enabled\nDescription=UART stress test\nExecStart=/app/chip_base_test/03uart_test/uartstress.sh -b 115200 -d /dev/ttyS2 -c 1000000\n\n[SPI]\nStatus=enabled\nDescription=SPI stress test\nExecStart=/app/chip_base_test/04_spi_test/spistress.sh -d /dev/spidev0.0 -c 1000000\n"})}),"\n",(0,i.jsx)(t.h3,{id:"usage-instructions",children:"Usage Instructions"}),"\n",(0,i.jsxs)(t.ol,{children:["\n",(0,i.jsxs)(t.li,{children:["\n",(0,i.jsxs)(t.p,{children:[(0,i.jsx)(t.strong,{children:"Edit the configuration file:"}),"\nOpen and edit the ",(0,i.jsx)(t.code,{children:"config/config.ini"})," file, adjusting the ",(0,i.jsx)(t.code,{children:"Status"})," value for each test item as needed:"]}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsxs)(t.li,{children:["Set to ",(0,i.jsx)(t.code,{children:"enabled"}),": activate the test item."]}),"\n",(0,i.jsxs)(t.li,{children:["Set to ",(0,i.jsx)(t.code,{children:"disabled"}),": deactivate the test item."]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(t.li,{children:["\n",(0,i.jsxs)(t.p,{children:[(0,i.jsx)(t.strong,{children:"Modify test parameters:"}),"\nAdjust the command and parameters in ",(0,i.jsx)(t.code,{children:"ExecStart"})," according to actual requirements. For example:"]}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsxs)(t.li,{children:["Modify test duration (e.g., ",(0,i.jsx)(t.code,{children:"-t 24h"})," means 24 hours of testing)."]}),"\n",(0,i.jsxs)(t.li,{children:["Adjust device paths (e.g., ",(0,i.jsx)(t.code,{children:"/dev/ttyS2"})," or ",(0,i.jsx)(t.code,{children:"/dev/spidev0.0"}),")."]}),"\n",(0,i.jsxs)(t.li,{children:["Tune other test options (e.g., loop count ",(0,i.jsx)(t.code,{children:"-c"})," or baud rate ",(0,i.jsx)(t.code,{children:"-b"}),")."]}),"\n",(0,i.jsxs)(t.li,{children:["All current test scripts support the ",(0,i.jsx)(t.code,{children:"-h"})," option, allowing users to consult help information for parameter adjustments."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(t.h2,{id:"launching-tests-with-startupsh",children:"Launching Tests with startup.sh"}),"\n",(0,i.jsxs)(t.p,{children:["After configuring ",(0,i.jsx)(t.code,{children:"config.ini"}),", users can start AutoTest by running the ",(0,i.jsx)(t.code,{children:"startup.sh"})," script. The script supports multiple launch methods to meet different usage scenarios:"]}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsxs)(t.li,{children:["\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.strong,{children:"Manual launch or debugging of test items"})}),"\n",(0,i.jsx)(t.p,{children:"Suitable for scenarios where the official system image is used and manual execution or debugging of test items is required. Execute the following command to start testing:"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-bash",children:"/app/chip_base_test/startup.sh\n# or\ncd /app/chip_base_test\n./startup.sh\n"})}),"\n",(0,i.jsx)(t.p,{children:"This method facilitates debugging individual test items or observing test execution."}),"\n"]}),"\n",(0,i.jsxs)(t.li,{children:["\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.strong,{children:"Auto-start or debugging of test items"})}),"\n",(0,i.jsxs)(t.p,{children:["Once test items have been configured and debugged successfully, ",(0,i.jsx)(t.code,{children:"startup.sh"})," can also be added to the ",(0,i.jsx)(t.code,{children:"rc.local"})," auto-start script to enable automatic testing upon board power-up."]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(t.h2,{id:"viewing-test-logs",children:"Viewing Test Logs"}),"\n",(0,i.jsx)(t.p,{children:"During test execution, the system generates relevant log files that users can inspect to monitor test progress or results. By default, log files are saved in the following path:"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-bash",children:"/app/chip_base_test/log\n"})}),"\n",(0,i.jsx)(t.h3,{id:"changing-the-log-storage-path",children:"Changing the Log Storage Path"}),"\n",(0,i.jsx)(t.p,{children:"Users can change the log storage location using either of the following two methods:"}),"\n",(0,i.jsxs)(t.ol,{children:["\n",(0,i.jsxs)(t.li,{children:["\n",(0,i.jsxs)(t.p,{children:[(0,i.jsx)(t.strong,{children:"Moving the directory:"}),"\nLogs are saved by default under the ",(0,i.jsx)(t.code,{children:"chip_base_test"})," directory. Users can simply move the entire ",(0,i.jsx)(t.code,{children:"chip_base_test"})," directory to a new location, for example:"]}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-bash",children:"mv /app/chip_base_test /userdata/chip_base_test\n"})}),"\n",(0,i.jsx)(t.p,{children:"After moving, log files will automatically be saved to the new path, for example:"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-text",children:"/userdata/chip_base_test/log\n"})}),"\n"]}),"\n",(0,i.jsxs)(t.li,{children:["\n",(0,i.jsxs)(t.p,{children:[(0,i.jsx)(t.strong,{children:"Customizing the log output path"}),"\nDriver unit test scripts support the ",(0,i.jsx)(t.code,{children:"-o"})," option to customize the log directory. Users can edit the ",(0,i.jsx)(t.code,{children:"config.ini"})," file and add the ",(0,i.jsx)(t.code,{children:"-o"})," option to the ",(0,i.jsx)(t.code,{children:"ExecStart"})," parameter of the corresponding test item. For example:"]}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-text",children:"ExecStart=/app/chip_base_test/01_cpu_bpu_ddr/scripts/stress_test.sh -t 24h -o /userdata/logs\n"})}),"\n",(0,i.jsxs)(t.p,{children:["This configuration saves logs to the ",(0,i.jsx)(t.code,{children:"/userdata/logs"})," directory."]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(t.p,{children:"By flexibly adjusting the log storage path, users can manage and review test results more conveniently while meeting log storage requirements in different environments."}),"\n",(0,i.jsx)(t.h2,{id:"adding-new-test-items",children:"Adding New Test Items"}),"\n",(0,i.jsxs)(t.p,{children:["AutoTest supports flexible extension of test items through the ",(0,i.jsx)(t.code,{children:"config.ini"})," file and scripts. Users can add new test functionalities as needed. Below are the steps for adding a new test item:"]}),"\n",(0,i.jsx)(t.h3,{id:"writing-a-test-script",children:"Writing a Test Script"}),"\n",(0,i.jsx)(t.p,{children:"Before adding a new test item, prepare or write the corresponding test script and ensure it can run independently. The test script should include the following elements:"}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsx)(t.li,{children:"Clear input parameters (e.g., test duration, device path, etc.)."}),"\n",(0,i.jsxs)(t.li,{children:["Log output functionality, preferably supporting the ",(0,i.jsx)(t.code,{children:"-o"})," parameter to customize the log path."]}),"\n"]}),"\n",(0,i.jsx)(t.p,{children:"Save the test script in an appropriate location, for example:"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-bash",children:"/app/chip_base_test/new_test/new_test.sh\n"})}),"\n",(0,i.jsxs)(t.h3,{id:"configuring-the-configini-file",children:["Configuring the ",(0,i.jsx)(t.code,{children:"config.ini"})," File"]}),"\n",(0,i.jsxs)(t.p,{children:["Add a new test item configuration block in ",(0,i.jsx)(t.code,{children:"config/config.ini"}),", defining the following fields:"]}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.strong,{children:"Status"}),": Set to ",(0,i.jsx)(t.code,{children:"enabled"})," to activate the test, or ",(0,i.jsx)(t.code,{children:"disabled"})," to keep it inactive temporarily."]}),"\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.strong,{children:"Description"}),": Describe the test functionality for easy identification."]}),"\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.strong,{children:"ExecStart"}),": Specify the test script path and its runtime parameters."]}),"\n"]}),"\n",(0,i.jsx)(t.p,{children:"Example configuration:"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-text",children:"[NewTest]\nStatus=enabled\nDescription=New feature stability or stress test\nExecStart=/app/chip_base_test/new_test/new_test.sh -t 12h -o /userdata/new_test_logs\n"})}),"\n",(0,i.jsx)(t.p,{children:"Field explanations:"}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsxs)(t.li,{children:["The ",(0,i.jsx)(t.strong,{children:(0,i.jsx)(t.code,{children:"-t"})})," parameter specifies test duration, e.g., ",(0,i.jsx)(t.code,{children:"12h"})," for 12 hours."]}),"\n",(0,i.jsxs)(t.li,{children:["The ",(0,i.jsx)(t.strong,{children:(0,i.jsx)(t.code,{children:"-o"})})," parameter specifies the log storage path, e.g., ",(0,i.jsx)(t.code,{children:"/userdata/new_test_logs"}),"."]}),"\n"]}),"\n",(0,i.jsx)(t.h3,{id:"launching-the-test",children:"Launching the Test"}),"\n",(0,i.jsxs)(t.p,{children:["After completing the configuration, start the test using the ",(0,i.jsx)(t.code,{children:"startup.sh"})," script:"]}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-bash",children:"/app/chip_base_test/startup.sh\n"})}),"\n",(0,i.jsxs)(t.p,{children:["The ",(0,i.jsx)(t.code,{children:"startup.sh"})," script will automatically load and execute the newly added test item based on the ",(0,i.jsx)(t.code,{children:"config.ini"})," configuration."]}),"\n",(0,i.jsx)(t.h3,{id:"verifying-the-test-item",children:"Verifying the Test Item"}),"\n",(0,i.jsx)(t.p,{children:"After running the test, verify the following to ensure the new test item works correctly:"}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsx)(t.li,{children:"Whether log files are generated as expected and contain complete records."}),"\n",(0,i.jsx)(t.li,{children:"Whether test results meet functional expectations."}),"\n",(0,i.jsxs)(t.li,{children:["Whether parameters configured in ",(0,i.jsx)(t.code,{children:"config.ini"})," take effect correctly."]}),"\n"]})]})}function h(e={}){const{wrapper:t}={...(0,r.R)(),...e.components};return t?(0,i.jsx)(t,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}}}]);