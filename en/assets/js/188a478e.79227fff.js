"use strict";(self.webpackChunkrdk_doc=self.webpackChunkrdk_doc||[]).push([[22891],{28453:(e,n,t)=>{t.d(n,{R:()=>s,x:()=>a});var r=t(96540);const i={},d=r.createContext(i);function s(e){const n=r.useContext(d);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:s(e.components),r.createElement(d.Provider,{value:n},e.children)}},70955:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>o,contentTitle:()=>a,default:()=>u,frontMatter:()=>s,metadata:()=>r,toc:()=>l});const r=JSON.parse('{"id":"Advanced_development/linux_development/driver_development_s100/driver_uart_dev","title":"UART Driver Debugging Guide","description":"The S100 chip has a total of four UART interfaces, namely UART0 to UART3. Among them, UART0 is used as the debug console. By default, DMA is disabled for UART0, and its baud rate (either 115200 or 921600) is determined by the Bootstrip pin configuration.","source":"@site/i18n/en/docusaurus-plugin-content-docs-docs_s/current/07_Advanced_development/02_linux_development/04_driver_development_s100/02_driver_uart_dev.md","sourceDirName":"07_Advanced_development/02_linux_development/04_driver_development_s100","slug":"/Advanced_development/linux_development/driver_development_s100/driver_uart_dev","permalink":"/rdk_doc/en/rdk_s/Advanced_development/linux_development/driver_development_s100/driver_uart_dev","draft":false,"unlisted":false,"tags":[],"version":"current","lastUpdatedAt":1770955133000,"sidebarPosition":2,"frontMatter":{"sidebar_position":2},"sidebar":"tutorialSidebar","previous":{"title":"Configure Uboot and Kernel Option Parameters","permalink":"/rdk_doc/en/rdk_s/Advanced_development/linux_development/driver_development_s100/uboot_kernel_config"},"next":{"title":"I2C Debugging Guide","permalink":"/rdk_doc/en/rdk_s/Advanced_development/linux_development/driver_development_s100/driver_i2c_dev"}}');var i=t(74848),d=t(28453);const s={sidebar_position:2},a="UART Driver Debugging Guide",o={},l=[{value:"UART Usage Instructions",id:"uart-usage-instructions",level:2},{value:"Code Paths",id:"code-paths",level:3},{value:"Kernel Configuration",id:"kernel-configuration",level:3},{value:"DTS Device Node Configuration",id:"dts-device-node-configuration",level:3},{value:"Usage Examples",id:"usage-examples",level:2},{value:"Check UART Nodes",id:"check-uart-nodes",level:3},{value:"UART-related Operations",id:"uart-related-operations",level:3},{value:"Notes",id:"notes",level:2}];function c(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,d.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"uart-driver-debugging-guide",children:"UART Driver Debugging Guide"})}),"\n",(0,i.jsx)(n.p,{children:"The S100 chip has a total of four UART interfaces, namely UART0 to UART3. Among them, UART0 is used as the debug console. By default, DMA is disabled for UART0, and its baud rate (either 115200 or 921600) is determined by the Bootstrip pin configuration."}),"\n",(0,i.jsx)(n.p,{children:"The other UART interfaces are used for data transmission. DMA is enabled by default in the device tree, and users can configure various baud rates via software. The commonly used baud rate is 921600. UART0 and UART1 support hardware flow control, while the other UART interfaces do not support this feature."}),"\n",(0,i.jsx)(n.h2,{id:"uart-usage-instructions",children:"UART Usage Instructions"}),"\n",(0,i.jsx)(n.h3,{id:"code-paths",children:"Code Paths"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-shell",children:"drivers/tty/serial/8250/8250_dw.c   # UART driver file\ndrivers/tty/serial/8250/8250_port.c    # UART port operation file\ndrivers/tty/serial/8250/8250_core.c    # Core 8250 UART driver\nhobot-drivers/serial/8250_pdma.c    # UART PDMA operation implementation file\n"})}),"\n",(0,i.jsx)(n.h3,{id:"kernel-configuration",children:"Kernel Configuration"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-{.text}",children:"/*hobot-drivers/configs/drobot_s100_defconfig*/\nCONFIG_SERIAL_8250=y   # 8250 driver configuration\nCONFIG_SERIAL_8250_CONSOLE=y   # 8250 console driver configuration\nCONFIG_SERIAL_8250_DW=y   # Enable Designware-specific features\n"})}),"\n",(0,i.jsx)(n.h3,{id:"dts-device-node-configuration",children:"DTS Device Node Configuration"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-{.text}",children:'/*kernel/arch/arm64/boot/dts/hobot/drobot-s100-soc.dtsi*/\nuart1: uart@394A0000 {\n      power-domains = <&scmi_smc_pd PD_IDX_LSPERI_TOP>;\n      compatible = "snps,dw-apb-uart";\n      reg = <0x0 0x394A0000 0x0 0x10000>;\n      reg-shift = <2>;\n      reg-io-width = <4>;\n      interrupts = <GIC_SPI PERISYS_UART0_INTR PERISYS_UART0_INTR_TRIG_TYPE>;\n      clock-frequency = <200000000>;\n      pinctrl-names = "default";\n      pinctrl-0 = <&peri_uart0>;\n      dmas = <&pdma0 0>, <&pdma0 1>;\n      dma-names = "rx", "tx";\n      status = "okay";\n };\n'})}),"\n",(0,i.jsx)(n.h2,{id:"usage-examples",children:"Usage Examples"}),"\n",(0,i.jsx)(n.h3,{id:"check-uart-nodes",children:"Check UART Nodes"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-{.text}",children:"ls /dev/ttyS*\n/dev/ttyS0  /dev/ttyS1  /dev/ttyS2  /dev/ttyS3\n"})}),"\n",(0,i.jsx)(n.h3,{id:"uart-related-operations",children:"UART-related Operations"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"View UART configuration such as baud rate:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-{.text}",children:"stty -F /dev/ttyS1 -a\n"})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Configure baud rate, etc.:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-{.text}",children:"stty -F /dev/ttyS1 speed 921600 cs8 -cstopb parenb -parodd\n"})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Read data from UART:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-{.text}",children:"cat /dev/ttyS1\n"})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Send test data via UART:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-{.text}",children:"echo 123456789 > /dev/ttyS1\n"})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"notes",children:"Notes"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"In the RDK S100 hardware design, the 40-pin GPIO uses TI's TXS-series level-shifting ICs to convert 1.8V I/O signals to 3.3V I/O signals. To ensure signal quality and reliability, avoid using additional level-shifting ICs on the communication peer side. If multiple stages of level shifting are used, pay close attention to the actual hardware signal integrity."}),"\n"]})]})}function u(e={}){const{wrapper:n}={...(0,d.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(c,{...e})}):c(e)}}}]);