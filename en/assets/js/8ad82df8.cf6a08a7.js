"use strict";(self.webpackChunkrdk_doc=self.webpackChunkrdk_doc||[]).push([[36986],{28453:(e,n,o)=>{o.d(n,{R:()=>r,x:()=>d});var i=o(96540);const t={},c=i.createContext(t);function r(e){const n=i.useContext(c);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:r(e.components),i.createElement(c.Provider,{value:n},e.children)}},40584:(e,n,o)=>{o.r(n),o.d(n,{assets:()=>s,contentTitle:()=>d,default:()=>f,frontMatter:()=>r,metadata:()=>i,toc:()=>l});const i=JSON.parse('{"id":"Advanced_development/linux_development/driver_development/uboot_kernel_config","title":"Configuration of Uboot and Kernel Options","description":"In software development, it is often necessary to configure the functional options of Uboot and Kernel. This chapter introduces several commonly used configuration methods for users\' reference.","source":"@site/i18n/en/docusaurus-plugin-content-docs/current/07_Advanced_development/02_linux_development/driver_development/uboot_kernel_config.md","sourceDirName":"07_Advanced_development/02_linux_development/driver_development","slug":"/Advanced_development/linux_development/driver_development/uboot_kernel_config","permalink":"/rdk_doc/en/Advanced_development/linux_development/driver_development/uboot_kernel_config","draft":false,"unlisted":false,"tags":[],"version":"current","lastUpdatedAt":1750764387000,"sidebarPosition":1,"frontMatter":{"sidebar_position":1},"sidebar":"tutorialSidebar","previous":{"title":"7.2.2 Driver Development Guide","permalink":"/rdk_doc/en/Advanced_development/linux_development/driver_development/"},"next":{"title":"UART Driver Debugging Guide","permalink":"/rdk_doc/en/Advanced_development/linux_development/driver_development/driver_uart_dev"}}');var t=o(74848),c=o(28453);const r={sidebar_position:1},d="Configuration of Uboot and Kernel Options",s={},l=[{value:"Configuration of Uboot Options",id:"configuration-of-uboot-options",level:2},{value:"Configure Kernel Options",id:"configure-kernel-options",level:2}];function a(e){const n={admonition:"admonition",code:"code",h1:"h1",h2:"h2",header:"header",img:"img",li:"li",p:"p",pre:"pre",ul:"ul",...(0,c.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"configuration-of-uboot-and-kernel-options",children:"Configuration of Uboot and Kernel Options"})}),"\n",(0,t.jsx)(n.p,{children:"In software development, it is often necessary to configure the functional options of Uboot and Kernel. This chapter introduces several commonly used configuration methods for users' reference."}),"\n",(0,t.jsx)(n.h2,{id:"configuration-of-uboot-options",children:"Configuration of Uboot Options"}),"\n",(0,t.jsxs)(n.admonition,{title:"Note",type:"info",children:[(0,t.jsxs)(n.p,{children:["The following instructions are provided with the example of modifying the ",(0,t.jsx)(n.code,{children:"xj3_ubuntu_nand_defconfig"})," configuration file."]}),(0,t.jsxs)(n.p,{children:["The specific configuration file used by Uboot can be found in the ",(0,t.jsx)(n.code,{children:"bootloader/device/.board_config.mk"})," board-level configuration file after executing ",(0,t.jsx)(n.code,{children:"./xbuild.sh lunch"}),", in the ",(0,t.jsx)(n.code,{children:"HR_UBOOT_CONFIG_FILE"})," variable."]})]}),"\n",(0,t.jsxs)(n.p,{children:["First, enter the ",(0,t.jsx)(n.code,{children:"uboot"})," directory and execute ",(0,t.jsx)(n.code,{children:"make ARCH=arm64 xj3_ubuntu_nand_defconfig"}),". Because the ",(0,t.jsx)(n.code,{children:"make"})," command will first execute the Makefile file in the top-level directory. The targets ending with ",(0,t.jsx)(n.code,{children:"config"})," have a common entry:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-makefile",children:"%config: scripts_basic outputmakefile FORCE\n        $(Q)$(MAKE) $(build)=scripts/kconfig $@\n"})}),"\n",(0,t.jsx)(n.p,{children:"The expanded command is:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"make -f ./scripts/Makefile.build obj=scripts/kconfig xj3_ubuntu_nand_defconfig\n"})}),"\n",(0,t.jsxs)(n.p,{children:["After executing this command, a ",(0,t.jsx)(n.code,{children:".config"})," file will be generated in the root directory of the Uboot source code."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"make ARCH=arm64 xj3_ubuntu_nand_defconfig\n\n  HOSTCC  scripts/basic/fixdep\n  HOSTCC  scripts/kconfig/conf.o\n  YACC    scripts/kconfig/zconf.tab.c\n  LEX     scripts/kconfig/zconf.lex.c\n  HOSTCC  scripts/kconfig/zconf.tab.o\n  HOSTLD  scripts/kconfig/conf\n#\n# configuration written to .config\n#\n"})}),"\n",(0,t.jsxs)(n.p,{children:["Then, you can execute ",(0,t.jsx)(n.code,{children:"make ARCH=arm64 menuconfig"})," to open the graphical configuration interface for configuring Uboot options."]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.img,{src:"https://rdk-doc.oss-cn-beijing.aliyuncs.com/doc/img/07_Advanced_development/02_linux_development/driver_development/image-20220518111319607.png",alt:"image-20220518111319607"}),'After completing the configuration in the menuconfig interface, select "Exit" and choose "Yes" or "No" to save the modifications to the ',(0,t.jsx)(n.code,{children:".config"})," file according to the prompt."]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{src:"https://rdk-doc.oss-cn-beijing.aliyuncs.com/doc/img/07_Advanced_development/02_linux_development/driver_development/image-20220518111506018.png",alt:"image-20220518111506018"})}),"\n",(0,t.jsxs)(n.p,{children:["After saving the configuration, execute the command ",(0,t.jsx)(n.code,{children:"diff .config configs/xj3_ubuntu_nand_defconfig"})," to compare the differences and confirm whether the modifications meet expectations."]}),"\n",(0,t.jsxs)(n.p,{children:["If the modifications are correct, execute ",(0,t.jsx)(n.code,{children:"cp .config configs/xj3_ubuntu_nand_defconfig"})," to replace the default configuration file."]}),"\n",(0,t.jsx)(n.h2,{id:"configure-kernel-options",children:"Configure Kernel Options"}),"\n",(0,t.jsxs)(n.admonition,{title:"Note",type:"info",children:[(0,t.jsxs)(n.p,{children:["The following instructions are based on modifying the ",(0,t.jsx)(n.code,{children:"xj3_perf_ubuntu_defconfig"})," configuration file."]}),(0,t.jsxs)(n.p,{children:["The specific configuration file used by the kernel can be found in the ",(0,t.jsx)(n.code,{children:"kernel_config_file"})," variable in the ",(0,t.jsx)(n.code,{children:"mk_kernel.sh"})," script."]})]}),"\n",(0,t.jsxs)(n.p,{children:["Configuring the kernel through ",(0,t.jsx)(n.code,{children:"menuconfig"})," is similar to configuring U-Boot. Follow these steps to configure the kernel options."]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Use ",(0,t.jsx)(n.code,{children:"xj3_perf_ubuntu_defconfig"})," to generate ",(0,t.jsx)(n.code,{children:".config"}),". If the source code has been fully compiled, the ",(0,t.jsx)(n.code,{children:".config"})," file will already be configured."]}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"make ARCH=arm64 xj3_perf_ubuntu_defconfig\n"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Execute the following command to modify the configuration."}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"make ARCH=arm64 menuconfig\n"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"After making modifications, you can see the differences between the modified and original configurations."}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"diff .config arch/arm64/configs/xj3_perf_ubuntu_defconfig\n"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Overwrite ",(0,t.jsx)(n.code,{children:"xj3_perf_ubuntu_defconfig"})," with the new configuration."]}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"cp .config arch/arm64/configs/xj3_perf_ubuntu_defconfig\n"})})]})}function f(e={}){const{wrapper:n}={...(0,c.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(a,{...e})}):a(e)}}}]);