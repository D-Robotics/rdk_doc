"use strict";(self.webpackChunkrdk_doc=self.webpackChunkrdk_doc||[]).push([[8708,25299],{11470:(e,n,s)=>{s.d(n,{A:()=>y});var r=s(96540),t=s(34164),i=s(23104),l=s(56347),o=s(205),a=s(57485),c=s(31682),d=s(70679);function h(e){return r.Children.toArray(e).filter(e=>"\n"!==e).map(e=>{if(!e||(0,r.isValidElement)(e)&&function(e){const{props:n}=e;return!!n&&"object"==typeof n&&"value"in n}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)})?.filter(Boolean)??[]}function u(e){const{values:n,children:s}=e;return(0,r.useMemo)(()=>{const e=n??function(e){return h(e).map(({props:{value:e,label:n,attributes:s,default:r}})=>({value:e,label:n,attributes:s,default:r}))}(s);return function(e){const n=(0,c.XI)(e,(e,n)=>e.value===n.value);if(n.length>0)throw new Error(`Docusaurus error: Duplicate values "${n.map(e=>e.value).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e},[n,s])}function x({value:e,tabValues:n}){return n.some(n=>n.value===e)}function p({queryString:e=!1,groupId:n}){const s=(0,l.W6)(),t=function({queryString:e=!1,groupId:n}){if("string"==typeof e)return e;if(!1===e)return null;if(!0===e&&!n)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return n??null}({queryString:e,groupId:n});return[(0,a.aZ)(t),(0,r.useCallback)(e=>{if(!t)return;const n=new URLSearchParams(s.location.search);n.set(t,e),s.replace({...s.location,search:n.toString()})},[t,s])]}function m(e){const{defaultValue:n,queryString:s=!1,groupId:t}=e,i=u(e),[l,a]=(0,r.useState)(()=>function({defaultValue:e,tabValues:n}){if(0===n.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(e){if(!x({value:e,tabValues:n}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${e}" but none of its children has the corresponding value. Available values are: ${n.map(e=>e.value).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return e}const s=n.find(e=>e.default)??n[0];if(!s)throw new Error("Unexpected error: 0 tabValues");return s.value}({defaultValue:n,tabValues:i})),[c,h]=p({queryString:s,groupId:t}),[m,j]=function({groupId:e}){const n=function(e){return e?`docusaurus.tab.${e}`:null}(e),[s,t]=(0,d.Dv)(n);return[s,(0,r.useCallback)(e=>{n&&t.set(e)},[n,t])]}({groupId:t}),g=(()=>{const e=c??m;return x({value:e,tabValues:i})?e:null})();(0,o.A)(()=>{g&&a(g)},[g]);return{selectedValue:l,selectValue:(0,r.useCallback)(e=>{if(!x({value:e,tabValues:i}))throw new Error(`Can't select invalid tab value=${e}`);a(e),h(e),j(e)},[h,j,i]),tabValues:i}}var j=s(92303);const g={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};var b=s(74848);function f({className:e,block:n,selectedValue:s,selectValue:r,tabValues:l}){const o=[],{blockElementScrollPositionUntilNextRender:a}=(0,i.a_)(),c=e=>{const n=e.currentTarget,t=o.indexOf(n),i=l[t].value;i!==s&&(a(n),r(i))},d=e=>{let n=null;switch(e.key){case"Enter":c(e);break;case"ArrowRight":{const s=o.indexOf(e.currentTarget)+1;n=o[s]??o[0];break}case"ArrowLeft":{const s=o.indexOf(e.currentTarget)-1;n=o[s]??o[o.length-1];break}}n?.focus()};return(0,b.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,t.A)("tabs",{"tabs--block":n},e),children:l.map(({value:e,label:n,attributes:r})=>(0,b.jsx)("li",{role:"tab",tabIndex:s===e?0:-1,"aria-selected":s===e,ref:e=>{o.push(e)},onKeyDown:d,onClick:c,...r,className:(0,t.A)("tabs__item",g.tabItem,r?.className,{"tabs__item--active":s===e}),children:n??e},e))})}function v({lazy:e,children:n,selectedValue:s}){const i=(Array.isArray(n)?n:[n]).filter(Boolean);if(e){const e=i.find(e=>e.props.value===s);return e?(0,r.cloneElement)(e,{className:(0,t.A)("margin-top--md",e.props.className)}):null}return(0,b.jsx)("div",{className:"margin-top--md",children:i.map((e,n)=>(0,r.cloneElement)(e,{key:n,hidden:e.props.value!==s}))})}function _(e){const n=m(e);return(0,b.jsxs)("div",{className:(0,t.A)("tabs-container",g.tabList),children:[(0,b.jsx)(f,{...n,...e}),(0,b.jsx)(v,{...n,...e})]})}function y(e){const n=(0,j.A)();return(0,b.jsx)(_,{...e,children:h(e.children)},String(n))}},19365:(e,n,s)=>{s.d(n,{A:()=>l});s(96540);var r=s(34164);const t={tabItem:"tabItem_Ymn6"};var i=s(74848);function l({children:e,hidden:n,className:s}){return(0,i.jsx)("div",{role:"tabpanel",className:(0,r.A)(t.tabItem,s),hidden:n,children:e})}},28453:(e,n,s)=>{s.d(n,{R:()=>l,x:()=>o});var r=s(96540);const t={},i=r.createContext(t);function l(e){const n=r.useContext(i);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:l(e.components),r.createElement(i.Provider,{value:n},e.children)}},77986:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>d,contentTitle:()=>c,default:()=>x,frontMatter:()=>a,metadata:()=>r,toc:()=>h});const r=JSON.parse('{"id":"Robot_development/quick_demo/demo_cv","title":"5.2.4 Image Processing Acceleration","description":"Gaussian Filtering","source":"@site/i18n/en/docusaurus-plugin-content-docs/current/05_Robot_development/02_quick_demo/demo_cv.md","sourceDirName":"05_Robot_development/02_quick_demo","slug":"/Robot_development/quick_demo/demo_cv","permalink":"/rdk_doc/en/Robot_development/quick_demo/demo_cv","draft":false,"unlisted":false,"tags":[],"version":"current","lastUpdatedAt":1764746491000,"sidebarPosition":4,"frontMatter":{"sidebar_position":4},"sidebar":"tutorialSidebar","previous":{"title":"5.2.3 Image Codec","permalink":"/rdk_doc/en/Robot_development/quick_demo/hobot_codec"},"next":{"title":"5.2.5 Communication","permalink":"/rdk_doc/en/Robot_development/quick_demo/demo_communication"}}');var t=s(74848),i=s(28453),l=s(11470),o=s(19365);const a={sidebar_position:4},c="5.2.4 Image Processing Acceleration",d={},h=[{value:"Gaussian Filtering",id:"gaussian-filtering",level:2},{value:"Introduction",id:"introduction",level:3},{value:"Supported Platforms",id:"supported-platforms",level:3},{value:"Preparation",id:"preparation",level:3},{value:"RDK",id:"rdk",level:4},{value:"Usage",id:"usage",level:3},{value:"BPU Acceleration",id:"bpu-acceleration",level:4},{value:"NEON Acceleration",id:"neon-acceleration",level:4},{value:"RDK",id:"rdk-1",level:4},{value:"Result Analysis",id:"result-analysis",level:3},{value:"BPU",id:"bpu",level:4},{value:"NEON",id:"neon",level:4},{value:"Mean Filtering",id:"mean-filtering",level:2},{value:"Introduction",id:"introduction-1",level:3},{value:"Supported Platforms",id:"supported-platforms-1",level:3},{value:"Preparation",id:"preparation-1",level:3},{value:"RDK",id:"rdk-2",level:4},{value:"Usage Guide",id:"usage-guide",level:3},{value:"RDK",id:"rdk-3",level:4},{value:"Result Analysis",id:"result-analysis-1",level:3},{value:"Comparison of hobot_cv and opencv processing performance",id:"comparison-of-hobot_cv-and-opencv-processing-performance",level:4},{value:"crop",id:"crop",level:2},{value:"Introduction",id:"introduction-2",level:3},{value:"Platform Support",id:"platform-support",level:3},{value:"Preparation",id:"preparation-2",level:3},{value:"RDK Platform",id:"rdk-platform",level:4},{value:"Instruction",id:"instruction",level:3},{value:"RDK",id:"rdk-4",level:4},{value:"Result Analysis",id:"result-analysis-2",level:3},{value:"Resize",id:"resize",level:2},{value:"Introduction",id:"introduction-3",level:3},{value:"Platform Support",id:"platform-support-1",level:3},{value:"Preparation",id:"preparation-3",level:3},{value:"RDK",id:"rdk-5",level:4},{value:"Usage",id:"usage-1",level:3},{value:"RDK",id:"rdk-6",level:4},{value:"Result Analysis",id:"result-analysis-3",level:3},{value:"RDK",id:"rdk-7",level:4},{value:"RDK performance comparison",id:"rdk-performance-comparison",level:4},{value:"rotate",id:"rotate",level:2},{value:"Introduction",id:"introduction-4",level:3},{value:"Supported Platforms",id:"supported-platforms-2",level:3},{value:"Preparation",id:"preparation-4",level:3},{value:"RDK Platform",id:"rdk-platform-1",level:4},{value:"User Guide",id:"user-guide",level:3},{value:"RDK",id:"rdk-8",level:4},{value:"Result Analysis",id:"result-analysis-4",level:3},{value:"Performance comparison of hobot_cv and OpenCV",id:"performance-comparison-of-hobot_cv-and-opencv",level:4},{value:"Pyramid",id:"pyramid",level:2},{value:"Introduction",id:"introduction-5",level:3},{value:"Supported Platforms",id:"supported-platforms-3",level:3},{value:"Preparation",id:"preparation-5",level:3},{value:"RDK Platform",id:"rdk-platform-2",level:4},{value:"RDK",id:"rdk-9",level:4},{value:"Result Analysis",id:"result-analysis-5",level:3},{value:"Performance Comparison",id:"performance-comparison",level:4},{value:"Color",id:"color",level:2},{value:"Introduction",id:"introduction-6",level:3},{value:"Platform Support",id:"platform-support-2",level:3},{value:"Preparation",id:"preparation-6",level:3},{value:"RDK",id:"rdk-10",level:4},{value:"Usage",id:"usage-2",level:3},{value:"RDK",id:"rdk-11",level:4},{value:"Result Analysis",id:"result-analysis-6",level:3},{value:"RDK",id:"rdk-12",level:4}];function u(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"524-image-processing-acceleration",children:"5.2.4 Image Processing Acceleration"})}),"\n","\n",(0,t.jsx)(n.h2,{id:"gaussian-filtering",children:"Gaussian Filtering"}),"\n",(0,t.jsx)(n.h3,{id:"introduction",children:"Introduction"}),"\n",(0,t.jsx)(n.p,{children:"Realize the function of Gaussian filtering. The acceleration types are BPU acceleration and NEON acceleration. BPU acceleration currently only supports the int16 format, and NEON acceleration currently only supports the int16 and uint16 formats."}),"\n",(0,t.jsxs)(n.p,{children:["Code repository:  (",(0,t.jsx)(n.a,{href:"https://github.com/D-Robotics/hobot_cv",children:"https://github.com/D-Robotics/hobot_cv"}),")"]}),"\n",(0,t.jsx)(n.h3,{id:"supported-platforms",children:"Supported Platforms"}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"Platform"}),(0,t.jsx)(n.th,{children:"System"}),(0,t.jsx)(n.th,{children:"Function"})]})}),(0,t.jsx)(n.tbody,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"RDK X3, RDK X3 Module"}),(0,t.jsx)(n.td,{children:"Ubuntu 20.04 (Foxy), Ubuntu 22.04 (Humble)"}),(0,t.jsx)(n.td,{children:"Read ToF images and perform Gaussian filtering"})]})})]}),"\n",(0,t.jsx)(n.h3,{id:"preparation",children:"Preparation"}),"\n",(0,t.jsx)(n.h4,{id:"rdk",children:"RDK"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"RDK has burned D-Robotics's provided  Ubuntu 20.04/22.04 system image."}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"RDK has successfully installed TogetheROS.Bot."}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"usage",children:"Usage"}),"\n",(0,t.jsx)(n.h4,{id:"bpu-acceleration",children:"BPU Acceleration"}),"\n",(0,t.jsx)(n.p,{children:"The current version supports the following parameter ranges:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Filtering type: Gaussian filtering"}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Supported data types: int16"}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Supported resolution: 320x240."}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Filtering kernel: 3x3 Gaussian"}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"sigmax: 0"}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"sigmay: 0"}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.h4,{id:"neon-acceleration",children:"NEON Acceleration"}),"\n",(0,t.jsx)(n.p,{children:"The current version supports the following parameter ranges:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Filtering type: Gaussian filtering- Supported data types: int16, uint16"}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Filter kernel: Gaussian 3x3, 5x5"}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"sigmax: 0"}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"sigmay: 0"}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"The package provides a simple test program that takes a local ToF image and uses the interface in hobot_cv to implement Gaussian filtering. For more detailed interface information, please refer to the README.md file in the hobot_cv package."}),"\n",(0,t.jsx)(n.h4,{id:"rdk-1",children:"RDK"}),"\n",(0,t.jsxs)(l.A,{groupId:"tros-distro",children:[(0,t.jsx)(o.A,{value:"foxy",label:"Foxy",children:(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"# Configure the tros.b environment\nsource /opt/tros/setup.bash\n"})})}),(0,t.jsx)(o.A,{value:"humble",label:"Humble",children:(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"# Configure the tros.b environment\nsource /opt/tros/humble/setup.bash\n"})})})]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-shell",children:"# Copy the models and configuration files needed for running the examples from the installation path of tros.b.\ncp -r /opt/tros/${TROS_DISTRO}/lib/hobot_cv/config/ .\n\n# Launch the BPU acceleration test program package\nros2 launch hobot_cv hobot_cv_gaussian_blur.launch.py\n\n# Launch the NEON acceleration test program package\nros2 launch hobot_cv hobot_cv_neon_blur.launch.py\n"})}),"\n",(0,t.jsx)(n.h3,{id:"result-analysis",children:"Result Analysis"}),"\n",(0,t.jsx)(n.h4,{id:"bpu",children:"BPU"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-text",children:"Output:\n===================\nimage name :images/frame1_4.png\ninfe cost time:1314\nguss_time cost time:2685\nhobotcv save rate:0.510615\n\nanalyse_result start \n---------GaussianBlur\nout_filter type:2,cols:320,rows:240,channel:1\ncls_filter type:2,cols:320,rows:240,channel:1\nout_filter minvalue:96,max:2363\nout_filter min,x:319,y:115\nout_filter max,x:147,y:239\ncls_filter minvalue:96,max:2364\ncls_filter min,x:319,y:115\ncls_filter max,x:147,y:239\n```diff diff diff\nmat_diff minvalue:0,max:2\nmat_diff min,x:2,y:0\nmat_diff max,x:110,y:14\n\nerror sum:8.46524e+06,max:2,mean_error:0.439232\nanalyse_result,time_used_ms_end:2\nanalyse_result end \n"})}),"\n",(0,t.jsx)(n.p,{children:"infe cost time:1314 // Indicates the time cost of Gaussian filtering accelerated by hobotcv, 1314 microseconds."}),"\n",(0,t.jsx)(n.p,{children:"guss_time cost time:2685 // Indicates the time cost of Gaussian filtering by OpenCV, 2685 microseconds."}),"\n",(0,t.jsx)(n.p,{children:"hobotcv save rate = (guss_time cost time - infe cost time) / guss_time cost time = 0.510615"}),"\n",(0,t.jsx)(n.p,{children:"According to the above comparison results, the performance is improved by 50% after being accelerated by hobot_cv."}),"\n",(0,t.jsx)(n.p,{children:"error sum:8.46524e+06,max:2,mean_error:0.439232 // The total error for a single image is: 8.46524e+06, the maximum error for a single pixel is: 2, and the average error is: 0.439232"}),"\n",(0,t.jsx)(n.p,{children:"Average error = sum / (width * height) = 8.46524e+06 / (320 * 240)"}),"\n",(0,t.jsx)(n.p,{children:"The performance comparison results between hobot_cv Gaussian filtering accelerated by BPU and OpenCV Gaussian filtering are as follows:"}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"Interface type"}),(0,t.jsx)(n.th,{children:"Kernel"}),(0,t.jsx)(n.th,{children:"Time cost (ms)"}),(0,t.jsx)(n.th,{children:"Single core CPU occupation (%)"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Hobotcv gaussian"}),(0,t.jsx)(n.td,{children:"Size(3,3)"}),(0,t.jsx)(n.td,{children:"1.10435"}),(0,t.jsx)(n.td,{children:"15.9"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Opencv gaussian"}),(0,t.jsx)(n.td,{children:"Size(3,3)"}),(0,t.jsx)(n.td,{children:"2.41861"}),(0,t.jsx)(n.td,{children:"49.7"})]})]})]}),"\n",(0,t.jsx)(n.h4,{id:"neon",children:"NEON"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-text",children:"Output:\n[neon_example-1] ===================\n[neon_example-1] image name: config/tof_images/frame1_4.png\n[neon_example-1] hobotcv mean cost time: 674\n[neon_example-1] opencv mean cost time: 1025\n[neon_example-1] hobotcv mean save rate: 0.342439\n[neon_example-1]\n[neon_example-1] analyse_result start\n[neon_example-1] ---------Mean_Blur\n[neon_example-1] error sum: 8.43744e+06, max: 1, mean_error: 0.430833\n[neon_example-1]\n[neon_example-1] hobotcv gaussian cost time: 603\n[neon_example-1] opencv gaussian cost time: 2545[neon_example-1] hobotcv gaussian save rate:0.763065\n[neon_example-1]\n[neon_example-1] analyse_result start\n[neon_example-1] ---------Gaussian_Blur\n[neon_example-1] error sum:9.13206e+06, max:1, mean_error:0.466302\n[neon_example-1]\n[neon_example-1] -------------------------\n"})}),"\n",(0,t.jsx)(n.p,{children:"hobotcv gaussian cost time:603 //hobotcv gaussian filtering with neon acceleration took 603 microseconds.\nopencv gaussian cost time:2545 //opencv gaussian filtering took 2545 microseconds.\nhobotcv gaussian save rate = (opencv cost time - hobotcv cost time) / opencv cost time = 0.763065\nFrom the above comparison, after the acceleration of hobotcv, the performance of Gaussian filtering has improved by 76%."}),"\n",(0,t.jsx)(n.p,{children:"The comparison results between hobot_cv Gaussian filtering with NEON acceleration and opencv Gaussian filtering are as follows:"}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"Interface Type"}),(0,t.jsx)(n.th,{children:"Kernel"}),(0,t.jsx)(n.th,{children:"Time(ms)"}),(0,t.jsx)(n.th,{children:"Single Core CPU Usage (%)"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Hobotcv Gaussian"}),(0,t.jsx)(n.td,{children:"Size(3,3)"}),(0,t.jsx)(n.td,{children:"0.430284"}),(0,t.jsx)(n.td,{children:"27.1"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Opencv Gaussian"}),(0,t.jsx)(n.td,{children:"Size(3,3)"}),(0,t.jsx)(n.td,{children:"2.42225"}),(0,t.jsx)(n.td,{children:"47"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Hobotcv Gaussian"}),(0,t.jsx)(n.td,{children:"Size(5,5)"}),(0,t.jsx)(n.td,{children:"0.854871"}),(0,t.jsx)(n.td,{children:"39.1"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Opencv Gaussian"}),(0,t.jsx)(n.td,{children:"Size(5,5)"}),(0,t.jsx)(n.td,{children:"3.15647"}),(0,t.jsx)(n.td,{children:"99.8"})]})]})]}),"\n",(0,t.jsx)(n.h2,{id:"mean-filtering",children:"Mean Filtering"}),"\n",(0,t.jsx)(n.h3,{id:"introduction-1",children:"Introduction"}),"\n",(0,t.jsx)(n.p,{children:"Implementation of Mean Filtering using NEON acceleration, currently only supporting int16 and uint16 formats."}),"\n",(0,t.jsxs)(n.p,{children:["Code repository:  (",(0,t.jsx)(n.a,{href:"https://github.com/D-Robotics/hobot_cv",children:"https://github.com/D-Robotics/hobot_cv"}),")"]}),"\n",(0,t.jsx)(n.h3,{id:"supported-platforms-1",children:"Supported Platforms"}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"Platform"}),(0,t.jsx)(n.th,{children:"System"}),(0,t.jsx)(n.th,{children:"Function"})]})}),(0,t.jsx)(n.tbody,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"RDK X3, RDK X3 Module"}),(0,t.jsx)(n.td,{children:"Ubuntu 20.04 (Foxy), Ubuntu 22.04 (Humble)"}),(0,t.jsx)(n.td,{children:"Read ToF images, perform Mean Filtering"})]})})]}),"\n",(0,t.jsx)(n.h3,{id:"preparation-1",children:"Preparation"}),"\n",(0,t.jsx)(n.h4,{id:"rdk-2",children:"RDK"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"RDK has flashed the  Ubuntu 20.04/22.04 system image provided by D-Robotics."}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"RDK has successfully installed TogetheROS.Bot."}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"usage-guide",children:"Usage Guide"}),"\n",(0,t.jsx)(n.p,{children:"The mean filtering supports the following parameter range:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Data Type: int16, uint16"}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Kernel: 3x3, 5x5"}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"The package provides a simple test program. The input is a offline ToF image, and the hobot_cv interface is called to perform mean filtering. For detailed interface information, please refer to README.md in the hobot_cv package for further understanding."}),"\n",(0,t.jsx)(n.h4,{id:"rdk-3",children:"RDK"}),"\n",(0,t.jsxs)(l.A,{groupId:"tros-distro",children:[(0,t.jsx)(o.A,{value:"foxy",label:"Foxy",children:(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"# Configure the tros.b environment\nsource /opt/tros/setup.bash\n"})})}),(0,t.jsx)(o.A,{value:"humble",label:"Humble",children:(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"# Configure the tros.b environment\nsource /opt/tros/humble/setup.bash\n"})})})]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-shell",children:"# Copy the required configuration files from the installation path of TogetheROS.\ncp -r /opt/tros/${TROS_DISTRO}/lib/hobot_cv/config/ .\n\n# Launch the test program pkg\nros2 launch hobot_cv hobot_cv_neon_blur.launch.py\n"})}),"\n",(0,t.jsx)(n.h3,{id:"result-analysis-1",children:"Result Analysis"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-text",children:"Output:\n[neon_example-1] ===================\n[neon_example-1] image name :config/tof_images/frame1_4.png\n[neon_example-1] hobotcv mean cost time:674\n[neon_example-1] opencv mean cost time:1025\n[neon_example-1] hobotcv mean save rate:0.342439\n[neon_example-1]\n[neon_example-1] analyse_result start\n[neon_example-1] ---------Mean_Blur\n[neon_example-1] error sum:8.43744e+06,max:1,mean_error:0.430833\n[neon_example-1]\n[neon_example-1] -------------------------\n"})}),"\n",(0,t.jsx)(n.p,{children:"Mean filtering cost time:674 // The hobot_cv mean filtering with neon acceleration interface took 674 microseconds.\nopencv mean cost time:1025 // Indicates the mean filtering time of opencv is 1025 microseconds.\nhobotcv mean save rate = (opencv cost time - hobotcv cost time) / opencv cost time = 0.342439\nFrom the above comparison, the mean filtering performance is improved by 34% after acceleration by hobot_cv."}),"\n",(0,t.jsx)(n.p,{children:"error sum:8.43744e+06,max:1,mean_error:0.430833 // The total error of mean filtering for a single image is: 8.43744e+06, the maximum error of a single pixel is: 1, and the average error is: 0.430833\nMean filtering average error = sum / (width x height) = 8.43744e+06 / (320 x 240)"}),"\n",(0,t.jsx)(n.h4,{id:"comparison-of-hobot_cv-and-opencv-processing-performance",children:"Comparison of hobot_cv and opencv processing performance"}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"Interface Type"}),(0,t.jsx)(n.th,{children:"Kernel"}),(0,t.jsx)(n.th,{children:"Time Consumption (ms)"}),(0,t.jsx)(n.th,{children:"CPU Usage (%)"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Hobotcv mean"}),(0,t.jsx)(n.td,{children:"Size(3,3)"}),(0,t.jsx)(n.td,{children:"0.466397"}),(0,t.jsx)(n.td,{children:"31.8"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Opencv mean"}),(0,t.jsx)(n.td,{children:"Size(3,3)"}),(0,t.jsx)(n.td,{children:"0.676677"}),(0,t.jsx)(n.td,{children:"40.2"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Hobotcv mean"}),(0,t.jsx)(n.td,{children:"Size(5,5)"}),(0,t.jsx)(n.td,{children:"0.737171"}),(0,t.jsx)(n.td,{children:"47.7"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Opencv mean"}),(0,t.jsx)(n.td,{children:"Size(5,5)"}),(0,t.jsx)(n.td,{children:"0.798177"}),(0,t.jsx)(n.td,{children:"52.9"})]})]})]}),"\n",(0,t.jsx)(n.h2,{id:"crop",children:"crop"}),"\n",(0,t.jsx)(n.h3,{id:"introduction-2",children:"Introduction"}),"\n",(0,t.jsx)(n.p,{children:"Implement the image cropping function, currently only supports NV12 format."}),"\n",(0,t.jsxs)(n.p,{children:["Code repository:  (",(0,t.jsx)(n.a,{href:"https://github.com/D-Robotics/hobot_cv",children:"https://github.com/D-Robotics/hobot_cv"}),")"]}),"\n",(0,t.jsx)(n.h3,{id:"platform-support",children:"Platform Support"}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"Platform"}),(0,t.jsx)(n.th,{children:"System"}),(0,t.jsx)(n.th,{children:"Function"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"RDK X3, RDK X3 Module"}),(0,t.jsx)(n.td,{children:"Ubuntu 20.04 (Foxy), Ubuntu 22.04 (Humble)"}),(0,t.jsx)(n.td,{children:"Read an image and crop it"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"RDK X5, RDK X5 Module"}),(0,t.jsx)(n.td,{children:"Ubuntu 22.04 (Humble)"}),(0,t.jsx)(n.td,{children:"Read an image and crop it"})]})]})]}),"\n",(0,t.jsx)(n.h3,{id:"preparation-2",children:"Preparation"}),"\n",(0,t.jsx)(n.h4,{id:"rdk-platform",children:"RDK Platform"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"RDK has already burned D-Robotics's provided  Ubuntu 20.04/22.04 system image."}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"RDK has successfully installed TogetheROS.Bot."}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"instruction",children:"Instruction"}),"\n",(0,t.jsx)(n.h4,{id:"rdk-4",children:"RDK"}),"\n",(0,t.jsxs)(l.A,{groupId:"tros-distro",children:[(0,t.jsx)(o.A,{value:"foxy",label:"Foxy",children:(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"# Configure the tros.b environment\nsource /opt/tros/setup.bash\n"})})}),(0,t.jsx)(o.A,{value:"humble",label:"Humble",children:(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"# Configure the tros.b environment\nsource /opt/tros/humble/setup.bash\n"})})})]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-shell",children:"# Copy the required models and configuration files from the installation path of tros.b.\ncp -r /opt/tros/${TROS_DISTRO}/lib/hobot_cv/config/ .\n\n# Launch the launch file\nros2 launch hobot_cv hobot_cv_crop.launch.py\n"})}),"\n",(0,t.jsx)(n.h3,{id:"result-analysis-2",children:"Result Analysis"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-text",children:"[INFO] [launch]: Default logging verbosity is set to INFO\n[INFO] [crop_example-1]: process started with pid [3064]\n[crop_example-1] [INFO] [1655951627.255477663] [example]: crop image to 960x540 pixels, time cost: 1 ms\n[crop_example-1] [INFO] [1655951627.336889080] [example]: crop image to 960x540 pixels, time cost: 1 ms[INFO] [crop_example-1]: process has finished cleanly [pid 3064]\n"})}),"\n",(0,t.jsx)(n.p,{children:"According to the log, the test program has finished processing the local 1920x1080 resolution image crop, and the time consumed is as follows:"}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"Image Processing"}),(0,t.jsx)(n.th,{children:"Runtime"})]})}),(0,t.jsx)(n.tbody,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Crop 1920x1080 to 960x540"}),(0,t.jsx)(n.td,{children:"1ms"})]})})]}),"\n",(0,t.jsx)(n.p,{children:"The original image is 1920x1080, and the top left corner of the image is cropped to a 960x540 region. The resulting image is shown below:"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{src:"https://rdk-doc.oss-cn-beijing.aliyuncs.com/doc/img/05_Robot_development/02_quick_demo/image/demo_cv/ori-crop.png",alt:""})}),"\n",(0,t.jsx)(n.h2,{id:"resize",children:"Resize"}),"\n",(0,t.jsx)(n.h3,{id:"introduction-3",children:"Introduction"}),"\n",(0,t.jsx)(n.p,{children:"Implement image scaling function, currently only supports NV12 format."}),"\n",(0,t.jsxs)(n.p,{children:["Code repository:  (",(0,t.jsx)(n.a,{href:"https://github.com/D-Robotics/hobot_cv",children:"https://github.com/D-Robotics/hobot_cv"}),")"]}),"\n",(0,t.jsx)(n.h3,{id:"platform-support-1",children:"Platform Support"}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"Platform"}),(0,t.jsx)(n.th,{children:"System"}),(0,t.jsx)(n.th,{children:"Function"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"RDK X3, RDK X3 Module"}),(0,t.jsx)(n.td,{children:"Ubuntu 20.04 (Foxy), Ubuntu 22.04 (Humble)"}),(0,t.jsx)(n.td,{children:"Read image and resize"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"RDK X5, RDK X5 Module, RDK S100"}),(0,t.jsx)(n.td,{children:"Ubuntu 22.04 (Humble)"}),(0,t.jsx)(n.td,{children:"Read image and resize"})]})]})]}),"\n",(0,t.jsx)(n.h3,{id:"preparation-3",children:"Preparation"}),"\n",(0,t.jsx)(n.h4,{id:"rdk-5",children:"RDK"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"The RDK has been burned with the  Ubuntu 20.04/22.04 system image provided by D-Robotics."}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"TogetheROS.Bot has been successfully installed on the RDK."}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"usage-1",children:"Usage"}),"\n",(0,t.jsx)(n.h4,{id:"rdk-6",children:"RDK"}),"\n",(0,t.jsxs)(l.A,{groupId:"tros-distro",children:[(0,t.jsx)(o.A,{value:"foxy",label:"Foxy",children:(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"# Configure the tros.b environment\nsource /opt/tros/setup.bash\n"})})}),(0,t.jsx)(o.A,{value:"humble",label:"Humble",children:(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"# Configure the tros.b environment\nsource /opt/tros/humble/setup.bash\n"})})})]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-shell",children:"# Copy the required models and configuration files from the TogetheROS installation path.\ncp -r /opt/tros/${TROS_DISTRO}/lib/hobot_cv/config/ .\n\n# Launch the file \nros2 launch hobot_cv hobot_cv_resize.launch.py\n"})}),"\n",(0,t.jsx)(n.h3,{id:"result-analysis-3",children:"Result Analysis"}),"\n",(0,t.jsx)(n.h4,{id:"rdk-7",children:"RDK"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-shell",children:"[INFO] [launch]: Default logging verbosity is set to INFO\n[INFO] [resize_example-1]: process started with pid [3083]\n[resize_example-1] [INFO] [1655951649.930987924] [example]:\n[resize_example-1] source image config/test.jpg is 1920x1080 pixels\n[resize_example-1] [INFO] [1655951649.931155799] [example]: resize image to 960x540 pixels, time cost: 297 ms\n[resize_example-1] [INFO] [1655951650.039223757] [example]: resize image to 960x540 pixels, time cost: 15 ms\n[INFO] [resize_example-1]: process has finished cleanly [pid 3083]\n"})}),"\n",(0,t.jsx)(n.p,{children:"According to the log, the test program has completed the resize processing of a local 1920x1080 resolution image. The interface is called twice, and the time costs for each run are as follows."}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"Image Processing"}),(0,t.jsx)(n.th,{children:"Time Cost for First Run"}),(0,t.jsx)(n.th,{children:"Time Cost for Second Run"})]})}),(0,t.jsx)(n.tbody,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"1920x1080 resized to 960x540"}),(0,t.jsx)(n.td,{children:"297 ms"}),(0,t.jsx)(n.td,{children:"15 ms"})]})})]}),"\n",(0,t.jsx)(n.p,{children:"The first run requires configuration of the hardware, so it takes more time. If there are no changes to the hardware configuration properties and the hardware directly processes the image, the time cost will be significantly reduced."}),"\n",(0,t.jsx)(n.p,{children:"The original image (1920x1080) and the resized image (960x540) are shown below:"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{src:"https://rdk-doc.oss-cn-beijing.aliyuncs.com/doc/img/05_Robot_development/02_quick_demo/image/demo_cv/ori-resize.png",alt:""})}),"\n",(0,t.jsx)(n.h4,{id:"rdk-performance-comparison",children:"RDK performance comparison"}),"\n",(0,t.jsxs)(n.p,{children:["Use the ",(0,t.jsx)(n.code,{children:"top"})," command to check CPU usage, which represents the CPU percentage used by the test process.\nThe time cost is in milliseconds, and the average value is taken after looping 1000 times.\nCPU frequency is locked during testing:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-shell",children:"sudo bash -c 'echo performance > /sys/devices/system/cpu/cpufreq/policy0/scaling_governor'\n"})}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"src wxh"}),(0,t.jsx)(n.th,{children:"dst wxh"}),(0,t.jsxs)(n.th,{children:["Configuration of",(0,t.jsx)("br",{})," Hardware Cost"]}),(0,t.jsxs)(n.th,{children:["Configuration of ",(0,t.jsx)("br",{}),"Hardware CPU Usage"]}),(0,t.jsx)(n.th,{children:"BPU Time Cost"}),(0,t.jsxs)(n.th,{children:["BPU Interface",(0,t.jsx)("br",{}),"CPU Usage"]}),(0,t.jsx)(n.th,{children:"OpenCV Time Cost"}),(0,t.jsxs)(n.th,{children:["OpenCV Processing",(0,t.jsx)("br",{}),"CPU Usage"]})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"512x512"}),(0,t.jsx)(n.td,{children:"128x128"}),(0,t.jsx)(n.td,{children:"1.53789"}),(0,t.jsx)(n.td,{children:"25.9"}),(0,t.jsx)(n.td,{children:"1.11054"}),(0,t.jsx)(n.td,{children:"89"}),(0,t.jsx)(n.td,{children:"1.71119"}),(0,t.jsx)(n.td,{children:"100.3"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"640x640"}),(0,t.jsx)(n.td,{children:"320x320"}),(0,t.jsx)(n.td,{children:"2.48536"}),(0,t.jsx)(n.td,{children:"28.5"}),(0,t.jsx)(n.td,{children:"1.82232"}),(0,t.jsx)(n.td,{children:"88"}),(0,t.jsx)(n.td,{children:"1.82384"}),(0,t.jsx)(n.td,{children:"338.9"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"896x896"}),(0,t.jsx)(n.td,{children:"384x384"}),(0,t.jsx)(n.td,{children:"4.54422"}),(0,t.jsx)(n.td,{children:"24.6"}),(0,t.jsx)(n.td,{children:"2.81954"}),(0,t.jsx)(n.td,{children:"79.7"}),(0,t.jsx)(n.td,{children:"7.84396"}),(0,t.jsx)(n.td,{children:"273.1"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"1024x1024"}),(0,t.jsx)(n.td,{children:"512x512"}),(0,t.jsx)(n.td,{children:"6.01103"}),(0,t.jsx)(n.td,{children:"25.2"}),(0,t.jsx)(n.td,{children:"3.89325"}),(0,t.jsx)(n.td,{children:"81.7"}),(0,t.jsx)(n.td,{children:"2.55761"}),(0,t.jsx)(n.td,{children:"381.7"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"1920x1088"}),(0,t.jsx)(n.td,{children:"512x512"}),(0,t.jsx)(n.td,{children:"11.0406"}),(0,t.jsx)(n.td,{children:"20.6"}),(0,t.jsx)(n.td,{children:"5.8513"}),(0,t.jsx)(n.td,{children:"71.1"}),(0,t.jsx)(n.td,{children:"8.19324"}),(0,t.jsx)(n.td,{children:"380.1"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"1920x1080"}),(0,t.jsx)(n.td,{children:"960x544"}),(0,t.jsx)(n.td,{children:"11.1562"}),(0,t.jsx)(n.td,{children:"22.3"}),(0,t.jsx)(n.td,{children:"7.09085"}),(0,t.jsx)(n.td,{children:"77.7"}),(0,t.jsx)(n.td,{children:"15.2978"}),(0,t.jsx)(n.td,{children:"382.4"})]})]})]}),"\n",(0,t.jsx)(n.h2,{id:"rotate",children:"rotate"}),"\n",(0,t.jsx)(n.h3,{id:"introduction-4",children:"Introduction"}),"\n",(0,t.jsx)(n.p,{children:"The rotate function implements image rotation, currently only supporting images in NV12 format. The supported rotation angles are 90, 180, and 270."}),"\n",(0,t.jsxs)(n.p,{children:["Code repository:  (",(0,t.jsx)(n.a,{href:"https://github.com/D-Robotics/hobot_cv",children:"https://github.com/D-Robotics/hobot_cv"}),")"]}),"\n",(0,t.jsx)(n.h3,{id:"supported-platforms-2",children:"Supported Platforms"}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"Platform"}),(0,t.jsx)(n.th,{children:"System"}),(0,t.jsx)(n.th,{children:"Function"})]})}),(0,t.jsx)(n.tbody,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"RDK X3, RDK X3 Module"}),(0,t.jsx)(n.td,{children:"Ubuntu 20.04 (Foxy), Ubuntu 22.04 (Humble)"}),(0,t.jsx)(n.td,{children:"Read and rotate images"})]})})]}),"\n",(0,t.jsx)(n.h3,{id:"preparation-4",children:"Preparation"}),"\n",(0,t.jsx)(n.h4,{id:"rdk-platform-1",children:"RDK Platform"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"RDK has been flashed with the  Ubuntu 20.04/22.04 system image provided by the D-Robotics team."}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"The TogetheROS.Bot has been successfully installed on the RDK."}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"user-guide",children:"User Guide"}),"\n",(0,t.jsx)(n.h4,{id:"rdk-8",children:"RDK"}),"\n",(0,t.jsxs)(l.A,{groupId:"tros-distro",children:[(0,t.jsx)(o.A,{value:"foxy",label:"Foxy",children:(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"source /opt/tros/setup.bash\n"})})}),(0,t.jsx)(o.A,{value:"humble",label:"Humble",children:(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"source /opt/tros/humble/setup.bash\n"})})})]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-shell",children:"# Copy the required models and configuration files from the installation path of tros.b.\ncp -r /opt/tros/${TROS_DISTRO}/lib/hobot_cv/config/ .\n\n# Launch the launch file\nros2 launch hobot_cv hobot_cv_rotate.launch.py\n"})}),"\n",(0,t.jsx)(n.h3,{id:"result-analysis-4",children:"Result Analysis"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-shell",children:"[INFO] [launch]: Default logging verbosity is set to INFO\n[INFO] [rotate_example-1]: process started with pid [3096]\n[rotate_example-1] [INFO] [1655951661.173422471] [example]: rotate image 180 , time cost: 415 ms\n[rotate_example-1]\n[rotate_example-1] [INFO] [1655951661.416188013] [example]: second rotate image 180 , time cost: 40 ms\n[rotate_example-1]\n[INFO] [rotate_example-1]: process has finished cleanly [pid 3096]\n"})}),"\n",(0,t.jsx)(n.p,{children:"According to the log, the test program has completed the rotation of a local image with a resolution of 1920x1080. The interface was called twice, and the time taken for each rotation is as follows."}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"Image Processing"}),(0,t.jsx)(n.th,{children:"First Run Time"}),(0,t.jsx)(n.th,{children:"Second Run Time"})]})}),(0,t.jsx)(n.tbody,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"1920x1080 Rotate 180 degrees"}),(0,t.jsx)(n.td,{children:"415ms"}),(0,t.jsx)(n.td,{children:"40ms"})]})})]}),"\n",(0,t.jsx)(n.p,{children:"The first run takes longer because the hardware needs to be configured. If there are no further changes to the hardware configuration, the hardware will process the images directly and the processing time will be significantly reduced."}),"\n",(0,t.jsx)(n.p,{children:"The original image size is 1920x1080, and the size after rotation is also 1920x1080:"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{src:"https://rdk-doc.oss-cn-beijing.aliyuncs.com/doc/img/05_Robot_development/03_boxs/segmentation/image/yolov8_seg/test.jpg",alt:"Original Image"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{src:"https://rdk-doc.oss-cn-beijing.aliyuncs.com/doc/img/05_Robot_development/02_quick_demo/image/demo_cv/rotate.jpg",alt:"Rotated Image"})}),"\n",(0,t.jsx)(n.h4,{id:"performance-comparison-of-hobot_cv-and-opencv",children:"Performance comparison of hobot_cv and OpenCV"}),"\n",(0,t.jsx)(n.p,{children:"CPU usage is measured using the top command and represents the percentage of CPU usage by the test process.\nThe processing time is measured in milliseconds, with an average value taken from 1000 iterations.\nTo ensure stable performance, the CPU frequency is locked during the test:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-shell",children:"sudo bash -c 'echo performance > /sys/devices/system/cpu/cpufreq/policy0/scaling_governor'\n"})}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"src wxh"}),(0,t.jsx)(n.th,{children:"Rotation"}),(0,t.jsx)(n.th,{children:"hobot_cv Time"}),(0,t.jsx)(n.th,{children:"hobot_cv CPU Usage"}),(0,t.jsx)(n.th,{children:"OpenCV Time"}),(0,t.jsx)(n.th,{children:"OpenCV CPU Usage"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"1920x1080"}),(0,t.jsx)(n.td,{children:"90 degrees"}),(0,t.jsx)(n.td,{children:"37.6568ms"}),(0,t.jsx)(n.td,{children:"61.6"}),(0,t.jsx)(n.td,{children:"55.8886ms"}),(0,t.jsx)(n.td,{children:"100.0"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"640x640"}),(0,t.jsx)(n.td,{children:"180 degrees"}),(0,t.jsx)(n.td,{children:"7.3133ms"}),(0,t.jsx)(n.td,{children:"66.8"}),(0,t.jsx)(n.td,{children:"5.1806ms"}),(0,t.jsx)(n.td,{children:"100.0"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"896x896"}),(0,t.jsx)(n.td,{children:"270 degrees"}),(0,t.jsx)(n.td,{children:"14.7723ms"}),(0,t.jsx)(n.td,{children:"62.5"}),(0,t.jsx)(n.td,{children:"13.6497ms"}),(0,t.jsx)(n.td,{children:"100.0"})]})]})]}),"\n",(0,t.jsx)(n.h2,{id:"pyramid",children:"Pyramid"}),"\n",(0,t.jsx)(n.h3,{id:"introduction-5",children:"Introduction"}),"\n",(0,t.jsx)(n.p,{children:"This function implements image pyramid scaling and currently supports NV12 format."}),"\n",(0,t.jsxs)(n.p,{children:["Code repository:  (",(0,t.jsx)(n.a,{href:"https://github.com/D-Robotics/hobot_cv",children:"https://github.com/D-Robotics/hobot_cv"}),")"]}),"\n",(0,t.jsx)(n.h3,{id:"supported-platforms-3",children:"Supported Platforms"}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"Platform"}),(0,t.jsx)(n.th,{children:"System"}),(0,t.jsx)(n.th,{children:"Function"})]})}),(0,t.jsx)(n.tbody,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"RDK X3, RDK X3 Module"}),(0,t.jsx)(n.td,{children:"Ubuntu 20.04 (Foxy), Ubuntu 22.04 (Humble)"}),(0,t.jsx)(n.td,{children:"Read image and perform image pyramid scaling"})]})})]}),"\n",(0,t.jsx)(n.h3,{id:"preparation-5",children:"Preparation"}),"\n",(0,t.jsx)(n.h4,{id:"rdk-platform-2",children:"RDK Platform"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"The RDK is pre-loaded with  Ubuntu 20.04/22.04 system image."}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"TogetheROS.Bot has been successfully installed on the RDK."}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.h4,{id:"rdk-9",children:"RDK"}),"\n",(0,t.jsxs)(l.A,{groupId:"tros-distro",children:[(0,t.jsx)(o.A,{value:"foxy",label:"Foxy",children:(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"source /opt/tros/setup.bash\n"})})}),(0,t.jsx)(o.A,{value:"humble",label:"Humble",children:(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"source /opt/tros/humble/setup.bash\n"})})})]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-shell",children:"# Copy the necessary models and configuration files for running the example from the installation path of tros.b\ncp -r /opt/tros/${TROS_DISTRO}/lib/hobot_cv/config/ .\n\n# Launch the launch file\nros2 launch hobot_cv hobot_cv_pyramid.launch.py\n"})}),"\n",(0,t.jsx)(n.h3,{id:"result-analysis-5",children:"Result Analysis"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-shell",children:"[INFO] [launch]: Default logging verbosity is set to INFO\n[INFO] [pyramid_example-1]: process started with pid [3071]\n[pyramid_example-1] [INFO] [1655951639.110992960] [example]: pyramid image , time cost: 299 ms\n[pyramid_example-1]\n[pyramid_example-1] [INFO] [1655951639.432398919] [example]: pyramid image , time cost: 19 ms\n[pyramid_example-1]\n[INFO] [pyramid_example-1]: process has finished cleanly [pid 3071]\n"})}),"\n",(0,t.jsx)(n.p,{children:"According to the log, the test program has completed the pyramid scaling process for a local image with a resolution of 1920x1080. The interface is called twice, with the following time costs for each run."}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"Image Processing"}),(0,t.jsx)(n.th,{children:"Time Cost for First Run"}),(0,t.jsx)(n.th,{children:"Time Cost for Second Run"})]})}),(0,t.jsx)(n.tbody,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"1920x1080 six-layer base layer output"}),(0,t.jsx)(n.td,{children:"299ms"}),(0,t.jsx)(n.td,{children:"19ms"})]})})]}),"\n",(0,t.jsx)(n.p,{children:"Because the first run requires hardware configuration, it takes more time. If the hardware configuration attributes are not changed and the hardware is used directly for processing, the time will be significantly reduced."}),"\n",(0,t.jsx)(n.p,{children:"The original 1920x1080 image and the pyramid-scaled image are as follows:"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{src:"https://rdk-doc.oss-cn-beijing.aliyuncs.com/doc/img/05_Robot_development/02_quick_demo/image/demo_cv/pym_ds.jpg",alt:""})}),"\n",(0,t.jsx)(n.p,{children:"Outputting six base layers, each layer's size is half of the previous layer's size."}),"\n",(0,t.jsx)(n.h4,{id:"performance-comparison",children:"Performance Comparison"}),"\n",(0,t.jsx)(n.p,{children:"With an input image of 1920x1080, we obtain output images with resolutions of 960x540, 480x270, 240x134, 120x66, 60x32 by generating 5 layers. We compare the efficiency between OpenCV and HobotCV, with the following results:"}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"HobotCV Cost"}),(0,t.jsx)(n.th,{children:"HobotCV CPU Usage"}),(0,t.jsx)(n.th,{children:"OpenCV Cost"}),(0,t.jsx)(n.th,{children:"OpenCV CPU Usage"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"19ms"}),(0,t.jsx)(n.td,{children:"42.5"}),(0,t.jsx)(n.td,{children:"56"}),(0,t.jsx)(n.td,{children:"100"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"19ms"}),(0,t.jsx)(n.td,{children:"42.5"}),(0,t.jsx)(n.td,{children:"56"}),(0,t.jsx)(n.td,{children:"100"})]})]})]}),"\n",(0,t.jsx)(n.p,{children:"CPU usage as a percentage (single-core), and time statistics in ms."}),"\n",(0,t.jsx)(n.h2,{id:"color",children:"Color"}),"\n",(0,t.jsx)(n.h3,{id:"introduction-6",children:"Introduction"}),"\n",(0,t.jsx)(n.p,{children:"Color Space Conversion between NV12 and BGR24."}),"\n",(0,t.jsxs)(n.p,{children:["Code repository:  (",(0,t.jsx)(n.a,{href:"https://github.com/D-Robotics/hobot_cv",children:"https://github.com/D-Robotics/hobot_cv"}),")"]}),"\n",(0,t.jsx)(n.h3,{id:"platform-support-2",children:"Platform Support"}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"Platform"}),(0,t.jsx)(n.th,{children:"System"}),(0,t.jsx)(n.th,{children:"Function"})]})}),(0,t.jsx)(n.tbody,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"RDK X5, RDK X5 Module, RDK S100"}),(0,t.jsx)(n.td,{children:"Ubuntu 22.04 (Humble)"}),(0,t.jsx)(n.td,{children:"Read image and resize"})]})})]}),"\n",(0,t.jsx)(n.h3,{id:"preparation-6",children:"Preparation"}),"\n",(0,t.jsx)(n.h4,{id:"rdk-10",children:"RDK"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"The RDK has been burned with the  Ubuntu 22.04 system image provided by D-Robotics."}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"TogetheROS.Bot has been successfully installed on the RDK."}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"usage-2",children:"Usage"}),"\n",(0,t.jsx)(n.h4,{id:"rdk-11",children:"RDK"}),"\n",(0,t.jsx)(l.A,{groupId:"tros-distro",children:(0,t.jsx)(o.A,{value:"humble",label:"Humble",children:(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"# Configure the tros.b environment\nsource /opt/tros/humble/setup.bash\n"})})})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-shell",children:"# Copy the required models and configuration files from the TogetheROS installation path.\ncp -r /opt/tros/${TROS_DISTRO}/lib/hobot_cv/config/ .\n\n# Launch the file \nros2 launch hobot_cv hobot_cv_conversion.launch.py\n"})}),"\n",(0,t.jsx)(n.h3,{id:"result-analysis-6",children:"Result Analysis"}),"\n",(0,t.jsx)(n.h4,{id:"rdk-12",children:"RDK"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-shell",children:"[INFO] [launch]: All log files can be found below /root/.ros/log/2025-03-25-14-50-55-535138-ubuntu-4139\n[INFO] [launch]: Default logging verbosity is set to INFO\n[INFO] [test_conersion-1]: process started with pid [4140]\n[test_conersion-1] [INFO] [1742885455.683144151] [hobot_cv]: bgr24_to_nv12 opencv time cost: 4 ms\n[test_conersion-1] [INFO] [1742885455.685469463] [hobot_cv]: nv12_to_bgr24 neon 1 time cost: 2 ms\n[test_conersion-1] [INFO] [1742885455.836798125] [hobot_cv]: nv12_to_bgr24 neon 2 time cost: 2 ms\n[test_conersion-1] [INFO] [1742885455.992973665] [hobot_cv]: bgr24_to_nv12 neon 1 time cost: 1 ms\n[test_conersion-1] [INFO] [1742885455.997803043] [hobot_cv]: nv12_to_bgr24 opencv time cost: 4 ms\n[test_conersion-1] [INFO] [1742885456.156813423] [hobot_cv]: bgr24_to_nv12 neon 2 time cost: 1 ms\n[test_conersion-1] [INFO] [1742885456.161413872] [hobot_cv]: nv12_to_bgr24 opencv time cost: 4 ms\n[INFO] [test_conersion-1]: process has finished cleanly [pid 4140]\n"})})]})}function x(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(u,{...e})}):u(e)}}}]);