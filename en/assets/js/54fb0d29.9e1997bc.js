"use strict";(self.webpackChunkrdk_doc=self.webpackChunkrdk_doc||[]).push([[58191],{28453:(e,n,s)=>{s.d(n,{R:()=>c,x:()=>o});var t=s(96540);const r={},i=t.createContext(r);function c(e){const n=t.useContext(i);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:c(e.components),t.createElement(i.Provider,{value:n},e.children)}},57621:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>l,contentTitle:()=>o,default:()=>h,frontMatter:()=>c,metadata:()=>t,toc:()=>d});const t=JSON.parse('{"id":"Advanced_development/linux_development/hardware_unit_test/ethernet_performance","title":"Ethernet Performance Testing","description":"This chapter aims to guide you on how to perform Ethernet performance testing using the iperf3 tool. You can refer to iperf3 for detailed usage instructions of this command.","source":"@site/i18n/en/docusaurus-plugin-content-docs-docs_s/current/07_Advanced_development/02_linux_development/05_hardware_unit_test/06-ethernet_performance.md","sourceDirName":"07_Advanced_development/02_linux_development/05_hardware_unit_test","slug":"/Advanced_development/linux_development/hardware_unit_test/ethernet_performance","permalink":"/rdk_doc/en/rdk_s/Advanced_development/linux_development/hardware_unit_test/ethernet_performance","draft":false,"unlisted":false,"tags":[],"version":"current","lastUpdatedAt":1764174115000,"sidebarPosition":6,"frontMatter":{"sidebar_position":6},"sidebar":"tutorialSidebar","previous":{"title":"Wi-Fi Performance Testing","permalink":"/rdk_doc/en/rdk_s/Advanced_development/linux_development/hardware_unit_test/wifi_performance"},"next":{"title":"CPU Performance Testing","permalink":"/rdk_doc/en/rdk_s/Advanced_development/linux_development/hardware_unit_test/cpu_performance"}}');var r=s(74848),i=s(28453);const c={sidebar_position:6},o="Ethernet Performance Testing",l={},d=[{value:"Testing Principle",id:"testing-principle",level:2},{value:"Preparation",id:"preparation",level:2},{value:"Example Configuration",id:"example-configuration",level:3},{value:"Testing Procedure",id:"testing-procedure",level:2},{value:"Step 1: Start the Server",id:"step-1-start-the-server",level:3},{value:"Step 2: Start the Client",id:"step-2-start-the-client",level:3},{value:"Test Criteria",id:"test-criteria",level:2},{value:"Test Results",id:"test-results",level:3},{value:"Common Issues",id:"common-issues",level:2},{value:"1. Why can&#39;t the <code>iperf3</code> client connect to the server?",id:"1-why-cant-the-iperf3-client-connect-to-the-server",level:3},{value:"2. Why is the measured bandwidth lower than expected?",id:"2-why-is-the-measured-bandwidth-lower-than-expected",level:3},{value:"3. Why is there a high packet loss rate during testing?",id:"3-why-is-there-a-high-packet-loss-rate-during-testing",level:3},{value:"4. How to resolve the \u201cAddress already in use\u201d error when running <code>iperf3</code>?",id:"4-how-to-resolve-the-address-already-in-use-error-when-running-iperf3",level:3}];function a(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"ethernet-performance-testing",children:"Ethernet Performance Testing"})}),"\n",(0,r.jsxs)(n.p,{children:["This chapter aims to guide you on how to perform Ethernet performance testing using the ",(0,r.jsx)(n.code,{children:"iperf3"})," tool. You can refer to ",(0,r.jsx)(n.a,{href:"https://iperf.fr/iperf-doc.php#3docd",children:"iperf3"})," for detailed usage instructions of this command."]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Key Focus Areas for Ethernet Performance Testing:"})}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Bandwidth and Throughput:"})," Test the actual available bandwidth of the Ethernet connection to evaluate its performance under high load."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Latency:"})," Assess the transmission delay over the Ethernet network. Increased latency under high load may negatively impact real-time applications."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Packet Loss Rate:"})," Measure the rate at which data packets are lost during transmission to evaluate network stability. Excessive packet loss compromises data integrity."]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"testing-principle",children:"Testing Principle"}),"\n",(0,r.jsx)(n.p,{children:"Ethernet performance testing relies on data transmission between a client and a server. The underlying principle is as follows:"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Server Side:"})," ",(0,r.jsx)(n.code,{children:"iperf3"})," listens on a specified port, waiting for client connections. The server calculates actual bandwidth and throughput by recording the amount of received data and the time interval."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Client Side:"})," The client actively connects to the server and sends data packets at a specified rate and interval to simulate network traffic load."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Statistics Collection:"})," During the test, ",(0,r.jsx)(n.code,{children:"iperf3"})," records key metrics\u2014including bandwidth, latency, packet loss rate, and retransmission count\u2014to facilitate network performance analysis."]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"preparation",children:"Preparation"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{src:"http://rdk-doc.oss-cn-beijing.aliyuncs.com/doc/images_to_upload/Ethernet_usage_diagram-en.png",alt:"Ethernet_usage_diagram.png"})}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Select Connection Method:"})," Direct connection between ",(0,r.jsx)(n.code,{children:"development board"})," and ",(0,r.jsx)(n.code,{children:"PC"}),", or direct connection between two ",(0,r.jsx)(n.code,{children:"development boards"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Identify Server and Client:"})," The development board can act as either client or server; the peer device can be a personal computer (PC) or another development board."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Ensure Same Subnet:"})," Configure both devices with IP addresses in the same subnet."]}),"\n"]}),"\n",(0,r.jsx)("div",{class:"note",children:(0,r.jsxs)(n.p,{children:[(0,r.jsx)("strong",{children:"Note:"})," The test configurations described in this chapter are ",(0,r.jsx)("u",{children:"for reference only"}),". Users should adjust test settings according to their actual hardware setup."]})}),"\n",(0,r.jsx)(n.h3,{id:"example-configuration",children:"Example Configuration"}),"\n",(0,r.jsx)(n.p,{children:"In this test, the following configuration is used:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Connection Method:"})," Direct connection between ",(0,r.jsx)(n.code,{children:"development board"})," and ",(0,r.jsx)(n.code,{children:"PC"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Server (PC):"})," IP address ",(0,r.jsx)(n.code,{children:"192.168.127.195"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Client (Development Board):"})," IP address ",(0,r.jsx)(n.code,{children:"192.168.127.10"})]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"Execute the following command to test Ethernet connectivity between the PC and the development board:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"ping -I eth0 192.168.127.195\n"})}),"\n",(0,r.jsx)(n.p,{children:"Execution result:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"PING 192.168.127.195 (192.168.127.195) from 192.168.127.10 eth0: 56(84) bytes of data.\n64 bytes from 192.168.127.195: icmp_seq=1 ttl=128 time=1.54 ms\n64 bytes from 192.168.127.195: icmp_seq=2 ttl=128 time=1.28 ms\n64 bytes from 192.168.127.195: icmp_seq=3 ttl=128 time=1.57 ms\n64 bytes from 192.168.127.195: icmp_seq=4 ttl=128 time=1.40 ms\n"})}),"\n",(0,r.jsx)(n.h2,{id:"testing-procedure",children:"Testing Procedure"}),"\n",(0,r.jsx)(n.h3,{id:"step-1-start-the-server",children:"Step 1: Start the Server"}),"\n",(0,r.jsxs)(n.p,{children:["On the PC, use ",(0,r.jsx)(n.code,{children:"iperf3"})," to start the server. First, download and install the iperf3 package from the ",(0,r.jsx)(n.a,{href:"https://iperf.fr/iperf-download.php",children:"iperf official website"}),"."]}),"\n",(0,r.jsx)(n.p,{children:"On Windows, run the following command in the Command Prompt (cmd):"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"iperf3 -s -p 5002\n"})}),"\n",(0,r.jsx)(n.p,{children:"Startup log:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"-----------------------------------------------------------\nServer listening on 5002\n-----------------------------------------------------------\n"})}),"\n",(0,r.jsx)(n.p,{children:"Log after successful client connection:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"Accepted connection from 192.168.127.10, port 51592\n[  5] local 192.168.127.195 port 5002 connected to 192.168.127.10 port 51598\n[ ID] Interval           Transfer     Bitrate\n[  5]   0.00-1.00   sec   112 MBytes   937 Mbits/sec\n[  5]   1.00-2.01   sec   113 MBytes   940 Mbits/sec\n[  5]   2.01-3.01   sec   112 MBytes   941 Mbits/sec\n[  5]   3.01-4.01   sec   113 MBytes   942 Mbits/sec\n[  5]   4.01-5.01   sec   112 MBytes   941 Mbits/sec\n[  5]   5.01-6.01   sec   113 MBytes   942 Mbits/sec\n[  5]   6.01-7.01   sec   112 MBytes   942 Mbits/sec\n[  5]   7.01-8.01   sec   112 MBytes   941 Mbits/sec\n[  5]   8.01-9.00   sec   111 MBytes   941 Mbits/sec\n[  5]   8.01-9.00   sec   111 MBytes   941 Mbits/sec\n"})}),"\n",(0,r.jsx)(n.h3,{id:"step-2-start-the-client",children:"Step 2: Start the Client"}),"\n",(0,r.jsx)(n.p,{children:"On the development board, launch the iperf3 client, specifying the server's IP address and port number, then begin the test."}),"\n",(0,r.jsx)(n.p,{children:"Execute the command:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"iperf3 -c 192.168.127.195 -i 1 -t 600 -p 5002\n"})}),"\n",(0,r.jsx)(n.p,{children:"Command parameter explanation:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"-c"}),": Specifies the server's IP address."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"-i"}),": Interval (in seconds) between periodic bandwidth reports."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"-t"}),": Total test duration (in seconds)."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"-p"}),": Specifies the port number the server is listening on."]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"Execution log:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"Connecting to host 192.168.127.195, port 5002\n[  5] local 192.168.127.10 port 51598 connected to 192.168.127.195 port 5002\n[ ID] Interval           Transfer     Bitrate         Retr  Cwnd\n[  5]   0.00-1.00   sec   115 MBytes   965 Mbits/sec    0    381 KBytes\n[  5]   1.00-2.00   sec   113 MBytes   947 Mbits/sec    0    402 KBytes\n[  5]   2.00-3.00   sec   113 MBytes   949 Mbits/sec    0    402 KBytes\n[  5]   3.00-4.00   sec   113 MBytes   950 Mbits/sec    0    402 KBytes\n[  5]   4.00-5.00   sec   113 MBytes   949 Mbits/sec    0    402 KBytes\n[  5]   5.00-6.00   sec   114 MBytes   956 Mbits/sec    0    425 KBytes\n[  5]   6.00-7.00   sec   113 MBytes   947 Mbits/sec    0    492 KBytes\n[  5]   7.00-8.00   sec   114 MBytes   954 Mbits/sec    0    492 KBytes\n"})}),"\n",(0,r.jsx)(n.h2,{id:"test-criteria",children:"Test Criteria"}),"\n",(0,r.jsx)(n.h3,{id:"test-results",children:"Test Results"}),"\n",(0,r.jsxs)(n.p,{children:["Refer to ",(0,r.jsx)(n.a,{href:"https://iperf.fr/iperf-doc.php#3doc",children:"iperf3 \u2013 Test Result Analysis"})," for explanations of each field in the output."]}),"\n",(0,r.jsx)(n.p,{children:"To achieve optimal performance test results, ensure the following conditions:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"The client and server are directly connected via a high-quality Ethernet cable."}),"\n",(0,r.jsx)(n.li,{children:"Both client and server have successfully negotiated a 1000 Mbps (Gigabit) link speed."}),"\n",(0,r.jsx)(n.li,{children:"No other high-load tasks are running on either the client or server during the test."}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"Current performance metrics obtained from our testing (for reference only):"}),"\n",(0,r.jsxs)(n.p,{children:["Receive bandwidth: ",(0,r.jsx)(n.strong,{children:"949 Mbits/sec"})]}),"\n",(0,r.jsxs)(n.p,{children:["Transmit bandwidth: ",(0,r.jsx)(n.strong,{children:"950 Mbits/sec"})]}),"\n",(0,r.jsx)(n.h2,{id:"common-issues",children:"Common Issues"}),"\n",(0,r.jsxs)(n.h3,{id:"1-why-cant-the-iperf3-client-connect-to-the-server",children:["1. Why can't the ",(0,r.jsx)(n.code,{children:"iperf3"})," client connect to the server?"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Root Causes:"})}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:"The client and server are not on the same subnet, or IP addresses are misconfigured."}),"\n",(0,r.jsxs)(n.li,{children:["A firewall is blocking the port used by ",(0,r.jsx)(n.code,{children:"iperf3"}),"."]}),"\n",(0,r.jsx)(n.li,{children:"The server is not running correctly or is not listening on the specified port."}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Solutions:"})}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["Ensure the client and server IP addresses are in the same subnet and can communicate via ",(0,r.jsx)(n.code,{children:"ping"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:["Check firewall settings and allow traffic through the ",(0,r.jsx)(n.code,{children:"iperf3"})," port (e.g., ",(0,r.jsx)(n.code,{children:"5002"}),")."]}),"\n",(0,r.jsxs)(n.li,{children:["Confirm that the server has correctly executed the ",(0,r.jsx)(n.code,{children:"iperf3 -s"})," command and is actively listening."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"2-why-is-the-measured-bandwidth-lower-than-expected",children:"2. Why is the measured bandwidth lower than expected?"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Root Causes:"})}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:"Network hardware (e.g., NIC) does not support Gigabit speeds, or the link failed to negotiate to 1000 Mbps."}),"\n",(0,r.jsx)(n.li,{children:"The client or server is running other high-load tasks that impact performance."}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Solutions:"})}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:"Verify that the hardware supports Gigabit Ethernet; if necessary, force the NIC to negotiate at 1000 Mbps."}),"\n",(0,r.jsx)(n.li,{children:"Before testing, close any applications or processes on the client and server that may consume network or system resources."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"3-why-is-there-a-high-packet-loss-rate-during-testing",children:"3. Why is there a high packet loss rate during testing?"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Root Causes:"})}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:"Network interference or poor-quality Ethernet cables."}),"\n",(0,r.jsx)(n.li,{children:"Network configuration (e.g., buffer size) on the test devices is inadequate."}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Solutions:"})}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:"Use high-quality Ethernet cables and ensure stable, interference-free connections."}),"\n",(0,r.jsx)(n.li,{children:"Adjust network settings, such as increasing TCP buffer sizes:"}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"sysctl net.core.rmem_max # View maximum receive buffer size (rmem_max)\nsysctl net.core.wmem_max # View maximum send buffer size (wmem_max)\nsysctl -w net.core.rmem_max=2500000 # Set max receive buffer to 2,500,000 bytes\nsysctl -w net.core.wmem_max=2500000 # Set max send buffer to 2,500,000 bytes\n"})}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.h3,{id:"4-how-to-resolve-the-address-already-in-use-error-when-running-iperf3",children:["4. How to resolve the \u201cAddress already in use\u201d error when running ",(0,r.jsx)(n.code,{children:"iperf3"}),"?"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Root Cause:"}),"\nThis error typically occurs because the server port is already occupied, often by another ",(0,r.jsx)(n.code,{children:"iperf3"})," instance that hasn\u2019t been terminated."]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Solutions:"})}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["Ensure no other ",(0,r.jsx)(n.code,{children:"iperf3"})," server instance is running, or start the server on a different port:","\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"iperf3 -s -p <new_port_number>\n"})}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["Identify and terminate the process occupying the port:","\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"netstat -tuln | grep 5002\nkill <process_ID>\n"})}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)("div",{class:"note",children:(0,r.jsxs)(n.p,{children:[(0,r.jsx)("strong",{children:"Tip:"})," If the above methods do not resolve the issue, please refer to the ",(0,r.jsx)(n.a,{href:"https://iperf.fr/",children:"iperf3 official documentation"})," or relevant technical forums for further assistance."]})})]})}function h(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(a,{...e})}):a(e)}}}]);