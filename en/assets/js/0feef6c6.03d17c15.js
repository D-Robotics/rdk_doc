"use strict";(self.webpackChunkrdk_doc=self.webpackChunkrdk_doc||[]).push([[85956],{28453:(e,d,i)=>{i.d(d,{R:()=>s,x:()=>t});var n=i(96540);const r={},o=n.createContext(r);function s(e){const d=n.useContext(o);return n.useMemo(function(){return"function"==typeof e?e(d):{...d,...e}},[d,e])}function t(e){let d;return d=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:s(e.components),n.createElement(o.Provider,{value:d},e.children)}},49834:(e,d,i)=>{i.r(d),i.d(d,{assets:()=>l,contentTitle:()=>t,default:()=>a,frontMatter:()=>s,metadata:()=>n,toc:()=>c});const n=JSON.parse('{"id":"Advanced_development/linux_development/driver_development_s100/driver_pcie/s100x_pcie_sw_arch","title":"S100X PCIe Software Architecture and Module Partitioning","description":"Software Framework","source":"@site/i18n/en/docusaurus-plugin-content-docs-docs_s/current/07_Advanced_development/02_linux_development/04_driver_development_s100/13_driver_pcie/02_s100x_pcie_sw_arch.md","sourceDirName":"07_Advanced_development/02_linux_development/04_driver_development_s100/13_driver_pcie","slug":"/Advanced_development/linux_development/driver_development_s100/driver_pcie/s100x_pcie_sw_arch","permalink":"/rdk_doc/en/rdk_s/Advanced_development/linux_development/driver_development_s100/driver_pcie/s100x_pcie_sw_arch","draft":false,"unlisted":false,"tags":[],"version":"current","lastUpdatedAt":1770017089000,"sidebarPosition":2,"frontMatter":{"sidebar_position":2},"sidebar":"tutorialSidebar","previous":{"title":"S100X PCIe Hardware Specifications and Supported Topologies","permalink":"/rdk_doc/en/rdk_s/Advanced_development/linux_development/driver_development_s100/driver_pcie/s100x_pcie_hw_guide"},"next":{"title":"Configuration of S100X PCIe Module Functionality under the Kernel","permalink":"/rdk_doc/en/rdk_s/Advanced_development/linux_development/driver_development_s100/driver_pcie/s100x_pcie_sw_setup"}}');var r=i(74848),o=i(28453);const s={sidebar_position:2},t="S100X PCIe Software Architecture and Module Partitioning",l={},c=[{value:"Software Framework",id:"software-framework",level:2},{value:"Driver Module Description",id:"driver-module-description",level:2},{value:"PCIe Driver Loading/Unloading",id:"pcie-driver-loadingunloading",level:2},{value:"RC-side Loading",id:"rc-side-loading",level:3},{value:"EP-side Loading",id:"ep-side-loading",level:3},{value:"RC-side Unloading",id:"rc-side-unloading",level:3},{value:"EP-side Unloading",id:"ep-side-unloading",level:3},{value:"User-space Module Description",id:"user-space-module-description",level:2}];function h(e){const d={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,o.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(d.header,{children:(0,r.jsx)(d.h1,{id:"s100x-pcie-software-architecture-and-module-partitioning",children:"S100X PCIe Software Architecture and Module Partitioning"})}),"\n",(0,r.jsx)(d.h2,{id:"software-framework",children:"Software Framework"}),"\n",(0,r.jsx)(d.p,{children:"The PCIe software framework is divided into two parts: RC and EP:"}),"\n",(0,r.jsx)(d.p,{children:(0,r.jsx)(d.img,{src:"http://rdk-doc.oss-cn-beijing.aliyuncs.com/doc/img/07_Advanced_development/02_linux_development/driver_development_s100/pcie/sw_arch-en.jpg",alt:"S100X_PCIE_sw_arch"})}),"\n",(0,r.jsx)(d.h2,{id:"driver-module-description",children:"Driver Module Description"}),"\n",(0,r.jsx)(d.p,{children:"Driver-related source code is located under the hobot-drivers/pcie directory. Details of each module are as follows:"}),"\n",(0,r.jsxs)(d.table,{children:[(0,r.jsx)(d.thead,{children:(0,r.jsxs)(d.tr,{children:[(0,r.jsx)(d.th,{children:"side"}),(0,r.jsx)(d.th,{children:"component"}),(0,r.jsx)(d.th,{children:"output"}),(0,r.jsx)(d.th,{children:"Source file"})]})}),(0,r.jsxs)(d.tbody,{children:[(0,r.jsxs)(d.tr,{children:[(0,r.jsx)(d.td,{children:"both"}),(0,r.jsx)(d.td,{children:"S13E01C01 PCIe basic driver"}),(0,r.jsx)(d.td,{children:"hobot-pcie-common.ko"}),(0,r.jsx)(d.td,{children:"hobot-ep-dev/hobot-pcie-common/"})]}),(0,r.jsxs)(d.tr,{children:[(0,r.jsx)(d.td,{children:"both"}),(0,r.jsx)(d.td,{children:"S13E01C03 PCIe controller driver"}),(0,r.jsx)(d.td,{children:"hobot-pcie.ko"}),(0,r.jsx)(d.td,{children:"hobot.c"})]}),(0,r.jsxs)(d.tr,{children:[(0,r.jsx)(d.td,{children:"RC"}),(0,r.jsx)(d.td,{children:"S13E01C02 PCIe device manager"}),(0,r.jsx)(d.td,{children:"hobot-pcie-dev-manager.ko"}),(0,r.jsx)(d.td,{children:"hobot-ep-dev/hobot-pcie-dev-manager"})]}),(0,r.jsxs)(d.tr,{children:[(0,r.jsx)(d.td,{children:"RC"}),(0,r.jsx)(d.td,{children:"S13E01C04 PCIe RC controller driver"}),(0,r.jsx)(d.td,{children:"hobot-pcie-rc.ko"}),(0,r.jsx)(d.td,{children:"hobot-rc.c"})]}),(0,r.jsxs)(d.tr,{children:[(0,r.jsx)(d.td,{children:"RC"}),(0,r.jsx)(d.td,{children:"S13E01C10 PCIe hybrid device driver"}),(0,r.jsx)(d.td,{children:"hobot-pcie-ep-dev.ko"}),(0,r.jsx)(d.td,{children:"hobot-ep-dev/hobot-pcie-ep-dev"})]}),(0,r.jsxs)(d.tr,{children:[(0,r.jsx)(d.td,{children:"RC"}),(0,r.jsx)(d.td,{children:"S13E01C11 PCIe device wrapper"}),(0,r.jsx)(d.td,{}),(0,r.jsx)(d.td,{})]}),(0,r.jsxs)(d.tr,{children:[(0,r.jsx)(d.td,{children:"EP"}),(0,r.jsx)(d.td,{children:"S13E01C05 PCIe EP controller driver"}),(0,r.jsx)(d.td,{children:"hobot-pcie-ep.ko"}),(0,r.jsx)(d.td,{children:"hobot-ep.c"})]}),(0,r.jsxs)(d.tr,{children:[(0,r.jsx)(d.td,{children:"EP"}),(0,r.jsx)(d.td,{children:"S13E01C06 PCIe function wrapper"}),(0,r.jsx)(d.td,{children:"hobot-pcie-ep-fun.ko"}),(0,r.jsx)(d.td,{children:"hobot-ep-fun/"})]}),(0,r.jsxs)(d.tr,{children:[(0,r.jsx)(d.td,{children:"EP"}),(0,r.jsx)(d.td,{children:"S13E01C07 PCIe hybrid function driver"}),(0,r.jsx)(d.td,{}),(0,r.jsx)(d.td,{})]})]})]}),"\n",(0,r.jsx)(d.h2,{id:"pcie-driver-loadingunloading",children:"PCIe Driver Loading/Unloading"}),"\n",(0,r.jsx)(d.h3,{id:"rc-side-loading",children:"RC-side Loading"}),"\n",(0,r.jsx)(d.pre,{children:(0,r.jsx)(d.code,{className:"language-shell",children:"modprobe hobot-pcie\nmodprobe hobot-pcie-rc\nmodprobe hobot-pcie-ep-dev\nmodprobe hobot-pcie-dev-manager\n"})}),"\n",(0,r.jsx)(d.h3,{id:"ep-side-loading",children:"EP-side Loading"}),"\n",(0,r.jsx)(d.pre,{children:(0,r.jsx)(d.code,{className:"language-shell",children:"modprobe hobot-pcie\nmodprobe hobot-pcie-ep-fun\n"})}),"\n",(0,r.jsx)(d.h3,{id:"rc-side-unloading",children:"RC-side Unloading"}),"\n",(0,r.jsx)(d.pre,{children:(0,r.jsx)(d.code,{className:"language-shell",children:"rmmod hobot_pcie_dev_manager\nrmmod hobot_pcie_ep_dev\nrmmod hobot_pcie_rc\nrmmod hobot_pcie_common\nrmmod hobot_pcie\n"})}),"\n",(0,r.jsx)(d.h3,{id:"ep-side-unloading",children:"EP-side Unloading"}),"\n",(0,r.jsx)(d.pre,{children:(0,r.jsx)(d.code,{className:"language-shell",children:"rmmod hobot_pcie_ep_fun\nrmmod hobot_pcie_ep\nrmmod hobot_pcie_common\nrmmod hobot_pcie\n"})}),"\n",(0,r.jsx)(d.p,{children:"Notes:"}),"\n",(0,r.jsxs)(d.ol,{children:["\n",(0,r.jsx)(d.li,{children:"Before unloading drivers, ensure all PCIe applications have been terminated. Always unload RC drivers before EP drivers."}),"\n",(0,r.jsxs)(d.li,{children:["Before system sleep, follow this sequence:","\n",(0,r.jsxs)(d.ul,{children:["\n",(0,r.jsx)(d.li,{children:"Stop PCIe applications on both sides"}),"\n",(0,r.jsx)(d.li,{children:"Unload RC drivers"}),"\n",(0,r.jsx)(d.li,{children:"Unload EP drivers"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(d.li,{children:["After system wake-up, follow this sequence:","\n",(0,r.jsxs)(d.ul,{children:["\n",(0,r.jsx)(d.li,{children:"Load EP drivers"}),"\n",(0,r.jsx)(d.li,{children:"Load RC drivers"}),"\n",(0,r.jsx)(d.li,{children:"Start PCIe applications"}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(d.li,{children:"If PCIe link instability or a peer reboot causes a PCIe link down, reboot both RC and EP to ensure PCIe functionality and system stability."}),"\n",(0,r.jsx)(d.li,{children:"Do not load PCIe-related drivers when PCIe functionality is not in use."}),"\n",(0,r.jsxs)(d.li,{children:["Before system reboot, follow this sequence:","\n",(0,r.jsxs)(d.ul,{children:["\n",(0,r.jsx)(d.li,{children:"Stop PCIe applications on both sides"}),"\n",(0,r.jsx)(d.li,{children:"Unload RC drivers"}),"\n",(0,r.jsx)(d.li,{children:"Unload EP drivers"}),"\n",(0,r.jsx)(d.li,{children:"Reboot the RC system"}),"\n",(0,r.jsx)(d.li,{children:"Reboot the EP system"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(d.h2,{id:"user-space-module-description",children:"User-space Module Description"}),"\n",(0,r.jsx)(d.p,{children:"User-space related source code is located under the hbre directory. Details of each module are as follows:"}),"\n",(0,r.jsxs)(d.table,{children:[(0,r.jsx)(d.thead,{children:(0,r.jsxs)(d.tr,{children:[(0,r.jsx)(d.th,{children:"side"}),(0,r.jsx)(d.th,{children:"component"}),(0,r.jsx)(d.th,{children:"output"}),(0,r.jsx)(d.th,{children:"Source file"})]})}),(0,r.jsxs)(d.tbody,{children:[(0,r.jsxs)(d.tr,{children:[(0,r.jsx)(d.td,{children:"both"}),(0,r.jsx)(d.td,{children:"S13E01C15 PCIe user library"}),(0,r.jsx)(d.td,{children:"libhbpcie.so"}),(0,r.jsx)(d.td,{children:"libhbpcie/"})]}),(0,r.jsxs)(d.tr,{children:[(0,r.jsx)(d.td,{children:"both"}),(0,r.jsx)(d.td,{children:"S13E01C16 PCIe High Level API"}),(0,r.jsx)(d.td,{children:"libhbpciehl.so"}),(0,r.jsx)(d.td,{children:"libhbpciehl/"})]})]})]})]})}function a(e={}){const{wrapper:d}={...(0,o.R)(),...e.components};return d?(0,r.jsx)(d,{...e,children:(0,r.jsx)(h,{...e})}):h(e)}}}]);