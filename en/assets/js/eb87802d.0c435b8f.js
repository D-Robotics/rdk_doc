"use strict";(self.webpackChunkrdk_doc=self.webpackChunkrdk_doc||[]).push([[1795],{28453:(n,e,d)=>{d.d(e,{R:()=>i,x:()=>l});var r=d(96540);const s={},c=r.createContext(s);function i(n){const e=r.useContext(c);return r.useMemo(function(){return"function"==typeof n?n(e):{...e,...n}},[e,n])}function l(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(s):n.components||s:i(n.components),r.createElement(c.Provider,{value:e},n.children)}},61339:(n,e,d)=>{d.r(e),d.d(e,{assets:()=>o,contentTitle:()=>l,default:()=>h,frontMatter:()=>i,metadata:()=>r,toc:()=>a});const r=JSON.parse('{"id":"Advanced_development/linux_development/driver_development_s100/driver_audio","title":"\u97f3\u9891\u8c03\u8bd5\u6307\u5357","description":"\u672c\u7ae0\u4e3b\u8981\u662fS100 I2S\u7684\u57fa\u672c\u7279\u6027\uff0c\u8bed\u97f3\u57fa\u7840\u77e5\u8bc6\u4ee5\u53ca\u6dfb\u52a0codec\u3001\u8c03\u8bd5\u58f0\u5361\u7684\u8bf4\u660e","source":"@site/docs_s/07_Advanced_development/02_linux_development/04_driver_development_s100/11_driver_audio.md","sourceDirName":"07_Advanced_development/02_linux_development/04_driver_development_s100","slug":"/Advanced_development/linux_development/driver_development_s100/driver_audio","permalink":"/rdk_doc/en/rdk_s/Advanced_development/linux_development/driver_development_s100/driver_audio","draft":false,"unlisted":false,"tags":[],"version":"current","lastUpdatedAt":1761560299000,"sidebarPosition":11,"frontMatter":{"sidebar_position":11},"sidebar":"tutorialSidebar","previous":{"title":"\u4f4e\u529f\u8017\u6a21\u5f0f\u8c03\u8bd5\u6307\u5357","permalink":"/rdk_doc/en/rdk_s/Advanced_development/linux_development/driver_development_s100/driver_lowpower"},"next":{"title":"\u65f6\u95f4\u540c\u6b65\u65b9\u6848","permalink":"/rdk_doc/en/rdk_s/Advanced_development/linux_development/driver_development_s100/driver_timesync"}}');var s=d(74848),c=d(28453);const i={sidebar_position:11},l="\u97f3\u9891\u8c03\u8bd5\u6307\u5357",o={},a=[{value:"\u6982\u8ff0",id:"\u6982\u8ff0",level:2},{value:"\u97f3\u9891\u5f00\u53d1\u8bf4\u660e",id:"\u97f3\u9891\u5f00\u53d1\u8bf4\u660e",level:2},{value:"I2S\u53c2\u6570\u8bf4\u660e",id:"i2s\u53c2\u6570\u8bf4\u660e",level:3},{value:"\u65b0\u589eCodec\u8bf4\u660e",id:"\u65b0\u589ecodec\u8bf4\u660e",level:3},{value:"\u6dfb\u52a0codec driver",id:"\u6dfb\u52a0codec-driver",level:4},{value:"\u6dfb\u52a0\u7f16\u8bd1\u9009\u9879",id:"\u6dfb\u52a0\u7f16\u8bd1\u9009\u9879",level:4},{value:"\u4fee\u6539dts",id:"\u4fee\u6539dts",level:4},{value:"\u8c03\u8bd5\u8bf4\u660e",id:"\u8c03\u8bd5\u8bf4\u660e",level:2},{value:"\u58f0\u5361\u8c03\u8bd5",id:"\u58f0\u5361\u8c03\u8bd5",level:3},{value:"\u5e38\u7528\u8c03\u8bd5\u624b\u6bb5",id:"\u5e38\u7528\u8c03\u8bd5\u624b\u6bb5",level:3},{value:"\u8c03\u6574debug log\u7b49\u7ea7",id:"\u8c03\u6574debug-log\u7b49\u7ea7",level:4},{value:"ALSA profs\u8282\u70b9\u8bf4\u660e",id:"alsa-profs\u8282\u70b9\u8bf4\u660e",level:4},{value:"/proc/asound/cards",id:"procasoundcards",level:5},{value:"/proc/asound/pcm",id:"procasoundpcm",level:5},{value:"/proc/asound/cardX/pcmY[c, p]/*",id:"procasoundcardxpcmyc-p",level:5},{value:"info",id:"info",level:6},{value:"hw_params",id:"hw_params",level:6},{value:"sw_params",id:"sw_params",level:6},{value:"status",id:"status",level:6},{value:"xrun",id:"xrun",level:4},{value:"\u53ef\u80fd\u51fa\u73b0xrun\u7684\u573a\u666f",id:"\u53ef\u80fd\u51fa\u73b0xrun\u7684\u573a\u666f",level:5},{value:"\u5b9a\u4f4dxrun",id:"\u5b9a\u4f4dxrun",level:5},{value:"\u4fee\u590dxrun",id:"\u4fee\u590dxrun",level:5},{value:"\u901a\u7528\u95ee\u9898",id:"\u901a\u7528\u95ee\u9898",level:3},{value:"\u6253\u5f00\u8bbe\u5907\u8282\u70b9\u62a5\u9519",id:"\u6253\u5f00\u8bbe\u5907\u8282\u70b9\u62a5\u9519",level:4},{value:"\u5f55\u5236/\u64ad\u653e\u95ee\u9898",id:"\u5f55\u5236\u64ad\u653e\u95ee\u9898",level:5},{value:"\u97f3\u9891\u5b50\u677f\u4f7f\u7528\u8bf4\u660e",id:"\u97f3\u9891\u5b50\u677f\u4f7f\u7528\u8bf4\u660e",level:2},{value:"\u97f3\u9891\u5b50\u677f\u4ecb\u7ecd",id:"\u97f3\u9891\u5b50\u677f\u4ecb\u7ecd",level:3},{value:"\u97f3\u9891\u5b50\u677f\u4e0e\u5f00\u53d1\u677f\u8fde\u63a5",id:"\u97f3\u9891\u5b50\u677f\u4e0e\u5f00\u53d1\u677f\u8fde\u63a5",level:3}];function p(n){const e={admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",h5:"h5",h6:"h6",header:"header",img:"img",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,c.R)(),...n.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(e.header,{children:(0,s.jsx)(e.h1,{id:"\u97f3\u9891\u8c03\u8bd5\u6307\u5357",children:"\u97f3\u9891\u8c03\u8bd5\u6307\u5357"})}),"\n",(0,s.jsx)(e.p,{children:"\u672c\u7ae0\u4e3b\u8981\u662fS100 I2S\u7684\u57fa\u672c\u7279\u6027\uff0c\u8bed\u97f3\u57fa\u7840\u77e5\u8bc6\u4ee5\u53ca\u6dfb\u52a0codec\u3001\u8c03\u8bd5\u58f0\u5361\u7684\u8bf4\u660e"}),"\n",(0,s.jsx)(e.h2,{id:"\u6982\u8ff0",children:"\u6982\u8ff0"}),"\n",(0,s.jsx)(e.p,{children:"CPU DAI: CPU\u4fa7\u7684\u6570\u5b57\u97f3\u9891\u63a5\u53e3\uff0c\u4e00\u822c\u662fi2s\u63a5\u53e3\uff0c\u63a7\u5236\u603b\u7ebf\u4f20\u8f93"}),"\n",(0,s.jsx)(e.p,{children:"CODEC DAI\uff1a\u5373codec\u3002\u63a7\u5236codec\u5de5\u4f5c\u6d41\uff0c\u63d0\u4f9b\u7ed9core\u5c42"}),"\n",(0,s.jsx)(e.p,{children:"DAI LINK\uff1a\u7ed1\u5b9aCPU DAI\u548cCODEC DAI\uff0c\u6307\u786c\u4ef6\u63a7\u5236\u5668\u9a71\u52a8"}),"\n",(0,s.jsx)(e.p,{children:"PLATFORM\uff1a\u6307\u5b9aCPU\u4fa7\u7684\u5e73\u53f0\u9a71\u52a8\uff0c\u901a\u5e38\u662fDMA\u9a71\u52a8\uff0c\u7528\u4e8e\u4f20\u8f93"}),"\n",(0,s.jsx)(e.p,{children:"DAPM\uff1a\u52a8\u6001\u97f3\u9891\u7535\u6e90\u7ba1\u7406"}),"\n",(0,s.jsx)(e.h2,{id:"\u97f3\u9891\u5f00\u53d1\u8bf4\u660e",children:"\u97f3\u9891\u5f00\u53d1\u8bf4\u660e"}),"\n",(0,s.jsx)(e.p,{children:"\u4e00\u4e2a\u5b8c\u6574\u7684\u58f0\u5361\u7531cpu dai\u3001codec dai\u3001platform\u3001sound card\u6784\u6210\u3002"}),"\n",(0,s.jsx)(e.p,{children:"cpu dai driver\uff1a\u4e00\u822c\u662fI2S\u63a5\u53e3\u9a71\u52a8\u3002"}),"\n",(0,s.jsx)(e.p,{children:"codec dai driver\uff1a\u6307\u7684\u662f\u5916\u63a5codec\u9a71\u52a8\u3002"}),"\n",(0,s.jsx)(e.p,{children:"platform driver\uff1a\u901a\u5e38\u662fdma\u9a71\u52a8\uff0c\u7528\u4e8e\u5b8c\u6210\u5bf9\u97f3\u9891\u6570\u636e\u7684\u7ba1\u7406\u3002"}),"\n",(0,s.jsx)(e.p,{children:"sound card driver\uff1a\u7528\u6765\u8d1f\u8d23\u8fde\u63a5cpu dai\u548ccodec dai\uff0c\u6bd4\u5982sound/soc/hobot/hobot-snd-s100-ac-fdx-host.c\u3002"}),"\n",(0,s.jsx)(e.h3,{id:"i2s\u53c2\u6570\u8bf4\u660e",children:"I2S\u53c2\u6570\u8bf4\u660e"}),"\n",(0,s.jsx)(e.p,{children:"S100 I2S\u82af\u7247\u652f\u6301\u80fd\u529b\u8bf4\u660e\uff1a"}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"\u901a\u9053\u652f\u6301\uff1a\u652f\u63011/2/4/8/16\u901a\u9053\uff1b"}),"\n",(0,s.jsx)(e.li,{children:"\u91c7\u6837\u7387\u652f\u6301\uff1a8k/16k/32k/48k/44.1k/96k/192k\uff1b"}),"\n",(0,s.jsx)(e.li,{children:"\u91c7\u6837\u7cbe\u5ea6\u652f\u6301\uff1a8bit/16bit/24bit/32bit\uff1b"}),"\n",(0,s.jsx)(e.li,{children:"\u4f20\u8f93\u534f\u8bae\u652f\u6301\uff1aI2S/DSP(TDM);"}),"\n",(0,s.jsx)(e.li,{children:"I2S\u652f\u6301\u914d\u7f6emaster\u6216\u8005slave\u6a21\u5f0f\uff1b"}),"\n",(0,s.jsx)(e.li,{children:"I2S\u6a21\u5757\u7684sysclk\u9700\u8981\u4e3abclk\u76846\u500d\u53ca\u4ee5\u4e0a\uff1b"}),"\n",(0,s.jsx)(e.li,{children:"\u652f\u6301\u5168\u53cc\u5de5\u6a21\u5f0f\u3002\u5728\u5168\u53cc\u5de5\u6a21\u5f0f\u65f6sdio0\u4e3a\u8f93\u5165\uff0csdio1\u4e3a\u8f93\u51fa\uff0c\u4e0d\u80fd\u66f4\u6539\uff1b"}),"\n",(0,s.jsx)(e.li,{children:"bclk\u8f93\u51fa\u4e0d\u80fd\u8d85\u8fc725MHz"}),"\n"]}),"\n",(0,s.jsx)(e.h3,{id:"\u65b0\u589ecodec\u8bf4\u660e",children:"\u65b0\u589eCodec\u8bf4\u660e"}),"\n",(0,s.jsx)(e.h4,{id:"\u6dfb\u52a0codec-driver",children:"\u6dfb\u52a0codec driver"}),"\n",(0,s.jsx)(e.p,{children:"\u5c06\u6240\u6dfb\u52a0\u7684codec\u9a71\u52a8\u6587\u4ef6\u589e\u52a0\u5230sound/soc/codecs/\u76ee\u5f55\u4e0b\u3002"}),"\n",(0,s.jsx)(e.h4,{id:"\u6dfb\u52a0\u7f16\u8bd1\u9009\u9879",children:"\u6dfb\u52a0\u7f16\u8bd1\u9009\u9879"}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"\u901a\u8fc7\u4fee\u6539sound/soc/codec/Kconfig\u4ee5\u53caMakefile\u6dfb\u52a0codec\u9a71\u52a8\u7684\u7f16\u8bd1\u914d\u7f6e\u3002"}),"\n"]}),"\n",(0,s.jsx)(e.p,{children:"\u5176\u4e2dKconfig\u6dfb\u52a0\u5185\u5bb9\u53c2\u8003\u5982\u4e0b\uff1a"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{children:'config SND_SOC_ES7210\n        tristate "ES7210 Audio Codec"\n        depends on I2C\n'})}),"\n",(0,s.jsx)(e.p,{children:"Makefile\u6dfb\u52a0\u5185\u5bb9\u53c2\u8003\uff1a"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{children:"obj-$(CONFIG_SND_SOC_ES7210)   += snd-soc-es7210.o\n"})}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"\u901a\u8fc7menuconfig\u4fee\u6539config\u914d\u7f6e\uff0c\u4f7f\u80fd\u7f16\u8bd1"}),"\n"]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{children:"sudo ./mk_kernel.sh menuconfig\n"})}),"\n",(0,s.jsxs)(e.p,{children:["\u6267\u884c\u4ee5\u4e0a\u547d\u4ee4\u540e\uff0c\u6253\u5f00Kernel Configuration\u914d\u7f6e\u754c\u9762\uff0c\u8f93\u5165",(0,s.jsx)(e.code,{children:"CONFIG_SND_SOC_ES7210"}),"\u5e76\u4f7f\u80fd\u3002"]}),"\n",(0,s.jsx)(e.h4,{id:"\u4fee\u6539dts",children:"\u4fee\u6539dts"}),"\n",(0,s.jsx)(e.p,{children:"dts\u4fee\u6539\u4e00\u822c\u6d89\u53ca\u4ee5\u4e0b\uff1a"}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"\u589e\u52a0codec\u9a71\u52a8\u8282\u70b9\u3002\u4e00\u822c\u901a\u8fc7i2c\u63a7\u5236codec\u5bc4\u5b58\u5668\uff0c\u56e0\u6b64\u9700\u8981\u5728i2c\u8282\u70b9\u6dfb\u52a0codec\u4fe1\u606f\uff0c\u53c2\u8003\u5982\u4e0b\uff1a"}),"\n"]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{children:'i2c5: i2c@39470000 {\n    es7210_0: es7210_0@40 {\n            compatible = "MicArray_0";\n            reg = <0x40>;\n            #sound-dai-cells = <1>;\n            channels = <8>;\n            adc_dev_num = <2>;\n            status = "okay";\n    };\n};\n'})}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"\u589e\u52a0sound card\u8282\u70b9\u3002\u5efa\u7acbcodec\u4e0ei2s\u7684dai link\u7ed1\u5b9a\u5173\u7cfb\uff0c\u53c2\u8003\u5982\u4e0b\uff1a"}),"\n"]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{children:'snd2: snd2 {\n        status = "okay";\n        model = "s100snd2";\n        compatible = "hobot, s100-snd-ac-fdx-master";\n        i2s_mode = <1>;/*1:i2s mode; 7:dsp_a mode*/\n        work_mode = <1>;/*0:hal-duplex; 1:full-duplex*/\n        channel_max = <2>;\n        mclk_set = <24576000>;\n        dai-link@0 {\n                dai-format = "dsp_a"; //"i2s"/"dsp_a" //\u5bf9\u5e94SND_SOC_DAIFMT_DSP_A\n                // bitclock-master; /\u914d\u7f6e*-master\uff0c\u5bf9\u5e94dai_fmt\u7b49\u4ef7\u4e8eSND_SOC_DAIFMT_CBM_CFM\u3002\u8868\u793a\u6307\u5b9acodec\u4f5c\u4e3amaster\u63d0\u4f9b\u65f6\u949f\u6e90\n                // frame-master;\n                // frame-inversion; //\u5bf9\u5e94SND_SOC_DAIFMT_NB_IF\uff0c\u5bf9\u5e94\u5e27\u540c\u6b65\u4fe1\u53f7\u7684\u6781\u6027\u53cd\u8f6c\u3002\u6b63\u5e38\u60c5\u51b5\u5de6\u58f0\u9053\u5bf9\u5e94\u4f4e\u7535\u5e73\uff0c\u53f3\u58f0\u9053\u5bf9\u5e94\u9ad8\u7535\u5e73\u3002\u542f\u52a8frame-inversion\u540e\u6781\u6027\u53cd\u8f6c\n                link-name = "s100dailink0";\n                cpu {\n                        sound-dai = <&i2s0 0>; //\u6570\u5b57\u97f3\u9891\u63a5\u53e3\uff0c\u63a7\u5236\u603b\u7ebf\u4f20\u8f93\n                };\n                codec {\n                        sound-dai = <&es7210_0 0>; //codec\u82af\u7247\u63a5\u53e3\n                };\n        };\n\n        dai-link@1 {\n                dai-format = "dsp_a";\n                link-name = "s100dailink1";\n                cpu {\n                        sound-dai = <&i2s0 1>;\n                };\n                codec {\n                        sound-dai = <&es8156>;\n                };\n        };\n};\n'})}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"\u53e6\u5916\uff0c\u5728dts\u4e2d\u589e\u52a0\u4e86dummy_codec\u8282\u70b9\uff0c\u5728\u6ca1\u6709\u5916\u90e8codec\u6216codec\u9700\u8981\u5355\u72ec\u914d\u7f6e\u4e0d\u4f9d\u8d56alsa\u6846\u67b6\u7684\u60c5\u51b5\u4e0b\uff0c\u901a\u8fc7\u6ce8\u518c\u7ed1\u5b9a\u865a\u62dfcodec\u7684\u58f0\u5361\u8bbe\u5907\u65b9\u5f0f\u5b9e\u73b0\u7528\u6237\u7a7a\u95f4\u521b\u5efa\u8bbe\u5907\u8282\u70b9\u63a7\u5236I2S/DMA\u3002"}),"\n"]}),"\n",(0,s.jsx)(e.h2,{id:"\u8c03\u8bd5\u8bf4\u660e",children:"\u8c03\u8bd5\u8bf4\u660e"}),"\n",(0,s.jsx)(e.h3,{id:"\u58f0\u5361\u8c03\u8bd5",children:"\u58f0\u5361\u8c03\u8bd5"}),"\n",(0,s.jsx)(e.admonition,{title:"\u6ce8\u610f",type:"info",children:(0,s.jsx)(e.p,{children:"\u672c\u8282\u58f0\u5361\u8c03\u8bd5\u57fa\u4e8eS100\u5916\u63a5\u5fae\u96ea\u97f3\u9891\u5b50\u677f\u7684\u65b9\u6848\u8fdb\u884c\u4ecb\u7ecd\u3002"})}),"\n",(0,s.jsx)(e.p,{children:"S100\u4e0a\u58f0\u5361\u6a21\u5757\u9ed8\u8ba4\u4ee5ko\u5f62\u5f0f\u5b58\u5728\uff0c\u4ee5\u52a8\u6001\u52a0\u8f7d\u65b9\u5f0f\u6302\u8f7d\u3002\u6302\u8f7d\u547d\u4ee4\u5982\u4e0b\uff1a"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{children:"modprobe hobot_cpudai_super\nmodprobe snd-soc-es8156\nmodprobe snd-soc-es7210\nmodprobe hobot_snd_s100_ac_fdx_host\n"})}),"\n",(0,s.jsx)(e.p,{children:"\u9a71\u52a8\u52a0\u8f7d\u540e\u786e\u8ba4\u58f0\u5361\u662f\u5426\u52a0\u8f7d\u6210\u529f\u7684\u65b9\u6cd5\uff1a"}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"\u68c0\u67e5/proc/asound/cards\u8282\u70b9"}),"\n"]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{children:"root@ubuntu:/# cat /proc/asound/cards\n 0 [s100snd2       ]: s100snd2 - s100snd2\n                      s100snd2\n"})}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"\u68c0\u67e5/dev/snd/\u8282\u70b9"}),"\n"]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{children:"root@ubuntu:/# ls -l /dev/snd\ntotal 0\ncrw-rw-r--+ 1 root misc 116,  4 Apr 29 19:09 controlC0\ncrw-rw-r--+ 1 root misc 116,  2 Apr 29 19:09 pcmC0D0c\ncrw-rw-r--+ 1 root misc 116,  3 Apr 29 19:09 pcmC0D1p\n"})}),"\n",(0,s.jsx)(e.p,{children:"\u58f0\u5361\u52a0\u8f7d\u6210\u529f\u540e\u529f\u80fd\u6d4b\u8bd5\u53c2\u8003\u547d\u4ee4\uff1a"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{children:"arecord -Dhw:0,0 -c 2 -r 16000 -f S16_LE -t wav -d 5 test.wav\naplay -Dhw:0,1 test.wav\n"})}),"\n",(0,s.jsxs)(e.admonition,{title:"\u6ce8\u610f",type:"info",children:[(0,s.jsx)(e.p,{children:"PDMA\u9a71\u52a8\u9650\u5236\u6570\u636e\u5927\u5c0f\u6ee1\u8db364\u5b57\u8282\u5bf9\u9f50\u3002"}),(0,s.jsx)(e.p,{children:"\u8fd9\u91cc\u7279\u522b\u5f3a\u8c03\u5728\u914d\u7f6eperiod-size\u503c\u65f6\uff0c\u8bbe\u7f6e\u503c\u9700\u6ee1\u8db3\u5b57\u8282\u5bf9\u9f50\u8981\u6c42\u3002"}),(0,s.jsx)(e.p,{children:"arecord/aplay\u5bf9\u5e94\u53c2\u6570\u914d\u7f6e\uff1a--period-size=X"})]}),"\n",(0,s.jsx)(e.h3,{id:"\u5e38\u7528\u8c03\u8bd5\u624b\u6bb5",children:"\u5e38\u7528\u8c03\u8bd5\u624b\u6bb5"}),"\n",(0,s.jsx)(e.h4,{id:"\u8c03\u6574debug-log\u7b49\u7ea7",children:"\u8c03\u6574debug log\u7b49\u7ea7"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{children:'echo "8 4 1 7" > /proc/sys/kernel/printk\necho -n "file hhobot-cpudai-super.c +p" > /sys/kernel/debug/dynamic_debug/control\necho -n "file hobot-i2s-super.c +p" > /sys/kernel/debug/dynamic_debug/control\necho -n "file hobot-platform-super.c +p" > /sys/kernel/debug/dynamic_debug/control\n'})}),"\n",(0,s.jsx)(e.h4,{id:"alsa-profs\u8282\u70b9\u8bf4\u660e",children:"ALSA profs\u8282\u70b9\u8bf4\u660e"}),"\n",(0,s.jsx)(e.p,{children:"profs\u662flinux\u7684\u4e00\u4e2a\u6587\u4ef6\u7cfb\u7edf\uff0c\u63d0\u4f9b\u5173\u4e8e\u5185\u6838\u6570\u636e\u7ed3\u6784\u7684\u63a5\u53e3\u3002\u6302\u8f7d\u76ee\u5f55\u4e3a/proc\u3002"}),"\n",(0,s.jsx)(e.p,{children:"ALSA procfs\u6302\u8f7d\u76ee\u5f55\u4e3a\uff1a/proc/asound\uff0cALSA\u4f7f\u7528/proc/asound\u76ee\u5f55\u4e0b\u7684\u6587\u4ef6\u4fdd\u5b58\u8bbe\u5907\u4fe1\u606f\u548c\u63a7\u5236\u76ee\u7684\u3002\u901a\u8fc7proc\u8282\u70b9\uff0c\u6211\u4eec\u53ef\u4ee5\u5feb\u901f\u67e5\u770b\u67d0\u4e9b\u4fe1\u606f\u7528\u4e8e\u5b9a\u4f4d\u8c03\u8bd5\u9047\u5230\u7684\u95ee\u9898\u3002"}),"\n",(0,s.jsx)(e.h5,{id:"procasoundcards",children:"/proc/asound/cards"}),"\n",(0,s.jsx)(e.p,{children:"\u5df2\u6ce8\u518c\u58f0\u5361\u7684\u5217\u8868\u3002\u901a\u8fc7\u67e5\u770b\u8be5\u8282\u70b9\uff0c\u68c0\u67e5\u5f53\u524d\u7cfb\u7edf\u6ce8\u518c\u7684\u58f0\u5361\u5217\u8868\u6216\u8005\u68c0\u67e5\u58f0\u5361\u662f\u5426\u6ce8\u518c\u6210\u529f"}),"\n",(0,s.jsx)(e.h5,{id:"procasoundpcm",children:"/proc/asound/pcm"}),"\n",(0,s.jsx)(e.p,{children:"\u5206\u914d\u7684pcm\u6d41\u8bbe\u5907\u7684\u4fe1\u606f\u3002\u901a\u8fc7\u67e5\u770b\u8be5\u8282\u70b9\uff0c\u627e\u5230\u5f53\u524d\u58f0\u5361\u652f\u6301\u7684\u8bbe\u5907\u5217\u8868\u3002\u8fd9\u6709\u52a9\u4e8e\u6d4b\u8bd5\u65f6\u9009\u62e9\u5982\u4f55\u8bbe\u7f6e\u8bbe\u5907\u8282\u70b9\u7684card/device\u503c\u3002"}),"\n",(0,s.jsx)(e.h5,{id:"procasoundcardxpcmyc-p",children:"/proc/asound/cardX/pcmY[c, p]/*"}),"\n",(0,s.jsx)(e.p,{children:"\u7cfb\u7edf\u4e2d\u58f0\u5361\u5bf9\u5e94\u7684\u6bcf\u4e2apcm\u6d41\u8bbe\u5907\u90fd\u6709\u4e00\u4e2a\u7c7b\u4f3c\u4e0a\u9762\u7684procfs\u76ee\u5f55\u3002\u5176\u4e2dX\u4ee3\u8868\u58f0\u5361\u53f7\uff0c/proc/asound/cards\u6216\u8005/dev/snd\u4e0b\u7684\u8bbe\u5907\u8282\u70b9\u4fe1\u606f\u53ef\u786e\u8ba4\uff1b\nY\u4ee3\u8868\u8bbe\u5907\u53f7\uff0c/proc/asound/pcm\u6216\u8005/dev/snd\u4e0b\u7684\u8bbe\u5907\u8282\u70b9\u4fe1\u606f\u53ef\u786e\u8ba4\u3002c/p\u5206\u522b\u4ee3\u8868capture/playback\u3002\u8be5\u76ee\u5f55\u53ef\u67e5\u770bPCM\u8bbe\u5907\u7684\u4fe1\u606f\u4ee5\u53castatus\u3002"}),"\n",(0,s.jsx)(e.h6,{id:"info",children:"info"}),"\n",(0,s.jsx)(e.p,{children:"pcm\u6d41\u7684\u4e00\u822c\u4fe1\u606f\uff0c\u6bd4\u5982\u58f0\u5361\u53f7\u3001\u8bbe\u5907\u53f7\u3001\u6d41\u7c7b\u578b\u3001\u6240\u7ed1\u5b9a\u7684codec\u7c7b\u578b\u7b49"}),"\n",(0,s.jsx)(e.h6,{id:"hw_params",children:"hw_params"}),"\n",(0,s.jsx)(e.p,{children:"pcm\u6d41\u6253\u5f00\u72b6\u6001\u4e0b\uff0c\u53ef\u4ee5\u67e5\u770bpcm\u7684\u57fa\u7840\u53c2\u6570\u914d\u7f6e\u3002\u6bd4\u5982\u91c7\u6837\u7387\u3001\u4f4d\u5bbd\u3001\u901a\u9053\u6570\u3001period_size\u3001buffer_size\u7b49\u3002\u914d\u7f6e\u7684period_size\u3001buffer_size\u53ef\u80fd\u4e0e\u8fd9\u91cc\u6253\u5370\u7684\u503c\u4e0d\u540c\u3002\u5b9e\u9645\u4ee5\u8fd9\u91cc\u67e5\u770b\u4e3a\u51c6\uff0c\u5bf9\u5e94\u7684\u662f\u786c\u4ef6\u7684\u5b9e\u9645\u53c2\u6570"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{children:"root@ubuntu:/proc/asound/card0/pcm0c/sub0# cat hw_params\naccess: RW_INTERLEAVED\nformat: S16_LE\nsubformat: STD\nchannels: 2\nrate: 48000 (48000/1)\nperiod_size: 1024\nbuffer_size: 4096\n"})}),"\n",(0,s.jsx)(e.h6,{id:"sw_params",children:"sw_params"}),"\n",(0,s.jsx)(e.p,{children:"pcm\u6d41\u6253\u5f00\u72b6\u6001\u4e0b\uff0c\u67e5\u770bstart_threshold\u3001stop_threshold\u3001silence_threshold\u7b49\u3002\u91cd\u70b9\u5173\u6ce8start_threshold\u3001stop_threshold\u9608\u503c"}),"\n",(0,s.jsx)(e.p,{children:"start_threshold: \u8be5\u503c\u8bbe\u7f6e\u592a\u5927\uff0c\u4ece\u5f00\u59cb\u64ad\u653e\u5230\u58f0\u97f3\u51fa\u6765\u5ef6\u65f6\u592a\u957f\uff0c\u4f1a\u5bfc\u81f4\u592a\u77ed\u4fc3\u7684\u58f0\u97f3\u64ad\u4e0d\u51fa\u6765"}),"\n",(0,s.jsx)(e.p,{children:"stop_threshold: \u5224\u65ad\u662f\u5426\u89e6\u53d1xrun\u7684\u6761\u4ef6\u3002\u5f53\u53ef\u7528\u7a7a\u95f4\u5927\u5c0f\u8d85\u8fc7\u8be5\u503c\u65f6\uff0c\u4f1a\u89e6\u53d1xrun\u3002"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{children:"root@ubuntu:/proc/asound/card0/pcm0c/sub0# cat sw_params\ntstamp_mode: ENABLE\nperiod_step: 1\navail_min: 1\nstart_threshold: 1\nstop_threshold: 40960\nsilence_threshold: 0\nsilence_size: 0\nboundary: 4611686018427387904\n"})}),"\n",(0,s.jsx)(e.h6,{id:"status",children:"status"}),"\n",(0,s.jsx)(e.p,{children:"\u53ef\u67e5\u770b\u5f53\u524dsubstream\u7684\u72b6\u6001(running\u3001xrun\u7b49)\uff0cappl_ptr/hw_ptr\u6307\u9488\u7684\u503c\u3002\u5176\u4e2d\uff0chw_ptr\u548capp_ptr\u53ef\u4ee5\u8bc6\u522b\u5e95\u5c42\u786c\u4ef6\u65e0\u6cd5\u4f20\u8f93\u6216\u63a5\u6536\u4efb\u4f55\u6570\u636e\u7684\u60c5\u51b5\u3002\n\u6bd4\u5982\uff0c\u542f\u52a8\u6d4b\u8bd5\u4f46\u662f\u4e2d\u65ad\u672a\u6b63\u5e38\u89e6\u53d1\uff0c\u6570\u636e\u4f20\u8f93\u5c06\u4f1a\u505c\u6ede\u3002\u6b64\u65f6\uff0chw_ptr/appl_ptr\u6307\u9488\u5c06\u6301\u7eed\u5f97\u4e0d\u5230\u66f4\u65b0"}),"\n",(0,s.jsx)(e.h4,{id:"xrun",children:"xrun"}),"\n",(0,s.jsx)(e.p,{children:'\u97f3\u9891\u5728\u64ad\u653e\u65f6\u5076\u73b0\u6216\u8005\u8fde\u7eed\u67d0\u4e2a\u65f6\u95f4\u6bb5\u51fa\u73b0\u65ad\u65ad\u7eed\u7eed\u3001\u58f0\u97f3\u7c7b\u4f3c"\u5472\u5472"\u6216\u8005"\u7206\u7834"\u7684\u6742\u97f3\uff0c \u4e00\u822c\u662f\u53d1\u751f\u4e86xrun\u3002xrun\u4e22\u5e27\u53d7\u7cfb\u7edf\u6027\u80fd\u9650\u5236\u4e0d\u53ef\u907f\u514d\uff0c\u5728\u6ee1\u8db3\u4f7f\u7528\u573a\u666f\u7684\u9700\u6c42\u4e0b\uff0c\u5141\u8bb8\u6709\u4e00\u5b9a\u7684\u4e22\u5e27\u7387\uff0c\u53ea\u80fd\u901a\u8fc7\u67d0\u4e9b\u65b9\u6cd5\u4f18\u5316\u8fbe\u5230\u5c3d\u91cf\u89c4\u907f\u3002\u5982\u679c\u51fa\u73b0xrun\u9891\u53d1\uff0c\u65e0\u6cd5\u6062\u590d\u7684\u60c5\u51b5\uff0c\u5c31\u9700\u8981\u6392\u67e5\u4ee3\u7801\u5b9e\u73b0\u4e0a\u662f\u5426\u6709\u7f3a\u9677'}),"\n",(0,s.jsx)(e.h5,{id:"\u53ef\u80fd\u51fa\u73b0xrun\u7684\u573a\u666f",children:"\u53ef\u80fd\u51fa\u73b0xrun\u7684\u573a\u666f"}),"\n",(0,s.jsx)(e.p,{children:"\u64ad\u653e\u65f6\uff0c\u5e94\u7528\u4f1a\u4e0d\u65ad\u628a\u97f3\u9891\u6570\u636e\u586b\u5165\u9a71\u52a8buffer\uff0c\u9a71\u52a8buffer\u7ecf\u8fc7i2s fifo\u9001\u7ed9codec\u64ad\u653e\u3002\u5f53\u5e94\u7528\u586b\u5165\u6162\u4e86\uff0c\u5bfc\u81f4\u9a71\u52a8buffer\u4e3a\u7a7a\uff0c\u5c31\u4f1a\u89e6\u53d1underrun\u5bfc\u81f4\u4e22\u5e27\uff0c\u53ef\u80fd\u4f1a\u6709\u58f0\u97f3\u5f02\u5e38\u7684\u73b0\u8c61"}),"\n",(0,s.jsx)(e.p,{children:"\u5f55\u97f3\u65f6\uff0ccodec\u8f6c\u5316\u7684\u6570\u5b57\u4fe1\u53f7\u7ecf\u8fc7i2s fifo\u586b\u5165\u9a71\u52a8buffer\uff0c\u5e94\u7528\u4f1a\u4ece\u9a71\u52a8buffer\u4e2d\u8bfb\u53d6\u97f3\u9891\u6570\u636e\u3002\u5f53\u5e94\u7528\u8bfb\u53d6\u7684\u901f\u5ea6\u8d76\u4e0d\u4e0a\u5199\u5165\u7684\u901f\u5ea6\uff0c\u8d85\u8fc7stop_threshold\u9608\u503c\u5c31\u4f1a\u89e6\u53d1overrun"}),"\n",(0,s.jsx)(e.h5,{id:"\u5b9a\u4f4dxrun",children:"\u5b9a\u4f4dxrun"}),"\n",(0,s.jsx)(e.p,{children:"\u68c0\u67e5xrun\u662f\u5426\u7531\u4e8eIO\u64cd\u4f5c\u8017\u65f6\u5bfc\u81f4"}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"\u97f3\u9891\u6587\u4ef6\u5199\u5165ram disk\u6216\u8005\u7279\u5b9a\u7684\u8bbe\u5907\u6587\u4ef6\uff0c\u53c2\u8003\u547d\u4ee4"}),"\n"]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{children:"\u5199\u5165ram disk\nmkdir /data/audio_test\ntinycap /data/audio_test/test.wav\n\n\u7279\u5b9a\u7684\u8bbe\u5907\u6587\u4ef6\ntinycap /dev/null\n"})}),"\n",(0,s.jsx)(e.p,{children:"\u6ce8\u610f\uff0c\u4ee5\u4e0a\u53ea\u80fd\u7528\u4e8e\u5b9a\u4f4dxrun\u662f\u5426\u7531\u4e8eIO\u64cd\u4f5c\u8017\u65f6\u5bfc\u81f4\uff0c\u4e0d\u80fd\u4f5c\u4e3a\u89e3\u51b3xrun\u7684\u65b9\u6848"}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"\u4f18\u5316\u5e94\u7528\u7a0b\u5e8f\u6d4b\u8bd5"}),"\n"]}),"\n",(0,s.jsx)(e.p,{children:"\u4f7f\u7528\u72ec\u7acb\u7684\u7ebf\u7a0b\u8bbf\u95ee\u5a92\u4f53\u5b58\u50a8\u548c\u8bfb\u5199PCM\u8bbe\u5907\u3002\n\u4ee5\u5f55\u97f3\u4e3a\u4f8b\uff0c\u5199\u6587\u4ef6\u521b\u5efa\u5355\u72ec\u7684\u7ebf\u7a0b\u548c\u521b\u5efaring buffer(ring buffer\u5927\u5c0f\u53ef\u81ea\u7531\u8c03\u6574)\uff0cpcm_read\u7684buffer\u5199\u5165ring buffer\uff0cfwrite\u4ecering buffer\u8bfb\u53d6\u6570\u636e\u3002\u53ea\u8981fwrite\u9677\u5165\u65f6\u95f4\u4e0d\u8d85\u8fc7ring buffer\u7684\u9650\u5236\uff0c\u5c31\u4e0d\u4f1a\u53d1\u751fxrun\u5bfc\u81f4\u6570\u636e\u3002"}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"\u4f9d\u9760/proc\u4e0b\u914d\u7f6e\u529f\u80fd\u67e5\u770b\u4fe1\u606f"}),"\n"]}),"\n",(0,s.jsx)(e.p,{children:"\u5f00\u542f\u7f16\u8bd1xrun_debug\u7684config\u914d\u7f6e\u9879\u3002\u7f16\u8bd1\u5e76\u91cd\u65b0\u70e7\u5199\u955c\u50cf\u3002\uff08\u5982\u679cxrun_debug\u5b58\u5728\uff0c\u8868\u793a\u8be5\u529f\u80fd\u5904\u4e8e\u4f7f\u80fd\u72b6\u6001\uff0c\u4e0d\u9700\u8981\u6267\u884c\u8fd9\u4e00\u6b65\uff09"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{children:"CONFIG_SND_PCM_XRUN_DEBUG=y\nCONFIG_SND_VERBOSE_PROCFS=y\nCONFIG_SND_DEBUG=y\n"})}),"\n",(0,s.jsxs)(e.p,{children:["proc\u8282\u70b9\u5bf9\u5e94\u4f4d\u7f6e",(0,s.jsx)(e.code,{children:"/proc/asound/cardX/pcmY[c,p]/xrun_debug"})]}),"\n",(0,s.jsx)(e.p,{children:"\u6bd4\u5982\uff0c\u5f80xrun_debug\u5199\u51653\uff0c\u4e5f\u5c31\u662f\u542f\u7528\u57fa\u672c\u8c03\u8bd5\u548c\u5806\u6808\u529f\u80fd\uff0c\u53ef\u4ee5\u67e5\u770bPCM\u6d41\u662f\u5426\u7531\u4e8e\u67d0\u79cd\u539f\u56e0\u800c\u505c\u6b62"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{children:"# Enable basic debugging and dump stack\n# Usefull to just see, if PCM stream is stopped for a reason (usually wrong audio process timing from scheduler)\necho 3 > /proc/asound/card0/pcm0p/xrun_debug\n"})}),"\n",(0,s.jsx)(e.h5,{id:"\u4fee\u590dxrun",children:"\u4fee\u590dxrun"}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"\u63d0\u9ad8\u7ebf\u7a0b\u4f18\u5148\u7ea7(\u8bbe\u7f6e\u5b9e\u65f6\u7ebf\u7a0b+\u4f18\u5148\u6743\u503c)"}),"\n",(0,s.jsx)(e.li,{children:"\u8c03\u5927period_size\uff0c\u6539\u53d8DMA\u4f20\u8f93\u6570\u636e\u91cf"}),"\n",(0,s.jsx)(e.li,{children:"\u5f02\u6b65\u5b9e\u73b0I/O\u8bfb\u5199\u548cALSA \u8bbe\u5907\u8bfb\u5199"}),"\n"]}),"\n",(0,s.jsx)(e.h3,{id:"\u901a\u7528\u95ee\u9898",children:"\u901a\u7528\u95ee\u9898"}),"\n",(0,s.jsx)(e.h4,{id:"\u6253\u5f00\u8bbe\u5907\u8282\u70b9\u62a5\u9519",children:"\u6253\u5f00\u8bbe\u5907\u8282\u70b9\u62a5\u9519"}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"Unable to open PCM device (cannot open device '/dev/snd/pcmC0D3c': No such file or director)"}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"\u9a71\u52a8\u52a0\u8f7d\u5931\u8d25\uff0c\u5bfc\u81f4/dev/snd\u4e0b\u6ca1\u6709\u751f\u6210\u8bbe\u5907\u8282\u70b9\uff1b"}),"\n",(0,s.jsx)(e.li,{children:"\u8bbe\u7f6e\u7684card/device\u503c\u9519\u8bef\u5bfc\u81f4\u627e\u4e0d\u5230\u5bf9\u5e94\u7684\u8bbe\u5907\u8282\u70b9\uff1b"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(e.p,{children:"\u5176\u4e2d\uff0c/dev/snd\u4e0b\u6ca1\u6709\u751f\u6210\u8bbe\u5907\u8282\u70b9\u7684\u53ef\u80fd\u539f\u56e0\uff1a"}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"i2s/codec\u9a71\u52a8\u52a0\u8f7d\u5931\u8d25\uff0c\u53ef\u4ee5\u901a\u8fc7dmesg\u770b\u662f\u5426\u6709\u4ee5\u4e0b\u4fe1\u606f\u6253\u5370"}),"\n"]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{children:"soc:sndcard@0: BUG: Can't get codec\nsoc:sndcard@0: BUG: Can't get cpu\nprobe of soc:sndcard@0 failed with error -22\n"})}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:'dts\u4e2d\u5404\u9a71\u52a8\u8282\u70b9\u7684status\u5c5e\u6027\u672a\u8bbe\u7f6e"okay"\u72b6\u6001\uff0c\u5bfc\u81f4\u9a71\u52a8\u52a0\u8f7d\u65f6\u4e0d\u4f1a\u6267\u884c\u4efb\u4f55\u64cd\u4f5c\u3002\u53ef\u4ee5\u5728\u9a71\u52a8\u52a0\u8f7d\u540e\uff0c\u901a\u8fc7dmesg\u67e5\u770b\u662f\u5426\u6709\u7c7b\u4f3csuccess register cpu dai0 driver\u4fe1\u606f\u6253\u5370'}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"Unable to open PCM device (cannot set hw params: Unknown error -22)"}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(e.p,{children:"\u5f53\u524d\u6d4b\u8bd5\u8bbe\u7f6e\u7684\u53c2\u6570\u503c\uff0c\u8d85\u8fc7i2s\u548ccodec\u9a71\u52a8\u4e2d\u5bf9\u4e8esnd_soc_dai_driver\u5b9a\u4e49\u7684rate\u3001format\u3001channel\u6700\u503c\u8303\u56f4\u4ea4\u96c6"}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"\u6253\u5f00\u8bbe\u5907\u8282\u70b9\u5361\u4f4f\uff0c\u5e94\u7528\u65e0\u4efb\u4f55log\u65e5\u5fd7\u6253\u5370"}),"\n"]}),"\n",(0,s.jsx)(e.p,{children:"ALSA\u6846\u67b6\u5141\u8bb8\u5355\u4e2a\u8bbe\u5907\u540c\u4e00\u65f6\u523b\u53ea\u80fd\u6253\u5f00\u4e00\u6b21\u3002\u68c0\u67e5\u5e94\u7528\u5b9e\u73b0\u4e0a\uff0c\u662f\u5426\u5b58\u5728\u4e0a\u6b21\u6267\u884c\u8fd8\u672a\u9000\u51fa\u7684\u60c5\u51b5\u4e0b\uff0c\u53c8\u542f\u52a8\u5e94\u7528"}),"\n",(0,s.jsx)(e.h5,{id:"\u5f55\u5236\u64ad\u653e\u95ee\u9898",children:"\u5f55\u5236/\u64ad\u653e\u95ee\u9898"}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"pcm_read/pcm_write\u8fd4\u56de\u5f02\u5e38\u503c\u4e3a-5"}),"\n"]}),"\n",(0,s.jsx)(e.p,{children:"\u8c03\u6574ALSA\u6846\u67b6log\u6253\u5370\u7b49\u7ea7\uff0c\u68c0\u67e5\u662f\u5426\u7531\u4e8e\u4e2d\u65ad\u6216\u8005\u786c\u4ef6\u94fe\u63a5\u5bfc\u81f4\u4e2d\u65ad\u6ca1\u6709\u4ea7\u751f\u5f15\u8d77\u5f02\u5e38"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{children:'echo "8 4 1 7" > /proc/sys/kernel/printk\necho -n "file pcm_lib.c +p" > /sys/kernel/debug/dynamic_debug/control\n'})}),"\n",(0,s.jsx)(e.p,{children:"\u51fa\u73b0```write error (DMA or IRQ trouble?)``\u6253\u5370\uff0c\u8bf4\u660e\u6ca1\u6709\u4e2d\u65ad\u3002\u9700\u8981\u68c0\u67e5\u5bc4\u5b58\u5668\u914d\u7f6e\u4ee5\u53ca\u786c\u4ef6\u94fe\u63a5\u60c5\u51b5"}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"pcm_read/pcm_write\u8fd4\u56de\u5f02\u5e38\u503c\u4e3a-32"}),"\n"]}),"\n",(0,s.jsx)(e.p,{children:"\u4e00\u822c\u662f\u53d1\u751f\u4e86xrun"}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"pcm_read\u8fd4\u56de\u5f02\u5e38\u503c\u4e3a-16"}),"\n"]}),"\n",(0,s.jsx)(e.p,{children:"\u6b63\u5e38\u5f55\u97f3(S100\u505aslave)\u65f6\uff0c\u65f6\u949f\u7a81\u7136\u65ad\u6389\u6216\u8005\u786c\u4ef6\u8fde\u63a5\u4e2d\u65ad\u4f1a\u53d1\u751f\u8be5\u5f02\u5e38"}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"\u5f55\u5236\u6570\u636e\u5747\u4e3a0\u6216\u8005\u64ad\u653e\u6ca1\u6709\u58f0\u97f3"}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"\u793a\u6ce2\u5668\u6d4b\u91cfi2s\u7684\u65f6\u949f\u7ebf\u9891\u7387\u662f\u5426\u6b63\u5e38\uff0cdata\u7ebf\u662f\u5426\u6709\u6570\u636e\u8f93\u51fa\u3002"}),"\n",(0,s.jsx)(e.li,{children:"\u5982\u679c\u65f6\u949f\u9891\u7387\u4e0d\u7b26\u5408\u9884\u671f\u6216\u8005\u91cf\u5230\u67d0\u4e2a\u65f6\u949f\u4fe1\u53f7\u6301\u7eed\u4fdd\u6301\u4f4e\u7535\u5e73\u7684\u60c5\u51b5\uff0c\u68c0\u67e5i2s \u5bc4\u5b58\u5668\u7684\u914d\u7f6e\u662f\u5426\u7b26\u5408\u9884\u671f\u3002\u6bd4\u5982\u4e3b\u4ece\u6a21\u5f0f\u3001\u65f6\u949f\u6bd4\u503c\u72b6\u6001"}),"\n",(0,s.jsx)(e.li,{children:"\u5982\u679c\u4ee5\u4e0a\u6ca1\u6709\u95ee\u9898\uff0c\u5c31\u9700\u8981\u68c0\u67e5codec\u82af\u7247\u662f\u5426\u6b63\u5e38\u5de5\u4f5c\u3002\u64ad\u653e\u4e00\u4e2a\u6b63\u5f26\u6ce2\uff0c\u6d4b\u91cfcodec\u4fa7\u6a21\u62df\u4fe1\u53f7\u7684 \u8f93\u51fa\uff0c\u5982\u679c\u8fd9\u91cc\u6ca1\u6709\u8f93\u51fa\uff0c\u786e\u8ba4codec\u7684\u65f6\u949f\u6bd4\u503c\u914d\u7f6e\u548cJ5\u7aef\u662f\u5426\u5339\u914d\uff0c\u4ee5\u53ca\u5f53\u524dS100\u7aef\u7684\u65f6\u949f\u6bd4\u503c\u662f\u5426\u5728codec\u53ef\u652f\u6301\u8303\u56f4\u3002"}),"\n",(0,s.jsx)(e.li,{children:"\u5982\u679ccodec\u7684\u8f93\u51fa\u4e5f\u80fd\u91cf\u5230\u51c6\u786e\u7684\u4fe1\u53f7\uff0c\u68c0\u67e5\u529f\u653e\u82af\u7247\u662f\u5426\u6b63\u5e38\u5de5\u4f5c\u3002\u786e\u8ba4\u529f\u653e\u82af\u7247\u5404\u7ba1\u811a\u5e45\u503c\u662f\u5426\u6b63\u5e38"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"\u5f55\u5236/\u64ad\u653e\u566a\u58f0"}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(e.p,{children:"\u4e00\u4e9bcodec\u8bbe\u8ba1\u7684\u65f6\u5019\uff0ccodec\u505aslave\u65f6\uff0c\u9700\u8981\u82af\u7247\u7684\u9a71\u52a8\u65f6\u949f\u548cbclk/lrclk\u65f6\u949f\u540c\u6e90\uff0c\u5426\u5219\u5728\u5f55\u97f3\u7684\u65f6\u5019\u4f1a\u51fa\u73b0\u6570\u636e\u8df3\u53d8\u6216\u8005\u91cd\u590d\u7684\u95ee\u9898\uff0c\u5bfc\u81f4\u4ea7\u751f\u566a\u58f0"}),"\n",(0,s.jsx)(e.h2,{id:"\u97f3\u9891\u5b50\u677f\u4f7f\u7528\u8bf4\u660e",children:"\u97f3\u9891\u5b50\u677f\u4f7f\u7528\u8bf4\u660e"}),"\n",(0,s.jsx)(e.h3,{id:"\u97f3\u9891\u5b50\u677f\u4ecb\u7ecd",children:"\u97f3\u9891\u5b50\u677f\u4ecb\u7ecd"}),"\n",(0,s.jsx)(e.p,{children:"\u97f3\u9891\u5b50\u677f\u4e0eS100\u5f00\u53d1\u677f\u8fde\u63a5\uff0c\u63a5\u6536\u5355\u8defI2S\u5168\u53cc\u5de5\u4fe1\u53f7\uff1b"}),"\n",(0,s.jsx)(e.p,{children:"\u5305\u542b2\u9897es7210\u82af\u7247\uff0cI2C\u5730\u5740\u4e3a0x40/0x42\uff0c\u53ef\u4ee5\u5f55\u52368\u901a\u9053\u97f3\u9891\uff0c\u5176\u4e2d4\u8def\u63a5\u6536\u6a21\u62dfmic\uff0c2\u8defaec\u56de\u91c7\u5587\u53ed\u6570\u636e\uff1b"}),"\n",(0,s.jsx)(e.p,{children:"\u5305\u542b1\u9897es8156\u82af\u7247\uff0cI2C\u5730\u5740\u4e3a0x8\uff0c\u53ef\u4ee5\u64ad\u653e2\u901a\u9053\u97f3\u9891\uff0c\u8fde\u63a5\u8033\u673a\u6216\u8005\u5587\u53ed\u6700\u7ec8\u64ad\u653e\u58f0\u97f3\uff1b"}),"\n",(0,s.jsx)(e.p,{children:"\u5b9e\u7269\u5982\u4e0b\u56fe\u6240\u793a\uff0c\u5176\u4e2d\u7ea2\u5708\u4e3aes7210\uff0c\u9ec4\u5708\u4e3aes8156\uff0c\u7eff\u5708\u4e3a4mic\u3002"}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.img,{src:"https://rdk-doc.oss-cn-beijing.aliyuncs.com/doc/img/07_Advanced_development/02_linux_development/driver_development_s100/audio1.png",alt:""})}),"\n",(0,s.jsx)(e.h3,{id:"\u97f3\u9891\u5b50\u677f\u4e0e\u5f00\u53d1\u677f\u8fde\u63a5",children:"\u97f3\u9891\u5b50\u677f\u4e0e\u5f00\u53d1\u677f\u8fde\u63a5"}),"\n",(0,s.jsx)(e.p,{children:"\u8fde\u63a5\u65b9\u5f0f\u5982\u4e0b\u56fe\uff1a"}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.img,{src:"https://rdk-doc.oss-cn-beijing.aliyuncs.com/doc/img/07_Advanced_development/02_linux_development/driver_development_s100/audio2.png",alt:""})}),"\n",(0,s.jsxs)(e.p,{children:[(0,s.jsx)(e.strong,{children:"\u6ce8\u610f\u4e8b\u9879"}),"\uff1a40pin\u4e0a\u7684PCM pin\u811a\u4e0ePCIE\u7684WIFI\u6a21\u7ec4\u590d\u7528\uff0c\u786c\u4ef6\u4e0a\u63d0\u4f9b\u4e86\u62e8\u7801\u5f00\u5173\u5b9e\u73b0pin\u811a\u529f\u80fd\u5207\u6362\u3002"]}),"\n",(0,s.jsx)(e.p,{children:"\u62e8\u7801\u5f00\u5173\u5207\u6362pin\u811a\u529f\u80fd\u8bf4\u660e\u5982\u4e0b\u56fe\uff1a"}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.img,{src:"https://rdk-doc.oss-cn-beijing.aliyuncs.com/doc/img/07_Advanced_development/02_linux_development/driver_development_s100/audio3.png",alt:""})})]})}function h(n={}){const{wrapper:e}={...(0,c.R)(),...n.components};return e?(0,s.jsx)(e,{...n,children:(0,s.jsx)(p,{...n})}):p(n)}}}]);