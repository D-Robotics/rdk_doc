"use strict";(self.webpackChunkrdk_doc=self.webpackChunkrdk_doc||[]).push([[85787],{28453:(e,n,s)=>{s.d(n,{R:()=>a,x:()=>d});var r=s(96540);const t={},i=r.createContext(t);function a(e){const n=r.useContext(i);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:a(e.components),r.createElement(i.Provider,{value:n},e.children)}},33560:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>o,contentTitle:()=>d,default:()=>h,frontMatter:()=>a,metadata:()=>r,toc:()=>l});const r=JSON.parse('{"id":"Advanced_development/linux_development/hardware_unit_test/ddr_bandwidth","title":"DDR Bandwidth Test","description":"Test Principle","source":"@site/i18n/en/docusaurus-plugin-content-docs-docs_s/current/07_Advanced_development/02_linux_development/05_hardware_unit_test/08-ddr_bandwidth.md","sourceDirName":"07_Advanced_development/02_linux_development/05_hardware_unit_test","slug":"/Advanced_development/linux_development/hardware_unit_test/ddr_bandwidth","permalink":"/rdk_doc/en/rdk_s/Advanced_development/linux_development/hardware_unit_test/ddr_bandwidth","draft":false,"unlisted":false,"tags":[],"version":"current","lastUpdatedAt":1770709590000,"sidebarPosition":8,"frontMatter":{"sidebar_position":8},"sidebar":"tutorialSidebar","previous":{"title":"CPU Performance Testing","permalink":"/rdk_doc/en/rdk_s/Advanced_development/linux_development/hardware_unit_test/cpu_performance"},"next":{"title":"USB Bus Speed Test","permalink":"/rdk_doc/en/rdk_s/Advanced_development/linux_development/hardware_unit_test/usb_performance"}}');var t=s(74848),i=s(28453);const a={sidebar_position:8},d="DDR Bandwidth Test",o={},l=[{value:"Test Principle",id:"test-principle",level:2},{value:"Preparation",id:"preparation",level:2},{value:"Test Procedure",id:"test-procedure",level:2},{value:"Test Metrics",id:"test-metrics",level:2},{value:"Pass Criteria",id:"pass-criteria",level:3},{value:"Test Result",id:"test-result",level:3}];function c(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",img:"img",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"ddr-bandwidth-test",children:"DDR Bandwidth Test"})}),"\n",(0,t.jsx)(n.h2,{id:"test-principle",children:"Test Principle"}),"\n",(0,t.jsx)(n.p,{children:"DDR (Double Data Rate) memory bandwidth is a key performance metric that measures the data transfer capability of a memory system. It reflects the amount of data the memory can transfer per unit time, typically expressed in MB/s or GB/s. By performing specific memory operations and measuring their execution time, the memory bandwidth performance can be estimated. The primary test operations include: Copy, Scale, Add, and Triad."}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"1. Copy Operation:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-c",children:"for (j=0; j<STREAM_ARRAY_SIZE; j++)\n    c[j] = a[j];\n"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["This operation copies data from array ",(0,t.jsx)(n.code,{children:"a[]"})," to array ",(0,t.jsx)(n.code,{children:"c[]"}),". It involves only memory reads and writes, thus measuring pure memory bandwidth."]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"2. Scale Operation:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-c",children:"for (j=0; j<STREAM_ARRAY_SIZE; j++)\n    b[j] = scalar * c[j];\n"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["This operation multiplies each element of array ",(0,t.jsx)(n.code,{children:"c[]"})," by a constant ",(0,t.jsx)(n.code,{children:"scalar"})," and stores the result in array ",(0,t.jsx)(n.code,{children:"b[]"}),". Bandwidth is measured through reading ",(0,t.jsx)(n.code,{children:"c[]"})," and writing to ",(0,t.jsx)(n.code,{children:"b[]"}),"."]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"3. Add Operation:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-c",children:"for (j=0; j<STREAM_ARRAY_SIZE; j++)\n    c[j] = a[j] + b[j];\n"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["This operation adds corresponding elements from arrays ",(0,t.jsx)(n.code,{children:"a[]"})," and ",(0,t.jsx)(n.code,{children:"b[]"}),", storing the result in array ",(0,t.jsx)(n.code,{children:"c[]"}),". It reads two arrays and writes to a third."]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"4. Triad Operation:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-c",children:"for (j=0; j<STREAM_ARRAY_SIZE; j++)\n    a[j] = b[j] + scalar * c[j];\n"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["This is a more complex operation that performs a fused multiply-add on elements from arrays ",(0,t.jsx)(n.code,{children:"b[]"})," and ",(0,t.jsx)(n.code,{children:"c[]"})," using the constant ",(0,t.jsx)(n.code,{children:"scalar"}),", storing the result in array ",(0,t.jsx)(n.code,{children:"a[]"}),"."]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"preparation",children:"Preparation"}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"1."})," Confirm DDR type and frequency: Different DDR memory types (e.g., LPDDR4) and their frequencies affect bandwidth test results. Use the command ",(0,t.jsx)(n.code,{children:"cat /sys/class/boardinfo/ddr_type"})," to check DDR status information."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"sunrise@ubuntu:/# cat /sys/class/boardinfo/ddr_type\nLPDDR5\n"})}),"\n",(0,t.jsx)(n.p,{children:"Currently, the RDKS100 DDR frequency is 6400 MHz."}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"2."})," Ensure the ",(0,t.jsx)(n.code,{children:"stream"})," test file exists under ",(0,t.jsx)(n.code,{children:"/app/chip_base_test/08_ddr_bandwidth/"}),". If not present, recompile it in this directory:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-shell",children:"sunrise@ubuntu:/# cd /app/chip_base_test/08_ddr_bandwidth\nsunrise@ubuntu:/# gcc -O3 -fopenmp -DNTIMES=100 stream.c -lgomp -o stream\n"})}),"\n",(0,t.jsx)(n.h2,{id:"test-procedure",children:"Test Procedure"}),"\n",(0,t.jsx)(n.p,{children:"After completing the preparation steps, run the test command:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-shell",children:"sunrise@ubuntu:/# ./stream\n"})}),"\n",(0,t.jsx)(n.p,{children:"After approximately 10 seconds, you will obtain the following results:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",children:"-------------------------------------------------------------\nSTREAM version $Revision: 5.10 $\n-------------------------------------------------------------\nThis system uses 8 bytes per array element.\n-------------------------------------------------------------\nArray size = 10000000 (elements), Offset = 0 (elements)\nMemory per array = 76.3 MiB (= 0.1 GiB).\nTotal memory required = 228.9 MiB (= 0.2 GiB).\nEach kernel will be executed 100 times.\n The *best* time for each kernel (excluding the first iteration)\n will be used to compute the reported bandwidth.\n-------------------------------------------------------------\nNumber of Threads requested = 6\nNumber of Threads counted = 6\n-------------------------------------------------------------\nYour clock granularity/precision appears to be 1 microseconds.\nEach test below will take on the order of 3674 microseconds.\n   (= 3674 clock ticks)\nIncrease the size of the arrays if this shows that\nyou are not getting at least 20 clock ticks per test.\n-------------------------------------------------------------\nWARNING -- The above is only a rough guideline.\nFor best results, please be sure you know the\nprecision of your system timer.\n-------------------------------------------------------------\n-------------------------------------------------------------\nFunction    Best Rate MB/s  Avg time     Min time     Max time\nCopy:           47239.8     0.003658     0.003387     0.004648\nScale:          48721.4     0.003657     0.003284     0.005366\nAdd:            46592.6     0.006095     0.005151     0.008138\nTriad:          46431.4     0.006107     0.005169     0.008374\n-------------------------------------------------------------\nSolution Validates: avg error less than 1.000000e-13 on all three arrays\n-------------------------------------------------------------\n"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Explanation of Key Information:"})}),"\n",(0,t.jsxs)(n.p,{children:["The four metrics in the test results\u2014",(0,t.jsx)(n.code,{children:"Copy"}),", ",(0,t.jsx)(n.code,{children:"Scale"}),", ",(0,t.jsx)(n.code,{children:"Add"}),", and ",(0,t.jsx)(n.code,{children:"Triad"}),"\u2014represent bandwidth measurements. The test principles for these four operations are illustrated in the figure below:"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{src:"https://rdk-doc.oss-cn-beijing.aliyuncs.com/doc/images_to_upload/DDR_test_principle.png",alt:"DDR_test_principle"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Copy:"})," Reads a value from one memory location and writes it to another."]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Test Description:"})," In the Copy test, the system copies the contents of one array to another. This is the most basic memory bandwidth test, primarily evaluating performance during simple memory-to-memory data copying."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Bandwidth Result:"})," 47578.1 MB/s"]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Scale:"})," Reads a value from memory, performs a multiplication, and writes the result to another memory location."]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Test Description:"})," Scale involves not only memory bandwidth but also CPU computation, thus better reflecting the collaboration between processor and memory."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Bandwidth Result:"})," 47904.1 MB/s"]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Add:"})," Reads two values from memory, adds them, and writes the result to another memory location."]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Test Description:"})," The Add test simulates adding two arrays and storing the result in a third array, testing bandwidth requirements during parallel CPU and memory operations."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Bandwidth Result:"})," 44642.0 MB/s"]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Triad (Combined Operation):"})," Combines Copy, Scale, and Add operations. Specifically, it reads two values ",(0,t.jsx)(n.code,{children:"a"})," and ",(0,t.jsx)(n.code,{children:"b"})," from memory, performs a fused multiply-add operation (",(0,t.jsx)(n.code,{children:"a + scalar * b"}),"), and writes the result to another memory location."]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Test Description:"})," Triad not only adds two arrays but also scales the result with another array, representing a composite operation involving computation, addition, and memory access simultaneously."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Bandwidth Result:"})," 42987.3 MB/s"]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Meaning of Values in Output Results:"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Best Rate MB/s:"})," The highest memory transfer rate achieved during the operation, measured in megabytes per second (MB/s). Represents peak performance."]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Avg time:"})," Average time per operation in seconds, indicating average latency."]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Min time:"})," Shortest operation time in seconds, representing best-case performance in a single run."]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Max time:"})," Longest operation time in seconds, representing worst-case performance in a single run."]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"test-metrics",children:"Test Metrics"}),"\n",(0,t.jsx)(n.p,{children:"DDR bandwidth is typically calculated based on memory clock frequency and bus width, using the following formula:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-shell",children:"Bandwidth (MB/s) = Memory Clock Frequency (MHz) \xd7 2 \xd7 Bus Width (bit) / 8\n"})}),"\n",(0,t.jsx)(n.p,{children:"On the S100 platform, the DDR memory frequency is 4266 MHz (2133 \xd7 2), and the memory bus width is 96 bits (i.e., 12 bytes). Thus, the theoretical bandwidth is:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-shell",children:"Bandwidth (MB/s) = 6400 MHz \xd7 12 Byte = 76800 MB/s\n"})}),"\n",(0,t.jsx)(n.h3,{id:"pass-criteria",children:"Pass Criteria"}),"\n",(0,t.jsx)(n.p,{children:"Actual DDR bandwidth test results are usually lower than theoretical bandwidth. A typical standard is 60%\u201370% of the theoretical bandwidth. For the S100 platform, with a theoretical bandwidth of 76800 MB/s, the pass threshold is:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-shell",children:"Pass Criterion = ddr_score(76800) \xd7 0.6 = 46080\n"})}),"\n",(0,t.jsx)(n.h3,{id:"test-result",children:"Test Result"}),"\n",(0,t.jsxs)(n.p,{children:["Taking the ",(0,t.jsx)(n.code,{children:"Triad"})," operation\u2014which closely mimics real-world DDR usage\u2014as an example, its measured bandwidth exceeds the pass criterion of 46080 MB/s. Therefore, the test result meets the DDR bandwidth standard and satisfies expected performance requirements."]})]})}function h(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(c,{...e})}):c(e)}}}]);