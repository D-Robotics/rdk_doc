"use strict";(self.webpackChunkrdk_doc=self.webpackChunkrdk_doc||[]).push([[81282],{607:(e,n,a)=>{a.r(n),a.d(n,{assets:()=>c,contentTitle:()=>o,default:()=>p,frontMatter:()=>r,metadata:()=>i,toc:()=>d});const i=JSON.parse('{"id":"Basic_Application/pydev_demo_sample/usb_camera_sample","title":"3.3.8 USB Camera Sample Introduction","description":"Sample Overview","source":"@site/i18n/en/docusaurus-plugin-content-docs/current/03_Basic_Application/03_pydev_demo_sample/02_usb_camera_sample.md","sourceDirName":"03_Basic_Application/03_pydev_demo_sample","slug":"/Basic_Application/pydev_demo_sample/usb_camera_sample","permalink":"/rdk_doc/en/Basic_Application/pydev_demo_sample/usb_camera_sample","draft":false,"unlisted":false,"tags":[],"version":"current","lastUpdatedAt":1770604318000,"sidebarPosition":8,"frontMatter":{"sidebar_position":8},"sidebar":"tutorialSidebar","previous":{"title":"3.3.7 YOLOv5s v6/v7 Sample Introduction","permalink":"/rdk_doc/en/Basic_Application/pydev_demo_sample/yolov5s_v6_v7_sample"},"next":{"title":"3.3.9 MIPI Camera Sample Introduction","permalink":"/rdk_doc/en/Basic_Application/pydev_demo_sample/mipi_camera_sample"}}');var s=a(74848),t=a(28453);const r={sidebar_position:8},o="3.3.8 USB Camera Sample Introduction",c={},d=[{value:"Sample Overview",id:"sample-overview",level:2},{value:"Effect Demonstration",id:"effect-demonstration",level:2},{value:"Hardware Preparation",id:"hardware-preparation",level:2},{value:"Hardware Connection",id:"hardware-connection",level:3},{value:"Quick Start",id:"quick-start",level:2},{value:"Code and Board Location",id:"code-and-board-location",level:3},{value:"Compilation and Execution",id:"compilation-and-execution",level:3},{value:"Execution Results",id:"execution-results",level:3},{value:"Detailed Introduction",id:"detailed-introduction",level:2},{value:"Sample Program Parameter Options",id:"sample-program-parameter-options",level:3},{value:"Software Architecture Description",id:"software-architecture-description",level:3},{value:"API Flow Description",id:"api-flow-description",level:3},{value:"FAQ",id:"faq",level:3}];function l(e){const n={br:"br",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"338-usb-camera-sample-introduction",children:"3.3.8 USB Camera Sample Introduction"})}),"\n",(0,s.jsx)(n.h2,{id:"sample-overview",children:"Sample Overview"}),"\n",(0,s.jsxs)(n.p,{children:["The USB camera sample contains two ",(0,s.jsx)(n.strong,{children:"Python"})," interface development code examples located at ",(0,s.jsx)(n.code,{children:"/app/pydev_demo/02_usb_camera_sample/"}),", demonstrating how to use USB cameras for image acquisition and processing. These two examples respectively showcase:"]}),"\n",(0,s.jsx)(n.p,{children:"usb_camera_fcos.py: Real-time object detection, using the FCOS model for real-time inference on video streams captured by the USB camera, and displaying detection results via HDMI."}),"\n",(0,s.jsx)(n.p,{children:"usb_camera_snap.py: Single image capture, capturing one image from the USB camera and saving it as a file."}),"\n",(0,s.jsx)(n.h2,{id:"effect-demonstration",children:"Effect Demonstration"}),"\n",(0,s.jsx)(n.p,{children:"Effect of usb_camera_fcos.py"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"http://rdk-doc.oss-cn-beijing.aliyuncs.com/doc/img/03_Basic_Application/03_pydev_demo_sample/image/pydev_02_usb_fcos.png",alt:"output-img"})}),"\n",(0,s.jsx)(n.p,{children:"Effect of usb_camera_snap.py"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"http://rdk-doc.oss-cn-beijing.aliyuncs.com/doc/img/03_Basic_Application/03_pydev_demo_sample/image/pydev_02_usb_snap.png",alt:"output-img"})}),"\n",(0,s.jsx)(n.h2,{id:"hardware-preparation",children:"Hardware Preparation"}),"\n",(0,s.jsx)(n.h3,{id:"hardware-connection",children:"Hardware Connection"}),"\n",(0,s.jsx)(n.p,{children:"Prepare an RDK development board"}),"\n",(0,s.jsx)(n.p,{children:"Connect the USB camera to the USB interface of the development board"}),"\n",(0,s.jsx)(n.p,{children:"Connect the monitor to the development board via HDMI cable (only required for usb_camera_fcos.py display)"}),"\n",(0,s.jsx)(n.p,{children:"Connect the power cable and network cable"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"http://rdk-doc.oss-cn-beijing.aliyuncs.com/doc/img/03_Basic_Application/03_pydev_demo_sample/image/pydev_02_hw_connect.png",alt:"connect-img"})}),"\n",(0,s.jsx)(n.h2,{id:"quick-start",children:"Quick Start"}),"\n",(0,s.jsx)(n.h3,{id:"code-and-board-location",children:"Code and Board Location"}),"\n",(0,s.jsxs)(n.p,{children:["Navigate to ",(0,s.jsx)(n.code,{children:"/app/pydev_demo/02_usb_camera_sample/"})," location, where you can see the USB camera sample contains two files:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"root@ubuntu:/app/pydev_demo/02_usb_camera_sample# tree\n.\n\u251c\u2500\u2500 usb_camera_fcos.py\n\u2514\u2500\u2500 usb_camera_snap.py\n"})}),"\n",(0,s.jsx)(n.h3,{id:"compilation-and-execution",children:"Compilation and Execution"}),"\n",(0,s.jsx)(n.p,{children:"Python examples do not require compilation and can be run directly."}),"\n",(0,s.jsx)(n.p,{children:"Run usb_camera_snap.py"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"python3 usb_camera_snap.py\n"})}),"\n",(0,s.jsx)(n.p,{children:"Run usb_camera_fcos.py"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"python3 usb_camera_fcos.py\n"})}),"\n",(0,s.jsx)(n.h3,{id:"execution-results",children:"Execution Results"}),"\n",(0,s.jsx)(n.p,{children:"usb_camera_snap.py Execution Results: After running, the program will automatically search for available USB camera devices, capture one frame of image and save it as img.jpg in the current directory."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"root@ubuntu:/app/pydev_demo/02_usb_camera_sample# ./usb_camera_snap.py \nOpening video device: /dev/video0\nOpen USB camera successfully\nCorrupt JPEG data: 766 extraneous bytes before marker 0xd9\nImage saved as img.jpg\n"})}),"\n",(0,s.jsx)(n.p,{children:"usb_camera_fcos.py Execution Results: After running, the program will automatically search for available USB camera devices and start real-time object detection. Detection results will be displayed via HDMI, and target information with FPS will be printed to the console."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"root@ubuntu:/app/pydev_demo/02_usb_camera_sample# ./usb_camera_fcos.py \n[BPU_PLAT]BPU Platform Version(1.3.6)!\n[HBRT] set log level as 0. version = 3.15.55.0\n[DNN] Runtime version = 1.24.5_(3.15.55 HBRT)\n[A][DNN][packed_model.cpp:247][Model](2000-01-01,08:05:40.810.884) [HorizonRT] The model builder version = 1.23.5\n[W][DNN]bpu_model_info.cpp:491][Version](2000-01-01,08:05:40.891.732) Model: fcos_efficientnetb0_512x512_nv12. Inconsistency between the hbrt library version 3.15.55.0 and the model build version 3.15.47.0 detected, in order to ensure correct model results, it is recommended to use compilation tools and the BPU SDK from the same OpenExplorer package.\ntensor type: NV12\ndata type: uint8\nlayout: NCHW\nshape: (1, 3, 512, 512)\n15\ntensor type: int32\ndata type: int32\nlayout: NHWC\nshape: (1, 64, 64, 80)\ntensor type: int32\ndata type: int32\nlayout: NHWC\nshape: (1, 32, 32, 80)\ntensor type: int32\ndata type: int32\nlayout: NHWC\nshape: (1, 16, 16, 80)\ntensor type: int32\ndata type: int32\nlayout: NHWC\nshape: (1, 8, 8, 80)\ntensor type: int32\ndata type: int32\nlayout: NHWC\nshape: (1, 4, 4, 80)\ntensor type: int32\ndata type: int32\nlayout: NHWC\nshape: (1, 64, 64, 4)\ntensor type: int32\ndata type: int32\nlayout: NHWC\nshape: (1, 32, 32, 4)\ntensor type: int32\ndata type: int32\nlayout: NHWC\nshape: (1, 16, 16, 4)\ntensor type: int32\ndata type: int32\nlayout: NHWC\nshape: (1, 8, 8, 4)\ntensor type: int32\ndata type: int32\nlayout: NHWC\nshape: (1, 4, 4, 4)\ntensor type: int32\ndata type: int32\nlayout: NCHW\nshape: (1, 64, 64, 1)\ntensor type: int32\ndata type: int32\nlayout: NCHW\nshape: (1, 32, 32, 1)\ntensor type: int32\ndata type: int32\nlayout: NCHW\nshape: (1, 16, 16, 1)\ntensor type: int32\ndata type: int32\nlayout: NCHW\nshape: (1, 8, 8, 1)\ntensor type: int32\ndata type: int32\nlayout: NCHW\nshape: (1, 4, 4, 1)\nOpening video device: /dev/video0\nOpen usb camera successfully\n1920x1080\n1280x800\n1280x720\n720x576\n720x480\n640x480\nNo suitable display method found.\nRunning without preview window\nperson is in the picture with confidence:0.5758\nFrame#1 (1 fps) [2000-01-01 08:05:41]\nperson is in the picture with confidence:0.6214\nperson is in the picture with confidence:0.6050\n\n...............\n\n\n"})}),"\n",(0,s.jsx)(n.h2,{id:"detailed-introduction",children:"Detailed Introduction"}),"\n",(0,s.jsx)(n.h3,{id:"sample-program-parameter-options",children:"Sample Program Parameter Options"}),"\n",(0,s.jsx)(n.p,{children:"Both examples support specifying the USB camera device node. If not specified, they will automatically search for the first available USB camera."}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Run with specified device node:"}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"python3 usb_camera_snap.py /dev/video8\npython3 usb_camera_fcos.py /dev/video8\n"})}),"\n",(0,s.jsx)(n.h3,{id:"software-architecture-description",children:"Software Architecture Description"}),"\n",(0,s.jsx)(n.p,{children:"This sample contains two different functions, so the software architecture differs slightly. They are explained separately here."}),"\n",(0,s.jsx)(n.p,{children:"usb_camera_snap.py"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Camera Discovery: Automatically searches for available USB camera devices."}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Camera Configuration: Sets camera output format to MJPEG, resolution 1920x1080."}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Image Capture: Reads one frame of image."}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Image Saving: Saves the image as a jpg file."}),"\n"]}),"\n"]}),"\n",(0,s.jsx)("center",{children:(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"http://rdk-doc.oss-cn-beijing.aliyuncs.com/doc/img/03_Basic_Application/03_pydev_demo_sample/image/pydev_02_usb_camera_snap_software_arch.png",alt:"software_arch_1"})})}),"\n",(0,s.jsx)(n.p,{children:"usb_camera_fcos.py"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Model Loading: Loads the FCOS object detection model."}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Camera Discovery and Configuration: Same as usb_camera_snap.py, but resolution set to 640x480."}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Display Initialization: Initializes HDMI display."}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Real-time Inference Loop:"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Read camera frame"}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Preprocess image (scaling, color space conversion)"}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Model inference"}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Post-processing (parse detection results)"}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Draw detection boxes and display"}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Calculate and print FPS"}),"\n"]}),"\n"]}),"\n",(0,s.jsx)("center",{children:(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"http://rdk-doc.oss-cn-beijing.aliyuncs.com/doc/img/03_Basic_Application/03_pydev_demo_sample/image/pydev_02_usb_camera_fcos_software_arch.png",alt:"software_arch_2"})})}),"\n",(0,s.jsx)(n.h3,{id:"api-flow-description",children:"API Flow Description"}),"\n",(0,s.jsx)(n.p,{children:"usb_camera_snap.py\nThis example does not use SP API, but uses basic OpenCV APIs."}),"\n",(0,s.jsx)("center",{children:(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"http://rdk-doc.oss-cn-beijing.aliyuncs.com/doc/img/03_Basic_Application/03_pydev_demo_sample/image/pydev_02_usb_camera_snap_api_flow.png",alt:"API_Flow_1"})})}),"\n",(0,s.jsx)(n.p,{children:"usb_camera_fcos.py\nThis example uses OpenCV interfaces as well as display resource interfaces and model operation interfaces in sp_dev."}),"\n",(0,s.jsx)("center",{children:(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"http://rdk-doc.oss-cn-beijing.aliyuncs.com/doc/img/03_Basic_Application/03_pydev_demo_sample/image/pydev_02_usb_camera_fcos_api_flow.png",alt:"API_Flow_2"})})}),"\n",(0,s.jsx)(n.h3,{id:"faq",children:"FAQ"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Q:"}),' What should I do when the sample prompts "No USB camera found" during execution?',(0,s.jsx)(n.br,{}),"\n",(0,s.jsx)(n.strong,{children:"A:"})," Please check if the USB camera is correctly connected and ensure the device node (such as /dev/video8) exists. You can try using the command ",(0,s.jsx)(n.code,{children:"v4l2-ctl --list-devices"})," to view available camera devices."]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Q:"})," What should I do if HDMI display is abnormal when running usb_camera_fcos.py?",(0,s.jsx)(n.br,{}),"\n",(0,s.jsx)(n.strong,{children:"A:"})," Please check the HDMI connection and ensure the display service has been stopped (such as using ",(0,s.jsx)(n.code,{children:"systemctl stop lightdm"}),")."]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Q:"})," How to adjust the detection threshold of usb_camera_fcos.py?",(0,s.jsx)(n.br,{}),"\n",(0,s.jsx)(n.strong,{children:"A:"})," Modify the value of ",(0,s.jsx)(n.code,{children:"fcos_postprocess_info.score_threshold"})," in the code, for example, change it to 0.5."]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Q:"})," How to modify the save path of usb_camera_snap.py?",(0,s.jsx)(n.br,{}),"\n",(0,s.jsx)(n.strong,{children:"A:"})," Modify the ",(0,s.jsx)(n.code,{children:"cv2.imwrite"})," parameter in the code to specify the full path, such as ",(0,s.jsx)(n.code,{children:"/home/root/image.jpg"}),"."]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Q:"})," What should I do if the frame rate is very low when running usb_camera_fcos.py?",(0,s.jsx)(n.br,{}),"\n",(0,s.jsx)(n.strong,{children:"A:"})," You can try reducing the camera resolution or switching to a lighter model version."]})]})}function p(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(l,{...e})}):l(e)}},28453:(e,n,a)=>{a.d(n,{R:()=>r,x:()=>o});var i=a(96540);const s={},t=i.createContext(s);function r(e){const n=i.useContext(t);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:r(e.components),i.createElement(t.Provider,{value:n},e.children)}}}]);