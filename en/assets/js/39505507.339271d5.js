"use strict";(self.webpackChunkrdk_doc=self.webpackChunkrdk_doc||[]).push([[95833],{11470:(e,r,n)=>{n.d(r,{A:()=>y});var t=n(96540),i=n(34164),o=n(23104),s=n(56347),a=n(205),l=n(57485),d=n(31682),c=n(70679);function g(e){return t.Children.toArray(e).filter(e=>"\n"!==e).map(e=>{if(!e||(0,t.isValidElement)(e)&&function(e){const{props:r}=e;return!!r&&"object"==typeof r&&"value"in r}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)})?.filter(Boolean)??[]}function u(e){const{values:r,children:n}=e;return(0,t.useMemo)(()=>{const e=r??function(e){return g(e).map(({props:{value:e,label:r,attributes:n,default:t}})=>({value:e,label:r,attributes:n,default:t}))}(n);return function(e){const r=(0,d.XI)(e,(e,r)=>e.value===r.value);if(r.length>0)throw new Error(`Docusaurus error: Duplicate values "${r.map(e=>e.value).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e},[r,n])}function h({value:e,tabValues:r}){return r.some(r=>r.value===e)}function p({queryString:e=!1,groupId:r}){const n=(0,s.W6)(),i=function({queryString:e=!1,groupId:r}){if("string"==typeof e)return e;if(!1===e)return null;if(!0===e&&!r)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return r??null}({queryString:e,groupId:r});return[(0,l.aZ)(i),(0,t.useCallback)(e=>{if(!i)return;const r=new URLSearchParams(n.location.search);r.set(i,e),n.replace({...n.location,search:r.toString()})},[i,n])]}function m(e){const{defaultValue:r,queryString:n=!1,groupId:i}=e,o=u(e),[s,l]=(0,t.useState)(()=>function({defaultValue:e,tabValues:r}){if(0===r.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(e){if(!h({value:e,tabValues:r}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${e}" but none of its children has the corresponding value. Available values are: ${r.map(e=>e.value).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return e}const n=r.find(e=>e.default)??r[0];if(!n)throw new Error("Unexpected error: 0 tabValues");return n.value}({defaultValue:r,tabValues:o})),[d,g]=p({queryString:n,groupId:i}),[m,b]=function({groupId:e}){const r=function(e){return e?`docusaurus.tab.${e}`:null}(e),[n,i]=(0,c.Dv)(r);return[n,(0,t.useCallback)(e=>{r&&i.set(e)},[r,i])]}({groupId:i}),f=(()=>{const e=d??m;return h({value:e,tabValues:o})?e:null})();(0,a.A)(()=>{f&&l(f)},[f]);return{selectedValue:s,selectValue:(0,t.useCallback)(e=>{if(!h({value:e,tabValues:o}))throw new Error(`Can't select invalid tab value=${e}`);l(e),g(e),b(e)},[g,b,o]),tabValues:o}}var b=n(92303);const f={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};var _=n(74848);function x({className:e,block:r,selectedValue:n,selectValue:t,tabValues:s}){const a=[],{blockElementScrollPositionUntilNextRender:l}=(0,o.a_)(),d=e=>{const r=e.currentTarget,i=a.indexOf(r),o=s[i].value;o!==n&&(l(r),t(o))},c=e=>{let r=null;switch(e.key){case"Enter":d(e);break;case"ArrowRight":{const n=a.indexOf(e.currentTarget)+1;r=a[n]??a[0];break}case"ArrowLeft":{const n=a.indexOf(e.currentTarget)-1;r=a[n]??a[a.length-1];break}}r?.focus()};return(0,_.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,i.A)("tabs",{"tabs--block":r},e),children:s.map(({value:e,label:r,attributes:t})=>(0,_.jsx)("li",{role:"tab",tabIndex:n===e?0:-1,"aria-selected":n===e,ref:e=>{a.push(e)},onKeyDown:c,onClick:d,...t,className:(0,i.A)("tabs__item",f.tabItem,t?.className,{"tabs__item--active":n===e}),children:r??e},e))})}function v({lazy:e,children:r,selectedValue:n}){const o=(Array.isArray(r)?r:[r]).filter(Boolean);if(e){const e=o.find(e=>e.props.value===n);return e?(0,t.cloneElement)(e,{className:(0,i.A)("margin-top--md",e.props.className)}):null}return(0,_.jsx)("div",{className:"margin-top--md",children:o.map((e,r)=>(0,t.cloneElement)(e,{key:r,hidden:e.props.value!==n}))})}function j(e){const r=m(e);return(0,_.jsxs)("div",{className:(0,i.A)("tabs-container",f.tabList),children:[(0,_.jsx)(x,{...r,...e}),(0,_.jsx)(v,{...r,...e})]})}function y(e){const r=(0,b.A)();return(0,_.jsx)(j,{...e,children:g(e.children)},String(r))}},19365:(e,r,n)=>{n.d(r,{A:()=>s});n(96540);var t=n(34164);const i={tabItem:"tabItem_Ymn6"};var o=n(74848);function s({children:e,hidden:r,className:n}){return(0,o.jsx)("div",{role:"tabpanel",className:(0,t.A)(i.tabItem,n),hidden:r,children:e})}},28453:(e,r,n)=>{n.d(r,{R:()=>s,x:()=>a});var t=n(96540);const i={},o=t.createContext(i);function s(e){const r=t.useContext(o);return t.useMemo(function(){return"function"==typeof e?e(r):{...r,...e}},[r,e])}function a(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:s(e.components),t.createElement(o.Provider,{value:r},e.children)}},82830:(e,r,n)=>{n.r(r),n.d(r,{assets:()=>c,contentTitle:()=>d,default:()=>h,frontMatter:()=>l,metadata:()=>t,toc:()=>g});const t=JSON.parse('{"id":"Robot_development/quick_demo/demo_tool","title":"5.2.7 Tools","description":"Image Publishing Tool","source":"@site/i18n/en/docusaurus-plugin-content-docs/current/05_Robot_development/02_quick_demo/demo_tool.md","sourceDirName":"05_Robot_development/02_quick_demo","slug":"/Robot_development/quick_demo/demo_tool","permalink":"/rdk_doc/en/Robot_development/quick_demo/demo_tool","draft":false,"unlisted":false,"tags":[],"version":"current","lastUpdatedAt":1750824357000,"sidebarPosition":7,"frontMatter":{"sidebar_position":7},"sidebar":"tutorialSidebar","previous":{"title":"5.2.6 Model Inference","permalink":"/rdk_doc/en/Robot_development/quick_demo/ai_predict"},"next":{"title":"5.2.8 Text to Speech","permalink":"/rdk_doc/en/Robot_development/quick_demo/hobot_tts"}}');var i=n(74848),o=n(28453),s=n(11470),a=n(19365);const l={sidebar_position:7},d="5.2.7 Tools",c={},g=[{value:"Image Publishing Tool",id:"image-publishing-tool",level:2},{value:"Introduction",id:"introduction",level:3},{value:"Supported Platforms",id:"supported-platforms",level:3},{value:"Preparations",id:"preparations",level:3},{value:"RDK",id:"rdk",level:4},{value:"Usage of a image",id:"usage-of-a-image",level:3},{value:"RDK",id:"rdk-1",level:4},{value:"Result Analysis",id:"result-analysis",level:3},{value:"Usage of a video",id:"usage-of-a-video",level:3},{value:"RDK",id:"rdk-2",level:4},{value:"Result Analysis",id:"result-analysis-1",level:3},{value:"Trigger Recording Tool",id:"trigger-recording-tool",level:2},{value:"Introduction",id:"introduction-1",level:3},{value:"Supported Platforms",id:"supported-platforms-1",level:3},{value:"Usage",id:"usage",level:3},{value:"Initialization",id:"initialization",level:4},{value:"Configuration Description",id:"configuration-description",level:4},{value:"Preparation",id:"preparation",level:3},{value:"RDK",id:"rdk-3",level:4},{value:"Usage",id:"usage-1",level:3},{value:"RDK",id:"rdk-4",level:4},{value:"Result Analysis",id:"result-analysis-2",level:3},{value:"Additional Functionality",id:"additional-functionality",level:3},{value:"Sending Tasks to Trigger Module",id:"sending-tasks-to-trigger-module",level:4},{value:"Trigger Protocol",id:"trigger-protocol",level:5},{value:"Running",id:"running",level:5},{value:"Log",id:"log",level:5}];function u(e){const r={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",h5:"h5",header:"header",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,o.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(r.header,{children:(0,i.jsx)(r.h1,{id:"527-tools",children:"5.2.7 Tools"})}),"\n","\n",(0,i.jsx)(r.h2,{id:"image-publishing-tool",children:"Image Publishing Tool"}),"\n",(0,i.jsx)(r.h3,{id:"introduction",children:"Introduction"}),"\n",(0,i.jsx)(r.p,{children:"The Image Publishing Tool supports reading local image or video files in batches and publishing them in ROS message, thereby improving algorithm debugging and deployment efficiency."}),"\n",(0,i.jsx)(r.p,{children:"For image publishing, it supports reading JPEG/JPG/PNG/NV12 format images and publishing compressed images or converting compressed images to NV12 format for publishing."}),"\n",(0,i.jsx)(r.p,{children:"For video publishing, it supports H264/H265/MP4 formats. After reading the video file, it extracts the relevant video stream for publishing."}),"\n",(0,i.jsxs)(r.p,{children:["Code repository:  (",(0,i.jsx)(r.a,{href:"https://github.com/D-Robotics/hobot_image_publisher.git",children:"https://github.com/D-Robotics/hobot_image_publisher.git"}),")"]}),"\n",(0,i.jsx)(r.h3,{id:"supported-platforms",children:"Supported Platforms"}),"\n",(0,i.jsxs)(r.table,{children:[(0,i.jsx)(r.thead,{children:(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.th,{children:"Platform"}),(0,i.jsx)(r.th,{children:"System"})]})}),(0,i.jsxs)(r.tbody,{children:[(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:"RDK X3, RDK X3 Module"}),(0,i.jsx)(r.td,{children:"Ubuntu 20.04 (Foxy), Ubuntu 22.04 (Humble)"})]}),(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:"RDK X5, RDK S100"}),(0,i.jsx)(r.td,{children:"Ubuntu 22.04 (Humble)"})]})]})]}),"\n",(0,i.jsx)(r.h3,{id:"preparations",children:"Preparations"}),"\n",(0,i.jsx)(r.h4,{id:"rdk",children:"RDK"}),"\n",(0,i.jsxs)(r.ol,{children:["\n",(0,i.jsxs)(r.li,{children:["\n",(0,i.jsx)(r.p,{children:"The RDK has been burned with the  Ubuntu 20.04/22.04 system image provided by D-Robotics."}),"\n"]}),"\n",(0,i.jsxs)(r.li,{children:["\n",(0,i.jsx)(r.p,{children:"The RDK has successfully installed tros.b."}),"\n"]}),"\n",(0,i.jsxs)(r.li,{children:["\n",(0,i.jsx)(r.p,{children:"The RDK can be accessed via network from a PC."}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(r.h3,{id:"usage-of-a-image",children:"Usage of a image"}),"\n",(0,i.jsx)(r.p,{children:"Read a local NV12 image in a loop and publish it. Use the image codec module to compress the image and encode it into JPEG format, and display the image on the PC's web interface."}),"\n",(0,i.jsx)(r.h4,{id:"rdk-1",children:"RDK"}),"\n",(0,i.jsxs)(s.A,{groupId:"tros-distro",children:[(0,i.jsx)(a.A,{value:"foxy",label:"Foxy",children:(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-bash",children:"# Configure the tros.b environment\nsource /opt/tros/setup.bash\n"})})}),(0,i.jsx)(a.A,{value:"humble",label:"Humble",children:(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-bash",children:"# Configure the tros.b environment\nsource /opt/tros/humble/setup.bash\n"})})})]}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-shell",children:"# Copy the configuration file required for running the example from the installation path of tros.b.\ncp -r /opt/tros/${TROS_DISTRO}/lib/hobot_image_publisher/config/ .\n\n# Start the launch file\nros2 launch hobot_image_publisher hobot_image_publisher_demo.launch.py\n"})}),"\n",(0,i.jsx)(r.h3,{id:"result-analysis",children:"Result Analysis"}),"\n",(0,i.jsx)(r.p,{children:"The terminal output during runtime is as follows:"}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-text",children:"[INFO] [launch]: All log files can be found below /root/.ros/log/2022-08-19-12-58-02-288516-ubuntu-24492\n[INFO] [launch]: Default logging verbosity is set to INFO\nwebserver has launch\n[INFO] [hobot_image_pub-1]: process started with pid [24511]\n[INFO] [hobot_codec_republish-2]: process started with pid [24513]\n[INFO] [websocket-3]: process started with pid [24519]\n"})}),"\n",(0,i.jsx)(r.p,{children:"The log output shows that the webserver has been started, and hobot_image_pub, hobot_codec_republish, and websocket are all running properly."}),"\n",(0,i.jsxs)(r.p,{children:["To view the image display effect, open a web browser on the PC and enter  ",(0,i.jsx)(r.code,{children:"http://IP:8000"})," (where IP is the IP address of the RDK):"]}),"\n",(0,i.jsx)(r.p,{children:(0,i.jsx)(r.img,{src:"https://rdk-doc.oss-cn-beijing.aliyuncs.com/doc/img/05_Robot_development/02_quick_demo/image/demo_tool/show.png",alt:"hobot_img_pub"})}),"\n",(0,i.jsx)(r.h3,{id:"usage-of-a-video",children:"Usage of a video"}),"\n",(0,i.jsx)(r.p,{children:"Read the video.list file locally, obtain the paths of the video files in the list file, and publish them in a loop. First, use the image codec module to decode the video stream into NV12 format images, and then use the image codec module to compress and encode the images into JPEG format for display on the web of the PC."}),"\n",(0,i.jsx)(r.h4,{id:"rdk-2",children:"RDK"}),"\n",(0,i.jsxs)(s.A,{groupId:"tros-distro",children:[(0,i.jsx)(a.A,{value:"foxy",label:"Foxy",children:(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-bash",children:"# Configure the tros.b environment\nsource /opt/tros/setup.bash\n"})})}),(0,i.jsx)(a.A,{value:"humble",label:"Humble",children:(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-bash",children:"# Configure the tros.b environment\nsource /opt/tros/humble/setup.bash\n"})})})]}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-shell",children:"# Copy the image files needed for the example from the installation path of tros.b\ncp -r /opt/tros/lib/hobot_image_publisher/config/ .\n\n# Start the launch file\nros2 launch hobot_image_publisher hobot_image_publisher_videolist_demo.launch.py\n"})}),"\n",(0,i.jsx)(r.h3,{id:"result-analysis-1",children:"Result Analysis"}),"\n",(0,i.jsx)(r.p,{children:"The following information is displayed in the terminal output during execution:"}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-text",children:"[INFO] [launch]: All log files can be found below /root/.ros/log/2022-10-22-21-44-03-663907-ubuntu-702475\n[INFO] [launch]: Default logging verbosity is set to INFO\nwebserver has launched\n[INFO] [hobot_image_pub-1]: process started with pid [702597]\n[INFO] [hobot_codec_republish-2]: process started with pid [702599]\n[INFO] [hobot_codec_republish-3]: process started with pid [702601]\n[INFO] [websocket-4]: process started with pid [702603]\n"})}),"\n",(0,i.jsx)(r.p,{children:"The output log shows that the webserver has started and hobot_image_pub, hobot_codec_republish, and websocket are all running normally."}),"\n",(0,i.jsxs)(r.p,{children:["To view the image display effect, enter ",(0,i.jsx)(r.code,{children:"http://IP:8000"})," in the browser on the PC (where IP is the IP address of the RDK):"]}),"\n",(0,i.jsx)(r.p,{children:(0,i.jsx)(r.img,{src:"https://rdk-doc.oss-cn-beijing.aliyuncs.com/doc/img/05_Robot_development/02_quick_demo/image/demo_tool/mp4show.jpg",alt:"hobot_img_pub"})}),"\n",(0,i.jsx)(r.h2,{id:"trigger-recording-tool",children:"Trigger Recording Tool"}),"\n",(0,i.jsx)(r.h3,{id:"introduction-1",children:"Introduction"}),"\n",(0,i.jsx)(r.p,{children:"Trigger is a mechanism that detects changes in the subscribed messages of the Trigger module, such as changes in the number of detection boxes or changes in car control information. It triggers corresponding events to record the specified time interval of ROS2 messages, helping developers locate and reproduce perception, control, and other issues in robot scenes."}),"\n",(0,i.jsx)(r.p,{children:"The trigger_node package is a Trigger module developed by D-Robotics based on ROS2, which is used to obtain specified rosbag data after triggering events. The package supports direct subscription to ai_msg/msg/PerceptionTargets topics. In the topic callback function, Trigger events are triggered and rosbag packages related to the Trigger events are recorded. Finally, the Trigger event information is saved and published in std_msg/msg/String type Trigger event topics."}),"\n",(0,i.jsx)(r.p,{children:"This chapter provides an example of using the Trigger module. The example demonstrates the functionality of subscribing to garbage detection box information and triggering a Trigger event based on whether the number of garbage detection boxes is greater than or equal to 3."}),"\n",(0,i.jsxs)(r.p,{children:["Code Repository:  (",(0,i.jsx)(r.a,{href:"https://github.com/D-Robotics/hobot_trigger.git",children:"https://github.com/D-Robotics/hobot_trigger.git"}),")"]}),"\n",(0,i.jsx)(r.p,{children:"Application Scenarios: data closed-loop link, robot Trigger event reporting scenario, can be combined with perception, control, and other tasks to record rosbag data when Trigger events occur."}),"\n",(0,i.jsx)(r.h3,{id:"supported-platforms-1",children:"Supported Platforms"}),"\n",(0,i.jsxs)(r.table,{children:[(0,i.jsx)(r.thead,{children:(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.th,{children:"Platform"}),(0,i.jsx)(r.th,{children:"System"}),(0,i.jsx)(r.th,{children:"Function"})]})}),(0,i.jsx)(r.tbody,{children:(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:"RDK X3, RDK X3 Module"}),(0,i.jsx)(r.td,{children:"Ubuntu 20.04 (Foxy), Ubuntu 22.04 (Humble)"}),(0,i.jsx)(r.td,{children:"Start MIPI/USB camera, trigger recording, and record rosbag data"})]})})]}),"\n",(0,i.jsx)(r.h3,{id:"usage",children:"Usage"}),"\n",(0,i.jsx)(r.h4,{id:"initialization",children:"Initialization"}),"\n",(0,i.jsx)(r.p,{children:"The Trigger module defines the parameters required for initialization configuration."}),"\n",(0,i.jsxs)(r.p,{children:["The ",(0,i.jsx)(r.code,{children:"config_file"})," is json, and the configuration is as follows:"]}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-bash",children:'{ \n  "domain": Trigger event domain. For example, cleaning robot, humanoid robot, etc. Different Trigger types are differentiated by domain for different types of robots.\n\n  "desc": Trigger module description.\n\n  "duration_ts_back": Duration after Trigger occurrence for recording.\n\n  "duration_ts_front": Duration before Trigger occurrence for recording.\n  \n  "level": Priority of Trigger event. When multiple different Triggers occur, a central node can be used to filter high-priority or low-priority Trigger events.\n  \n  "src_module_id": Module ID where Trigger occurred, used for managing different Trigger modules to meet different business requirements.\n  \n  "status": Trigger status, \'0\': off, \'1\': on.\n  \n  "strategy_version": Version number of the Trigger module strategy.\n  \n  "topics": List of topics that need to be recorded, including topic names.\n  \n  "trigger_type": Trigger type ID. Each Trigger module may have more than one triggering condition, for example, detecting 2 pieces of garbage is one type, detecting 3 pieces of garbage is another type.\n  \n  "unique_id": Unique device identifier.\n  \n  "version": Trigger module version information.\n  \n  "extra_kv": Other redundant extension information can be recorded here.\n}\n'})}),"\n",(0,i.jsx)(r.h4,{id:"configuration-description",children:"Configuration Description"}),"\n",(0,i.jsxs)(r.p,{children:["In the ",(0,i.jsx)(r.code,{children:"trigger_node"})," base class, the ",(0,i.jsx)(r.code,{children:"Config"})," structure is defined, in which some configurations are consistent with the Trigger configuration during initialization, while the remaining content needs to be filled according to the actual situation when the Trigger is triggered."]}),"\n",(0,i.jsxs)(r.p,{children:["When users develop based on ",(0,i.jsx)(r.code,{children:"Trigger_node"}),', they only need to instantiate a structure variable each time the Trigger occurs, fill in the relevant information when the Trigger occurs in the structure variable, such as "timestamp", "gps_pos", etc., and pass it to the Trigger event recording queue ',(0,i.jsx)(r.code,{children:"requests_"}),"."]}),"\n",(0,i.jsxs)(r.p,{children:["Based on this, users can develop custom Trigger modules. For more information, please refer to the implementation method of ",(0,i.jsx)(r.code,{children:"trigger_node_example"})," in the code repository."]}),"\n",(0,i.jsxs)(r.p,{children:["Code repository:  (",(0,i.jsx)(r.a,{href:"https://github.com/D-Robotics/hobot_trigger.git",children:"https://github.com/D-Robotics/hobot_trigger.git"}),")"]}),"\n",(0,i.jsx)(r.p,{children:"The structure information is as follows:"}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-c++",children:"struct Config {\n  std::string domain;       // Trigger event domain\n  std::string desc;         // Trigger description information\n  long duration_ts_back;    // Duration of recording after Trigger occurs\n  long duration_ts_front;   // Duration of recording before Trigger occurs\n  GPS_POS gps_pos;          // GPS positioning\n  int level;                // Priority level\n  std::string rosbag_path;  // Local file path of rosbag after Trigger occurs\n  int src_module_id;        // Module that Trigger occurs\n  int status;               // Trigger status\n  std::string strategy_version; // Strategy version number\n  long timestamp;           // Trigger occurrence timestamp\n  std::vector<std::string> topics;    // List of topics to be recorded, including topic names and types\n  int trigger_type;         // Trigger type\n  std::string unique_id;    // Device unique identifier\n  std::string version;      // Trigger version information\n  std::vector<EXTRA_KV> extra_kv;   // Additional information\n};\n"})}),"\n",(0,i.jsx)(r.h3,{id:"preparation",children:"Preparation"}),"\n",(0,i.jsx)(r.h4,{id:"rdk-3",children:"RDK"}),"\n",(0,i.jsxs)(r.ol,{children:["\n",(0,i.jsxs)(r.li,{children:["\n",(0,i.jsx)(r.p,{children:"RDK has burned the  Ubuntu 20.04/22.04 system image provided by D-Robotics."}),"\n"]}),"\n",(0,i.jsxs)(r.li,{children:["\n",(0,i.jsx)(r.p,{children:"RDK has successfully installed TogetheROS.Bot."}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(r.h3,{id:"usage-1",children:"Usage"}),"\n",(0,i.jsx)(r.h4,{id:"rdk-4",children:"RDK"}),"\n",(0,i.jsx)(r.p,{children:(0,i.jsx)(r.strong,{children:"Publish Images with MIPI Camera"})}),"\n",(0,i.jsxs)(s.A,{groupId:"tros-distro",children:[(0,i.jsx)(a.A,{value:"foxy",label:"Foxy",children:(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-bash",children:"# Configure the tros.b environment\nsource /opt/tros/setup.bash\n"})})}),(0,i.jsx)(a.A,{value:"humble",label:"Humble",children:(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-bash",children:"apt install ros-humble-rosbag2-storage-mcap\n\n# Configure the tros.b environment\nsource /opt/tros/humble/setup.bash\n"})})})]}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-shell",children:"# Copy the necessary configuration files for the example to run from the installation path of tros\ncp -r /opt/tros/lib/mono2d_trash_detection/config/ .\ncp -r /opt/tros/lib/trigger_node_example/config/ .\n\n# Configure MIPI camera\nexport CAM_TYPE=mipi\n\n# Launch the launch file\nros2 launch trigger_node_example hobot_trigger_example.launch.py\n"})}),"\n",(0,i.jsx)(r.p,{children:(0,i.jsx)(r.strong,{children:"Publishing Images using a USB Camera"})}),"\n",(0,i.jsxs)(s.A,{groupId:"tros-distro",children:[(0,i.jsx)(a.A,{value:"foxy",label:"Foxy",children:(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-bash",children:"# Configure the tros.b environment\nsource /opt/tros/setup.bash\n"})})}),(0,i.jsx)(a.A,{value:"humble",label:"Humble",children:(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-bash",children:"# Configure the tros.b environment\nsource /opt/tros/humble/setup.bash\n"})})})]}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-shell",children:"# Copy the necessary configuration files from the installation path of tros.\ncp -r /opt/tros/lib/mono2d_trash_detection/config/ .\ncp -r /opt/tros/lib/trigger_node_example/config/ .\n\n# Configure the USB camera\nexport CAM_TYPE=usb\n\n# Launch the launch file\nros2 launch trigger_node_example hobot_trigger_example.launch.py\n"})}),"\n",(0,i.jsx)(r.h3,{id:"result-analysis-2",children:"Result Analysis"}),"\n",(0,i.jsx)(r.p,{children:(0,i.jsx)(r.strong,{children:"Publishing Images using a MIPI Camera"})}),"\n",(0,i.jsx)(r.p,{children:"After package initialization, the following information will be displayed in the terminal:"}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-shell",children:'  [INFO] [launch]: All log files can be found below /root/.ros/log/2023-05-13-17-31-53-158704-ubuntu-2981490\n   [INFO] [launch]: Default logging verbosity is set to INFO\n   [INFO] [trigger_node_example-1]: process started with pid [2981766]\n   [trigger_node_example-1] [WARN] [1683970314.850652382] [hobot_trigger]: Parameter:\n   [trigger_node_example-1]  cache_path: /home/hobot/recorder/\n   [trigger_node_example-1]  config_file: config/trigger_config.json\n   [trigger_node_example-1]  format: mcap\n   [trigger_node_example-1]  isRecord(1:record, 0:norecord): 1\n   [trigger_node_example-1]  agent_msg_sub_topic_name: /hobot_agent\n   [trigger_node_example-1]  event_msg_sub_topic_name: /ai_msg_mono2d_trash_detection\n   [trigger_node_example-1]  msg_pub_topic_name: /hobot_trigger\n   [trigger_node_example-1]  config detail: {"domain":"robot","desc":"trigger lane","duration_ts_back":5000,"duration_ts_front":5000,"level":1,"rosbag_path":"","src_module_id":203,"timestamp":-1,"topic":["/image_raw/compressed","/ai_msg_mono2d_trash_detection"],"trigger_type":1110,"unique_id":"v1.0.0\\n","version":"v1.0.0\\n"}\n   [trigger_node_example-1] [WARN] [1683970314.893573769] [hobot_trigger]: TriggerNode Init Succeed!\n   [trigger_node_example-1] [WARN] [1683970314.898132256] [example]: TriggerExampleNode Init.\n   [trigger_node_example-1] [WARN] [1683970315.931225440] [example]: Trigger Event!\n   [trigger_node_example-1] [WARN] [1683970322.178604839] [rosbag2_storage_mcap]: no message indices found, falling back to reading in file order\n   [trigger_node_example-1] [WARN] [1683970323.007470033] [hobot_trigger]: Trigger Event Report. Trigger moudle id: 203, type id: 1110\n   [trigger_node_example-1]  Report message: {"domain":"","desc":"trigger lane","duration_ts_back":5000,"duration_ts_front":5000,"level":1,"rosbag_path":"trigger/OriginBot002_20230513-173155-931/OriginBot002_20230513-173155-931_0.mcap","src_module_id":203,"timestamp":1683970315931,"topic":["/image_raw/compressed","/ai_msg_mono2d_trash_detection"],"trigger_type":1110,"unique_id":"bot","version":"v1.0.0"}\n\n'})}),"\n",(0,i.jsx)(r.p,{children:'The rosbag generated by Trigger will be recorded in the "trigger" directory of the current running directory. The recorded rosbag data can be played in foxglove. For instructions on how to play rosbag files in foxglove, refer to Section 2.2 Display - foxglove in the manual.The effect is as follows:'}),"\n",(0,i.jsx)(r.p,{children:(0,i.jsx)(r.img,{src:"https://rdk-doc.oss-cn-beijing.aliyuncs.com/doc/img/05_Robot_development/02_quick_demo/image/demo_tool/trigger_example_trash_det.gif",alt:""})}),"\n",(0,i.jsx)(r.p,{children:"This Trigger example records data 5 seconds before and after an event. At the same time, you can see that the Trigger event occurred in the middle of the event, and the reason for the Trigger event was recorded: a piece of trash was thrown into the scene, causing the number of trash in the scene to reach three, triggering the Trigger."}),"\n",(0,i.jsx)(r.h3,{id:"additional-functionality",children:"Additional Functionality"}),"\n",(0,i.jsx)(r.h4,{id:"sending-tasks-to-trigger-module",children:"Sending Tasks to Trigger Module"}),"\n",(0,i.jsx)(r.p,{children:"The Trigger module supports receiving Trigger tasks from other nodes to control Trigger configuration. The tasks can be sent through publishing std_msgs topic messages, where the message data is in json format as a string. Send the task protocol to the Trigger module."}),"\n",(0,i.jsx)(r.h5,{id:"trigger-protocol",children:"Trigger Protocol"}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-json",children:'{\n   "version": "v0.0.1_20230421",       // Trigger module version information.\n   "trigger_status": true,             // Trigger status, \'false\': off, \'true\': on.\n   "strategy": [\n      {\n            "src_module_id": 203,      // ID of the module where the Trigger occurs.\n            "trigger_type": 1110,      // Trigger type ID.\n            "level": 1,                // Priority of the Trigger event.\n            "desc": "",                // Description of the Trigger module.\n            "duration_ts_back": 5000,  // Duration of recording after Trigger occurred.\n            "duration_ts_front": 3000  // Duration of recording before Trigger occurred.\n      }\n   ]\n}\n'})}),"\n",(0,i.jsx)(r.h5,{id:"running",children:"Running"}),"\n",(0,i.jsx)(r.p,{children:'Based on starting the Trigger node earlier, in another terminal, publish a topic message named "/hobot_agent" using std_msgs.'}),"\n",(0,i.jsxs)(s.A,{groupId:"tros-distro",children:[(0,i.jsx)(a.A,{value:"foxy",label:"Foxy",children:(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-bash",children:"# Configure the tros.b environment\nsource /opt/tros/setup.bash\n"})})}),(0,i.jsx)(a.A,{value:"humble",label:"Humble",children:(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-bash",children:"# Configure the tros.b environment\nsource /opt/tros/humble/setup.bash\n"})})})]}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-shell",children:'# Publish a topic message named "/hobot_agent" using std_msgs\nros2 topic pub /hobot_agent std_msgs/String "data: \'{\\"version\\":\\"v0.0.1_20230421\\",\\"trigger_status\\":true,\\"strategy\\":[{\\"src_module_id\\":203,\\"trigger_type\\":1110,\\"status\\":true,\\"level\\":1,\\"desc\\":\\"test\\",\\"duration_ts_back\\":5000,\\"duration_ts_front\\":3000}]}\'"\n'})}),"\n",(0,i.jsx)(r.h5,{id:"log",children:"Log"}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-shell",children:'[WARN] [1691670626.026737642] [hobot_trigger]: TriggerNode Init Succeed!\n[WARN] [1691670626.026859316] [example]: TriggerExampleNode Init.\n[INFO] [1691670626.517232775] [TriggerNode]: Updated Trigger Config: {"domain":"robot","desc":"trigger lane","duration_ts_back":5000,"duration_ts_front":3000,"gps_pos":{"latitude":-1,"longitude":-1},"level":1,"rosbag_path":"","src_module_id":203,"strategy_version":"Robot_sweeper_V1.0_20230526","timestamp":0,"topic":["/image_raw/compressed","/ai_msg_mono2d_trash_detection","/hobot_visualization"],"trigger_type":1110,"unique_id":"OriginBot002","version":"v0.0.1_20230421","extra_kv":[]}\n'})}),"\n",(0,i.jsx)(r.p,{children:"Analysis: When sending configuration tasks to the Trigger module, the configuration of the Trigger node can be successfully updated (the log of the Trigger node shows INFO to see the log update)."})]})}function h(e={}){const{wrapper:r}={...(0,o.R)(),...e.components};return r?(0,i.jsx)(r,{...e,children:(0,i.jsx)(u,{...e})}):u(e)}}}]);