"use strict";(self.webpackChunkrdk_doc=self.webpackChunkrdk_doc||[]).push([[9255],{28453:(e,n,s)=>{s.d(n,{R:()=>t,x:()=>l});var d=s(96540);const r={},i=d.createContext(r);function t(e){const n=d.useContext(i);return d.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:t(e.components),d.createElement(i.Provider,{value:n},e.children)}},44097:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>o,contentTitle:()=>l,default:()=>h,frontMatter:()=>t,metadata:()=>d,toc:()=>c});const d=JSON.parse('{"id":"Advanced_development/linux_development/driver_development_s100/driver_lowpower","title":"Low Power Mode Debugging Guide","description":"S100 Chip Power Domains","source":"@site/i18n/en/docusaurus-plugin-content-docs-docs_s/current/07_Advanced_development/02_linux_development/04_driver_development_s100/10_driver_lowpower.md","sourceDirName":"07_Advanced_development/02_linux_development/04_driver_development_s100","slug":"/Advanced_development/linux_development/driver_development_s100/driver_lowpower","permalink":"/rdk_doc/en/rdk_s/Advanced_development/linux_development/driver_development_s100/driver_lowpower","draft":false,"unlisted":false,"tags":[],"version":"current","lastUpdatedAt":1766140001000,"sidebarPosition":10,"frontMatter":{"sidebar_position":10},"sidebar":"tutorialSidebar","previous":{"title":"Thermal System","permalink":"/rdk_doc/en/rdk_s/Advanced_development/linux_development/driver_development_s100/driver_thermal_dev"},"next":{"title":"Audio Debugging Guide","permalink":"/rdk_doc/en/rdk_s/Advanced_development/linux_development/driver_development_s100/driver_audio"}}');var r=s(74848),i=s(28453);const t={sidebar_position:10},l="Low Power Mode Debugging Guide",o={},c=[{value:"S100 Chip Power Domains",id:"s100-chip-power-domains",level:2},{value:"S100 Power States List",id:"s100-power-states-list",level:2},{value:"Sleep and Wake-up",id:"sleep-and-wake-up",level:2},{value:"Setting Sleep Mode",id:"setting-sleep-mode",level:3},{value:"Display currently supported sleep modes",id:"display-currently-supported-sleep-modes",level:4},{value:"Display the current sleep mode",id:"display-the-current-sleep-mode",level:4},{value:"Switch sleep mode",id:"switch-sleep-mode",level:4},{value:"Setting Wake-up Sources",id:"setting-wake-up-sources",level:3},{value:"Setting wake-up source via MCU command",id:"setting-wake-up-source-via-mcu-command",level:4},{value:"Setting wake-up source via MCU API",id:"setting-wake-up-source-via-mcu-api",level:4},{value:"RTC Wake-up Time Configuration",id:"rtc-wake-up-time-configuration",level:5},{value:"GPIO Wake-up Source Configuration",id:"gpio-wake-up-source-configuration",level:5},{value:"GPIO Index Definitions",id:"gpio-index-definitions",level:5},{value:"Sleep Commands",id:"sleep-commands",level:3},{value:"Wake-up Commands",id:"wake-up-commands",level:3},{value:"Light sleep mode wake-up command",id:"light-sleep-mode-wake-up-command",level:4},{value:"Light sleep mode wake-up API",id:"light-sleep-mode-wake-up-api",level:4}];function a(e){const n={br:"br",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",h5:"h5",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"low-power-mode-debugging-guide",children:"Low Power Mode Debugging Guide"})}),"\n",(0,r.jsx)(n.h2,{id:"s100-chip-power-domains",children:"S100 Chip Power Domains"}),"\n",(0,r.jsx)(n.p,{children:"The S100 chip contains three power domains: AON, MCU, and Main. The AON domain must remain powered at all times (never powered off). The MCU domain supplies power to the HSM, MCU, and their internal IPs. The Main domain powers all other components."}),"\n",(0,r.jsx)(n.h2,{id:"s100-power-states-list",children:"S100 Power States List"}),"\n",(0,r.jsx)(n.p,{children:"The S100 currently implements five power states: Off, MCU only, Working, Deep sleep, and Light sleep. Details are as follows:"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Power State"}),(0,r.jsx)(n.th,{children:"Description"}),(0,r.jsx)(n.th,{children:"AON"}),(0,r.jsx)(n.th,{children:"MCU"}),(0,r.jsx)(n.th,{children:"Main"}),(0,r.jsx)(n.th,{children:"DDR Chips"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Off"}),(0,r.jsx)(n.td,{children:"Chip completely powered off"}),(0,r.jsx)(n.td,{children:"Off"}),(0,r.jsx)(n.td,{children:"Off"}),(0,r.jsx)(n.td,{children:"Off"}),(0,r.jsx)(n.td,{children:"Off"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"MCU only"}),(0,r.jsx)(n.td,{children:"MCU Rcore operates normally"}),(0,r.jsx)(n.td,{children:"On"}),(0,r.jsx)(n.td,{children:"On"}),(0,r.jsx)(n.td,{children:"Off"}),(0,r.jsx)(n.td,{children:"Off"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Deep sleep"}),(0,r.jsx)(n.td,{children:"Only AON is active; can be woken up"}),(0,r.jsx)(n.td,{children:"On"}),(0,r.jsx)(n.td,{children:"Off"}),(0,r.jsx)(n.td,{children:"Off"}),(0,r.jsx)(n.td,{children:"Self-refresh"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Working"}),(0,r.jsx)(n.td,{children:"Normal operating mode"}),(0,r.jsx)(n.td,{children:"On"}),(0,r.jsx)(n.td,{children:"On"}),(0,r.jsx)(n.td,{children:"On"}),(0,r.jsx)(n.td,{children:"On"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Light sleep"}),(0,r.jsx)(n.td,{children:"MCU operates normally; only DDR chips in Main domain are powered to maintain self-refresh"}),(0,r.jsx)(n.td,{children:"On"}),(0,r.jsx)(n.td,{children:"On"}),(0,r.jsx)(n.td,{children:"Off"}),(0,r.jsx)(n.td,{children:"Self-refresh"})]})]})]}),"\n",(0,r.jsx)(n.h2,{id:"sleep-and-wake-up",children:"Sleep and Wake-up"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Note: The wake-up source APIs and commands described below, including those specific to Light sleep mode, can only be invoked from MCU0."})}),"\n",(0,r.jsx)(n.h3,{id:"setting-sleep-mode",children:"Setting Sleep Mode"}),"\n",(0,r.jsx)(n.p,{children:"The default sleep mode is Deep sleep."}),"\n",(0,r.jsx)(n.h4,{id:"display-currently-supported-sleep-modes",children:"Display currently supported sleep modes"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-Shell",children:"root@ubuntu:~# cat /sys/devices/platform/suspend-mode/suspend_mode/suspend_mode\nlight deep\n"})}),"\n",(0,r.jsxs)(n.p,{children:["Currently supported sleep modes are ",(0,r.jsx)(n.code,{children:"deep"})," and ",(0,r.jsx)(n.code,{children:"light"}),", with ",(0,r.jsx)(n.code,{children:"deep"})," as the default."]}),"\n",(0,r.jsx)(n.h4,{id:"display-the-current-sleep-mode",children:"Display the current sleep mode"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-Shell",children:"root@ubuntu:~# cat /sys/devices/platform/suspend-mode/suspend_mode/current_suspend_mode\ndeep\n"})}),"\n",(0,r.jsx)(n.h4,{id:"switch-sleep-mode",children:"Switch sleep mode"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-Shell",children:"root@ubuntu:~# cat /sys/devices/platform/suspend-mode/suspend_mode/current_suspend_mode\ndeep\nroot@ubuntu:~# echo light > /sys/devices/platform/suspend-mode/suspend_mode/suspend_mode\nroot@ubuntu:~# cat /sys/devices/platform/suspend-mode/suspend_mode/current_suspend_mode\nlight\n"})}),"\n",(0,r.jsx)(n.h3,{id:"setting-wake-up-sources",children:"Setting Wake-up Sources"}),"\n",(0,r.jsx)(n.p,{children:"The default wake-up source is RTC with a timeout of 15 seconds."}),"\n",(0,r.jsx)(n.h4,{id:"setting-wake-up-source-via-mcu-command",children:"Setting wake-up source via MCU command"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-Shell",children:"D-Robotics:/$ wakeupsource\n[01504.149120 0]WakeupSource Usage:\n[01504.149349 0]    WakeupSource rtc <time(seconds)>\n[01504.149935 0]    WakeupSource can\n[01504.150347 0]    WakeupSource gpio <gpio_index> <type> <level>\n[01504.151093 0]        type:  0:level other:edge\n[01504.151628 0]        level: 0:low   other:high\n"})}),"\n",(0,r.jsx)(n.p,{children:"Currently, only RTC and GPIO are supported as wake-up sources. Examples are shown below:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Set RTC as wake-up source with a 60-second timeout:"}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-Shell",children:"D-Robotics:/$ wakeupsource rtc 60\n[01620.452562 0]rtc init alarm time 60.\nReturn: 0, 0x00000000\n"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Set GPIO as wake-up source: AON GPIO 11, active-low:"}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-Shell",children:"D-Robotics:/$ wakeupsource gpio 11 0 0\n[01680.254419 0]set gpio wakeup source with index 11 type 0 level 0.\nReturn: 0, 0x00000000\n"})}),"\n",(0,r.jsx)(n.h4,{id:"setting-wake-up-source-via-mcu-api",children:"Setting wake-up source via MCU API"}),"\n",(0,r.jsx)(n.h5,{id:"rtc-wake-up-time-configuration",children:"RTC Wake-up Time Configuration"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"SysPower_RtcWakeupSet"})}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Attribute"}),(0,r.jsx)(n.th,{children:"Description"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Name"}),(0,r.jsx)(n.td,{children:"SysPower_RtcWakeupSet"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Syntax"}),(0,r.jsx)(n.td,{children:"Std_ReturnType SysPower_RtcWakeupSet (uint32 WakeupTime)"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Sync/Async"}),(0,r.jsx)(n.td,{children:"Synchronous"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Reentrancy"}),(0,r.jsx)(n.td,{children:"Non-reentrant"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Parameters (in)"}),(0,r.jsx)(n.td,{children:"WakeupTime: RTC alarm time in seconds"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Parameters (inout)"}),(0,r.jsx)(n.td,{children:"None"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Parameters (out)"}),(0,r.jsx)(n.td,{children:"None"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Return value"}),(0,r.jsx)(n.td,{children:"Std_ReturnType"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Description"}),(0,r.jsx)(n.td,{children:"Set RTC wake-up time"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Available via"}),(0,r.jsx)(n.td,{children:"as extern function"})]})]})]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsxs)(n.strong,{children:["Note: After setting the RTC wake-up time, the countdown starts only after the MCU actually initiates the sleep procedure; i.e., counting begins after ",(0,r.jsx)(n.code,{children:"SysPower_Suspend"})," is called and core0 enters sleep."]})}),"\n",(0,r.jsx)(n.h5,{id:"gpio-wake-up-source-configuration",children:"GPIO Wake-up Source Configuration"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"SysPower_GpioWakeupSet"})}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Attribute"}),(0,r.jsx)(n.th,{children:"Description"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Name"}),(0,r.jsx)(n.td,{children:"SysPower_GpioWakeupSet"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Syntax"}),(0,r.jsx)(n.td,{children:"Std_ReturnType SysPower_GpioWakeupSet (uint32 GpioIdx, uint32 Type, uint32 Polarity)"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Sync/Async"}),(0,r.jsx)(n.td,{children:"Synchronous"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Reentrancy"}),(0,r.jsx)(n.td,{children:"Non-reentrant"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Parameters (in)"}),(0,r.jsx)(n.td,{children:"GpioIdx: index of AON GPIO; Type: 0 for level-triggered, others for edge-triggered; Polarity: 0 for low, others for high"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Parameters (inout)"}),(0,r.jsx)(n.td,{children:"None"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Parameters (out)"}),(0,r.jsx)(n.td,{children:"None"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Return value"}),(0,r.jsx)(n.td,{children:"Std_ReturnType"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Description"}),(0,r.jsx)(n.td,{children:"Set GPIO wake-up source"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Available via"}),(0,r.jsx)(n.td,{children:"as extern function"})]})]})]}),"\n",(0,r.jsx)(n.h5,{id:"gpio-index-definitions",children:"GPIO Index Definitions"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-Shell",children:"0: CAN0_RX/(GPIO0)\n1: CAN1_RX/(GPIO1)\n2: CAN2_RX/(GPIO2)\n3: CAN3_RX/(GPIO3)\n4: CAN4_RX/(GPIO4)\n5: CAN5_RX/(GPIO5)\n6: CAN6_RX/(GPIO6)\n7: CAN7_RX/(GPIO7)\n8: CAN8_RX/(GPIO8)\n9: CAN9_RX/(GPIO9)\n10: LIN1_RXD/GPIO(10)\n11: LIN2_RXD/GPIO(11)\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"RTC can be configured as the sole wake-up source, but GPIO cannot be used alone. When configuring GPIO as a wake-up source, RTC must also be configured as a wake-up source simultaneously."})}),"\n",(0,r.jsx)(n.h3,{id:"sleep-commands",children:"Sleep Commands"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Sleep via button press (SLEEP button, short press)"}),"\n",(0,r.jsxs)(n.li,{children:["Enter sleep from Acore by running ",(0,r.jsx)(n.code,{children:"systemctl suspend"})]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"wake-up-commands",children:"Wake-up Commands"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"In Deep sleep mode, the system wakes up automatically when RTC is configured as the wake-up source."}),"\n",(0,r.jsx)(n.li,{children:"In Deep sleep mode, if GPIO is configured as a wake-up source, pressing the SLEEP button (short press) after entering sleep will wake the system."}),"\n",(0,r.jsx)(n.li,{children:"In Light sleep mode, wake-up can only be triggered by executing a command or calling an API from the MCU."}),"\n"]}),"\n",(0,r.jsx)(n.h4,{id:"light-sleep-mode-wake-up-command",children:"Light sleep mode wake-up command"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-Shell",children:"D-Robotics:/$ wakefromll\nD-Robotics:/$ [0544.238961 0] main on start\n...\n"})}),"\n",(0,r.jsx)(n.h4,{id:"light-sleep-mode-wake-up-api",children:"Light sleep mode wake-up API"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Pmu_PerformMainDomainOn"})}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Attribute"}),(0,r.jsx)(n.th,{children:"Description"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Name"}),(0,r.jsx)(n.td,{children:"Pmu_PerformMainDomainOn"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Syntax"}),(0,r.jsx)(n.td,{children:"Std_ReturnType Pmu_PerformMainDomainOn (void)"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Sync/Async"}),(0,r.jsx)(n.td,{children:"Synchronous"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Reentrancy"}),(0,r.jsx)(n.td,{children:"Non-reentrant"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Parameters (in)"}),(0,r.jsx)(n.td,{children:"None"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Parameters (inout)"}),(0,r.jsx)(n.td,{children:"None"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Parameters (out)"}),(0,r.jsx)(n.td,{children:"None"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Return value"}),(0,r.jsx)(n.td,{children:"Std_ReturnType"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Description"}),(0,r.jsx)(n.td,{children:"Power on or resume the Main domain and its peripherals"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Available via"}),(0,r.jsx)(n.td,{children:"Pmu.h"})]})]})]}),"\n",(0,r.jsxs)(n.p,{children:["Sample code for the above sleep/wake-up APIs can be found in",(0,r.jsx)(n.br,{}),"\n",(0,r.jsx)(n.code,{children:"Service/Cmd_Utility/power_sample_cmd/src/PowerControl.c"})]})]})}function h(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(a,{...e})}):a(e)}}}]);