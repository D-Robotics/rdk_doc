"use strict";(self.webpackChunkrdk_doc=self.webpackChunkrdk_doc||[]).push([[95059],{28453:(e,n,_)=>{_.d(n,{R:()=>r,x:()=>d});var t=_(96540);const i={},c=t.createContext(i);function r(e){const n=t.useContext(c);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:r(e.components),t.createElement(c.Provider,{value:n},e.children)}},81572:(e,n,_)=>{_.r(n),_.d(n,{assets:()=>s,contentTitle:()=>d,default:()=>m,frontMatter:()=>r,metadata:()=>t,toc:()=>l});const t=JSON.parse('{"id":"Advanced_development/multimedia_development/S100/codec","title":"\u7f16\u89e3\u7801","description":"\u7cfb\u7edf\u6982\u8ff0","source":"@site/docs_s/07_Advanced_development/03_multimedia_development/01_S100/03_codec.md","sourceDirName":"07_Advanced_development/03_multimedia_development/01_S100","slug":"/Advanced_development/multimedia_development/S100/codec","permalink":"/rdk_doc/en/rdk_s/Advanced_development/multimedia_development/S100/codec","draft":false,"unlisted":false,"tags":[],"version":"current","lastUpdatedAt":1755081897000,"sidebarPosition":3,"frontMatter":{"sidebar_position":3},"sidebar":"tutorialSidebar","previous":{"title":"Camera\u70b9\u4eae","permalink":"/rdk_doc/en/rdk_s/Advanced_development/multimedia_development/S100/camera_bringup"},"next":{"title":"\u663e\u793a\u5b50\u7cfb\u7edf","permalink":"/rdk_doc/en/rdk_s/Advanced_development/multimedia_development/S100/display"}}');var i=_(74848),c=_(28453);const r={sidebar_position:3},d="\u7f16\u89e3\u7801",s={},l=[{value:"\u7cfb\u7edf\u6982\u8ff0",id:"\u7cfb\u7edf\u6982\u8ff0",level:2},{value:"\u6982\u8ff0",id:"\u6982\u8ff0",level:3},{value:"JPU\u786c\u4ef6\u7279\u6027",id:"jpu\u786c\u4ef6\u7279\u6027",level:4},{value:"VPU\u786c\u4ef6\u7279\u6027",id:"vpu\u786c\u4ef6\u7279\u6027",level:4},{value:"\u8f6f\u4ef6\u529f\u80fd",id:"\u8f6f\u4ef6\u529f\u80fd",level:3},{value:"\u6574\u4f53\u6846\u67b6",id:"\u6574\u4f53\u6846\u67b6",level:4},{value:"\u7801\u7387\u63a7\u5236\u6a21\u5f0f",id:"\u7801\u7387\u63a7\u5236\u6a21\u5f0f",level:4},{value:"CBR\u8bf4\u660e",id:"cbr\u8bf4\u660e",level:5},{value:"VBR\u8bf4\u660e",id:"vbr\u8bf4\u660e",level:5},{value:"AVBR\u8bf4\u660e",id:"avbr\u8bf4\u660e",level:5},{value:"FixQp\u8bf4\u660e",id:"fixqp\u8bf4\u660e",level:5},{value:"QPMAP\u8bf4\u660e",id:"qpmap\u8bf4\u660e",level:5},{value:"\u8c03\u8bd5\u65b9\u6cd5",id:"\u8c03\u8bd5\u65b9\u6cd5",level:3},{value:"\u7f16\u7801\u6548\u679c\u8c03\u4f18",id:"\u7f16\u7801\u6548\u679c\u8c03\u4f18",level:4},{value:"GOP\u7ed3\u6784\u8bf4\u660e",id:"gop\u7ed3\u6784\u8bf4\u660e",level:4},{value:"GOP\u9884\u7f6e\u7ed3\u6784",id:"gop\u9884\u7f6e\u7ed3\u6784",level:5},{value:"VPU\u8c03\u8bd5\u65b9\u5f0f",id:"vpu\u8c03\u8bd5\u65b9\u5f0f",level:4},{value:"\u7f16\u7801\u72b6\u6001",id:"\u7f16\u7801\u72b6\u6001",level:5},{value:"\u89e3\u7801\u72b6\u6001",id:"\u89e3\u7801\u72b6\u6001",level:5},{value:"JPU \u8c03\u8bd5\u65b9\u5f0f",id:"jpu-\u8c03\u8bd5\u65b9\u5f0f",level:4},{value:"\u7f16\u7801\u72b6\u6001",id:"\u7f16\u7801\u72b6\u6001-1",level:5},{value:"\u89e3\u7801\u72b6\u6001",id:"\u89e3\u7801\u72b6\u6001-1",level:5},{value:"\u5178\u578b\u573a\u666f",id:"\u5178\u578b\u573a\u666f",level:3},{value:"\u5355\u8def\u7f16\u7801",id:"\u5355\u8def\u7f16\u7801",level:4},{value:"\u5355\u8def\u89e3\u7801",id:"\u5355\u8def\u89e3\u7801",level:4},{value:"\u591a\u8def\u7f16\u7801",id:"\u591a\u8def\u7f16\u7801",level:4},{value:"\u591a\u8def\u89e3\u7801",id:"\u591a\u8def\u89e3\u7801",level:4},{value:"Codec API",id:"codec-api",level:2},{value:"MediaCodec\u63a5\u53e3\u8bf4\u660e",id:"mediacodec\u63a5\u53e3\u8bf4\u660e",level:3},{value:"GOP",id:"gop",level:4},{value:"GOP\u7ed3\u6784\u8868",id:"gop\u7ed3\u6784\u8868",level:5},{value:"GOP\u9884\u7f6e\u7ed3\u6784",id:"gop\u9884\u7f6e\u7ed3\u6784-1",level:5},{value:"\u957f\u671f\u53c2\u8003\u5e27",id:"\u957f\u671f\u53c2\u8003\u5e27",level:4},{value:"Intra Refresh",id:"intra-refresh",level:4},{value:"\u7801\u7387\u63a7\u5236",id:"\u7801\u7387\u63a7\u5236",level:4},{value:"ROI",id:"roi",level:4},{value:"\u8f93\u5165\u8f93\u51fabuffer\u7ba1\u7406",id:"\u8f93\u5165\u8f93\u51fabuffer\u7ba1\u7406",level:4},{value:"\u5e27\u7387\u63a7\u5236",id:"\u5e27\u7387\u63a7\u5236",level:4},{value:"\u5e27Skip\u8bbe\u7f6e",id:"\u5e27skip\u8bbe\u7f6e",level:4},{value:"JPEG\u7f16\u89e3\u7801\u9650\u5236",id:"jpeg\u7f16\u89e3\u7801\u9650\u5236",level:4},{value:"API\u53c2\u8003",id:"api\u53c2\u8003",level:3},{value:"hb_mm_mc_get_descriptor",id:"hb_mm_mc_get_descriptor",level:4},{value:"hb_mm_mc_get_default_context",id:"hb_mm_mc_get_default_context",level:4},{value:"hb_mm_mc_initialize",id:"hb_mm_mc_initialize",level:4},{value:"hb_mm_mc_set_callback",id:"hb_mm_mc_set_callback",level:4},{value:"hb_mm_mc_configure",id:"hb_mm_mc_configure",level:4},{value:"hb_mm_mc_start",id:"hb_mm_mc_start",level:4},{value:"hb_mm_mc_stop",id:"hb_mm_mc_stop",level:4},{value:"hb_mm_mc_pause",id:"hb_mm_mc_pause",level:4},{value:"hb_mm_mc_flush",id:"hb_mm_mc_flush",level:4},{value:"hb_mm_mc_release",id:"hb_mm_mc_release",level:4},{value:"hb_mm_mc_get_state",id:"hb_mm_mc_get_state",level:4},{value:"hb_mm_mc_get_status",id:"hb_mm_mc_get_status",level:4},{value:"hb_mm_mc_queue_input_buffer",id:"hb_mm_mc_queue_input_buffer",level:4},{value:"hb_mm_mc_dequeue_input_buffer",id:"hb_mm_mc_dequeue_input_buffer",level:4},{value:"hb_mm_mc_queue_output_buffer",id:"hb_mm_mc_queue_output_buffer",level:4},{value:"hb_mm_mc_dequeue_output_buffer",id:"hb_mm_mc_dequeue_output_buffer",level:4},{value:"hb_mm_mc_get_longterm_ref_mode",id:"hb_mm_mc_get_longterm_ref_mode",level:4},{value:"hb_mm_mc_set_longterm_ref_mode",id:"hb_mm_mc_set_longterm_ref_mode",level:4},{value:"hb_mm_mc_get_intra_refresh_config",id:"hb_mm_mc_get_intra_refresh_config",level:4},{value:"hb_mm_mc_set_intra_refresh_config",id:"hb_mm_mc_set_intra_refresh_config",level:4},{value:"hb_mm_mc_get_rate_control_config",id:"hb_mm_mc_get_rate_control_config",level:4},{value:"hb_mm_mc_set_rate_control_config",id:"hb_mm_mc_set_rate_control_config",level:4},{value:"hb_mm_mc_get_deblk_filter_config",id:"hb_mm_mc_get_deblk_filter_config",level:4},{value:"hb_mm_mc_set_deblk_filter_config",id:"hb_mm_mc_set_deblk_filter_config",level:4},{value:"hb_mm_mc_get_sao_config",id:"hb_mm_mc_get_sao_config",level:4},{value:"hb_mm_mc_set_sao_config",id:"hb_mm_mc_set_sao_config",level:4},{value:"hb_mm_mc_get_entropy_config",id:"hb_mm_mc_get_entropy_config",level:4},{value:"hb_mm_mc_set_entropy_config",id:"hb_mm_mc_set_entropy_config",level:4},{value:"hb_mm_mc_get_vui_timing_config",id:"hb_mm_mc_get_vui_timing_config",level:4},{value:"hb_mm_mc_set_vui_timing_config",id:"hb_mm_mc_set_vui_timing_config",level:4},{value:"hb_mm_mc_get_slice_config",id:"hb_mm_mc_get_slice_config",level:4},{value:"hb_mm_mc_set_slice_config",id:"hb_mm_mc_set_slice_config",level:4},{value:"hb_mm_mc_insert_user_data",id:"hb_mm_mc_insert_user_data",level:4},{value:"hb_mm_mc_request_idr_frame",id:"hb_mm_mc_request_idr_frame",level:4},{value:"hb_mm_mc_skip_pic",id:"hb_mm_mc_skip_pic",level:4},{value:"hb_mm_mc_get_smart_bg_enc_config",id:"hb_mm_mc_get_smart_bg_enc_config",level:4},{value:"hb_mm_mc_set_smart_bg_enc_config",id:"hb_mm_mc_set_smart_bg_enc_config",level:4},{value:"hb_mm_mc_get_pred_unit_config",id:"hb_mm_mc_get_pred_unit_config",level:4},{value:"hb_mm_mc_set_pred_unit_config",id:"hb_mm_mc_set_pred_unit_config",level:4},{value:"hb_mm_mc_get_transform_config",id:"hb_mm_mc_get_transform_config",level:4},{value:"hb_mm_mc_set_transform_config",id:"hb_mm_mc_set_transform_config",level:4},{value:"hb_mm_mc_get_roi_config",id:"hb_mm_mc_get_roi_config",level:4},{value:"hb_mm_mc_set_roi_config",id:"hb_mm_mc_set_roi_config",level:4},{value:"hb_mm_mc_get_mode_decision_config",id:"hb_mm_mc_get_mode_decision_config",level:4},{value:"hb_mm_mc_set_mode_decision_config",id:"hb_mm_mc_set_mode_decision_config",level:4},{value:"hb_mm_mc_get_user_data",id:"hb_mm_mc_get_user_data",level:4},{value:"hb_mm_mc_release_user_data",id:"hb_mm_mc_release_user_data",level:4},{value:"hb_mm_mc_get_mjpeg_config",id:"hb_mm_mc_get_mjpeg_config",level:4},{value:"hb_mm_mc_set_mjpeg_config",id:"hb_mm_mc_set_mjpeg_config",level:4},{value:"hb_mm_mc_get_jpeg_config",id:"hb_mm_mc_get_jpeg_config",level:4},{value:"hb_mm_mc_set_jpeg_config",id:"hb_mm_mc_set_jpeg_config",level:4},{value:"hb_mm_mc_get_fd",id:"hb_mm_mc_get_fd",level:4},{value:"hb_mm_mc_close_fd",id:"hb_mm_mc_close_fd",level:4},{value:"hb_mm_mc_set_camera",id:"hb_mm_mc_set_camera",level:4},{value:"hb_mm_mc_get_vui_config",id:"hb_mm_mc_get_vui_config",level:4},{value:"hb_mm_mc_set_vui_config",id:"hb_mm_mc_set_vui_config",level:4},{value:"hb_mm_mc_get_3dnr_enc_config",id:"hb_mm_mc_get_3dnr_enc_config",level:4},{value:"hb_mm_mc_set_3dnr_enc_config",id:"hb_mm_mc_set_3dnr_enc_config",level:4},{value:"hb_mm_mc_request_idr_header",id:"hb_mm_mc_request_idr_header",level:4},{value:"hb_mm_mc_enable_idr_frame",id:"hb_mm_mc_enable_idr_frame",level:4},{value:"hb_mm_mc_register_audio_encoder",id:"hb_mm_mc_register_audio_encoder",level:4},{value:"hb_mm_mc_unregister_audio_encoder",id:"hb_mm_mc_unregister_audio_encoder",level:4},{value:"hb_mm_mc_register_audio_decoder",id:"hb_mm_mc_register_audio_decoder",level:4},{value:"hb_mm_mc_unregister_audio_decoder",id:"hb_mm_mc_unregister_audio_decoder",level:4},{value:"hb_mm_mc_get_explicit_header_config",id:"hb_mm_mc_get_explicit_header_config",level:4},{value:"hb_mm_mc_set_explicit_header_config",id:"hb_mm_mc_set_explicit_header_config",level:4},{value:"hb_mm_mc_get_roi_avg_qp",id:"hb_mm_mc_get_roi_avg_qp",level:4},{value:"hb_mm_mc_set_roi_avg_qp",id:"hb_mm_mc_set_roi_avg_qp",level:4},{value:"\u4e3b\u8981\u53c2\u6570\u8bf4\u660e",id:"\u4e3b\u8981\u53c2\u6570\u8bf4\u660e",level:3},{value:"media_codec_state_t",id:"media_codec_state_t",level:4},{value:"media_codec_id_t",id:"media_codec_id_t",level:4},{value:"mc_video_rate_control_mode_t",id:"mc_video_rate_control_mode_t",level:4},{value:"mc_h264_cbr_params_t",id:"mc_h264_cbr_params_t",level:4},{value:"mc_h264_vbr_params_t",id:"mc_h264_vbr_params_t",level:4},{value:"mc_h264_avbr_params_t",id:"mc_h264_avbr_params_t",level:4},{value:"mc_h264_fix_qp_params_t",id:"mc_h264_fix_qp_params_t",level:4},{value:"mc_h264_qp_map_params_t",id:"mc_h264_qp_map_params_t",level:4},{value:"mc_h265_cbr_params_t",id:"mc_h265_cbr_params_t",level:4},{value:"mc_h265_vbr_params_t",id:"mc_h265_vbr_params_t",level:4},{value:"mc_h265_avbr_params_t",id:"mc_h265_avbr_params_t",level:4},{value:"mc_h265_fix_qp_params_t",id:"mc_h265_fix_qp_params_t",level:4},{value:"mc_h265_qp_map_params_t",id:"mc_h265_qp_map_params_t",level:4},{value:"mc_mjpeg_fix_qp_params_t",id:"mc_mjpeg_fix_qp_params_t",level:4},{value:"mc_video_custom_gop_pic_params_t",id:"mc_video_custom_gop_pic_params_t",level:4},{value:"mc_inter_status_t",id:"mc_inter_status_t",level:4},{value:"media_codec_context_t",id:"media_codec_context_t",level:4},{value:"mc_video_codec_enc_params_t",id:"mc_video_codec_enc_params_t",level:4},{value:"mc_video_codec_dec_params_t",id:"mc_video_codec_dec_params_t",level:4},{value:"mc_audio_codec_enc_params_t",id:"mc_audio_codec_enc_params_t",level:4},{value:"mc_audio_codec_dec_params_t",id:"mc_audio_codec_dec_params_t",level:4},{value:"\u8fd4\u56de\u503c\u8bf4\u660e",id:"\u8fd4\u56de\u503c\u8bf4\u660e",level:3},{value:"Codec sample",id:"codec-sample",level:2},{value:"\u7f16\u7801\u793a\u4f8b",id:"\u7f16\u7801\u793a\u4f8b",level:3},{value:"\u529f\u80fd\u6982\u8ff0",id:"\u529f\u80fd\u6982\u8ff0",level:4},{value:"\u8f6f\u4ef6\u67b6\u6784\u8bf4\u660e",id:"\u8f6f\u4ef6\u67b6\u6784\u8bf4\u660e",level:5},{value:"\u786c\u4ef6\u6570\u636e\u6d41\u8bf4\u660e",id:"\u786c\u4ef6\u6570\u636e\u6d41\u8bf4\u660e",level:5},{value:"\u4ee3\u7801\u4f4d\u7f6e\u53ca\u76ee\u5f55\u7ed3\u6784",id:"\u4ee3\u7801\u4f4d\u7f6e\u53ca\u76ee\u5f55\u7ed3\u6784",level:5},{value:"\u7f16\u8bd1",id:"\u7f16\u8bd1",level:4},{value:"\u7f16\u8bd1\u73af\u5883",id:"\u7f16\u8bd1\u73af\u5883",level:5},{value:"\u7f16\u8bd1\u8bf4\u660e",id:"\u7f16\u8bd1\u8bf4\u660e",level:5},{value:"\u8fd0\u884c",id:"\u8fd0\u884c",level:4},{value:"\u652f\u6301\u5e73\u53f0",id:"\u652f\u6301\u5e73\u53f0",level:5},{value:"\u677f\u7aef\u90e8\u7f72\u53ca\u914d\u7f6e",id:"\u677f\u7aef\u90e8\u7f72\u53ca\u914d\u7f6e",level:5},{value:"\u8fd0\u884c\u6307\u5357",id:"\u8fd0\u884c\u6307\u5357",level:5},{value:"\u8fd0\u884c\u53c2\u6570\u8bf4\u660e",id:"\u8fd0\u884c\u53c2\u6570\u8bf4\u660e",level:6},{value:"\u5e2e\u52a9\u83dc\u5355",id:"\u5e2e\u52a9\u83dc\u5355",level:6},{value:"\u8fd0\u884c\u65b9\u6cd5",id:"\u8fd0\u884c\u65b9\u6cd5",level:6},{value:"\u8fd0\u884c\u7ed3\u679c\u8bf4\u660e",id:"\u8fd0\u884c\u7ed3\u679c\u8bf4\u660e",level:6},{value:"\u89e3\u7801\u793a\u4f8b",id:"\u89e3\u7801\u793a\u4f8b",level:3},{value:"\u529f\u80fd\u6982\u8ff0",id:"\u529f\u80fd\u6982\u8ff0-1",level:4},{value:"\u8f6f\u4ef6\u67b6\u6784",id:"\u8f6f\u4ef6\u67b6\u6784",level:5},{value:"\u786c\u4ef6\u6570\u636e\u6d41\u8bf4\u660e",id:"\u786c\u4ef6\u6570\u636e\u6d41\u8bf4\u660e-1",level:5},{value:"\u4ee3\u7801\u4f4d\u7f6e\u53ca\u76ee\u5f55\u7ed3\u6784",id:"\u4ee3\u7801\u4f4d\u7f6e\u53ca\u76ee\u5f55\u7ed3\u6784-1",level:5},{value:"\u7f16\u8bd1",id:"\u7f16\u8bd1-1",level:4},{value:"\u7f16\u8bd1\u73af\u5883",id:"\u7f16\u8bd1\u73af\u5883-1",level:5},{value:"\u7f16\u8bd1\u8bf4\u660e",id:"\u7f16\u8bd1\u8bf4\u660e-1",level:5},{value:"\u8fd0\u884c",id:"\u8fd0\u884c-1",level:4},{value:"\u652f\u6301\u5e73\u53f0",id:"\u652f\u6301\u5e73\u53f0-1",level:5},{value:"\u677f\u7aef\u90e8\u7f72\u53ca\u914d\u7f6e",id:"\u677f\u7aef\u90e8\u7f72\u53ca\u914d\u7f6e-1",level:5},{value:"\u8fd0\u884c\u6307\u5357",id:"\u8fd0\u884c\u6307\u5357-1",level:5},{value:"\u8fd0\u884c\u53c2\u6570\u8bf4\u660e",id:"\u8fd0\u884c\u53c2\u6570\u8bf4\u660e-1",level:6},{value:"\u5e2e\u52a9\u83dc\u5355",id:"\u5e2e\u52a9\u83dc\u5355-1",level:6},{value:"\u8fd0\u884c\u65b9\u6cd5",id:"\u8fd0\u884c\u65b9\u6cd5-1",level:6},{value:"\u8fd0\u884c\u7ed3\u679c\u8bf4\u660e",id:"\u8fd0\u884c\u7ed3\u679c\u8bf4\u660e-1",level:6}];function a(e){const n={a:"a",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",h5:"h5",h6:"h6",header:"header",img:"img",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,c.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"\u7f16\u89e3\u7801",children:"\u7f16\u89e3\u7801"})}),"\n",(0,i.jsx)(n.h2,{id:"\u7cfb\u7edf\u6982\u8ff0",children:"\u7cfb\u7edf\u6982\u8ff0"}),"\n",(0,i.jsx)(n.h3,{id:"\u6982\u8ff0",children:"\u6982\u8ff0"}),"\n",(0,i.jsx)(n.p,{children:"Codec\uff08Coder-Decoder\uff09\u662f\u6307\u7f16\u89e3\u7801\u5668\uff0c\u7528\u4e8e\u538b\u7f29\u6216\u89e3\u538b\u7f29\u89c6\u9891\u3001\u56fe\u50cf\u3001\u97f3\u9891\u7b49\u5a92\u4f53\u6570\u636e\uff1bS100\nSoc\u4e2d\u5b58\u5728\u4e24\u79cd\u786c\u4ef6\u7f16\u89e3\u7801\u5355\u5143\uff0c\u5206\u522b\u662fVPU\uff08Video process unit\uff09\u548cJPU\uff08Jpeg process\nunit\uff09\uff0c\u53ef\u63d0\u4f9b4K@90fps\u7684\u89c6\u9891\u7f16\u89e3\u7801\u80fd\u529b\u548c4K@90fps\u7684\u56fe\u50cf\u7f16\u89e3\u7801\u80fd\u529b\u3002"}),"\n",(0,i.jsx)(n.h4,{id:"jpu\u786c\u4ef6\u7279\u6027",children:"JPU\u786c\u4ef6\u7279\u6027"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:(0,i.jsx)(n.strong,{children:"HW Feature"})}),(0,i.jsx)(n.th,{children:(0,i.jsx)(n.strong,{children:"Feature Indicator"})})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"HW number"}),(0,i.jsx)(n.td,{children:"1"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"maximum input"}),(0,i.jsx)(n.td,{children:"8192x8192"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"minimum input"}),(0,i.jsx)(n.td,{children:"32x32"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"performance"}),(0,i.jsx)(n.td,{children:"4K@90fps"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"max instance"}),(0,i.jsx)(n.td,{children:"64"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"input image format"}),(0,i.jsx)(n.td,{children:"4:0:0, 4:2:0, 4:2:2, 4:4:0, and 4:4:4 color format"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"output image format"}),(0,i.jsx)(n.td,{children:"4:0:0, 4:2:0, 4:2:2, 4:4:0, and 4:4:4 color format"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"input crop"}),(0,i.jsx)(n.td,{children:"Supports"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"bitrate control"}),(0,i.jsx)(n.td,{children:"FIXQP(MJPEG)"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"rotation"}),(0,i.jsx)(n.td,{children:"90, 180, 270"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"mirror"}),(0,i.jsx)(n.td,{children:"Vertical, Horizontal, Vertical+Horizontal"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"quantization table"}),(0,i.jsx)(n.td,{children:"Supports Custom Settings"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"huffman table"}),(0,i.jsx)(n.td,{children:"Supports Custom Settings"})]})]})]}),"\n",(0,i.jsx)(n.h4,{id:"vpu\u786c\u4ef6\u7279\u6027",children:"VPU\u786c\u4ef6\u7279\u6027"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:(0,i.jsx)(n.strong,{children:"HW Feature"})}),(0,i.jsx)(n.th,{children:(0,i.jsx)(n.strong,{children:"Feature Indicator"})})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"HW number"}),(0,i.jsx)(n.td,{children:"1"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"maximum input"}),(0,i.jsx)(n.td,{children:"8192x4096"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"minimum input"}),(0,i.jsx)(n.td,{children:"256x128"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"input alignment required"}),(0,i.jsx)(n.td,{children:"width 32, height 8"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"performance"}),(0,i.jsx)(n.td,{children:"4K@90fps"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"max instance"}),(0,i.jsx)(n.td,{children:"32"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"input image format"}),(0,i.jsx)(n.td,{children:"4:2:0, 4:2:2 color format"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"output image format"}),(0,i.jsx)(n.td,{children:"4:2:0, 4:2:2 color format"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"input crop"}),(0,i.jsx)(n.td,{children:"Supports"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"bitrate control"}),(0,i.jsx)(n.td,{children:"CBR, VBR, AVBR, FIXQP, QPMAP"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"rotation"}),(0,i.jsx)(n.td,{children:"90, 180, 270"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"mirror"}),(0,i.jsx)(n.td,{children:"Vertical, Horizontal, Vertical+Horizontal"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"long-term reference prediction"}),(0,i.jsx)(n.td,{children:"Supports Custom Settings"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"intra refresh"}),(0,i.jsx)(n.td,{children:"Supports"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"deblocking filter"}),(0,i.jsx)(n.td,{children:"Supports"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"request IDR"}),(0,i.jsx)(n.td,{children:"Supports"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"ROI mode"}),(0,i.jsx)(n.td,{children:"mode1: Users can set multiple zones\u2019(up to 64) qp value(0-51), should not work with CBR or AVBR mode mode2: Users can set multiple zones\u2019(up to 64) important level(0-8), should work with CBR or AVBR mode"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"GOP mode"}),(0,i.jsx)(n.td,{children:"0: Custom GOP 1 : I-I-I-I,..I (all intra, gop_size=1) 2 : I-P-P-P,\u2026 P (consecutive P, gop_size=1) 3 : I-B-B-B,\u2026B (consecutive B, gop_size=1) 4 : I-B-P-B-P,\u2026 (gop_size=2) 5 : I-B-B-B-P,\u2026 (gop_size=4) 6 : I-P-P-P-P,\u2026 (consecutive P, gop_size=4) 7 : I-B-B-B-B,\u2026 (consecutive B, gop_size=4) 8 : I-B-B-B-B-B-B-B-B,\u2026 (random access, gop_size=8) 9 : I-P-P-P,\u2026 P (consecutive P, gop_size = 1, with single reference)"})]})]})]}),"\n",(0,i.jsx)(n.h3,{id:"\u8f6f\u4ef6\u529f\u80fd",children:"\u8f6f\u4ef6\u529f\u80fd"}),"\n",(0,i.jsx)(n.h4,{id:"\u6574\u4f53\u6846\u67b6",children:"\u6574\u4f53\u6846\u67b6"}),"\n",(0,i.jsx)(n.p,{children:"MediaCodec\u5b50\u7cfb\u7edf\u4f1a\u63d0\u4f9b\u97f3\u89c6\u9891\u548c\u56fe\u50cf\u7684\u7f16\u89e3\u7801\u7ec4\u4ef6\uff0c\u539f\u59cb\u6d41\u5c01\u88c5\u548c\u89c6\u9891\u5f55\u50cf\u7b49\u529f\u80fd\u3002\u8be5\u7cfb\u7edf\u4e3b\u8981\u4f1a\u5c01\u88c5\u5e95\u5c42codec\u786c\u4ef6\u8d44\u6e90\u548c\u8f6f\u4ef6\u7f16\u89e3\u7801\u5e93\uff0c\u4e3a\u4e0a\u5c42\u63d0\u4f9b\u7f16\u89e3\u7801\u80fd\u529b\u3002\u5f00\u53d1\u8005\u53ef\u4ee5\u57fa\u4e8e\u63d0\u4f9b\u7684\u7f16\u89e3\u7801\u63a5\u53e3\u5b9e\u73b0H265\u548cH264\u89c6\u9891\u7684\u7f16\u89e3\u7801\u529f\u80fd\uff0c\u4e5f\u53ef\u4ee5\u4f7f\u7528JPEG\u7f16\u7801\u529f\u80fd\u5c06\u6444\u50cf\u5934\u6570\u636e\u5b58\u6210JPEG\u56fe\u7247\uff0c\u8fd8\u53ef\u4ee5\u4f7f\u7528\u89c6\u9891\u5f55\u50cf\u529f\u80fd\u5b9e\u73b0\u6444\u50cf\u5934\u6570\u636e\u7684\u5f55\u5236\u3002"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{src:"https://rdk-doc.oss-cn-beijing.aliyuncs.com/doc/img/07_Advanced_development/03_multimedia_development/02_S100/codec/2f8364ee5efbb8cb14136e0dc942248e.png",alt:""})}),"\n",(0,i.jsx)(n.h4,{id:"\u7801\u7387\u63a7\u5236\u6a21\u5f0f",children:"\u7801\u7387\u63a7\u5236\u6a21\u5f0f"}),"\n",(0,i.jsx)(n.p,{children:"MediaCodec\u652f\u6301\u5bf9H264/H265\u548cMJPEG\u534f\u8bae\u7684\u7801\u7387\u63a7\u5236\uff0c\u5206\u522b\u652f\u6301H264/H265\u7f16\u7801\u901a\u9053\u7684CBR\u3001VBR\u3001AVBR\u3001FixQp\u548cQpMap\u4e94\u79cd\u7801\u7387\u63a7\u5236\u65b9\u5f0f\uff0c\u4ee5\u53ca\u652f\u6301MJPGE\u7f16\u7801\u901a\u9053\u7684FixQp\u7801\u7387\u63a7\u5236\u65b9\u5f0f\u3002"}),"\n",(0,i.jsx)(n.h5,{id:"cbr\u8bf4\u660e",children:"CBR\u8bf4\u660e"}),"\n",(0,i.jsx)(n.p,{children:"CBR\u8868\u793a\u6052\u5b9a\u7801\u7387\uff0c\u80fd\u591f\u4fdd\u8bc1\u6574\u4f53\u7684\u7f16\u7801\u7801\u7387\u7a33\u5b9a\u3002\u4e0b\u9762\u662fCBR\u6a21\u5f0f\u4e0b\u5404\u4e2a\u53c2\u6570\u542b\u4e49\uff1a"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:(0,i.jsx)(n.strong,{children:"\u6570\u636e\u9879"})}),(0,i.jsx)(n.th,{children:(0,i.jsx)(n.strong,{children:"\u63cf\u8ff0"})}),(0,i.jsx)(n.th,{children:(0,i.jsx)(n.strong,{children:"\u53d6\u503c\u8303\u56f4"})}),(0,i.jsx)(n.th,{children:(0,i.jsx)(n.strong,{children:"\u9ed8\u8ba4\u503c"})})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"intra_period"}),(0,i.jsx)(n.td,{children:"I\u5e27\u95f4\u9694"}),(0,i.jsx)(n.td,{children:"[0,2047]"}),(0,i.jsx)(n.td,{children:"28"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"intra_qp"}),(0,i.jsx)(n.td,{children:"I\u5e27\u7684QP\u503c"}),(0,i.jsx)(n.td,{children:"[0,51]"}),(0,i.jsx)(n.td,{children:"0"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"bit_rate"}),(0,i.jsx)(n.td,{children:"\u76ee\u6807\u5e73\u5747\u6bd4\u7279\u7387\uff0c\u5355\u4f4d\u662fkbps"}),(0,i.jsx)(n.td,{children:"[0,700000]"}),(0,i.jsx)(n.td,{children:"0"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"frame_rate"}),(0,i.jsx)(n.td,{children:"\u76ee\u6807\u5e27\u7387\uff0c\u5355\u4f4d\u662ffps"}),(0,i.jsx)(n.td,{children:"[1,240]"}),(0,i.jsx)(n.td,{children:"30"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"initial_rc_qp"}),(0,i.jsx)(n.td,{children:"\u6307\u5b9a\u7801\u7387\u63a7\u5236\u65f6\u7684\u521d\u59cbQP\u503c\uff0c\u5f53\u8be5\u503c\u4e0d\u5728[0,51]\u8303\u56f4\u5185,\u7f16\u7801\u5668\u5185\u90e8\u4f1a\u51b3\u5b9a\u521d\u59cb\u503c"}),(0,i.jsx)(n.td,{children:"[0,63]"}),(0,i.jsx)(n.td,{children:"63"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"vbv_buffer_size"}),(0,i.jsx)(n.td,{children:"\u6307\u5b9aVBV Buffer\u7684\u5927\u5c0f\uff0c\u5355\u4f4d\u662fms\uff1b\u5b9e\u9645\u7684VBV buffer\u7684\u7a7a\u95f4\u5927\u5c0f\u4e3abit_rate*vbv_buffer_size/1000(kb)\uff0c\u8be5buffer\u7684\u5927\u5c0f\u4f1a\u5f71\u54cd\u7f16\u7801\u56fe\u50cf\u8d28\u91cf\u548c\u7801\u7387\u63a7\u5236\u7cbe\u5ea6\u3002\u5f53\u8be5buffer\u6bd4\u8f83\u5c0f\u65f6\uff0c\u7801\u7387\u63a7\u5236\u7cbe\u786e\u5ea6\u9ad8\uff0c\u4f46\u56fe\u50cf\u7f16\u7801\u8d28\u91cf\u8f83\u5dee\uff1b\u5f53\u8be5buffer\u6bd4\u8f83\u5927\u65f6\uff0c\u56fe\u50cf\u7f16\u7801\u8d28\u91cf\u9ad8\uff0c\u4f46\u662f\u7801\u7387\u6ce2\u52a8\u5927\u3002"}),(0,i.jsx)(n.td,{children:"[10,3000]"}),(0,i.jsx)(n.td,{children:"10"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"ctu_level_rc_enalbe"}),(0,i.jsx)(n.td,{children:"H264/H265\u7684\u7801\u7387\u63a7\u5236\u53ef\u4ee5\u5de5\u4f5c\u5728CTU\u7ea7\u522b\u7684\u63a7\u5236\uff0c\u8be5\u6a21\u5f0f\u53ef\u4ee5\u8fbe\u5230\u66f4\u9ad8\u7cbe\u5ea6\u7684\u7801\u7387\u63a7\u5236\uff0c\u4f46\u662f\u4f1a\u635f\u5931\u7f16\u7801\u56fe\u50cf\u8d28\u91cf\uff0c\u8be5\u6a21\u5f0f\u4e0d\u53ef\u4ee5\u548cROI\u7f16\u7801\u4e00\u8d77\u5de5\u4f5c\uff0c\u5f53\u4f7f\u80fdROI\u7f16\u7801\u65f6\uff0c\u8be5\u529f\u80fd\u81ea\u52a8\u5931\u6548\u3002"}),(0,i.jsx)(n.td,{children:"[0,1]"}),(0,i.jsx)(n.td,{children:"0"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"min_qp_I"}),(0,i.jsx)(n.td,{children:"I\u5e27\u7684\u6700\u5c0fQP\u503c"}),(0,i.jsx)(n.td,{children:"[0,51]"}),(0,i.jsx)(n.td,{children:"8"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"max_qp_I"}),(0,i.jsx)(n.td,{children:"I\u5e27\u7684\u6700\u5927QP\u503c"}),(0,i.jsx)(n.td,{children:"[0,51]"}),(0,i.jsx)(n.td,{children:"51"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"min_qp_P"}),(0,i.jsx)(n.td,{children:"P\u5e27\u7684\u6700\u5c0fQP\u503c"}),(0,i.jsx)(n.td,{children:"[0,51]"}),(0,i.jsx)(n.td,{children:"8"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"max_qp_P"}),(0,i.jsx)(n.td,{children:"P\u5e27\u7684\u6700\u5927QP\u503c"}),(0,i.jsx)(n.td,{children:"[0,51]"}),(0,i.jsx)(n.td,{children:"51"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"min_qp_B"}),(0,i.jsx)(n.td,{children:"B\u5e27\u7684\u6700\u5c0fQP\u503c"}),(0,i.jsx)(n.td,{children:"[0,51]"}),(0,i.jsx)(n.td,{children:"8"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"max_qp_B"}),(0,i.jsx)(n.td,{children:"B\u5e27\u7684\u6700\u5927QP\u503c"}),(0,i.jsx)(n.td,{children:"[0,51]"}),(0,i.jsx)(n.td,{children:"51"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"hvs_qp_enable"}),(0,i.jsx)(n.td,{children:"H264/H265\u7684\u7801\u7387\u63a7\u5236\u53ef\u4ee5\u5de5\u4f5c\u5728subCTU\u7ea7\u522b\u7684\u63a7\u5236\uff0c\u8be5\u6a21\u5f0f\u4f1a\u8c03\u6574\u5b50\u5b8f\u5757\u7684QP\u503c\uff0c\u8fdb\u800c\u63d0\u9ad8\u4e3b\u89c2\u56fe\u50cf\u8d28\u91cf\u3002"}),(0,i.jsx)(n.td,{children:"[0,1]"}),(0,i.jsx)(n.td,{children:"1"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"hvs_qp_scale"}),(0,i.jsx)(n.td,{children:"\u5f53hvs_qp_enable\u4f7f\u80fd\u540e\u6709\u6548\uff0c\u8be5\u503c\u8868\u793aQP\u7f29\u653e\u56e0\u5b50\u3002"}),(0,i.jsx)(n.td,{children:"[0,4]"}),(0,i.jsx)(n.td,{children:"2"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"max_delta_qp"}),(0,i.jsx)(n.td,{children:"\u5f53hvs_qp_enable\u4f7f\u80fd\u540e\u6709\u6548\uff0c\u6307\u5b9aHVS qp\u503c\u7684\u6700\u5927\u504f\u5dee\u8303\u56f4\u3002"}),(0,i.jsx)(n.td,{children:"[0,51]"}),(0,i.jsx)(n.td,{children:"10"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"qp_map_enable"}),(0,i.jsx)(n.td,{children:"\u4f7f\u80fdROI\u7f16\u7801\u65f6\u7684QP map"}),(0,i.jsx)(n.td,{children:"[0,1]"}),(0,i.jsx)(n.td,{children:"0"})]})]})]}),"\n",(0,i.jsx)(n.h5,{id:"vbr\u8bf4\u660e",children:"VBR\u8bf4\u660e"}),"\n",(0,i.jsx)(n.p,{children:"VBR\u8868\u793a\u53ef\u53d8\u7801\u7387\uff0c\u7b80\u5355\u573a\u666f\u5206\u914d\u6bd4\u8f83\u5927\u7684qp\uff0c\u538b\u7f29\u7387\u5c0f\uff0c\u8d28\u91cf\u9ad8\u3002\u590d\u6742\u573a\u666f\u5206\u914d\u8f83\u5c0fqp\uff0c\u53ef\u4ee5\u4fdd\u8bc1\u7f16\u7801\u56fe\u50cf\u7684\u8d28\u91cf\u7a33\u5b9a\u3002\u4e0b\u9762\u662fVBR\u6a21\u5f0f\u4e0b\u5404\u4e2a\u53c2\u6570\u542b\u4e49\uff1a"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:(0,i.jsx)(n.strong,{children:"\u6570\u636e\u9879"})}),(0,i.jsx)(n.th,{children:(0,i.jsx)(n.strong,{children:"\u63cf\u8ff0"})}),(0,i.jsx)(n.th,{children:(0,i.jsx)(n.strong,{children:"\u53d6\u503c\u8303\u56f4"})}),(0,i.jsx)(n.th,{children:(0,i.jsx)(n.strong,{children:"\u9ed8\u8ba4\u503c"})})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"intra_period"}),(0,i.jsx)(n.td,{children:"I\u5e27\u95f4\u9694"}),(0,i.jsx)(n.td,{children:"[0,2047]"}),(0,i.jsx)(n.td,{children:"28"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"intra_qp"}),(0,i.jsx)(n.td,{children:"I\u5e27\u7684QP\u503c"}),(0,i.jsx)(n.td,{children:"[0,51]"}),(0,i.jsx)(n.td,{children:"0"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"frame_rate"}),(0,i.jsx)(n.td,{children:"\u76ee\u6807\u5e27\u7387\uff0c\u5355\u4f4d\u662ffps"}),(0,i.jsx)(n.td,{children:"[1,240]"}),(0,i.jsx)(n.td,{children:"0"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"qp_map_enable"}),(0,i.jsx)(n.td,{children:"\u4f7f\u80fdROI\u7f16\u7801\u65f6\u7684QP map"}),(0,i.jsx)(n.td,{children:"0,1"}),(0,i.jsx)(n.td,{children:"0"})]})]})]}),"\n",(0,i.jsx)(n.h5,{id:"avbr\u8bf4\u660e",children:"AVBR\u8bf4\u660e"}),"\n",(0,i.jsx)(n.p,{children:"ABR\u8868\u793a\u6052\u5b9a\u5e73\u5747\u76ee\u6807\u7801\u7387\uff0c\u7b80\u5355\u573a\u666f\u5206\u914d\u8f83\u4f4e\u7801\u7387\uff0c\u590d\u6742\u573a\u666f\u5206\u914d\u8db3\u591f\u7801\u7387\uff0c\u4f7f\u5f97\u6709\u9650\u7684\u7801\u7387\u80fd\u591f\u5728\u4e0d\u540c\u573a\u666f\u4e0b\u5408\u7406\u5206\u914d\uff0c\u8fd9\u7c7b\u4f3cVBR\u3002\u540c\u65f6\u4e00\u5b9a\u65f6\u95f4\u5185\uff0c\u5e73\u5747\u7801\u7387\u53c8\u63a5\u8fd1\u8bbe\u7f6e\u7684\u76ee\u6807\u7801\u7387\uff0c\u8fd9\u6837\u53ef\u4ee5\u63a7\u5236\u8f93\u51fa\u6587\u4ef6\u7684\u5927\u5c0f\uff0c\u8fd9\u53c8\u7c7b\u4f3cCBR\u3002\u53ef\u4ee5\u8ba4\u4e3a\u662fCBR\u548cVBR\u7684\u6298\u4e2d\u65b9\u6848\uff0c\u4ea7\u751f\u7801\u7387\u548c\u56fe\u50cf\u8d28\u91cf\u76f8\u5bf9\u7a33\u5b9a\u7684\u7801\u6d41\u3002\u4e0b\u9762\u662fAVBR\u6a21\u5f0f\u4e0b\u5404\u4e2a\u53c2\u6570\u542b\u4e49\uff1a"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:(0,i.jsx)(n.strong,{children:"\u6570\u636e\u9879"})}),(0,i.jsx)(n.th,{children:(0,i.jsx)(n.strong,{children:"\u63cf\u8ff0"})}),(0,i.jsx)(n.th,{children:(0,i.jsx)(n.strong,{children:"\u53d6\u503c\u8303\u56f4"})}),(0,i.jsx)(n.th,{children:(0,i.jsx)(n.strong,{children:"\u9ed8\u8ba4\u503c"})})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"intra_period"}),(0,i.jsx)(n.td,{children:"I\u5e27\u95f4\u9694"}),(0,i.jsx)(n.td,{children:"[0,2047]"}),(0,i.jsx)(n.td,{children:"28"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"intra_qp"}),(0,i.jsx)(n.td,{children:"I\u5e27\u7684QP\u503c"}),(0,i.jsx)(n.td,{children:"[0,51]"}),(0,i.jsx)(n.td,{children:"0"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"bit_rate"}),(0,i.jsx)(n.td,{children:"\u76ee\u6807\u5e73\u5747\u6bd4\u7279\u7387\uff0c\u5355\u4f4d\u662fkbps"}),(0,i.jsx)(n.td,{children:"[0,700000]"}),(0,i.jsx)(n.td,{children:"0"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"frame_rate"}),(0,i.jsx)(n.td,{children:"\u76ee\u6807\u5e27\u7387\uff0c\u5355\u4f4d\u662ffps"}),(0,i.jsx)(n.td,{children:"[1,240]"}),(0,i.jsx)(n.td,{children:"30"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"initial_rc_qp"}),(0,i.jsx)(n.td,{children:"\u6307\u5b9a\u7801\u7387\u63a7\u5236\u65f6\u7684\u521d\u59cbQP\u503c\uff0c\u5f53\u8be5\u503c\u4e0d\u5728[0,51]\u8303\u56f4\u5185,\u7f16\u7801\u5668\u5185\u90e8\u4f1a\u51b3\u5b9a\u521d\u59cb\u503c"}),(0,i.jsx)(n.td,{children:"[0,63]"}),(0,i.jsx)(n.td,{children:"63"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"vbv_buffer_size"}),(0,i.jsx)(n.td,{children:"\u6307\u5b9aVBVBuffer\u7684\u5927\u5c0f\uff0c\u5355\u4f4d\u662fms\uff1b\u5b9e\u9645\u7684VBVbuffer\u7684\u7a7a\u95f4\u5927\u5c0f\u4e3abit_rate*vbv_buffer_size/1000\uff08kb\uff09\uff0c\u8be5buffer\u7684\u5927\u5c0f\u4f1a\u5f71\u54cd\u7f16\u7801\u56fe\u50cf\u8d28\u91cf\u548c\u7801\u7387\u63a7\u5236\u7cbe\u5ea6\u3002\u5f53\u8be5buffer\u6bd4\u8f83\u5c0f\u65f6\uff0c\u7801\u7387\u63a7\u5236\u7cbe\u786e\u5ea6\u9ad8\uff0c\u4f46\u56fe\u50cf\u7f16\u7801\u8d28\u91cf\u8f83\u5dee\uff1b\u5f53\u8be5buffer\u6bd4\u8f83\u5927\u65f6\uff0c\u56fe\u50cf\u7f16\u7801\u8d28\u91cf\u9ad8\uff0c\u4f46\u662f\u7801\u7387\u6ce2\u52a8\u5927\u3002"}),(0,i.jsx)(n.td,{children:"[10,3000]"}),(0,i.jsx)(n.td,{children:"3000"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"ctu_level_rc_enalbe"}),(0,i.jsx)(n.td,{children:"H264/H265\u7684\u7801\u7387\u63a7\u5236\u53ef\u4ee5\u5de5\u4f5c\u5728CTU\u7ea7\u522b\u7684\u63a7\u5236\uff0c\u8be5\u6a21\u5f0f\u53ef\u4ee5\u8fbe\u5230\u66f4\u9ad8\u7cbe\u5ea6\u7684\u7801\u7387\u63a7\u5236\uff0c\u4f46\u662f\u4f1a\u635f\u5931\u7f16\u7801\u56fe\u50cf\u8d28\u91cf\uff0c\u8be5\u6a21\u5f0f\u4e0d\u53ef\u4ee5\u548cROI\u7f16\u7801\u4e00\u8d77\u5de5\u4f5c\uff0c\u5f53\u4f7f\u80fdROI\u7f16\u7801\u65f6\uff0c\u8be5\u529f\u80fd\u81ea\u52a8\u5931\u6548\u3002"}),(0,i.jsx)(n.td,{children:"[0,1]"}),(0,i.jsx)(n.td,{children:"0"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"min_qp_I"}),(0,i.jsx)(n.td,{children:"I\u5e27\u7684\u6700\u5c0fQP\u503c"}),(0,i.jsx)(n.td,{children:"[0,51]"}),(0,i.jsx)(n.td,{children:"8"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"max_qp_I"}),(0,i.jsx)(n.td,{children:"I\u5e27\u7684\u6700\u5927QP\u503c"}),(0,i.jsx)(n.td,{children:"[0,51]"}),(0,i.jsx)(n.td,{children:"51"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"min_qp_P"}),(0,i.jsx)(n.td,{children:"P\u5e27\u7684\u6700\u5c0fQP\u503c"}),(0,i.jsx)(n.td,{children:"[0,51]"}),(0,i.jsx)(n.td,{children:"8"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"max_qp_P"}),(0,i.jsx)(n.td,{children:"P\u5e27\u7684\u6700\u5927QP\u503c"}),(0,i.jsx)(n.td,{children:"[0,51]"}),(0,i.jsx)(n.td,{children:"51"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"min_qp_B"}),(0,i.jsx)(n.td,{children:"B\u5e27\u7684\u6700\u5c0fQP\u503c"}),(0,i.jsx)(n.td,{children:"[0,51]"}),(0,i.jsx)(n.td,{children:"8"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"max_qp_B"}),(0,i.jsx)(n.td,{children:"B\u5e27\u7684\u6700\u5927QP\u503c"}),(0,i.jsx)(n.td,{children:"[0,51]"}),(0,i.jsx)(n.td,{children:"51"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"hvs_qp_enable"}),(0,i.jsx)(n.td,{children:"H264/H265\u7684\u7801\u7387\u63a7\u5236\u53ef\u4ee5\u5de5\u4f5c\u5728subCTU\u7ea7\u522b\u7684\u63a7\u5236\uff0c\u8be5\u6a21\u5f0f\u4f1a\u8c03\u6574\u5b50\u5b8f\u5757\u7684QP\u503c\uff0c\u8fdb\u800c\u63d0\u9ad8\u4e3b\u89c2\u56fe\u50cf\u8d28\u91cf\u3002"}),(0,i.jsx)(n.td,{children:"[0,1]"}),(0,i.jsx)(n.td,{children:"1"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"hvs_qp_scale"}),(0,i.jsx)(n.td,{children:"\u5f53hvs_qp_enable\u4f7f\u80fd\u540e\u6709\u6548\uff0c\u8be5\u503c\u8868\u793aQP\u7f29\u653e\u56e0\u5b50\u3002"}),(0,i.jsx)(n.td,{children:"[0,4]"}),(0,i.jsx)(n.td,{children:"2"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"max_delta_qp"}),(0,i.jsx)(n.td,{children:"\u5f53hvs_qp_enable\u4f7f\u80fd\u540e\u6709\u6548\uff0c\u6307\u5b9aHVSqp\u503c\u7684\u6700\u5927\u504f\u5dee\u8303\u56f4\u3002"}),(0,i.jsx)(n.td,{children:"[0,51]"}),(0,i.jsx)(n.td,{children:"10"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"qp_map_enable"}),(0,i.jsx)(n.td,{children:"\u4f7f\u80fdROI\u7f16\u7801\u65f6\u7684QPmap"}),(0,i.jsx)(n.td,{children:"[0,1]"}),(0,i.jsx)(n.td,{children:"0"})]})]})]}),"\n",(0,i.jsx)(n.h5,{id:"fixqp\u8bf4\u660e",children:"FixQp\u8bf4\u660e"}),"\n",(0,i.jsx)(n.p,{children:"FixQp\u8868\u793a\u56fa\u5b9a\u6bcf\u4e00\u4e2aI\u5e27\u3001P\u5e27\u7684QP\u503c\uff0c\u5bf9\u4e8eI/P\u5e27\u53ef\u4ee5\u5206\u522b\u8bbe\u503c\u3002\u4e0b\u9762\u662fFixQp\u6a21\u5f0f\u4e0b\u5404\u4e2a\u53c2\u6570\u542b\u4e49\uff1a"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:(0,i.jsx)(n.strong,{children:"\u6570\u636e\u9879"})}),(0,i.jsx)(n.th,{children:(0,i.jsx)(n.strong,{children:"\u63cf\u8ff0"})}),(0,i.jsx)(n.th,{children:(0,i.jsx)(n.strong,{children:"\u53d6\u503c\u8303\u56f4"})}),(0,i.jsx)(n.th,{children:(0,i.jsx)(n.strong,{children:"\u9ed8\u8ba4\u503c"})})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"intra_period"}),(0,i.jsx)(n.td,{children:"I\u5e27\u95f4\u9694"}),(0,i.jsx)(n.td,{children:"[0,2047]"}),(0,i.jsx)(n.td,{children:"28"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"frame_rate"}),(0,i.jsx)(n.td,{children:"\u76ee\u6807\u5e27\u7387\uff0c\u5355\u4f4d\u662ffps"}),(0,i.jsx)(n.td,{children:"[1,240]"}),(0,i.jsx)(n.td,{children:"30"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"force_qp_I"}),(0,i.jsx)(n.td,{children:"\u5f3a\u5236I\u5e27\u7684QP\u503c"}),(0,i.jsx)(n.td,{children:"[0,51]"}),(0,i.jsx)(n.td,{children:"0"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"force_qp_P"}),(0,i.jsx)(n.td,{children:"\u5f3a\u5236P\u5e27\u7684QP\u503c"}),(0,i.jsx)(n.td,{children:"[0,51]"}),(0,i.jsx)(n.td,{children:"0"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"force_qp_B"}),(0,i.jsx)(n.td,{children:"\u5f3a\u5236B\u5e27\u7684QP\u503c"}),(0,i.jsx)(n.td,{children:"[0,51]"}),(0,i.jsx)(n.td,{children:"0"})]})]})]}),"\n",(0,i.jsx)(n.h5,{id:"qpmap\u8bf4\u660e",children:"QPMAP\u8bf4\u660e"}),"\n",(0,i.jsx)(n.p,{children:"QPMAP\u8868\u793a\u4e3a\u4e00\u5e27\u56fe\u50cf\u4e2d\u7684\u6bcf\u4e00\u4e2a\u5757\u6307\u5b9aQP\u503c\uff0c\u5176\u4e2dH265\u5757\u5927\u5c0f\u4e3a32x32,H264\u5757\u5927\u5c0f\u4e3a16x16\u3002\u4e0b\u9762\u662fQPMAP\u6a21\u5f0f\u4e0b\u5404\u4e2a\u53c2\u6570\u542b\u4e49\uff1a"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:(0,i.jsx)(n.strong,{children:"\u6570\u636e\u9879"})}),(0,i.jsx)(n.th,{children:(0,i.jsx)(n.strong,{children:"\u63cf\u8ff0"})}),(0,i.jsx)(n.th,{children:(0,i.jsx)(n.strong,{children:"\u53d6\u503c\u8303\u56f4"})}),(0,i.jsx)(n.th,{children:(0,i.jsx)(n.strong,{children:"\u9ed8\u8ba4\u503c"})})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"intra_period"}),(0,i.jsx)(n.td,{children:"I\u5e27\u95f4\u9694"}),(0,i.jsx)(n.td,{children:"[0,2047]"}),(0,i.jsx)(n.td,{children:"28"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"frame_rate"}),(0,i.jsx)(n.td,{children:"\u76ee\u6807\u5e27\u7387\uff0c\u5355\u4f4d\u662ffps"}),(0,i.jsx)(n.td,{children:"[1,240]"}),(0,i.jsx)(n.td,{children:"30"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"qp_map_array"}),(0,i.jsx)(n.td,{children:"\u6307\u5b9aQPmap\u8868\uff0cH265\u7684subCTU\u5927\u5c0f\u4e3a32x32\uff0c\u9700\u8981\u4e3a\u6bcf\u4e00\u4e2asubCTU\u6307\u5b9a\u4e00\u4e2aQP\u503c\uff0c\u6bcf\u4e2aQP\u503c\u5360\u4e00\u4e2a\u5b57\u8282\uff0c\u5e76\u4e14\u6309\u7167\u5149\u6805\u626b\u63cf\u65b9\u5411\u6392\u5e8f\u3002"}),(0,i.jsx)(n.td,{children:"\u6307\u9488\u5730\u5740"}),(0,i.jsx)(n.td,{children:"NULL"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"qp_map_array_count"}),(0,i.jsx)(n.td,{children:"\u6307\u5b9aQPmap\u8868\u7684\u5927\u5c0f\u3002"}),(0,i.jsx)(n.td,{children:"[0, MC_VIDEO_MAX_SUB_CTU_NUM]&&(ALIGN64(picWidth)>>5)*(ALIGN64(picHeight)>>5)"}),(0,i.jsx)(n.td,{children:"0"})]})]})]}),"\n",(0,i.jsx)(n.h3,{id:"\u8c03\u8bd5\u65b9\u6cd5",children:"\u8c03\u8bd5\u65b9\u6cd5"}),"\n",(0,i.jsx)(n.h4,{id:"\u7f16\u7801\u6548\u679c\u8c03\u4f18",children:"\u7f16\u7801\u6548\u679c\u8c03\u4f18"}),"\n",(0,i.jsx)(n.p,{children:"\u6839\u636e\u5f53\u524d\u5ba2\u6237\u4f7f\u7528codec\u8fdb\u884c\u89c6\u9891\u7f16\u7801\u7684\u573a\u666f\uff0c\u591a\u5c06\u7801\u7387\u6a21\u5f0f\u8bbe\u7f6e\u4e3aCBR\uff0c\u5f53\u7f16\u7801\u7684\u573a\u666f\u8f83\u4e3a\u590d\u6742\u65f6\uff0c\u4e3a\u4e86\u4fdd\u8bc1\u89c6\u9891\u8d28\u91cf\uff0c\u786c\u4ef6\u4f1a\u81ea\u52a8\u63d0\u9ad8\u7801\u7387\u503c\uff0c\u5bfc\u81f4\u8f93\u51fa\u7684\u89c6\u9891\u8f83\u9884\u671f\u66f4\u5927\u3002\u56e0\u6b64\u4e3a\u4e86\u517c\u987e\u89c6\u9891\u8d28\u91cf\u548c\u5b9e\u9645\u7801\u7387\uff0c\u9700\u8981\u7edf\u7b79bit_rate\u548cmax_qp_I/P\u503c\u7684\u8bbe\u7f6e\u3002\u4e0b\u9762\u7ed9\u51fa\u4e86\u5168I\u5e27\u6a21\u5f0f\u4e0b\uff0c\u4e0d\u540c\u590d\u6742\u573a\u666f\u4e0b\uff0c\u7801\u7387\u8bbe\u7f6e\u4e3a15000kbps\u65f6\uff0c\u4e0d\u540cmax_qp_I\u4e0b\u5b9e\u9645\u7801\u7387\u548cqp\u7684\u60c5\u51b5\uff08\u4e0d\u540c\u573a\u666f\u590d\u6742\u7a0b\u5ea6\u4e0d\u540c\uff0c\u4e0b\u5217\u6570\u636e\u4ec5\u4f9b\u53c2\u8003\uff09\uff1a"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"\u573a\u666f&\u53c2\u6570"}),(0,i.jsx)(n.th,{children:"\u5ba4\u5916\u767d\u5929\u590d\u6742\u573a\u666f bitrate(15000) max_qp_I(35)"}),(0,i.jsx)(n.th,{children:"\u5ba4\u5916\u767d\u5929\u590d\u6742\u573a\u666f bitrate(15000) max_qp_I(38)"}),(0,i.jsx)(n.th,{children:"\u5ba4\u5916\u767d\u5929\u590d\u6742\u573a\u666f bitrate(15000) max_qp_I(39)"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Bit alloction(bps)\uff08\u8d8a\u5927\u56fe\u50cf\u8d28\u91cf\u8d8a\u9ad8\uff09"}),(0,i.jsx)(n.td,{children:"60300045"}),(0,i.jsx)(n.td,{children:"42186920"}),(0,i.jsx)(n.td,{children:"35898230"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Qp avg\uff08\u8d8a\u5c0f\u56fe\u50cf\u8d28\u91cf\u8d8a\u9ad8\uff09"}),(0,i.jsx)(n.td,{children:"35"}),(0,i.jsx)(n.td,{children:"38"}),(0,i.jsx)(n.td,{children:"39"})]})]})]}),"\n",(0,i.jsx)(n.h4,{id:"gop\u7ed3\u6784\u8bf4\u660e",children:"GOP\u7ed3\u6784\u8bf4\u660e"}),"\n",(0,i.jsx)(n.p,{children:"H264/H265\u7f16\u7801\u652f\u6301GOP\u7ed3\u6784\u7684\u8bbe\u7f6e\uff0c\u7528\u6237\u53ef\u4ece\u9884\u7f6e\u76843\u79cdGOP\u7ed3\u6784\u79cd\u9009\u62e9\uff0c\u4e5f\u53ef\u81ea\u5b9a\u4e49GOP\u7ed3\u6784\u3002"}),"\n",(0,i.jsx)(n.p,{children:"GOP\u7ed3\u6784\u8868\u53ef\u5b9a\u4e49\u4e00\u7ec4\u5468\u671f\u6027\u7684GOP\u7ed3\u6784\uff0c\u8be5GOP\u7ed3\u6784\u5c06\u7528\u4e8e\u6574\u4e2a\u7f16\u7801\u8fc7\u7a0b\u3002\u5355\u4e2a\u7ed3\u6784\u8868\u4e2d\u7684\u5143\u7d20\u5982\u4e0b\u8868\u6240\u793a\uff0c\u5176\u4e2d\u53ef\u4ee5\u6307\u5b9a\u8be5\u56fe\u50cf\u7684\u53c2\u8003\u5e27\uff0c\u5982\u679cIDR\u5e27\u540e\u7684\u5176\u4ed6\u5e27\u6307\u5b9a\u7684\u53c2\u8003\u5e27\u4e3aIDR\u5e27\u524d\u7684\u6570\u636e\u5e27\uff0c\u7f16\u7801\u5668\u5185\u90e8\u4f1a\u81ea\u52a8\u5904\u7406\u8fd9\u79cd\u60c5\u51b5\u4f7f\u5176\u4e0d\u53c2\u8003\u5176\u4ed6\u5e27\uff0c\u7528\u6237\u65e0\u9700\u5173\u5fc3\u8fd9\u79cd\u60c5\u51b5\u3002\u7528\u6237\u5728\u81ea\u5b9a\u4e49GOP\u7ed3\u6784\u65f6\u9700\u8981\u6307\u660e\u7ed3\u6784\u8868\u7684\u6570\u91cf\uff0c\u6700\u591a\u53ef\u5b9a\u4e493\u4e2a\u7ed3\u6784\u8868\uff0c\u7ed3\u6784\u8868\u7684\u987a\u5e8f\u9700\u8981\u6309\u7167\u89e3\u7801\u987a\u5e8f\u6392\u5217\u3002\n\u4e0b\u9762\u8868\u793a\u4e86\u7ed3\u6784\u8868\u4e2d\u5404\u4e2a\u5143\u7d20\u7684\u542b\u4e49\uff1a"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"\u5143\u7d20"}),(0,i.jsx)(n.th,{children:"\u63cf\u8ff0"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Type"}),(0,i.jsx)(n.td,{children:"\u5e27\u7c7b\u578b(I\u3001P\u3001B)"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"POC"}),(0,i.jsx)(n.td,{children:"GOP\u5185\u5e27\u7684\u663e\u793a\u987a\u5e8f\uff0c\u53d6\u503c\u8303\u56f4\u4e3a[1,gop_size]\u3002"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"QPoffset"}),(0,i.jsx)(n.td,{children:"\u81ea\u5b9a\u4e49GOP\u4e2d\u56fe\u7247\u7684\u91cf\u5316\u53c2\u6570"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"NUM_REF_PIC_L0"}),(0,i.jsx)(n.td,{children:"\u6807\u8bb0\u4e3aP\u5e27\u4f7f\u7528\u591a\u53c2\u8003\u56fe\u7247\uff0c\u4ec5\u5728PIC_TYPE\u4e3aP\u65f6\u6709\u6548\u3002"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"temporal_id"}),(0,i.jsx)(n.td,{children:"\u5e27\u7684\u65f6\u95f4\u5c42\uff0c\u5e27\u65e0\u6cd5\u4ece\u5177\u6709\u8f83\u9ad8\u65f6\u95f4 id\uff080~6\uff09\u7684\u5e27\u8fdb\u884c\u9884\u6d4b\u3002"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"1st_ref_POC"}),(0,i.jsx)(n.td,{children:"L0\u7684\u7b2c\u4e00\u5f20\u53c2\u8003\u56fe\u7247\u7684POC"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"2nd_ref_POC"}),(0,i.jsx)(n.td,{children:"Type\u4e3aB\u65f6\uff0c\u7b2c\u4e00\u5f20\u53c2\u8003\u56fe\u7247\u7684POC\u662fL1\u7684\uff1b Type\u4e3aP\u65f6\uff0c\u7b2c\u4e8c\u5f20\u53c2\u8003\u56fe\u7247\u7684POC\u662fL0\u7684\uff1b \u53ef\u4ee5\u4f7freference_L1\u548cB slice\u4e2d\u7684\u53c2\u8003\u56fe\u7247\u5177\u6709\u76f8\u540c\u7684POC\uff0c \u4f46\u51fa\u4e8e\u538b\u7f29\u6548\u7387\u7684\u8003\u8651\uff0c\u5efa\u8baereference_L1\u548creference_L0\u7684POC\u4e0d\u540c\u3002"})]})]})]}),"\n",(0,i.jsx)(n.h5,{id:"gop\u9884\u7f6e\u7ed3\u6784",children:"GOP\u9884\u7f6e\u7ed3\u6784"}),"\n",(0,i.jsx)(n.p,{children:"\u4e00\u5171\u652f\u6301\u8bbe\u7f6e\u4e5d\u79cdGOP\u9884\u7f6e\u7ed3\u6784"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"\u5e8f\u53f7"}),(0,i.jsx)(n.th,{children:"GOP\u7ed3\u6784"}),(0,i.jsx)(n.th,{children:"\u4f4e\u5ef6\u8fdf\uff08\u7f16\u7801\u987a\u5e8f\u548c\u663e\u793a\u987a\u5e8f\u76f8\u540c\uff09"}),(0,i.jsx)(n.th,{children:"GOP\u5927\u5c0f"}),(0,i.jsx)(n.th,{children:"\u7f16\u7801\u987a\u5e8f"}),(0,i.jsx)(n.th,{children:"\u6700\u5c0f\u6e90\u5e27buffer\u6570\u91cf"}),(0,i.jsx)(n.th,{children:"\u6700\u5c0f\u89e3\u7801\u56fe\u7247buffer\u6570\u91cf"}),(0,i.jsx)(n.th,{children:"\u5468\u671f\u5185\uff08I \u5e27\u95f4\u9694\uff09\u8981\u6c42"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"1"}),(0,i.jsx)(n.td,{children:"I"}),(0,i.jsx)(n.td,{children:"Yes"}),(0,i.jsx)(n.td,{children:"1"}),(0,i.jsx)(n.td,{children:"I0-I1-I2\u2026"}),(0,i.jsx)(n.td,{children:"1"}),(0,i.jsx)(n.td,{children:"1"}),(0,i.jsx)(n.td,{})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"2"}),(0,i.jsx)(n.td,{children:"P"}),(0,i.jsx)(n.td,{children:"Yes"}),(0,i.jsx)(n.td,{children:"1"}),(0,i.jsx)(n.td,{children:"P0-P1-P2\u2026"}),(0,i.jsx)(n.td,{children:"1"}),(0,i.jsx)(n.td,{children:"2"}),(0,i.jsx)(n.td,{})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"3"}),(0,i.jsx)(n.td,{children:"B"}),(0,i.jsx)(n.td,{children:"Yes"}),(0,i.jsx)(n.td,{children:"1"}),(0,i.jsx)(n.td,{children:"B0-B1-B2\u2026"}),(0,i.jsx)(n.td,{children:"1"}),(0,i.jsx)(n.td,{children:"3"}),(0,i.jsx)(n.td,{})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"4"}),(0,i.jsx)(n.td,{children:"BP"}),(0,i.jsx)(n.td,{children:"NO"}),(0,i.jsx)(n.td,{children:"2"}),(0,i.jsx)(n.td,{children:"B1-P0-B3-P2\u2026"}),(0,i.jsx)(n.td,{children:"1"}),(0,i.jsx)(n.td,{children:"3"}),(0,i.jsx)(n.td,{})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"5"}),(0,i.jsx)(n.td,{children:"BBBP"}),(0,i.jsx)(n.td,{children:"Yes"}),(0,i.jsx)(n.td,{children:"1"}),(0,i.jsx)(n.td,{children:"B2-B1-B3-P0\u2026"}),(0,i.jsx)(n.td,{children:"7"}),(0,i.jsx)(n.td,{children:"4"}),(0,i.jsx)(n.td,{})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"6"}),(0,i.jsx)(n.td,{children:"PPPP"}),(0,i.jsx)(n.td,{children:"Yes"}),(0,i.jsx)(n.td,{children:"4"}),(0,i.jsx)(n.td,{children:"P0-P1-P2-P3\u2026"}),(0,i.jsx)(n.td,{children:"1"}),(0,i.jsx)(n.td,{children:"2"}),(0,i.jsx)(n.td,{})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"7"}),(0,i.jsx)(n.td,{children:"BBBB"}),(0,i.jsx)(n.td,{children:"Yes"}),(0,i.jsx)(n.td,{children:"4"}),(0,i.jsx)(n.td,{children:"B0-B1-B2-B3\u2026"}),(0,i.jsx)(n.td,{children:"1"}),(0,i.jsx)(n.td,{children:"3"}),(0,i.jsx)(n.td,{})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"8"}),(0,i.jsx)(n.td,{children:"BBBB BBBB"}),(0,i.jsx)(n.td,{children:"Yes"}),(0,i.jsx)(n.td,{children:"1"}),(0,i.jsx)(n.td,{children:"B3-B2-B4- B1-B6-B5- B7-B0\u2026"}),(0,i.jsx)(n.td,{children:"12"}),(0,i.jsx)(n.td,{children:"5"}),(0,i.jsx)(n.td,{})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"9"}),(0,i.jsx)(n.td,{children:"P"}),(0,i.jsx)(n.td,{children:"Yes"}),(0,i.jsx)(n.td,{children:"1"}),(0,i.jsx)(n.td,{children:"P0"}),(0,i.jsx)(n.td,{children:"1"}),(0,i.jsx)(n.td,{children:"2"}),(0,i.jsx)(n.td,{})]})]})]}),"\n",(0,i.jsx)(n.p,{children:"GOP Preset 1"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"\u53ea\u6709I\u5e27\uff0c\u6ca1\u6709\u76f8\u4e92\u53c2\u8003\uff1b"}),"\n",(0,i.jsx)(n.li,{children:"\u4f4e\u5ef6\u65f6\uff1b"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{src:"https://rdk-doc.oss-cn-beijing.aliyuncs.com/doc/img/07_Advanced_development/03_multimedia_development/02_S100/codec/b02cc41ab083664ba3f8a3bef1543afa.png",alt:""})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{src:"https://rdk-doc.oss-cn-beijing.aliyuncs.com/doc/img/07_Advanced_development/03_multimedia_development/02_S100/codec/fa1da95bc8801b2d6225b2abf1b2f2d3.png",alt:""})}),"\n",(0,i.jsx)(n.p,{children:"GOP Preset 2"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"\u53ea\u6709I\u5e27\u548cP\u5e27\uff1b"}),"\n",(0,i.jsx)(n.li,{children:"P\u5e27\u53c2\u80032\u4e2a\u524d\u5411\u53c2\u8003\u5e27\uff1b"}),"\n",(0,i.jsx)(n.li,{children:"\u4f4e\u5ef6\u65f6\uff1b"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{src:"https://rdk-doc.oss-cn-beijing.aliyuncs.com/doc/img/07_Advanced_development/03_multimedia_development/02_S100/codec/e3c2f773a89f6ee2fe2dab03200b6fd0.png",alt:""})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{src:"https://rdk-doc.oss-cn-beijing.aliyuncs.com/doc/img/07_Advanced_development/03_multimedia_development/02_S100/codec/8fa5f892bd7282e82ac8ed96011c943d.png",alt:""})}),"\n",(0,i.jsx)(n.p,{children:"GOP Preset 3"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"\u53ea\u6709I\u5e27\u548cB\u5e27\uff1b"}),"\n",(0,i.jsx)(n.li,{children:"B\u5e27\u53c2\u80032\u4e2a\u524d\u5411\u53c2\u8003\u5e27\uff1b"}),"\n",(0,i.jsx)(n.li,{children:"\u4f4e\u5ef6\u65f6\uff1b"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{src:"https://rdk-doc.oss-cn-beijing.aliyuncs.com/doc/img/07_Advanced_development/03_multimedia_development/02_S100/codec/03bbdf35dc3e2a1b38f9e05d7038d064.png",alt:""})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{src:"https://rdk-doc.oss-cn-beijing.aliyuncs.com/doc/img/07_Advanced_development/03_multimedia_development/02_S100/codec/e1b5707ea0c32b6a0c1658527a6186dd.png",alt:""})}),"\n",(0,i.jsx)(n.p,{children:"GOP Preset 4"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"\u53ea\u6709I\u5e27\u3001P\u5e27\u548cB\u5e27\uff1b"}),"\n",(0,i.jsx)(n.li,{children:"P\u5e27\u53c2\u80032\u4e2a\u524d\u5411\u53c2\u8003\u5e27\uff1b"}),"\n",(0,i.jsx)(n.li,{children:"B\u5e27\u53c2\u80031\u4e2a\u524d\u5411\u53c2\u8003\u5e27\u548c\u4e00\u4e2a\u540e\u5411\u53c2\u8003\u5e27\uff1b"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{src:"https://rdk-doc.oss-cn-beijing.aliyuncs.com/doc/img/07_Advanced_development/03_multimedia_development/02_S100/codec/17e10e6a27db202fe9a0c2b5f3d5dd50.png",alt:""})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{src:"https://rdk-doc.oss-cn-beijing.aliyuncs.com/doc/img/07_Advanced_development/03_multimedia_development/02_S100/codec/972bbe22d2e7364c1c0a3db03f57343e.png",alt:""})}),"\n",(0,i.jsx)(n.p,{children:"GOP Preset 5"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"\u53ea\u6709I\u5e27\u3001P\u5e27\u548cB\u5e27\uff1b"}),"\n",(0,i.jsx)(n.li,{children:"P\u5e27\u53c2\u80032\u4e2a\u524d\u5411\u53c2\u8003\u5e27\uff1b"}),"\n",(0,i.jsx)(n.li,{children:"B\u5e27\u53c2\u80031\u4e2a\u524d\u5411\u53c2\u8003\u5e27\u548c\u4e00\u4e2a\u540e\u5411\u53c2\u8003\u5e27\uff0c\u540e\u5411\u53c2\u8003\u5e27\u53ef\u4e3aP\u5e27\u6216B\u5e27\uff1b"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{src:"https://rdk-doc.oss-cn-beijing.aliyuncs.com/doc/img/07_Advanced_development/03_multimedia_development/02_S100/codec/16ad2d15f0b22a91fda1450747a18422.png",alt:""})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{src:"https://rdk-doc.oss-cn-beijing.aliyuncs.com/doc/img/07_Advanced_development/03_multimedia_development/02_S100/codec/8ff1393cdbb997c8768ea2f9f00c3c8b.png",alt:""})}),"\n",(0,i.jsx)(n.p,{children:"GOP Preset 6"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"\u53ea\u6709I\u5e27\u548cP\u5e27\uff1b"}),"\n",(0,i.jsx)(n.li,{children:"P\u5e27\u53c2\u80032\u4e2a\u524d\u5411\u53c2\u8003\u5e27\uff1b"}),"\n",(0,i.jsx)(n.li,{children:"\u4f4e\u5ef6\u65f6\uff1b"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{src:"https://rdk-doc.oss-cn-beijing.aliyuncs.com/doc/img/07_Advanced_development/03_multimedia_development/02_S100/codec/a5fbffa7c85a3423729f06d45f83a601.png",alt:""})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{src:"https://rdk-doc.oss-cn-beijing.aliyuncs.com/doc/img/07_Advanced_development/03_multimedia_development/02_S100/codec/1e88c6cbacb8fff86f5d5fc301e01abd.png",alt:""})}),"\n",(0,i.jsx)(n.p,{children:"GOP Preset 7"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"\u53ea\u6709I\u5e27\u548cB\u5e27\uff1b"}),"\n",(0,i.jsx)(n.li,{children:"B\u5e27\u53c2\u80032\u4e2a\u524d\u5411\u53c2\u8003\u5e27\uff1b"}),"\n",(0,i.jsx)(n.li,{children:"\u4f4e\u5ef6\u65f6\uff1b"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{src:"https://rdk-doc.oss-cn-beijing.aliyuncs.com/doc/img/07_Advanced_development/03_multimedia_development/02_S100/codec/40cd6c4fa7cf66f9bf14c3675cb7ef20.png",alt:""})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{src:"https://rdk-doc.oss-cn-beijing.aliyuncs.com/doc/img/07_Advanced_development/03_multimedia_development/02_S100/codec/be7fe30d2685e27e2b36f305ef745eb4.png",alt:""})}),"\n",(0,i.jsx)(n.p,{children:"GOP Preset 8"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"\u53ea\u6709I\u5e27\u548cB\u5e27\uff1b"}),"\n",(0,i.jsx)(n.li,{children:"B\u5e27\u53c2\u80031\u4e2a\u524d\u5411\u53c2\u8003\u5e27\uff0c\u4e00\u4e2a\u540e\u5411\u53c2\u8003\u5e27\uff1b"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{src:"https://rdk-doc.oss-cn-beijing.aliyuncs.com/doc/img/07_Advanced_development/03_multimedia_development/02_S100/codec/9c46efaf2a9106bcee2468098e209b1f.png",alt:""})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{src:"https://rdk-doc.oss-cn-beijing.aliyuncs.com/doc/img/07_Advanced_development/03_multimedia_development/02_S100/codec/d016b90fa0a06e183b6871bc430a8714.png",alt:""})}),"\n",(0,i.jsx)(n.p,{children:"GOP Preset 9"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"\u53ea\u6709I\u5e27\u548cP\u5e27\uff1b"}),"\n",(0,i.jsx)(n.li,{children:"P\u5e27\u53c2\u80031\u4e2a\u524d\u5411\u53c2\u8003\u5e27\uff1b"}),"\n",(0,i.jsx)(n.li,{children:"\u4f4e\u5ef6\u65f6\uff1b"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{src:"https://rdk-doc.oss-cn-beijing.aliyuncs.com/doc/img/07_Advanced_development/03_multimedia_development/02_S100/codec/0bc1b9d3e73b4037b64236650738b5cd.png",alt:""})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{src:"https://rdk-doc.oss-cn-beijing.aliyuncs.com/doc/img/07_Advanced_development/03_multimedia_development/02_S100/codec/937b45950423ff5006e378cb510d695d.png",alt:""})}),"\n",(0,i.jsx)(n.h4,{id:"vpu\u8c03\u8bd5\u65b9\u5f0f",children:"VPU\u8c03\u8bd5\u65b9\u5f0f"}),"\n",(0,i.jsx)(n.p,{children:"VPU\uff08\u89c6\u9891\u5904\u7406\u5355\u5143\uff09\u662f\u4e00\u79cd\u4e13\u7528\u7684\u89c6\u89c9\u5904\u7406\u5355\u5143\uff0c\u53ef\u4ee5\u9ad8\u6548\u5904\u7406\u89c6\u9891\u5185\u5bb9\u3002VPU\u53ef\u4ee5\u5b9e\u73b0H265\u89c6\u9891\u683c\u5f0f\u7684\u7f16\u89e3\u7801\u5904\u7406\u3002\u7528\u6237\u901a\u8fc7Codec\u63d0\u4f9b\u7684\u63a5\u53e3\u5373\u53ef\u83b7\u5f97\u8f93\u5165\u7684\u7f16\u7801/\u89e3\u7801\u6d41\u3002"}),"\n",(0,i.jsx)(n.h5,{id:"\u7f16\u7801\u72b6\u6001",children:"\u7f16\u7801\u72b6\u6001"}),"\n",(0,i.jsx)(n.p,{children:"\u7f16\u7801\u8c03\u8bd5\u4fe1\u606f"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-c",children:"cat /sys/kernel/debug/vpu/venc\nroot@ubuntu:~# cat /sys/kernel/debug/vpu/venc\n----encode enc param----\nenc_idx  enc_id     profile       level width height pix_fmt fbuf_count extern_buf_flag bsbuf_count bsbuf_size mirror rotate\n      0    h265        Main unspecified  4096   2160       0          5               1           5   13271040      0      0\n\n----encode h265cbr param----\nenc_idx rc_mode intra_period intra_qp bit_rate frame_rate initial_rc_qp vbv_buffer_size ctu_level_rc_enalbe min_qp_I max_qp_I min_qp_P max_qp_P min_qp_B max_qp_B hvs_qp_enable hvs_qp_scale qp_map_enable max_delta_qp\n      0 h265cbr           20       30     5000         30            30            3000                   1        8       50        8       50        8       50             1            2             0           10\n----encode gop param----\nenc_idx  enc_id gop_preset_idx custom_gop_size decoding_refresh_type\n      0    h265              2               0                     2\n----encode intra refresh----\nenc_idx  enc_id intra_refresh_mode intra_refresh_arg\n      0    h265                  0                 0\n\n----encode longterm ref----\nenc_idx  enc_id use_longterm longterm_pic_period longterm_pic_using_period\n      0    h265            0                   0                         0\n----encode roi_params----\nenc_idx  enc_id roi_enable roi_map_array_count\n      0    h265          0                   0\n----encode mode_decision 1----\nenc_idx  enc_id mode_decision_enable pu04_delta_rate pu08_delta_rate pu16_delta_rate pu32_delta_rate pu04_intra_planar_delta_rate pu04_intra_dc_delta_rate pu04_intra_angle_delta_rate pu08_intra_planar_delta_rate pu08_intra_dc_delta_rate pu08_intra_angle_delta_rate pu16_intra_planar_delta_rate pu16_intra_dc_delta_rate pu16_intra_angle_delta_rate\n      0    h265                    0               0               0               0               0                            0                        0                           0                            0                        0                           0                            0                        0                           0\n\n----encode mode_decision 2----\nenc_idx  enc_id pu32_intra_planar_delta_rate pu32_intra_dc_delta_rate pu32_intra_angle_delta_rate cu08_intra_delta_rate cu08_inter_delta_rate cu08_merge_delta_rate cu16_intra_delta_rate cu16_inter_delta_rate cu16_merge_delta_rate cu32_intra_delta_rate cu32_inter_delta_rate cu32_merge_delta_rate\n      0    h265                            0                        0                           0                     0                     0                     0                     0                     0                     0                     0                     0                     0\n----encode h265_transform----\nenc_idx  enc_id chroma_cb_qp_offset chroma_cr_qp_offset user_scaling_list_enable\n      0    h265                   0                   0                        0\n----encode h265_pred_unit----\nenc_idx  enc_id intra_nxn_enable constrained_intra_pred_flag strong_intra_smoothing_enabled_flag max_num_merge\n      0    h265                1                           0                                   1             2\n----encode h265 timing----\nenc_idx  enc_id vui_num_units_in_tick vui_time_scale vui_num_ticks_poc_diff_one_minus1\n      0    h265                  1000          30000                                 0\n----encode h265 slice params----\nenc_idx  enc_id h265_independent_slice_mode h265_independent_slice_arg h265_dependent_slice_mode h265_dependent_slice_arg\n      0    h265                           0                          0                         0                        0\n----encode h265 deblk filter----\nenc_idx  enc_id slice_deblocking_filter_disabled_flag slice_beta_offset_div2 slice_tc_offset_div2 slice_loop_filter_across_slices_enabled_flag\n      0    h265                                     0                      0                    0                                            1\n\n----encode h265 sao param----\nenc_idx  enc_id sample_adaptive_offset_enabled_flag\n\n      0    h265                              1\n----encode status----\nenc_idx  enc_id cur_input_buf_cnt cur_output_buf_cnt left_recv_frame left_enc_frame total_input_buf_cnt total_output_buf_cnt     fps\n      0    h265                 4                  1               0              0                1093                 1089      35\n"})}),"\n",(0,i.jsx)(n.p,{children:"\u53c2\u6570\u89e3\u91ca"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"\u8c03\u8bd5\u4fe1\u606f\u5206\u7ec4"}),(0,i.jsx)(n.th,{children:"\u72b6\u6001\u53c2\u6570"}),(0,i.jsx)(n.th,{children:"\u8bf4\u660e"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"encode enc param"}),(0,i.jsx)(n.td,{children:"\u57fa\u7840\u7f16\u7801\u53c2\u6570"}),(0,i.jsx)(n.td,{children:"enc_idx\uff1a\u7f16\u7801\u5b9e\u4f8b\u503c enc_id\uff1a\u7f16\u7801\u7c7b\u578b profile\uff1aprofile\u7c7b\u578b level\uff1ah265 level\u7c7b\u578b width\uff1a\u7f16\u7801\u5bbd\u5ea6 height\uff1a\u7f16\u7801\u9ad8\u5ea6 pix_fmt\uff1a\u8f93\u5165\u5e27\u50cf\u7d20\u7c7b\u578b fbuf_count\uff1a\u8f93\u5165\u7684rameBuffer\u6570 extern_buf_flag\uff1a\u662f\u5426\u4f7f\u7528\u5916\u90e8\u8f93\u5165buffer bsbuf_count\uff1abitstreamBuffer\u6570 bsbuf_size\uff1abitstreamBuffer\u5927\u5c0f mirror\uff1a\u662f\u5426\u8bbe\u7f6e\u955c\u50cf rotate\uff1a\u662f\u5426\u8bbe\u7f6e\u65cb\u8f6c"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"encode h265cbr param"}),(0,i.jsx)(n.td,{children:"CBR\u7801\u7387\u63a7\u5236\u53c2\u6570"}),(0,i.jsx)(n.td,{children:"enc_idx\uff1a\u7f16\u7801\u5b9e\u4f8b\u503c rc_mode\uff1a\u7801\u7387\u63a7\u5236\u7c7b\u578b intra_period\uff1aI\u5e27\u95f4\u9694 intra_qp\uff1aI\u5e27qp\u503c bit_rate\uff1a\u7801\u7387\u503c frame_rate\uff1a\u5e27\u7387 initial_rc_qp\uff1a\u521d\u59cbQP\u503c vbv_buffer_size\uff1aVBV buffer\u7684\u5927\u5c0f ctu_level_rc_enalbe\uff1a\u7801\u7387\u63a7\u5236\u662f\u5426\u5de5\u4f5c\u5728ctu\u7ea7\u522b min_qp_I\uff1aI\u5e27\u6700\u5c0fQP\u503c max_qp_I\uff1aI\u5e27\u6700\u5927QP\u503c min_qp_P\uff1aP\u5e27\u6700\u5c0fQP\u503c max_qp_P\uff1aP\u5e27\u6700\u5927QP\u503c min_qp_B\uff1aB\u5e27\u6700\u5c0fQP\u503c max_qp_B\uff1aB\u5e27\u6700\u5927QP\u503c hvs_qp_enable\uff1a\u7801\u7387\u63a7\u5236\u662f\u5426\u5de5\u4f5c\u5728subCTU\u7ea7\u522b hvs_qp_scale\uff1aQP\u7f29\u653e\u56e0\u5b50 qp_map_enable\uff1a\u4f7f\u80fdROI\u7f16\u7801\u65f6\u7684QP map max_delta_qp\uff1a\u6307\u5b9aHVS QP\u503c\u7684\u6700\u5927\u504f\u5dee\u8303\u56f4"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"encode gop param"}),(0,i.jsx)(n.td,{children:"GOP\u53c2\u6570"}),(0,i.jsx)(n.td,{children:"enc_idx\uff1a\u7f16\u7801\u5b9e\u4f8b\u503c enc_id\uff1a\u7f16\u7801\u7c7b\u578b gop_preset_idx\uff1a\u9009\u62e9\u9884\u7f6e\u7684GOP\u7ed3\u6784 custom_gop_size\uff1a\u81ea\u5b9a\u4e49\u65f6GOP\u7684\u5927\u5c0f decoding_refresh_type\uff1a\u8bbe\u7f6eIDR\u5e27\u7684\u5177\u4f53\u7c7b\u578b"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"encode intra refresh"}),(0,i.jsx)(n.td,{children:"\u5e27\u5185\u5237\u65b0\u53c2\u6570"}),(0,i.jsx)(n.td,{children:"enc_idx\uff1a\u7f16\u7801\u5b9e\u4f8b\u503c enc_id\uff1a\u7f16\u7801\u7c7b\u578b intra_refresh_mode\uff1a\u5e27\u5185\u5237\u65b0\u6a21\u5f0f intra_refresh_arg\uff1a\u5e27\u5185\u5237\u65b0\u53c2\u6570"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"encode longterm ref"}),(0,i.jsx)(n.td,{children:"\u957f\u671f\u53c2\u8003\u5e27\u53c2\u6570"}),(0,i.jsx)(n.td,{children:"enc_idx\uff1a\u7f16\u7801\u5b9e\u4f8b\u503c enc_id\uff1a\u7f16\u7801\u7c7b\u578b use_longterm\uff1a\u4f7f\u80fd\u957f\u671f\u53c2\u8003\u5e27 longterm_pic_period\uff1a\u957f\u671f\u53c2\u8003\u5e27\u5468\u671f longterm_pic_using_period\uff1a\u53c2\u8003\u957f\u671f\u53c2\u8003\u5e27\u7684\u5468\u671f"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"encode roi_params"}),(0,i.jsx)(n.td,{children:"ROI\u53c2\u6570"}),(0,i.jsx)(n.td,{children:"enc_idx\uff1a\u7f16\u7801\u5b9e\u4f8b\u503c enc_id\uff1a\u7f16\u7801\u7c7b\u578b roi_enable\uff1a\u4f7f\u80fdROI\u7f16\u7801 roi_map_array_count\uff1aROI map\u4e2d\u5143\u7d20\u7684\u4e2a\u6570"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"encode mode_decision 1"}),(0,i.jsx)(n.td,{children:"\u5757\u7f16\u7801\u6a21\u5f0f\u51b3\u7b56\u53c2\u65701"}),(0,i.jsx)(n.td,{children:"\u5404\u79cd\u6a21\u5f0f\u9009\u62e9\u53c2\u6570\u503c\uff0c\u5305\u62ecpu04_delta_rate\uff0cpu08_delta_rate\u7b49"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"encode mode_decision 2"}),(0,i.jsx)(n.td,{children:"\u5757\u7f16\u7801\u6a21\u5f0f\u51b3\u7b56\u53c2\u65702"}),(0,i.jsx)(n.td,{children:"\u5404\u79cd\u6a21\u5f0f\u9009\u62e9\u53c2\u6570\u503c\uff0c\u5305\u62ecpu32_intra_planar_delta_rate\uff0c pu32_intra_dc_delta_rate\u7b49"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"encode h265_transform"}),(0,i.jsx)(n.td,{children:"Transform\u53c2\u6570"}),(0,i.jsx)(n.td,{children:"enc_idx\uff1a\u7f16\u7801\u5b9e\u4f8b\u503c enc_id\uff1a\u7f16\u7801\u7c7b\u578b chroma_cb_qp_offset\uff1a\u6307\u5b9acb\u5206\u91cf\u7684QP\u504f\u5dee chroma_cr_qp_offset\uff1a\u6307\u5b9acr\u5206\u91cf\u7684QP\u504f\u5dee user_scaling_list_enable\uff1a\u4f7f\u80fd\u7528\u6237\u6307\u5b9a\u7684scaling list"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"encode h265_pred_unit"}),(0,i.jsx)(n.td,{children:"\u9884\u6d4b\u5355\u5143\u53c2\u6570"}),(0,i.jsx)(n.td,{children:"enc_idx\uff1a\u7f16\u7801\u5b9e\u4f8b\u503c enc_id\uff1a\u7f16\u7801\u7c7b\u578b intra_nxn_enable\uff1a\u4f7f\u80fdintra NXN PUs constrained_intra_pred_flag\uff1a\u5e27\u5185\u9884\u6d4b\u662f\u5426\u53d7\u9650 strong_intra_smoothing_enabled_flag\uff1a\u6ee4\u6ce2\u8fc7\u7a0b\u662f\u5426\u4f7f\u7528\u53cc\u5411\u7ebf\u6027\u63d2\u503c max_num_merge\uff1a\u6307\u5b9amerge\u5019\u9009\u7684\u6570\u91cf"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"encode h265 timing"}),(0,i.jsx)(n.td,{children:"Timing\u53c2\u6570"}),(0,i.jsx)(n.td,{children:"enc_idx\uff1a\u7f16\u7801\u5b9e\u4f8b\u503c enc_id\uff1a\u7f16\u7801\u7c7b\u578b vui_num_units_in_tick\uff1a\u6307\u5b9a\u65f6\u95f4\u5355\u4f4d\u6570 vui_time_scale\uff1a\u4e00\u79d2\u5185\u7684\u65f6\u95f4\u5355\u4f4d\u6570 vui_num_ticks_poc_diff_one_minus1\uff1a\u6307\u5b9a\u4e0e\u7b49\u4e8e1\u7684\u56fe\u7247\u987a\u5e8f\u8ba1\u6570\u503c\u4e4b\u5dee\u5bf9\u5e94\u7684\u65f6\u949f\u6ef4\u7b54\u6570"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"encode h265 slice params"}),(0,i.jsx)(n.td,{children:"Slice\u53c2\u6570"}),(0,i.jsx)(n.td,{children:"enc_idx\uff1a\u7f16\u7801\u5b9e\u4f8b\u503c enc_id\uff1a\u7f16\u7801\u7c7b\u578b h265_independent_slice_mode\uff1a\u72ec\u7acbslice\u7f16\u7801\u6a21\u5f0f h265_independent_slice_arg\uff1a\u72ec\u7acbslice\u7684\u5927\u5c0f h265_dependent_slice_mode\uff1a\u975e\u72ec\u7acbslice\u7f16\u7801\u6a21\u5f0f h265_dependent_slice_arg\uff1a\u975e\u72ec\u7acbslice\u7684\u5927\u5c0f"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"encode h265 deblk filter"}),(0,i.jsx)(n.td,{children:"\u53bb\u5757\u6ee4\u6ce2\u53c2\u6570"}),(0,i.jsx)(n.td,{children:"enc_idx\uff1a\u7f16\u7801\u5b9e\u4f8b\u503c enc_id\uff1a\u7f16\u7801\u7c7b\u578b slice_deblocking_filter_disabled_flag\uff1a\u662f\u5426\u8fdb\u884cslice\u5185\u90e8\u6ee4\u6ce2 slice_beta_offset_div2\uff1a\u6307\u5b9a\u5f53\u524d\u5207\u7247\u7684\u03b2\u53bb\u5757\u53c2\u6570\u504f\u79fb\u91cf slice_tc_offset_div2\uff1a\u6307\u5b9a\u5f53\u524d\u5207\u7247\u7684tC\u53bb\u5757\u53c2\u6570\u504f\u79fb\u91cf slice_loop_filter_across_slices_enabled_flag\uff1a\u662f\u5426\u8fdb\u884c\u8fb9\u754c\u6ee4\u6ce2"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"encode h265 sao param"}),(0,i.jsx)(n.td,{children:"SAO\u53c2\u6570"}),(0,i.jsx)(n.td,{children:"enc_idx\uff1a\u7f16\u7801\u5b9e\u4f8b\u503c enc_id\uff1a\u7f16\u7801\u7c7b\u578b sample_adaptive_offset_enabled_flag\uff1a\u662f\u5426\u5bf9\u7ecf\u8fc7\u53bb\u5757\u6ee4\u6ce2\u5904\u7406\u540e\u7684\u91cd\u6784\u56fe\u50cf\u8fdb\u884c\u91c7\u6837\u81ea\u9002\u5e94\u504f\u79fb\u5904\u7406"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"encode status"}),(0,i.jsx)(n.td,{children:"\u5f53\u524d\u7f16\u7801\u72b6\u6001\u53c2\u6570"}),(0,i.jsx)(n.td,{children:"enc_idx\uff1a\u7f16\u7801\u5b9e\u4f8b\u503c enc_id\uff1a\u7f16\u7801\u7c7b\u578b cur_input_buf_cnt\uff1a\u5f53\u524d\u4f7f\u7528\u7684inputbuffer\u6570\u91cf cur_output_buf_cnt\uff1a\u5f53\u524d\u4f7f\u7528\u7684outputbuffer\u6570\u91cf left_recv_frame\uff1a\u5269\u4f59\u9700\u8981\u63a5\u6536\u7684\u5e27\u6570\uff08\u8bbe\u7f6ereceive_frame_number\u540e\u6709\u6548\uff09 left_enc_frame\uff1a\u5269\u4f59\u9700\u8981\u7f16\u7801\u7684\u5e27\u6570\uff08\u8bbe\u7f6ereceive_frame_number\u540e\u6709\u6548\uff09 total_input_buf_cnt\uff1a\u8868\u793a\u5f53\u524d\u603b\u4f7f\u7528\u7684inputbuffer\u6570 total_output_buf_cnt\uff1a\u8868\u793a\u5f53\u524d\u603b\u4f7f\u7528\u7684outputbuffer\u6570 fps\uff1a\u8868\u793a\u5f53\u524d\u7684\u5e27\u7387"})]})]})]}),"\n",(0,i.jsx)(n.h5,{id:"\u89e3\u7801\u72b6\u6001",children:"\u89e3\u7801\u72b6\u6001"}),"\n",(0,i.jsx)(n.p,{children:"\u89e3\u7801\u8c03\u8bd5\u4fe1\u606f"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-c",children:"cat /sys/kernel/debug/vpu/vdec\nroot@ubuntu:~# cat /sys/kernel/debug/vpu/vdec\n----decode param----\ndec_idx dec_id feed_mode pix_fmt bitstream_buf_size bitstream_buf_count frame_buf_count\n   0   h265     1      0     13271040          6   6\n----h265 decode param----\ndec_idx dec_id reorder_enable skip_mode bandwidth_Opt cra_as_bla dec_temporal_id_mode target_dec_temporal_id_plus1\n   0   h265        1          0          1            0        0                      0\n----decode frameinfo----\ndec_idx dec_id display_width display_height\n    0   h265       4096       2160\n----decode status----\ndec_idx dec_id cur_input_buf_cnt cur_output_buf_cnt total_input_buf_cnt total_output_buf_cnt fps\n   0   h265          5                1              458       453         53\n"})}),"\n",(0,i.jsx)(n.p,{children:"\u53c2\u6570\u89e3\u91ca"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"\u8c03\u8bd5\u4fe1\u606f\u5206\u7ec4"}),(0,i.jsx)(n.th,{children:"\u72b6\u6001\u53c2\u6570"}),(0,i.jsx)(n.th,{children:"\u8bf4\u660e"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"decode param"}),(0,i.jsx)(n.td,{children:"\u57fa\u7840\u89e3\u7801\u53c2\u6570"}),(0,i.jsx)(n.td,{children:"dec_idx\uff1a\u89e3\u7801\u5b9e\u4f8b\u503c dec_id\uff1a\u89e3\u7801\u7c7b\u578b feed_mode\uff1a\u6570\u636e\u586b\u5145\u7c7b\u578b pix_fmt\uff1a\u8f93\u51fa\u50cf\u7d20\u7c7b\u578b bitstream_buf_size\uff1a\u8f93\u5165\u7684bitstream\u7f13\u5b58\u533a\u5927\u5c0f bitstream_buf_count\uff1a\u8f93\u5165\u7684bitstream\u7f13\u5b58\u533a\u4e2a\u6570 frame_buf_count\uff1a\u8f93\u51fa\u7684Framebuffer\u7f13\u5b58\u7684\u4e2a\u6570"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"h265 decode param"}),(0,i.jsx)(n.td,{children:"H265\u89e3\u7801\u57fa\u7840\u53c2\u6570"}),(0,i.jsx)(n.td,{children:"dec_idx\uff1a\u89e3\u7801\u5b9e\u4f8b\u503c dec_id\uff1a\u89e3\u7801\u7c7b\u578b reorder_enable\uff1a\u4f7f\u80fd\u89e3\u7801\u5668\u6309\u663e\u793a\u987a\u5e8f\u8f93\u51fa\u5e27\u5e8f\u5217 skip_mode\uff1a\u4f7f\u80fd\u5e27\u89e3\u7801\u5ffd\u7565\u6a21\u5f0f bandwidth_Opt\uff1a\u4f7f\u80fd\u8282\u7701\u5e26\u5bbd\u6a21\u5f0f cra_as_bla\uff1a\u4f7f\u80fdCRA\u4f5c\u4e3aBLA\u5904\u7406 dec_temporal_id_mode\uff1a\u6307\u5b9atemporal id\u7684\u9009\u62e9\u6a21\u5f0f target_dec_temporal_id_plus1\uff1a\u6307\u5b9atemporal id\u503c"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"decode frameinfo"}),(0,i.jsx)(n.td,{children:"\u89e3\u7801\u8f93\u51fa\u5e27\u4fe1\u606f"}),(0,i.jsx)(n.td,{children:"dec_idx\uff1a\u89e3\u7801\u5b9e\u4f8b\u503c dec_id\uff1a\u89e3\u7801\u7c7b\u578b display_width\uff1a\u663e\u793a\u7684\u5bbd\u5ea6 display_height\uff1a\u663e\u793a\u7684\u9ad8\u5ea6"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"decode status"}),(0,i.jsx)(n.td,{children:"\u5f53\u524d\u89e3\u7801\u72b6\u6001\u53c2\u6570"}),(0,i.jsx)(n.td,{children:"dec_idx\uff1a\u89e3\u7801\u5b9e\u4f8b\u503c dec_id\uff1a\u89e3\u7801\u7c7b\u578b cur_input_buf_cnt\uff1a\u5f53\u524d\u4f7f\u7528\u7684inputbuffer\u6570\u91cf cur_output_buf_cnt\uff1a\u5f53\u524d\u4f7f\u7528\u7684outputbuffer\u6570\u91cf total_input_buf_cnt\uff1a\u5f53\u524d\u603b\u4f7f\u7528\u7684inputbuffer\u6570 total_output_buf_cnt\uff1a\u5f53\u524d\u603b\u4f7f\u7528\u7684outputbuffer\u6570 fps\uff1a\u5f53\u524d\u5e27\u7387"})]})]})]}),"\n",(0,i.jsx)(n.h4,{id:"jpu-\u8c03\u8bd5\u65b9\u5f0f",children:"JPU \u8c03\u8bd5\u65b9\u5f0f"}),"\n",(0,i.jsx)(n.p,{children:"JPU\uff08\u56fe\u7247\u5904\u7406\u5355\u5143\uff09\u4e3b\u8981\u7528\u4ee5\u5b8c\u6210JPEG/MJPEG\u7684\u7f16\u89e3\u7801\u529f\u80fd\u3002\u7528\u6237\u53ef\u4ee5\u901a\u8fc7CODEC\u63a5\u53e3\u8f93\u5165\u5f85\u7f16\u7801\u7684YUV\u6570\u636e\u6216\u5f85\u89e3\u7801\u7684JPEG\u56fe\u7247\uff0c\u901a\u8fc7JPU\u5904\u7406\u540e\u83b7\u53d6\u7f16\u7801\u5b8c\u7684JPEG\u56fe\u7247\u6216\u89e3\u7801\u5b8c\u7684YUV\u6570\u636e\u3002"}),"\n",(0,i.jsx)(n.h5,{id:"\u7f16\u7801\u72b6\u6001-1",children:"\u7f16\u7801\u72b6\u6001"}),"\n",(0,i.jsx)(n.p,{children:"\u7f16\u7801\u8c03\u8bd5\u4fe1\u606f"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-c",children:"cat /sys/kernel/debug/jpu/jenc\nroot@ubuntu:~# cat /sys/kernel/debug/jpu/jenc\n----encode param----\nenc_idx  enc_id width height pix_fmt fbuf_count extern_buf_flag bsbuf_count bsbuf_size mirror rotate\n      0    jpeg  1920   1088       1          5               0           5    3137536      0      0\n\n----encode rc param----\nenc_idx   rc_mode frame_rate quality_factor\n      0 noratecontrol          0              0\n----encode status----\nenc_idx  enc_id cur_input_buf_cnt cur_output_buf_cnt left_recv_frame left_enc_frame total_input_buf_cnt total_output_buf_cnt     fps\n      0    jpeg                 4                  1               0              0                4344                 4340     287\n"})}),"\n",(0,i.jsx)(n.p,{children:"\u53c2\u6570\u89e3\u91ca"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"\u8c03\u8bd5\u4fe1\u606f\u5206\u7ec4"}),(0,i.jsx)(n.th,{children:"\u72b6\u6001\u53c2\u6570"}),(0,i.jsx)(n.th,{children:"\u8bf4\u660e"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"encode param"}),(0,i.jsx)(n.td,{children:"\u57fa\u7840\u7f16\u7801\u53c2\u6570"}),(0,i.jsx)(n.td,{children:"enc_idx\uff1a\u7f16\u7801\u5b9e\u4f8b enc_id\uff1a\u7f16\u7801\u7c7b\u578b width\uff1a\u56fe\u50cf\u5bbd\u5ea6 height\uff1a\u56fe\u50cf\u9ad8\u5ea6 pix_fmt\uff1a\u50cf\u7d20\u7c7b\u578b fbuf_count\uff1a\u8f93\u5165\u7684Framebuffer\u7f13\u5b58\u7684\u4e2a\u6570 extern_buf_flag\uff1a\u662f\u5426\u4f7f\u7528\u7528\u6237\u5206\u914d\u7684\u8f93\u5165buffer bsbuf_count\uff1a\u8f93\u51fa\u7684bitstream\u7f13\u5b58\u533a\u4e2a\u6570 bsbuf_size\uff1a\u8f93\u51fa\u7684bitstream\u7684\u5927\u5c0f mirror\uff1a\u662f\u5426\u8bbe\u7f6e\u955c\u50cf rotate\uff1a\u662f\u5426\u8bbe\u7f6e\u65cb\u8f6c"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"encode rc param"}),(0,i.jsx)(n.td,{children:"mjpeg\u7801\u7387\u63a7\u5236\u53c2\u6570"}),(0,i.jsx)(n.td,{children:"enc_idx\uff1a\u7f16\u7801\u5b9e\u4f8b rc_mode\uff1a\u7801\u7387\u63a7\u5236\u6a21\u5f0f frame_rate\uff1a\u76ee\u6807\u5e27\u7387 quality_factor\uff1a\u91cf\u5316\u56e0\u5b50"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"encode status"}),(0,i.jsx)(n.td,{children:"\u5f53\u524d\u7f16\u7801\u72b6\u6001\u53c2\u6570"}),(0,i.jsx)(n.td,{children:"enc_idx\uff1a\u7f16\u7801\u5b9e\u4f8b\u503c enc_id\uff1a\u7f16\u7801\u7c7b\u578b cur_input_buf_cnt\uff1a\u5f53\u524d\u4f7f\u7528\u7684inputbuffer\u6570\u91cf cur_output_buf_cnt\uff1a\u5f53\u524d\u4f7f\u7528\u7684outputbuffer\u6570\u91cf left_recv_frame\uff1a\u5269\u4f59\u9700\u8981\u63a5\u6536\u7684\u5e27\u6570\uff08\u8bbe\u7f6ereceive_frame_number\u540e\u6709\u6548\uff09 left_enc_frame\uff1a\u5269\u4f59\u9700\u8981\u7f16\u7801\u7684\u5e27\u6570\uff08\u8bbe\u7f6ereceive_frame_number\u540e\u6709\u6548\uff09 total_input_buf_cnt\uff1a\u8868\u793a\u5f53\u524d\u603b\u4f7f\u7528\u7684inputbuffer\u6570 total_output_buf_cnt\uff1a\u8868\u793a\u5f53\u524d\u603b\u4f7f\u7528\u7684outputbuffer\u6570 fps\uff1a\u8868\u793a\u5f53\u524d\u7684\u5e27\u7387"})]})]})]}),"\n",(0,i.jsx)(n.h5,{id:"\u89e3\u7801\u72b6\u6001-1",children:"\u89e3\u7801\u72b6\u6001"}),"\n",(0,i.jsx)(n.p,{children:"\u89e3\u7801\u8c03\u8bd5\u4fe1\u606f"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-c",children:"cat /sys/kernel/debug/jpu/jdec\nroot@ubuntu:~# cat /sys/kernel/debug/jpu/jdec\n\n----decode param----\ndec_idx  dec_id feed_mode pix_fmt bitstream_buf_size bitstream_buf_count frame_buf_count mirror rotate\n      0    jpeg         1       1            3133440                   5               5      0      0\n\n----decode frameinfo----\ndec_idx  dec_id display_width display_height\n      0    jpeg          1920           1088\n\n----decode status----\ndec_idx  dec_id cur_input_buf_cnt cur_output_buf_cnt total_input_buf_cnt total_output_buf_cnt     fps\n      0    jpeg                 0                  1                3779                 3779     264\n"})}),"\n",(0,i.jsx)(n.p,{children:"\u53c2\u6570\u89e3\u91ca"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"\u8c03\u8bd5\u4fe1\u606f\u5206\u7ec4"}),(0,i.jsx)(n.th,{children:"\u72b6\u6001\u53c2\u6570"}),(0,i.jsx)(n.th,{children:"\u8bf4\u660e"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"decode param"}),(0,i.jsx)(n.td,{children:"\u89e3\u7801\u57fa\u7840\u53c2\u6570"}),(0,i.jsx)(n.td,{children:"dec_idx\uff1a\u89e3\u7801\u5b9e\u4f8b dec_id\uff1a\u89e3\u7801\u7c7b\u578b feed_mode\uff1a pix_fmt\uff1a\u56fe\u50cf\u50cf\u7d20 bitstream_buf_size\uff1a\u8f93\u5165\u7684bitstream\u7f13\u5b58\u533a\u5927\u5c0f bitstream_buf_count\uff1a\u8f93\u5165\u7684bitstream\u7f13\u5b58\u533a\u4e2a\u6570 frame_buf_count\uff1a\u8f93\u51fa\u7684Framebuffer\u7f13\u5b58\u7684\u4e2a\u6570 mirror\uff1a\u662f\u5426\u8bbe\u7f6e\u955c\u50cf rotate\uff1a\u662f\u5426\u8bbe\u7f6e\u65cb\u8f6c"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"decode frameinfo"}),(0,i.jsx)(n.td,{children:"\u89e3\u7801\u8f93\u51fa\u5e27\u4fe1\u606f"}),(0,i.jsx)(n.td,{children:"dec_idx\uff1a\u89e3\u7801\u5b9e\u4f8b\u503c dec_id\uff1a\u89e3\u7801\u7c7b\u578b display_width\uff1a\u663e\u793a\u7684\u5bbd\u5ea6 display_height\uff1a\u663e\u793a\u7684\u9ad8\u5ea6"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"decode status"}),(0,i.jsx)(n.td,{children:"\u5f53\u524d\u7f16\u7801\u72b6\u6001\u53c2\u6570"}),(0,i.jsx)(n.td,{children:"dec_idx\uff1a\u89e3\u7801\u5b9e\u4f8b\u503c dec_id\uff1a\u89e3\u7801\u7c7b\u578b cur_input_buf_cnt\uff1a\u5f53\u524d\u4f7f\u7528\u7684inputbuffer\u6570\u91cf cur_output_buf_cnt\uff1a\u5f53\u524d\u4f7f\u7528\u7684outputbuffer\u6570\u91cf total_input_buf_cnt\uff1a\u5f53\u524d\u603b\u4f7f\u7528\u7684inputbuffer\u6570 total_output_buf_cnt\uff1a\u5f53\u524d\u603b\u4f7f\u7528\u7684outputbuffer\u6570 fps\uff1a\u5f53\u524d\u5e27\u7387"})]})]})]}),"\n",(0,i.jsx)(n.h3,{id:"\u5178\u578b\u573a\u666f",children:"\u5178\u578b\u573a\u666f"}),"\n",(0,i.jsx)(n.h4,{id:"\u5355\u8def\u7f16\u7801",children:"\u5355\u8def\u7f16\u7801"}),"\n",(0,i.jsx)(n.p,{children:"\u5355\u8def\u7f16\u7801\u573a\u666f\u5982\u4e0b\u56fe\u6240\u793a\u3002Scenario0\u662f\u7b80\u5355\u573a\u666f\uff0c\u4eceEMMC\u4e2d\u8bfb\u53d6YUV\u89c6\u9891/\u56fe\u50cf\u6587\u4ef6\uff0c\u7ecf\u8fc7VPU\u786c\u4ef6\u7f16\u7801\u8f93\u51fa\u7684H26x\u7801\u6d41\u6216JPU\u786c\u4ef6\u7f16\u7801\u8f93\u51fa\u7684Jpeg\u56fe\u50cf\uff0c\u6700\u540e\u4fdd\u5b58\u4e3a\u6587\u4ef6\u5b58\u50a8\u5230EMMC\u3002Scenario1\u662f\u4e32\u8054\u524d\u540e\u7ea7\u6a21\u5757\u7684\u590d\u6742\u573a\u666f\uff0c\u5c06\u6444\u50cf\u5934\u91c7\u96c6\u7684\u6570\u636e\u7f16\u7801\u538b\u7f29\u540e\u8fdb\u884c\u4fdd\u5b58\u6216\u901a\u8fc7\u7f51\u7edc\u548cPCIE\u4f20\u8f93\u3002"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{src:"https://rdk-doc.oss-cn-beijing.aliyuncs.com/doc/img/07_Advanced_development/03_multimedia_development/02_S100/codec/788c1e3b839232111ccd53d35d25e278.png",alt:""})}),"\n",(0,i.jsx)(n.h4,{id:"\u5355\u8def\u89e3\u7801",children:"\u5355\u8def\u89e3\u7801"}),"\n",(0,i.jsx)(n.p,{children:"\u5355\u8def\u89e3\u7801\u573a\u666f\u5982\u4e0b\u56fe\u6240\u793a\u3002Scenario0\u662f\u7b80\u5355\u573a\u666f\uff0c\u4eceEMMC\u4e2d\u8bfb\u53d6H26x\u7801\u6d41/Jpeg\u56fe\u50cf\u6587\u4ef6\uff0c\u7ecf\u8fc7VPU\u6216JPU\u786c\u4ef6\u89e3\u7801\u8f93\u51fa\u7684YUV\u6570\u636e\uff0c\u6700\u540e\u4fdd\u5b58\u4e3a\u6587\u4ef6\u5b58\u50a8\u5230EMMC\u3002Scenario1\u662f\u4e32\u8054\u524d\u540e\u7ea7\u6a21\u5757\u7684\u590d\u6742\u573a\u666f\uff0c\u901a\u8fc7\u7f51\u7edc\u6216PCIE\u63a5\u6536\u5df2\u7f16\u7801\u7684\u89c6\u9891\u6216\u56fe\u50cf\u6570\u636e\uff0c\u7ecf\u8fc7VPU\u6216JPU\u786c\u4ef6\u89e3\u7801\u540e\u4f7f\u7528IDE\u663e\u793a\u64ad\u653e\u3002"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{src:"https://rdk-doc.oss-cn-beijing.aliyuncs.com/doc/img/07_Advanced_development/03_multimedia_development/02_S100/codec/e50f9bf3c4d1ecfbd36b354f9009e8bc.png",alt:""})}),"\n",(0,i.jsx)(n.h4,{id:"\u591a\u8def\u7f16\u7801",children:"\u591a\u8def\u7f16\u7801"}),"\n",(0,i.jsx)(n.p,{children:"\u591a\u8def\u7f16\u7801\u573a\u666f\u5982\u4e0b\u56fe\u6240\u793a\uff0cScenario0\u662f\u6587\u4ef6\u8f93\u5165\u7684\u7b80\u5355\u573a\u666f\uff0cScenario1\u662f\u4e32\u8054\u524d\u540e\u7ea7\u6a21\u5757\u7684\u590d\u6742\u573a\u666f\uff0c\u9700\u8981\u6ce8\u610f\u7684\u662f\u5728Scenario1\u573a\u666f\u8981\u7efc\u5408\u8003\u8651\u94fe\u8def\u4e2d\u5404\u4e2a\u6a21\u5757\u7684\u80fd\u529b\u9650\u5236\u3002"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{src:"https://rdk-doc.oss-cn-beijing.aliyuncs.com/doc/img/07_Advanced_development/03_multimedia_development/02_S100/codec/272e3467c640af379d1b4c0a1de27eae.png",alt:""})}),"\n",(0,i.jsx)(n.h4,{id:"\u591a\u8def\u89e3\u7801",children:"\u591a\u8def\u89e3\u7801"}),"\n",(0,i.jsx)(n.p,{children:"\u591a\u8def\u89e3\u7801\u573a\u666f\u5982\u4e0b\u56fe\u6240\u793a\uff0cScenario0\u662f\u6587\u4ef6\u8f93\u5165\u7684\u7b80\u5355\u573a\u666f\uff0cScenario1\u662f\u4e32\u8054\u524d\u540e\u7ea7\u6a21\u5757\u7684\u590d\u6742\u573a\u666f\uff0c\u9700\u8981\u6ce8\u610f\u7684\u662f\u5728Scenario1\u573a\u666f\u8981\u7efc\u5408\u8003\u8651\u94fe\u8def\u4e2d\u5404\u4e2a\u6a21\u5757\u7684\u80fd\u529b\u9650\u5236\u3002"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{src:"https://rdk-doc.oss-cn-beijing.aliyuncs.com/doc/img/07_Advanced_development/03_multimedia_development/02_S100/codec/04f0aba90a1d65017dfeb90f9afa43e2.png",alt:""})}),"\n",(0,i.jsx)(n.h2,{id:"codec-api",children:"Codec API"}),"\n",(0,i.jsx)(n.h3,{id:"mediacodec\u63a5\u53e3\u8bf4\u660e",children:"MediaCodec\u63a5\u53e3\u8bf4\u660e"}),"\n",(0,i.jsx)(n.p,{children:"MediaCodec\u6a21\u5757\u4e3b\u8981\u7528\u4e8e\u97f3\u9891\u3001\u89c6\u9891\u548cJPEG\u56fe\u50cf\u7684\u7f16\u89e3\u7801\u3002\u672c\u6a21\u5757\u5c06\u4f1a\u63d0\u4f9b\u4e00\u7cfb\u5217\u7684\u63a5\u53e3\u4fbf\u4e8e\u7528\u6237\u8f93\u5165\u5f85\u5904\u7406\u7684\u6570\u636e\u548c\u83b7\u53d6\u5904\u7406\u5b8c\u7684\u6570\u636e\u3002\u672c\u6a21\u5757\u652f\u6301\u591a\u8def\u7f16\u7801\u6216\u89e3\u7801\u5b9e\u4f8b\u540c\u65f6\u5de5\u4f5c\uff0c\u5176\u4e2d\u89c6\u9891\u548cJPEG\u56fe\u50cf\u7684\u7f16\u89e3\u7801\u7531\u786c\u4ef6\u5b9e\u73b0\uff0c\u7528\u6237\u9700\u8981\u8c03\u7528libmultimedia.so\uff0c\u97f3\u9891\u5219\u57fa\u4e8eFFMPEG\u7684\u63a5\u53e3\u7531\u8f6f\u4ef6\u5b9e\u73b0\uff0c\u7528\u6237\u9700\u8981\u8c03\u7528libffmedia.so\uff0c\u5982\u4e0b\u8868\u6240\u793a\u4e3aRDKS100\u6240\u652f\u6301\u7684\u89c6\u9891\u7f16\u89e3\u7801\u89c4\u8303\u548c\u97f3\u9891\u7f16\u89e3\u7801\u89c4\u8303\uff0c\u9700\u8981\u6ce8\u610f\u7684\u662fAAC\u7684\u7f16\u89e3\u7801\u9700\u8981license\u6388\u6743\uff0c\u56e0\u6b64\u7528\u6237\u9700\u8981\u83b7\u5f97\u6388\u6743\u540e\u624d\u80fd\u4f7f\u80fd\u76f8\u5173\u4ee3\u7801\u3002"}),"\n",(0,i.jsx)(n.p,{children:"H265 profile\u6700\u9ad8\u652f\u6301Main profile\uff0cLevel\u6700\u9ad8\u652f\u6301L5.1\uff0cTier\u652f\u6301Main-tier\u3002H264 profile\u6700\u9ad8\u652f\u6301High profile\uff0cLevel\u6700\u9ad8\u652f\u6301L5.2\u3002MJPEG/JPEG \u652f\u6301ISO/IEC 10918-1 Baseline sequential\u3002\u97f3\u9891\u652f\u6301\uff1aG.711 A-law/Mu-law\uff0cG.729 ADPCM\uff0cADPCM IMA WAV\uff0cFLAC\uff0cAAC LC\uff0cAAC Main\uff0cAAC SSR\uff0cAAC LTP\uff0cAAC LD\uff0cAAC HE\uff0cAAC HEv2\uff08AAC\u9700\u8981license\u6388\u6743\uff09\u3002"}),"\n",(0,i.jsx)(n.p,{children:"\u6b64\u5916\u89c6\u9891\u548c\u56fe\u50cf\u7684\u6570\u636e\u6e90\u5305\u62ecVIO\u8f93\u5165\u7684\u56fe\u50cf\u548c\u7528\u6237\u8f93\u5165\u7684YUV\u6570\u636e\u4e24\u7c7b\uff0c\u7528\u6237\u8f93\u5165\u7684YUV\u6570\u636e\u5219\u53ef\u80fd\u662f\u4ece\u6587\u4ef6\u4e2d\u52a0\u8f7d\u6216\u8005\u901a\u8fc7\u7f51\u7edc\u4f20\u8f93\u83b7\u5f97\uff1b\u97f3\u9891\u7684\u6570\u636e\u6e90\u5305\u62ecMIC\u8f93\u5165\u7684\u97f3\u9891\u548c\u7528\u6237\u8f93\u5165\u7684PCM\u6570\u636e\u4e24\u7c7b\uff0cMIC\u8f93\u5165\u7684\u97f3\u9891\u662f\u7531Audio Codec\u91c7\u96c6\u7684\u6570\u5b57\u4fe1\u53f7\uff0c\u7528\u6237\u8f93\u5165\u7684PCM\u6570\u636e\u5219\u53ef\u80fd\u662f\u4ece\u6587\u4ef6\u6216\u7f51\u7edc\u4f20\u8f93\u83b7\u5f97\u3002"}),"\n",(0,i.jsx)(n.h4,{id:"gop",children:"GOP"}),"\n",(0,i.jsx)(n.p,{children:"H264/H265\u7f16\u7801\u652f\u6301GOP\u7ed3\u6784\u7684\u8bbe\u7f6e\uff0c\u7528\u6237\u53ef\u4ece\u9884\u7f6e\u76849\u79cdGOP\u7ed3\u6784\u4e2d\u9009\u62e9\uff0c\u4e5f\u53ef\u81ea\u5b9a\u4e49GOP\u7ed3\u6784\u3002"}),"\n",(0,i.jsx)(n.h5,{id:"gop\u7ed3\u6784\u8868",children:"GOP\u7ed3\u6784\u8868"}),"\n",(0,i.jsx)(n.p,{children:"GOP\u7ed3\u6784\u8868\u53ef\u5b9a\u4e49\u4e00\u7ec4\u5468\u671f\u6027\u7684GOP\u7ed3\u6784\uff0c\u8be5GOP\u7ed3\u6784\u5c06\u7528\u4e8e\u6574\u4e2a\u7f16\u7801\u8fc7\u7a0b\u3002\u5355\u4e2a\u7ed3\u6784\u8868\u4e2d\u7684\u5143\u7d20\u5982\u4e0b\u8868\u6240\u793a\uff0c\u5176\u4e2d\u53ef\u4ee5\u6307\u5b9a\u8be5\u56fe\u50cf\u7684\u53c2\u8003\u5e27\uff0c\u5982\u679cIDR\u5e27\u540e\u7684\u5176\u4ed6\u5e27\u6307\u5b9a\u7684\u53c2\u8003\u5e27\u4e3aIDR\u5e27\u524d\u7684\u6570\u636e\u5e27\uff0c\u7f16\u7801\u5668\u5185\u90e8\u4f1a\u81ea\u52a8\u5904\u7406\u8fd9\u79cd\u60c5\u51b5\u4f7f\u5176\u4e0d\u53c2\u8003\u5176\u4ed6\u5e27\uff0c\u7528\u6237\u65e0\u9700\u5173\u5fc3\u8fd9\u79cd\u60c5\u51b5\u3002\u7528\u6237\u5728\u81ea\u5b9a\u4e49GOP\u7ed3\u6784\u65f6\u9700\u8981\u6307\u660e\u7ed3\u6784\u8868\u7684\u6570\u91cf\uff0c\u6700\u591a\u53ef\u5b9a\u4e493\u4e2a\u7ed3\u6784\u8868\uff0c\u7ed3\u6784\u8868\u7684\u987a\u5e8f\u9700\u8981\u6309\u7167\u89e3\u7801\u987a\u5e8f\u6392\u5217\u3002"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Element"}),(0,i.jsx)(n.th,{children:"Description"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Type"}),(0,i.jsx)(n.td,{children:"Slice type\uff08I\uff0cP\uff09"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"POC"}),(0,i.jsx)(n.td,{children:"Display order of the frame within a GOP\uff0cranging from 1 to GOP size"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"QPoffset"}),(0,i.jsx)(n.td,{children:"A quantization parameter of the picture in the custom GOP"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"NUM_REF_PIC_L0"}),(0,i.jsx)(n.td,{children:"Flag to use multi reference picture for P picture. It is valid only if PIC_TYPE is P"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"temporal_id"}),(0,i.jsx)(n.td,{children:"Temporal layer of the frame. A frame cannot predict from a frame with a higher temporal id (0~6)."})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"1st_ref_POC"}),(0,i.jsx)(n.td,{children:"The POC of the 1st reference picture of L0"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"2nd_ref_POC"}),(0,i.jsx)(n.td,{children:"The POC of 1st reference picture of L1 in case that Type is equal to B. The POC of 2nd reference picture of L0 in case that Type is equal to P. Note that reference_L1 can have the same POC as reference in B slice. But for compression efficiency it is recommended that reference_L1 have a different POC from reference_L0."})]})]})]}),"\n",(0,i.jsx)(n.h5,{id:"gop\u9884\u7f6e\u7ed3\u6784-1",children:"GOP\u9884\u7f6e\u7ed3\u6784"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Index"}),(0,i.jsx)(n.th,{children:"GOP Stru cture"}),(0,i.jsx)(n.th,{children:"Low Delay (encoding order and display order are same)"}),(0,i.jsx)(n.th,{children:"GOP Size"}),(0,i.jsx)(n.th,{children:"Encoding Order"}),(0,i.jsx)(n.th,{children:"Minimum Source Frame Buffer"}),(0,i.jsx)(n.th,{children:"Minimum Decoded Picture Buffer"}),(0,i.jsx)(n.th,{children:"Intra Period (I Frame Interval) Requirement"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"1"}),(0,i.jsx)(n.td,{children:"I"}),(0,i.jsx)(n.td,{children:"Yes"}),(0,i.jsx)(n.td,{children:"1"}),(0,i.jsx)(n.td,{children:"I0-I1-I2\u2026"}),(0,i.jsx)(n.td,{children:"1"}),(0,i.jsx)(n.td,{children:"1"}),(0,i.jsx)(n.td,{})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"2"}),(0,i.jsx)(n.td,{children:"P"}),(0,i.jsx)(n.td,{children:"Yes"}),(0,i.jsx)(n.td,{children:"1"}),(0,i.jsx)(n.td,{children:"P0-P1-P2\u2026"}),(0,i.jsx)(n.td,{children:"1"}),(0,i.jsx)(n.td,{children:"2"}),(0,i.jsx)(n.td,{})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"3"}),(0,i.jsx)(n.td,{children:"B"}),(0,i.jsx)(n.td,{children:"Yes"}),(0,i.jsx)(n.td,{children:"1"}),(0,i.jsx)(n.td,{children:"B0-B1-B2\u2026"}),(0,i.jsx)(n.td,{children:"1"}),(0,i.jsx)(n.td,{children:"3"}),(0,i.jsx)(n.td,{})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"4"}),(0,i.jsx)(n.td,{children:"BP"}),(0,i.jsx)(n.td,{children:"NO"}),(0,i.jsx)(n.td,{children:"2"}),(0,i.jsx)(n.td,{children:"B1-P0-B3-P2\u2026"}),(0,i.jsx)(n.td,{children:"1"}),(0,i.jsx)(n.td,{children:"3"}),(0,i.jsx)(n.td,{children:"Multiple of 2"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"5"}),(0,i.jsx)(n.td,{children:"BBBP"}),(0,i.jsx)(n.td,{children:"Yes"}),(0,i.jsx)(n.td,{children:"1"}),(0,i.jsx)(n.td,{children:"B2-B1-B3-P0\u2026"}),(0,i.jsx)(n.td,{children:"7"}),(0,i.jsx)(n.td,{children:"4"}),(0,i.jsx)(n.td,{children:"Multiple of 4"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"6"}),(0,i.jsx)(n.td,{children:"PPPP"}),(0,i.jsx)(n.td,{children:"Yes"}),(0,i.jsx)(n.td,{children:"4"}),(0,i.jsx)(n.td,{children:"P0-P1-P2-P3\u2026"}),(0,i.jsx)(n.td,{children:"1"}),(0,i.jsx)(n.td,{children:"2"}),(0,i.jsx)(n.td,{})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"7"}),(0,i.jsx)(n.td,{children:"BBBB"}),(0,i.jsx)(n.td,{children:"Yes"}),(0,i.jsx)(n.td,{children:"4"}),(0,i.jsx)(n.td,{children:"B0-B1-B2-B3\u2026"}),(0,i.jsx)(n.td,{children:"1"}),(0,i.jsx)(n.td,{children:"3"}),(0,i.jsx)(n.td,{})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"8"}),(0,i.jsx)(n.td,{children:"BBBB BBBB"}),(0,i.jsx)(n.td,{children:"Yes"}),(0,i.jsx)(n.td,{children:"1"}),(0,i.jsx)(n.td,{children:"B3-B2-B4- B1-B6-B5- B7-B0\u2026"}),(0,i.jsx)(n.td,{children:"12"}),(0,i.jsx)(n.td,{children:"5"}),(0,i.jsx)(n.td,{children:"Multiple of 8"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"9"}),(0,i.jsx)(n.td,{children:"P"}),(0,i.jsx)(n.td,{children:"Yes"}),(0,i.jsx)(n.td,{children:"1"}),(0,i.jsx)(n.td,{children:"P0"}),(0,i.jsx)(n.td,{children:"1"}),(0,i.jsx)(n.td,{children:"2"}),(0,i.jsx)(n.td,{})]})]})]}),"\n",(0,i.jsx)(n.p,{children:"\u4ee5\u4e0b\u4f1a\u5bf99\u79cd\u9884\u7f6e\u7684GOP\u7ed3\u6784\u8fdb\u884c\u8bf4\u660e\u3002"}),"\n",(0,i.jsx)(n.p,{children:"GOP Preset 1"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"\u53ea\u6709I\u5e27\uff0c\u6ca1\u6709\u76f8\u4e92\u53c2\u8003\uff1b"}),"\n",(0,i.jsx)(n.li,{children:"\u4f4e\u5ef6\u65f6\uff1b"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{src:"https://rdk-doc.oss-cn-beijing.aliyuncs.com/doc/img/07_Advanced_development/03_multimedia_development/02_S100/codec/gop1.png",alt:"gop1"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{src:"https://rdk-doc.oss-cn-beijing.aliyuncs.com/doc/img/07_Advanced_development/03_multimedia_development/02_S100/codec/gop2.png",alt:"gop2"})}),"\n",(0,i.jsx)(n.p,{children:"GOP Preset 2"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"\u53ea\u6709I\u5e27\u548cP\u5e27\uff1b"}),"\n",(0,i.jsx)(n.li,{children:"P\u5e27\u53c2\u80032\u4e2a\u524d\u5411\u53c2\u8003\u5e27\uff1b"}),"\n",(0,i.jsx)(n.li,{children:"\u4f4e\u5ef6\u65f6\uff1b"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{src:"https://rdk-doc.oss-cn-beijing.aliyuncs.com/doc/img/07_Advanced_development/03_multimedia_development/02_S100/codec/gop3.png",alt:"gop3"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{src:"https://rdk-doc.oss-cn-beijing.aliyuncs.com/doc/img/07_Advanced_development/03_multimedia_development/02_S100/codec/gop4.png",alt:"gop4"})}),"\n",(0,i.jsx)(n.p,{children:"GOP Preset 3"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"\u53ea\u6709I\u5e27\u548cB\u5e27\uff1b"}),"\n",(0,i.jsx)(n.li,{children:"B\u5e27\u53c2\u80032\u4e2a\u524d\u5411\u53c2\u8003\u5e27\uff1b"}),"\n",(0,i.jsx)(n.li,{children:"\u4f4e\u5ef6\u65f6\uff1b"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{src:"https://rdk-doc.oss-cn-beijing.aliyuncs.com/doc/img/07_Advanced_development/03_multimedia_development/02_S100/codec/gop5.png",alt:"gop5"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{src:"https://rdk-doc.oss-cn-beijing.aliyuncs.com/doc/img/07_Advanced_development/03_multimedia_development/02_S100/codec/gop6.png",alt:"gop6"})}),"\n",(0,i.jsx)(n.p,{children:"GOP Preset 4"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"\u53ea\u6709I\u5e27\u3001P\u5e27\u548cB\u5e27\uff1b"}),"\n",(0,i.jsx)(n.li,{children:"P\u5e27\u53c2\u80032\u4e2a\u524d\u5411\u53c2\u8003\u5e27\uff1b"}),"\n",(0,i.jsx)(n.li,{children:"B\u5e27\u53c2\u80031\u4e2a\u524d\u5411\u53c2\u8003\u5e27\u548c\u4e00\u4e2a\u540e\u5411\u53c2\u8003\u5e27\uff1b"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{src:"https://rdk-doc.oss-cn-beijing.aliyuncs.com/doc/img/07_Advanced_development/03_multimedia_development/02_S100/codec/gop7.png",alt:"gop7"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{src:"https://rdk-doc.oss-cn-beijing.aliyuncs.com/doc/img/07_Advanced_development/03_multimedia_development/02_S100/codec/gop8.png",alt:"gop8"})}),"\n",(0,i.jsx)(n.p,{children:"GOP Preset 5"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"\u53ea\u6709I\u5e27\u3001P\u5e27\u548cB\u5e27\uff1b"}),"\n",(0,i.jsx)(n.li,{children:"P\u5e27\u53c2\u80032\u4e2a\u524d\u5411\u53c2\u8003\u5e27\uff1b"}),"\n",(0,i.jsx)(n.li,{children:"B\u5e27\u53c2\u80031\u4e2a\u524d\u5411\u53c2\u8003\u5e27\u548c\u4e00\u4e2a\u540e\u5411\u53c2\u8003\u5e27\uff0c\u540e\u5411\u53c2\u8003\u5e27\u53ef\u4e3aP\u5e27\u6216B\u5e27\uff1b"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{src:"https://rdk-doc.oss-cn-beijing.aliyuncs.com/doc/img/07_Advanced_development/03_multimedia_development/02_S100/codec/gop9.png",alt:"gop9"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{src:"https://rdk-doc.oss-cn-beijing.aliyuncs.com/doc/img/07_Advanced_development/03_multimedia_development/02_S100/codec/gop10.png",alt:"gop10"})}),"\n",(0,i.jsx)(n.p,{children:"GOP Preset 6"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"\u53ea\u6709I\u5e27\u548cP\u5e27\uff1b"}),"\n",(0,i.jsx)(n.li,{children:"P\u5e27\u53c2\u80032\u4e2a\u524d\u5411\u53c2\u8003\u5e27\uff1b"}),"\n",(0,i.jsx)(n.li,{children:"\u4f4e\u5ef6\u65f6\uff1b"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{src:"https://rdk-doc.oss-cn-beijing.aliyuncs.com/doc/img/07_Advanced_development/03_multimedia_development/02_S100/codec/gop11.png",alt:"gop11"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{src:"https://rdk-doc.oss-cn-beijing.aliyuncs.com/doc/img/07_Advanced_development/03_multimedia_development/02_S100/codec/gop12.png",alt:"gop12"})}),"\n",(0,i.jsx)(n.p,{children:"GOP Preset 7"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"\u53ea\u6709I\u5e27\u548cB\u5e27\uff1b"}),"\n",(0,i.jsx)(n.li,{children:"B\u5e27\u53c2\u80032\u4e2a\u524d\u5411\u53c2\u8003\u5e27\uff1b"}),"\n",(0,i.jsx)(n.li,{children:"\u4f4e\u5ef6\u65f6\uff1b"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{src:"https://rdk-doc.oss-cn-beijing.aliyuncs.com/doc/img/07_Advanced_development/03_multimedia_development/02_S100/codec/gop13.png",alt:"gop13"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{src:"https://rdk-doc.oss-cn-beijing.aliyuncs.com/doc/img/07_Advanced_development/03_multimedia_development/02_S100/codec/gop14.png",alt:"gop14"})}),"\n",(0,i.jsx)(n.p,{children:"GOP Preset 8"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"\u53ea\u6709I\u5e27\u548cB\u5e27\uff1b"}),"\n",(0,i.jsx)(n.li,{children:"B\u5e27\u53c2\u80031\u4e2a\u524d\u5411\u53c2\u8003\u5e27\uff0c\u4e00\u4e2a\u540e\u5411\u53c2\u8003\u5e27\uff1b"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{src:"https://rdk-doc.oss-cn-beijing.aliyuncs.com/doc/img/07_Advanced_development/03_multimedia_development/02_S100/codec/gop15.png",alt:"gop15"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{src:"https://rdk-doc.oss-cn-beijing.aliyuncs.com/doc/img/07_Advanced_development/03_multimedia_development/02_S100/codec/gop16.png",alt:"gop16"})}),"\n",(0,i.jsx)(n.p,{children:"GOP Preset 9"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"\u53ea\u6709I\u5e27\u548cP\u5e27\uff1b"}),"\n",(0,i.jsx)(n.li,{children:"P\u5e27\u53c2\u80031\u4e2a\u524d\u5411\u53c2\u8003\u5e27\uff1b"}),"\n",(0,i.jsx)(n.li,{children:"\u4f4e\u5ef6\u65f6\uff1b"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{src:"https://rdk-doc.oss-cn-beijing.aliyuncs.com/doc/img/07_Advanced_development/03_multimedia_development/02_S100/codec/gop17.png",alt:"gop17"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{src:"https://rdk-doc.oss-cn-beijing.aliyuncs.com/doc/img/07_Advanced_development/03_multimedia_development/02_S100/codec/gop18.png",alt:"gop18"})}),"\n",(0,i.jsx)(n.h4,{id:"\u957f\u671f\u53c2\u8003\u5e27",children:"\u957f\u671f\u53c2\u8003\u5e27"}),"\n",(0,i.jsx)(n.p,{children:"\u7528\u6237\u53ef\u6307\u5b9a\u957f\u671f\u53c2\u8003\u5e27\u7684\u5468\u671f\u548c\u53c2\u8003\u957f\u671f\u53c2\u8003\u5e27\u7684\u5468\u671f\uff0c\u5982\u4e0b\u56fe\u6240\u793a\uff1a"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{src:"https://rdk-doc.oss-cn-beijing.aliyuncs.com/doc/img/07_Advanced_development/03_multimedia_development/02_S100/codec/reference_frame.png",alt:"reference_frame"})}),"\n",(0,i.jsx)(n.h4,{id:"intra-refresh",children:"Intra Refresh"}),"\n",(0,i.jsx)(n.p,{children:"Intra\nRefresh\u6a21\u5f0f\u901a\u8fc7\u5728\u975eI\u5e27\u5185\u90e8\u5468\u671f\u6027\u7684\u63d2\u5165\u5e27\u5185\u7f16\u7801\u7684MB/CTU\u6765\u63d0\u9ad8\u5bb9\u9519\u6027\u3002\u5b83\u80fd\u591f\u4e3a\u89e3\u7801\u5668\u63d0\u4f9b\u66f4\u591a\u7684\u4fee\u590d\u70b9\u6765\u907f\u514d\u65f6\u57df\u9519\u8bef\u9020\u6210\u7684\u56fe\u50cf\u635f\u574f\u3002\u7528\u6237\u53ef\u4ee5\u6307\u5b9aMB/CTU\u7684\u8fde\u7eed\u884c\u6570\u3001\u5217\u6570\u6216\u8005\u6b65\u957f\u6765\u5f3a\u5236\u7f16\u7801\u5668\u63d2\u5165\u5e27\u5185\u7f16\u7801\u5355\u5143\uff0c\u7528\u6237\u8fd8\u53ef\u6307\u5b9a\u5e27\u5185\u7f16\u7801\u5355\u5143\u7684\u5927\u5c0f\u7531\u7f16\u7801\u5668\u5185\u90e8\u51b3\u5b9a\u54ea\u4e00\u5757\u9700\u8981\u5e27\u5185\u7f16\u7801\u3002"}),"\n",(0,i.jsx)(n.h4,{id:"\u7801\u7387\u63a7\u5236",children:"\u7801\u7387\u63a7\u5236"}),"\n",(0,i.jsx)(n.p,{children:"MediaCodec\u652f\u6301\u5bf9H264\u3001H265\u548cMJPEG\u534f\u8bae\u7684\u7801\u7387\u63a7\u5236\uff0c\u5206\u522b\u652f\u6301H264\u3001H265\u7f16\u7801\u901a\u9053\u7684CBR\u3001VBR\u3001AVBR\u3001FixQp\u548cQpMap\u4e94\u79cd\u7801\u7387\u63a7\u5236\u65b9\u5f0f\uff0c\u4ee5\u53ca\u652f\u6301MJPEG\u7f16\u7801\u901a\u9053\u7684FixQp\u7801\u7387\u63a7\u5236\u65b9\u5f0f\u3002CBR\u80fd\u591f\u4fdd\u8bc1\u6574\u4f53\u7684\u7f16\u7801\u7801\u7387\u7a33\u5b9a\uff1bVBR\u5219\u662f\u4fdd\u8bc1\u7f16\u7801\u56fe\u50cf\u7684\u8d28\u91cf\u7a33\u5b9a\uff1b\u800cAVBR\u4f1a\u517c\u987e\u7801\u7387\u548c\u56fe\u50cf\u8d28\u91cf\uff0c\u4ea7\u751f\u7801\u7387\u548c\u56fe\u50cf\u8d28\u91cf\u76f8\u5bf9\u7a33\u5b9a\u7684\u7801\u6d41\uff1bFixQp\u5219\u662f\u56fa\u5b9a\u6bcf\u4e00\u4e2aI\u5e27\u3001P\u5e27\u7684QP\u503c\uff1bQPMAP\u5219\u662f\u4e3a\u4e00\u5e27\u56fe\u50cf\u4e2d\u7684\u6bcf\u4e00\u4e2a\u5757\u6307\u5b9aQP\u503c\uff0c\u5176\u4e2dH265\u5757\u5927\u5c0f\u4e3a32x32\uff0cH264\u5757\u5927\u5c0f\u4e3a16x16\u3002"}),"\n",(0,i.jsx)(n.p,{children:"\u5bf9\u4e8eCBR\u548cAVBR\u6765\u8bf4\uff0c\u7f16\u7801\u5668\u5185\u90e8\u4f1a\u4e3a\u6bcf\u4e00\u5e27\u56fe\u7247\u627e\u5230\u5408\u9002\u7684QP\u503c\uff0c\u4ece\u800c\u4fdd\u8bc1\u6052\u5b9a\u7801\u7387\u3002\u7f16\u7801\u5668\u5185\u90e8\u652f\u6301\u4e09\u79cd\u7ea7\u522b\u7684\u7801\u7387\u63a7\u5236\uff0c\u5206\u522b\u4e3a\u5e27\u7ea7\u522b\u3001CTU/MB\u7ea7\u522b\u548csubCTU/subMB\u7ea7\u522b\u3002\u5176\u4e2d\u5e27\u7ea7\u522b\u7684\u63a7\u5236\u4e3b\u8981\u4f1a\u6839\u636e\u76ee\u6807\u7801\u7387\u4e3a\u6bcf\u4e00\u5e27\u56fe\u7247\u4ea7\u751f\u4e00\u4e2aQP\u503c\uff0c\u4ece\u800c\u4fdd\u8bc1\u7801\u7387\u6052\u5b9a\uff1bCTU/MB\u7ea7\u522b\u7684\u63a7\u5236\u5219\u6839\u636e\u6bcf\u4e00\u4e2a64x64\u7684CTU\u621616x16\u7684MB\u7684\u76ee\u6807\u7801\u7387\u4e3a\u6bcf\u4e2ablock\u4ea7\u751f\u4e00\u4e2aQP\u503c\uff0c\u80fd\u591f\u5f97\u5230\u66f4\u597d\u7684\u7801\u7387\u63a7\u5236\uff0c\u4f46\u662f\u9891\u7e41\u7684QP\u503c\u8c03\u6574\u4f1a\u9020\u6210\u56fe\u50cf\u8d28\u91cf\u4e0d\u7a33\u5b9a\u7684\u95ee\u9898\uff1bsubCTU/subMB\u7ea7\u522b\u7684\u63a7\u5236\u5219\u4e3a\u6bcf\u4e00\u4e2a32x32\u7684subCTU\u62168x8\u7684subMB\u4ea7\u751f\u4e00\u4e2aQP\u503c\uff0c\u5176\u4e2d\u590d\u6742\u7684\u5757\u4f1a\u5f97\u5230\u8f83\u9ad8\u7684QP\u503c\uff0c\u9759\u6001\u7684\u5757\u5219\u4f1a\u5f97\u5230\u8f83\u4f4e\u7684QP\u503c\uff0c\u56e0\u4e3a\u76f8\u6bd4\u4e8e\u590d\u6742\u7684\u533a\u57df\u4eba\u773c\u5bf9\u4e8e\u9759\u6001\u7684\u533a\u57df\u66f4\u654f\u611f\uff0c\u590d\u6742\u548c\u9759\u6001\u533a\u57df\u7684\u68c0\u6d4b\u4e3b\u8981\u4f9d\u8d56\u4e8e\u5185\u90e8\u786c\u4ef6\u6a21\u5757\uff0c\u8fd9\u4e2a\u7ea7\u522b\u63a7\u5236\u4e3b\u8981\u662f\u4e3a\u4e86\u63d0\u9ad8\u4e3b\u89c2\u56fe\u50cf\u8d28\u91cf\u540c\u65f6\u4fdd\u8bc1\u7801\u7387\u6052\u5b9a\uff0c\u8be5\u6a21\u5f0f\u63a7\u5236\u4e0bSSIM\u5f97\u5206\u8f83\u9ad8\uff0c\u4f46\u662fPSNR\u5f97\u5206\u4f1a\u964d\u4f4e\u3002"}),"\n",(0,i.jsx)(n.h4,{id:"roi",children:"ROI"}),"\n",(0,i.jsx)(n.p,{children:"ROI\u7f16\u7801\u7684\u5b9e\u73b0\u4f9d\u8d56\u4e8e\u548cQPMAP\u7c7b\u4f3c\uff0c\u9700\u8981\u7528\u6237\u6309\u7167\u5149\u6805\u626b\u63cf\u7684\u65b9\u5411\u4e3a\u6bcf\u4e00\u4e2a\u5757\u8bbe\u5b9aQP\u503c\uff0c\u5982\u4e0b\u56fe\uff1a"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{src:"https://rdk-doc.oss-cn-beijing.aliyuncs.com/doc/img/07_Advanced_development/03_multimedia_development/02_S100/codec/roi_map.png",alt:"roi_map"})}),"\n",(0,i.jsx)(n.p,{children:"\u5bf9\u4e8eH264\u7f16\u7801\u6765\u8bf4\uff0c\u6bcf\u4e00\u4e2a\u5757\u7684\u5927\u5c0f\u4e3a16x16\uff0c\u800cH265\u4e2d\u5219\u4e3a32x32\u3002\u5728ROI\nmap\u8868\u4e2d\uff0c\u6bcf\u4e00\u4e2aQP\u503c\u5360\u7528\u4e00\u4e2a\u5b57\u8282\uff0c\u5927\u5c0f\u4e3a0~51\u3002ROI\u7f16\u7801\u53ef\u4ee5\u548cCBR\u548cAVBR\u4e00\u8d77\u5de5\u4f5c\uff0c\u5f53\u4e0d\u4f7f\u80fdCBR\u6216AVBR\u65f6\uff0c\u6bcf\u4e2a\u5757\u533a\u57df\u7684\u5b9e\u9645QP\u503c\u5c31\u4e3aROI\nmap\u4e2d\u6307\u5b9a\u7684\u503c\uff0c\u5f53\u4f7f\u80fdCBR\u6216AVBR\u65f6\uff0c\u5219\u6bcf\u4e2a\u5757\u533a\u57df\u7684\u5b9e\u9645\u503c\u7531\u4ee5\u4e0b\u516c\u5f0f\u5f97\u5230\uff1a"}),"\n",(0,i.jsx)(n.p,{children:"QP(i) = MQP(i)+ RQP(i) - ROIAvgQP"}),"\n",(0,i.jsx)(n.p,{children:"\u5176\u4e2dMQP\u4e3aROI map\u4e2d\u7684\u503c\uff0c RQP\u4e3a\u7f16\u7801\u5668\u5185\u90e8\u7801\u7387\u63a7\u5236\u5f97\u5230\u7684\u503c\uff0c ROIAvaQP\u4e3aROI\nmap\u4e2dQP\u7684\u5e73\u5747\u503c\u3002"}),"\n",(0,i.jsx)(n.h4,{id:"\u8f93\u5165\u8f93\u51fabuffer\u7ba1\u7406",children:"\u8f93\u5165\u8f93\u51fabuffer\u7ba1\u7406"}),"\n",(0,i.jsx)(n.p,{children:"MediaCodec\u7684buffer\u5305\u62ec\u8f93\u5165\u548c\u8f93\u51fabuffer\u4e24\u79cd\uff0c\u4e00\u822c\u60c5\u51b5\u4e0b\uff0c\u8fd9\u4e9bbuffer\u4f1a\u7531MediaCodec\u901a\u8fc7ION\u63a5\u53e3\u7edf\u4e00\u5206\u914d\uff0c\u7528\u6237\u4e0d\u9700\u8981\u5173\u5fc3buffer\u7684\u5206\u914d\uff0c\u53ea\u9700\u8981\u5728\u64cd\u4f5cbuffer\u524d\u6267\u884cdequeue\u64cd\u4f5c\u83b7\u53d6\u7a7a\u95f2\u7684buffer\uff0c\u5904\u7406\u5b8c\u540e\u6267\u884cqueue\u64cd\u4f5c\u8fd4\u8fd8\u8be5buffer\u3002\u4f46\u662f\u4e3a\u4e86\u51cf\u5c11\u67d0\u4e9b\u60c5\u51b5\u4e0bbuffer\u7684\u62f7\u8d1d\u64cd\u4f5c\uff0c\u6bd4\u5982PYM\u7684\u8f93\u51fabuffer\u7528\u6765\u7f16\u7801\u65f6\uff0c\u8be5buffer\u662f\u7531PYM\u5185\u90e8\u901a\u8fc7ION\u5206\u914d\uff0c\u53ef\u76f4\u63a5\u4f5c\u4e3aMediaCodec\u7684\u8f93\u5165buffer\uff0c\u56e0\u6b64MediaCodec\u8fd8\u652f\u6301\u7f16\u7801\u65f6\u7684\u8f93\u5165buffer\u7531\u7528\u6237\u5206\u914d\uff0c\u4f46\u662f\u7528\u6237\u5fc5\u987b\u901a\u8fc7ION\u63a5\u53e3\u5206\u914d\u7269\u7406\u8fde\u7eed\u7684buffer\uff0c\u8fd8\u9700\u8981\u5728MediaCodec\u914d\u7f6e\u524d\u6307\u5b9amedia_codec_context_t\u4e2d\u7684external_frame_buf\u53d8\u91cf\u3002\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u5f53\u7528\u6237\u6307\u5b9a\u8f93\u5165buffer\u4e0d\u9700\u8981MediaCodec\u5206\u914d\u4e4b\u540e\uff0c\u5728buffer\u64cd\u4f5c\u65f6\uff0c\u7528\u6237\u4ecd\u7136\u9700\u8981\u6267\u884cdequeue\u64cd\u4f5c\u83b7\u53d6\u961f\u5217\u4fe1\u606f\uff0c\u7136\u540e\u5bf9\u961f\u5217\u4e2d\u7684\u4fe1\u606f\u8fdb\u884c\u8d4b\u503c\uff08\u4e3b\u8981\u662f\u865a\u62df\u5730\u5740\u548c\u7269\u7406\u5730\u5740\uff09\uff0c\u518d\u6267\u884cqueue\u64cd\u4f5c\u3002"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{src:"https://rdk-doc.oss-cn-beijing.aliyuncs.com/doc/img/07_Advanced_development/03_multimedia_development/02_S100/codec/buffer.png",alt:"buffer"})}),"\n",(0,i.jsx)(n.h4,{id:"\u5e27\u7387\u63a7\u5236",children:"\u5e27\u7387\u63a7\u5236"}),"\n",(0,i.jsx)(n.p,{children:"MediaCodec\u5185\u90e8\u76ee\u524d\u4e0d\u652f\u6301\u5e27\u7387\u63a7\u5236\uff0c\u5f53\u7528\u6237\u4e0d\u4f7f\u7528hb_mm_mc_set_camera\u63a5\u53e3\u4f7f\u80fdVIO\u548cMediaCodec\u7684\u76f4\u63a5\u4ea4\u4e92\u65f6\uff0c\u7528\u6237\u53ef\u81ea\u884c\u63a7\u5236buffer\u7684\u8f93\u5165\u5e27\u7387\uff1b\u5f53\u7528\u6237\u4f7f\u80fdVIO\u548cMediaCodec\u7684\u4ea4\u4e92\u540e\uff0c\u7528\u6237\u4e0d\u9700\u8981\u63a7\u5236\u8f93\u5165buffer\uff0c\u53ea\u9700\u8981\u64cd\u4f5c\u8f93\u51fabuffer\uff0c\u6b64\u65f6MediaCodec\u5185\u90e8\u4e5f\u4e0d\u4f1a\u5bf9\u8f93\u5165buffer\u8fdb\u884c\u5e27\u7387\u63a7\u5236\uff0c\u5f53\u7f16\u7801\u51fa\u73b0\u5361\u987f\u6216\u8005\u8f93\u5165buffer\u961f\u5217\u6ee1\u7b49\u60c5\u51b5\u65f6\uff0cMediaCodec\u4f1a\u7b49\u5f85\u961f\u5217\u63a7\u7ebf\u540e\u518d\u6b21\u64cd\u4f5c\u3002"}),"\n",(0,i.jsx)(n.h4,{id:"\u5e27skip\u8bbe\u7f6e",children:"\u5e27Skip\u8bbe\u7f6e"}),"\n",(0,i.jsx)(n.p,{children:"\u7528\u6237\u53ef\u8c03\u7528hb_mm_mc_skip_pic\u8bbe\u7f6e\u4e0b\u4e00\u6b21queue\u64cd\u4f5c\u8f93\u5165\u7684\u56fe\u50cf\u7684\u7f16\u7801\u6a21\u5f0f\u4e3askip\u6a21\u5f0f\uff0c\u8be5\u6a21\u5f0f\u53ea\u5bf9\u975eI\u5e27\u7f16\u7801\u6709\u6548\uff1bskip\u6a21\u5f0f\u4e0b\u7f16\u7801\u5668\u5185\u90e8\u4f1a\u5ffd\u7565\u8f93\u5165\u5e27\uff0c\u800c\u662f\u5229\u7528\u4e0a\u4e00\u5e27\u7684\u91cd\u6784\u5e27\u751f\u6210\u8be5\u6b21\u8f93\u5165\u7684\u7684\u91cd\u6784\u5e27\uff0c\u8f93\u5165\u5e27\u5219\u88ab\u7f16\u7801\u6210P\u5e27\u3002"}),"\n",(0,i.jsx)(n.h4,{id:"jpeg\u7f16\u89e3\u7801\u9650\u5236",children:"JPEG\u7f16\u89e3\u7801\u9650\u5236"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"JPEG/MJPEG\u7f16\u7801\u65f6\uff0c\u5f53\u8f93\u5165\u4e3ayuv420\u548cyuv422\u683c\u5f0f\u65f6\uff0c\u8981\u6c42\u8f93\u5165\u7684\u5bbd16\u5bf9\u9f50\uff0c\u8f93\u5165\u7684\u9ad88\u5bf9\u9f50\uff0c\u5f53\u8f93\u5165\u4e3ayuv440\u3001yuv444\u548cyuv400\u683c\u5f0f\u65f6\uff0c\u8981\u6c42\u8f93\u5165\u7684\u5bbd\u548c\u9ad88\u5bf9\u9f50\uff0c\u5982\u679c\u540c\u65f6crop\uff0c\u8981\u6c42\u8f93\u5165\u7684x\u548cy\u5750\u68078\u5bf9\u9f50\uff1b"}),"\n",(0,i.jsx)(n.li,{children:"JPEG/MJPEG\u7f16\u7801\u540c\u65f6\u65cb\u8f6c90/270\uff0c\u5f53\u8f93\u5165\u4e3ayuv420\u683c\u5f0f\u65f6\uff0c\u8981\u6c42\u8f93\u5165\u7684\u5bbd16\u5bf9\u9f50\uff0c\u9ad88\u5bf9\u9f50\uff0c\u5f53\u8f93\u5165\u7684\u683c\u5f0f\u4e3ayuv422\u548cyuv440\u65f6\uff0c\u8981\u6c42\u8f93\u5165\u7684\u5bbd16\u5bf9\u9f50\uff0c\u8f93\u5165\u7684\u9ad816\u5bf9\u9f50\uff0c\u5f53\u8f93\u5165\u7684\u683c\u5f0f\u4e3ayuv444\u548cyuv400\u65f6\uff0c\u8981\u6c42\u8f93\u5165\u7684\u5bbd\u548c\u9ad88\u5bf9\u9f50\uff0c\u5982\u679c\u540c\u65f6crop\uff0c\u5f53\u8f93\u5165\u4e3ayuv420\u683c\u5f0f\u65f6\uff0c\u8981\u6c42crop\u7684\u5bbd16\u5bf9\u9f50\uff0c"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"crop\u7684\u9ad88\u5bf9\u9f50\uff0c\u5f53\u8f93\u5165\u7684\u683c\u5f0f\u4e3ayuv422\u548cyuv440\u65f6\uff0c\u8981\u6c42crop\u7684\u5bbd16\u5bf9\u9f50\uff0ccrop\u7684\u9ad816\u5bf9\u9f50\uff0c\u5f53\u8f93\u5165\u7684\u683c\u5f0f\u4e3ayuv444\u548cyuv400\u65f6\uff0c\u8981\u6c42crop\u7684\u5bbd\u548c\u9ad88\u5bf9\u9f50\uff1b"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"JPEG/MJPEG\u7f16\u7801\u540c\u65f6\u65cb\u8f6c90/270\uff0c\u5f53\u8f93\u5165\u683c\u5f0f\u4e3ayuv422\u683c\u5f0f\u65f6\uff0c\u65cb\u8f6c\u540e\u7684\u683c\u5f0f\u4f1a\u53d8\u6210yuv440\uff0c\u5f53\u8f93\u5165\u683c\u5f0f\u4e3ayuv440\u683c\u5f0f\u65f6\uff0c\u65cb\u8f6c\u540e\u7684\u683c\u5f0f\u53d8\u6210yuv422\uff1b"}),"\n",(0,i.jsx)(n.li,{children:"JPEG/MJPEG\u89e3\u7801\u540c\u65f6\u65cb\u8f6c\u6216\u955c\u50cf\u65f6\uff0c\u8981\u6c42\u8f93\u51fa\u7684yuv\u683c\u5f0f\u9700\u8981\u548c\u8f93\u5165\u7684\u56fe\u50cf\u683c\u5f0f\u4e00\u81f4\uff0c\u4f46\u662fYUV422\u683c\u5f0f\u7684JPEG/MJPEG\u65cb\u8f6c90/270\u89e3\u7801\u65f6\uff0c\u8981\u6c42\u8f93\u51fa\u7684\u683c\u5f0f\u4e3aYUV440p/YUYV/YVYU/UYVY/VYUY\uff1b"}),"\n",(0,i.jsx)(n.li,{children:"JPEG/MJPEG\u89e3\u7801\u65f6\uff0c\u65cb\u8f6c\u6216\u955c\u50cf\u4e0d\u80fd\u548cCrop\u540c\u65f6\u5de5\u4f5c\uff1b"}),"\n",(0,i.jsx)(n.li,{children:"JPEG/MJPEG\u89e3\u7801\u65f6\uff0c\u8f93\u51fabuffer\u7684\u5bbd\u9ad8\u8981\u6c42\u548c\u8f93\u5165\u683c\u5f0f\u7684MCU"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"width\u548cheight\u5bf9\u9f50\uff0c\u5982\u679c\u4f7f\u80fd\u4e86Crop\uff0ccrop\u7684\u53c2\u6570\uff08\u5305\u62ec\u8d77\u59cb\u5750\u6807\u548c\u5bbd\u9ad8\uff09\u9700\u8981\u548c\u8f93\u5165\u683c\u5f0f\u7684MCU\nwidth\u548cheight\u5bf9\u9f50\uff1b\uff08MCU\xa0size\xa0for\xa0420:\xa016x16,\xa0422:\xa016x8,\xa0440:\xa08x16,\xa0400:\xa08x8,\xa0444:\xa08x8.\uff09"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"JPEG/MJPEG\u89e3\u7801\u65f6\uff0c\u8f93\u51fa\u683c\u5f0f\u4e3aPacked\nYUV444\uff0c\u8981\u6c42\u8f93\u5165\u683c\u5f0f\u4e3aYUV444\u683c\u5f0f\uff1b"}),"\n",(0,i.jsx)(n.li,{children:"JPEG/MJPEG\u89e3\u7801\u53ea\u652f\u6301MC_FEEDING_MODE_FRAME_SIZE\u6a21\u5f0f\uff1b"}),"\n",(0,i.jsx)(n.li,{children:"JPEG\u7f16\u7801\u65f6\uff0c\u5982\u679c\u7528\u6237\u6307\u5b9abitstream buffer\u5f97size\uff0c\u9700\u8981\u989d\u5916\u5206\u914d4k\u5927\u5c0f\u3002"}),"\n",(0,i.jsx)(n.li,{children:"JPEG\u7f16\u7801\u65f6\uff0c\u7531\u4e8e\u7f16\u7801\u5668\u5185\u90e8\u5904\u7406\u4ee516x16\u4e3a\u5355\u5143\u505a\u7f16\u7801\u5904\u7406\uff0c\u5f53\u5f85\u7f16\u7801\u6570\u636e\u4e3a\u975e16x16\u5bf9\u9f50\u65f6\uff0c\u7f16\u7801\u5b8c\u7684\u6570\u636e\u6700\u540e\u4e00\u90e8\u5206\u586b\u5145\u7684\u90e8\u5206\u4f1a\u5b58\u5728\u5dee\u5f02\uff0c\u4f46\u662f\u4e0d\u4f1a\u5f71\u54cd\u6709\u6548\u6570\u636e\uff0c\u8fd9\u4e2a\u662f\u786c\u4ef6\u9650\u5236\uff1b\u56e0\u6b64\u505amd5\u6bd4\u8f83\u65f6\u9700\u8981\u6ce8\u610f\u8fd9\u70b9\u3002"}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"api\u53c2\u8003",children:"API\u53c2\u8003"}),"\n",(0,i.jsx)(n.h4,{id:"hb_mm_mc_get_descriptor",children:"hb_mm_mc_get_descriptor"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u51fd\u6570\u58f0\u660e\u3011"}),"\n",(0,i.jsx)(n.p,{children:"const\nmedia_codec_descriptor_t*hb_mm_mc_get_descriptor(media_codec_id_t\ncodec_id);"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u53c2\u6570\u63cf\u8ff0\u3011"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"[IN] media_codec_id_t codec_id\uff1a\u8868\u793acodec\u7c7b\u578b"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u8fd4\u56de\u503c\u3011"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"\u975e\u7a7a\uff1acodec\u63cf\u8ff0\u4fe1\u606f"}),"\n",(0,i.jsx)(n.li,{children:"NULL\uff1a\u8868\u793a\u67e5\u8be2\u4e0d\u5230\u8be5codec id\u5bf9\u5e94\u7684\u63cf\u8ff0\u7b26"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u529f\u80fd\u63cf\u8ff0\u3011"}),"\n",(0,i.jsx)(n.p,{children:"\u6839\u636ecodec_id\u83b7\u53d6MediaCodec\u652f\u6301\u7684codec\u4fe1\u606f\uff0c\u4fe1\u606f\u5305\u62eccodec\u540d\u5b57\uff0c\u8be6\u7ec6\u63cf\u8ff0\uff0cMIME\u7c7b\u578b\u4ee5\u53cacodec\u652f\u6301\u7684profile\u7c7b\u578b\u7b49\u3002"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u793a\u4f8b\u4ee3\u7801\u3011"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:'#include "hb_media_codec.h"\n#include "hb_media_error.h"\nint main(int argc, char *argv[])\n{\n    const media_codec_descriptor_t *desc = NULL;\n    desc = hb_mm_mc_get_descriptor(MEDIA_CODEC_ID_H265);\n    return 0;\n}\n'})}),"\n",(0,i.jsx)(n.h4,{id:"hb_mm_mc_get_default_context",children:"hb_mm_mc_get_default_context"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u51fd\u6570\u58f0\u660e\u3011"}),"\n",(0,i.jsx)(n.p,{children:"hb_s32 hb_mm_mc_get_default_context(media_codec_id_t codec_id,\nhb_bool encoder, media_codec_context_t *context)"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u53c2\u6570\u63cf\u8ff0\u3011"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"[IN] media_codec_id_t codec_id\uff1a\u8868\u793acodec\u7c7b\u578b"}),"\n",(0,i.jsx)(n.li,{children:"[IN] hb_bool encoder\uff1a\u6307\u5b9acodec\u662f\u7f16\u7801\u5668\u8fd8\u662f\u89e3\u7801\u5668"}),"\n",(0,i.jsx)(n.li,{children:"[OUT] media_codec_context_t\n*context\uff1a\u6307\u5b9acodec\u7c7b\u578b\u9ed8\u8ba4\u7684context"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u8fd4\u56de\u503c\u3011"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"0\uff1a\u64cd\u4f5c\u6210\u529f"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_INVALID_PARAMS\uff1a \u65e0\u6548\u53c2\u6570"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u529f\u80fd\u63cf\u8ff0\u3011"}),"\n",(0,i.jsx)(n.p,{children:"\u83b7\u53d6\u6307\u5b9a\u7684codec\u7684\u9ed8\u8ba4\u5c5e\u6027\u3002"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u793a\u4f8b\u4ee3\u7801\u3011"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:'#include "hb_media_codec.h"\n#include "hb_media_error.h"\nint main(int argc, char *argv[])\n{\n    int ret = 0;\n    media_codec_context_t context;\n    memset(&context, 0x00, sizeof(context));\n    ret = hb_mm_mc_get_default_context(MEDIA_CODEC_ID_H265, 1, &context)\n    return 0;\n}\n'})}),"\n",(0,i.jsx)(n.h4,{id:"hb_mm_mc_initialize",children:"hb_mm_mc_initialize"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u51fd\u6570\u58f0\u660e\u3011"}),"\n",(0,i.jsx)(n.p,{children:"hb_s32 hb_mm_mc_initialize(media_codec_context_t *context)"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u53c2\u6570\u63cf\u8ff0\u3011"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"[IN] media_codec_context_t *context\uff1a\u6307\u5b9acodec\u7c7b\u578b\u7684context"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u8fd4\u56de\u503c\u3011"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"0\uff1a\u64cd\u4f5c\u6210\u529f"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_UNKNOWN\uff1a \u672a\u77e5\u9519\u8bef"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_INVALID_PARAMS\uff1a\u65e0\u6548\u53c2\u6570"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_OPERATION_NOT_ALLOWED\uff1a\u64cd\u4f5c\u4e0d\u5141\u8bb8"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_INSUFFICIENT_RES\uff1a\u5185\u90e8\u5185\u5b58\u8d44\u6e90\u4e0d\u8db3"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_NO_FREE_INSTANCE\uff1a\u6ca1\u6709\u53ef\u7528\u7684instance\uff08Video\u6700\u591a32\u4e2a\uff0cMJPEG/JPEG\u6700\u591a64\u4e2a\uff0cAudio\u6700\u591a32\u4e2a\uff09"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u529f\u80fd\u63cf\u8ff0\u3011"}),"\n",(0,i.jsx)(n.p,{children:"\u521d\u59cb\u5316\u7f16\u7801\u6216\u89e3\u7801\u5668\uff0c\u8c03\u7528\u6210\u529f\u540eMediaCodec\u8fdb\u5165MEDIA_CODEC_STATE_INITIALIZED\u72b6\u6001\u3002"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u793a\u4f8b\u4ee3\u7801\u3011"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:'#include "hb_media_codec.h"\n#include "hb_media_error.h"\nstatic Uint64 osal_gettime(void)\n{\n    struct timespec tp;\n    clock_gettime(CLOCK_MONOTONIC, &tp);\n    return ((Uint64)tp.tv_sec*1000 + tp.tv_nsec/1000000);\n}\ntypedef struct MediaCodecTestContext {\n    media_codec_context_t *context;\n    char *inputFileName;\n    char *outputFileName;\n} MediaCodecTestContext;\ntypedef struct AsyncMediaCtx {\n    media_codec_context_t *ctx;\n    FILE *inFile;\n    FILE *outFile;\n    int lastStream;\n    Uint64 startTime;\n    int32_t duration;\n} AsyncMediaCtx;\nstatic void on_encoder_input_buffer_available(hb_ptr userdata,\nmedia_codec_buffer_t *inputBuffer) {\n    AsyncMediaCtx *asyncCtx = (AsyncMediaCtx *)userdata;\n    Int noMoreInput = 0;\n    hb_s32 ret = 0;\n    Uint64 curTime = 0;\n    if (!noMoreInput) {\n        curTime = osal_gettime();\n        if ((curTime - asyncCtx->startTime)/1000 < (uint32_t)asyncCtx->duration) {\n            ret = fread(inputBuffer->vframe_buf.vir_ptr[0], 1,\n            inputBuffer->vframe_buf.size, asyncCtx->inFile);\n            if (ret <= 0) {\n                if(fseek(asyncCtx->inFile, 0, SEEK_SET)) {\n                printf("Failed to rewind input filen");\n            } else {\n                ret = fread(inputBuffer->vframe_buf.vir_ptr[0], 1,\n                inputBuffer->vframe_buf.size, asyncCtx->inFile);\n                if (ret <= 0) {\n                    printf("Failed to read input filen");\n                }\n            }\n        }\n    }\n    if (!ret) {\n        printf("%s There is no more input data!n", TAG);\n        inputBuffer->vframe_buf.frame_end = TRUE;\n        noMoreInput = 1;\n    } else {\n        inputBuffer->vframe_buf.frame_end = TRUE;\n        inputBuffer->vframe_buf.size = 0;\n    }\n}\nstatic void on_encoder_output_buffer_available(hb_ptr userdata,\nmedia_codec_buffer_t *outputBuffer,\nmedia_codec_output_buffer_info_t *extraInfo) {\n    AsyncMediaCtx *asyncCtx = (AsyncMediaCtx *)userdata;\n    mc_265_output_stream_info_t info = extraInfo->video_stream_info;\n    fwrite(outputBuffer->vstream_buf.vir_ptr,\n    outputBuffer->vstream_buf.size, 1, asyncCtx->outFile);\n    if (outputBuffer->vstream_buf.stream_end) {\n        printf("There is no more output data!n");\n        asyncCtx->lastStream = 1;\n    }\n}\nstatic void on_encoder_media_codec_message(hb_ptr userdata, hb_s32\n       error) {\n    AsyncMediaCtx *asyncCtx = (AsyncMediaCtx *)userdata;\n    if (error) {\n        asyncCtx->lastStream = 1;\n        printf("ERROR happened!n");\n    }\n}\nstatic void on_vlc_buffer_message(hb_ptr userdata, hb_s32 * vlc_buf)\n{\n    MediaCodecTestContext *ctx = (MediaCodecTestContext *)userdata;\n    printf("%s %s VLC Buffer size = %d; Reset to %d.n", TAG,\n    __FUNCTION__,\n    *vlc_buf, ctx->vlc_buf_size);\n    *vlc_buf = ctx->vlc_buf_size;\n}\nstatic void do_async_encoding(void *arg) {\n    hb_s32 ret = 0;\n    FILE *outFile;\n    FILE *inFile;\n    int step = 0;\n    AsyncMediaCtx asyncCtx;\n    MediaCodecTestContext *ctx = (MediaCodecTestContext *)arg;\n    media_codec_context_t *context = ctx->context;\n    char *inputFileName = ctx->inputFileName;\n    char *outputFileName = ctx->outputFileName;\n    media_codec_state_t state = MEDIA_CODEC_STATE_NONE;\n    inFile = fopen(inputFileName, "rb");\n    if (!inFile) {\n        goto ERR;\n    }\n    outFile = fopen(outputFileName, "wb");\n    if (!outFile) {\n        goto ERR;\n    }\n    memset(&asyncCtx, 0x00, sizeof(AsyncMediaCtx));\n    asyncCtx.ctx = context;\n    asyncCtx.inFile = inFile;\n    asyncCtx.outFile = outFile;\n    asyncCtx.lastStream = 0;\n    asyncCtx.duration = 5;\n    asyncCtx.startTime = osal_gettime();\n    ret = hb_mm_mc_initialize(context);\n    if (ret) {\n        goto ERR;\n    }\n    media_codec_callback_t callback;\n    callback.on_input_buffer_available =\n    on_encoder_input_buffer_available;\n    callback.on_output_buffer_available =\n    on_encoder_output_buffer_available;\n    callback.on_media_codec_message = on_encoder_media_codec_message;\n    ret = hb_mm_mc_set_callback(context, &callback, &asyncCtx);\n    if (ret) {\n        goto ERR;\n    }\n    media_codec_callback_t callback2;\n    callback2.on_vlc_buffer_message = on_vlc_buffer_message;\n    if (ctx->vlc_buf_size > 0) {\n        ret = hb_mm_mc_set_vlc_buffer_listener(context, &callback2, ctx);\n        if (ret) {\n            goto ERR;\n        }\n    }\n    ret = hb_mm_mc_configure(context);\n    if (ret) {\n        goto ERR;\n    }\n    mc_av_codec_startup_params_t startup_params;\n    startup_params.video_enc_startup_params.receive_frame_number = 0;\n    ret = hb_mm_mc_start(context, &startup_params);\n    if (ret) {\n        goto ERR;\n    }\n    while(!asyncCtx.lastStream) {\n        sleep(1);\n    }\n    hb_mm_mc_stop(context);\n    hb_mm_mc_release(context);\n    context = NULL;\nERR:\n    hb_mm_mc_get_state(context, &state);\n    if (context && state !=\n    MEDIA_CODEC_STATE_UNINITIALIZED) {\n        hb_mm_mc_stop(context);\n        hb_mm_mc_release(context);\n    }\n    if (inFile)\n        fclose(inFile);\n    if (outFile)\n        fclose(outFile);\n}\nint main(int argc, char *argv[])\n{\n    int ret = 0;\n    char outputFileName[MAX_FILE_PATH] = "./tmp.yuv";\n    char inputFileName[MAX_FILE_PATH] = "./output.h265";\n    mc_video_codec_enc_params_t *params = NULL;\n    media_codec_context_t context;\n    memset(&context, 0x00, sizeof(media_codec_context_t));\n    context.codec_id = MEDIA_CODEC_ID_H265;\n    context.encoder = 1;\n    params = &context.video_enc_params;\n    params->width = 640;\n    params->height = 480;\n    params->pix_fmt = MC_PIXEL_FORMAT_YUV420P;\n    params->frame_buf_count = 5;\n    params->external_frame_buf = 0;\n    params->bitstream_buf_count = 5;\n    params->rc_params.mode = MC_AV_RC_MODE_H265CBR;\n    ret = hb_mm_mc_get_rate_control_config(&context, &params->rc_params);\n    if (ret) {\n        return -1;\n    }\n    params->rc_params.h265_cbr_params.bit_rate = 5000;\n    params->rc_params.h265_cbr_params.frame_rate = 30;\n    params->rc_params.h265_cbr_params.intra_period = 30;\n    params->gop_params.decoding_refresh_type = 2;\n    params->gop_params.gop_preset_idx = 2;\n    params->rot_degree = MC_CCW_0;\n    params->mir_direction = MC_DIRECTION_NONE;\n    params->frame_cropping_flag = FALSE;\n    MediaCodecTestContext ctx;\n    memset(&ctx, 0x00, sizeof(ctx));\n    ctx.context = &context;\n    ctx.inputFileName = inputFileName;\n    ctx.outputFileName = outputFileName;\n    do_async_encoding(&ctx);\n    return 0;\n}\n'})}),"\n",(0,i.jsx)(n.h4,{id:"hb_mm_mc_set_callback",children:"hb_mm_mc_set_callback"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u51fd\u6570\u58f0\u660e\u3011"}),"\n",(0,i.jsx)(n.p,{children:"hb_s32 hb_mm_mc_set_callback(media_codec_context_t *context,\nconst media_codec_callback_t *callback, hb_ptr userdata)"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u53c2\u6570\u63cf\u8ff0\u3011"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"[IN] media_codec_context_t *context\uff1a\u6307\u5b9acodec\u7c7b\u578b\u7684context"}),"\n",(0,i.jsx)(n.li,{children:"[IN] const media_codec_callback_t *callback\uff1a\u7528\u6237\u56de\u8c03\u51fd\u6570"}),"\n",(0,i.jsx)(n.li,{children:"[IN] hb_ptr\nuserdata\uff1a\u7528\u6237\u6570\u636e\u6307\u9488\uff0c\u8be5\u503c\u4f1a\u5728\u56de\u8c03\u51fd\u6570\u88ab\u8c03\u7528\u65f6\u4f5c\u4e3a\u5165\u53c2\u4f20\u5165"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u8fd4\u56de\u503c\u3011"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"0\uff1a\u64cd\u4f5c\u6210\u529f"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_UNKNOWN\uff1a \u672a\u77e5\u9519\u8bef"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_INVALID_PARAMS\uff1a\u65e0\u6548\u53c2\u6570"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_OPERATION_NOT_ALLOWED\uff1a\u64cd\u4f5c\u4e0d\u5141\u8bb8"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u529f\u80fd\u63cf\u8ff0\u3011"}),"\n",(0,i.jsx)(n.p,{children:"\u8bbe\u7f6e\u56de\u8c03\u51fd\u6570\u6307\u9488\uff0c\u8c03\u7528\u8be5\u51fd\u6570\u540eMediaCodec\u4f1a\u8fdb\u5165\u5f02\u6b65\u5de5\u4f5c\u6a21\u5f0f\u3002"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u793a\u4f8b\u4ee3\u7801\u3011"}),"\n",(0,i.jsxs)(n.p,{children:["\u53c2\u8003 ",(0,i.jsx)(n.a,{href:"#hb_mm_mc_initialize",children:"hb_mm_mc_initialize"})]}),"\n",(0,i.jsx)(n.h4,{id:"hb_mm_mc_configure",children:"hb_mm_mc_configure"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u51fd\u6570\u58f0\u660e\u3011"}),"\n",(0,i.jsx)(n.p,{children:"hb_s32 hb_mm_mc_configure(media_codec_context_t *context)"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u53c2\u6570\u63cf\u8ff0\u3011"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"[IN] media_codec_context_t *context\uff1a\u6307\u5b9acodec\u7c7b\u578b\u7684context"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u8fd4\u56de\u503c\u3011"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"0\uff1a\u64cd\u4f5c\u6210\u529f"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_UNKNOWN\uff1a \u672a\u77e5\u9519\u8bef"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_INVALID_PARAMS\uff1a\u65e0\u6548\u53c2\u6570"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_OPERATION_NOT_ALLOWED\uff1a\u64cd\u4f5c\u4e0d\u5141\u8bb8"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_INSUFFICIENT_RES\uff1a\u5185\u90e8\u5185\u5b58\u8d44\u6e90\u4e0d\u8db3"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_INVALID_INSTANCE\uff1a\u65e0\u6548\u5b9e\u4f8b"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u529f\u80fd\u63cf\u8ff0\u3011"}),"\n",(0,i.jsx)(n.p,{children:"\u6839\u636e\u8f93\u5165\u4fe1\u606f\u914d\u7f6e\u7f16\u7801\u6216\u89e3\u7801\u5668\uff0c\u8c03\u7528\u6210\u529f\u540eMediaCodec\u8fdb\u5165MEDIA_CODEC_STATE_CONFIGURED\u72b6\u6001\u3002"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u793a\u4f8b\u4ee3\u7801\u3011"}),"\n",(0,i.jsxs)(n.p,{children:["\u53c2\u8003 ",(0,i.jsx)(n.a,{href:"#hb_mm_mc_initialize",children:"hb_mm_mc_initialize"})]}),"\n",(0,i.jsx)(n.h4,{id:"hb_mm_mc_start",children:"hb_mm_mc_start"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u51fd\u6570\u58f0\u660e\u3011"}),"\n",(0,i.jsx)(n.p,{children:"hb_s32 hb_mm_mc_start(media_codec_context_t *context, const\nmc_av_codec_startup_params_t *info)"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u53c2\u6570\u63cf\u8ff0\u3011"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"[IN] media_codec_context_t *context\uff1a\u6307\u5b9acodec\u7c7b\u578b\u7684context"}),"\n",(0,i.jsx)(n.li,{children:"[IN] mc_av_codec_startup_params_t\n*info\uff1a\u6307\u5b9a\u97f3\u89c6\u9891\u7f16\u89e3\u7801\u65f6\u7684\u542f\u52a8\u53c2\u6570"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u8fd4\u56de\u503c\u3011"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"0\uff1a\u64cd\u4f5c\u6210\u529f"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_UNKNOWN\uff1a \u672a\u77e5\u9519\u8bef"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_INVALID_PARAMS\uff1a\u65e0\u6548\u53c2\u6570"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_OPERATION_NOT_ALLOWED\uff1a\u64cd\u4f5c\u4e0d\u5141\u8bb8"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_INSUFFICIENT_RES\uff1a\u5185\u90e8\u5185\u5b58\u8d44\u6e90\u4e0d\u8db3"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_INVALID_INSTANCE\uff1a\u65e0\u6548\u5b9e\u4f8b"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u529f\u80fd\u63cf\u8ff0\u3011"}),"\n",(0,i.jsx)(n.p,{children:"\u542f\u52a8\u7f16\u7801/\u89e3\u7801\u6d41\u7a0b\uff0cMediaCodec\u5c06\u521b\u5efa\u7f16\u89e3\u7801\u5b9e\u4f8b\u3001\u8bbe\u7f6e\u5e8f\u5217\u6216\u89e3\u6790\u6570\u636e\u6d41\u3001\u6ce8\u518cFramebuffer\u3001\u7f16\u7801\u5934\u4fe1\u606f\u7b49\uff0c\u8c03\u7528\u6210\u529f\u540eMediaCodec\u8fdb\u5165MEDIA_CODEC_STATE_STARTED\u72b6\u6001\u3002"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u793a\u4f8b\u4ee3\u7801\u3011"}),"\n",(0,i.jsxs)(n.p,{children:["\u53c2\u8003 ",(0,i.jsx)(n.a,{href:"#hb_mm_mc_initialize",children:"hb_mm_mc_initialize"})]}),"\n",(0,i.jsx)(n.h4,{id:"hb_mm_mc_stop",children:"hb_mm_mc_stop"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u51fd\u6570\u58f0\u660e\u3011"}),"\n",(0,i.jsx)(n.p,{children:"hb_s32 hb_mm_mc_stop(media_codec_context_t *context)"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u53c2\u6570\u63cf\u8ff0\u3011"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"[IN] media_codec_context_t *context\uff1a\u6307\u5b9acodec\u7c7b\u578b\u7684context"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u8fd4\u56de\u503c\u3011"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"0\uff1a\u64cd\u4f5c\u6210\u529f"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_UNKNOWN\uff1a \u672a\u77e5\u9519\u8bef"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_OPERATION_NOT_ALLOWED\uff1a\u64cd\u4f5c\u4e0d\u5141\u8bb8"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_INVALID_INSTANCE\uff1a\u65e0\u6548\u5b9e\u4f8b"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u529f\u80fd\u63cf\u8ff0\u3011"}),"\n",(0,i.jsx)(n.p,{children:"\u505c\u6b62\u7f16\u7801/\u89e3\u7801\u6d41\u7a0b\uff0c\u9000\u51fa\u6240\u6709\u5b50\u7ebf\u7a0b\u5e76\u91ca\u653e\u76f8\u5173\u8d44\u6e90\uff0c\u8c03\u7528\u6210\u529f\u540eMediaCodec\u56de\u5230MEDIA_CODEC_STATE_INITIALIZED\u72b6\u6001\u3002"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u793a\u4f8b\u4ee3\u7801\u3011"}),"\n",(0,i.jsxs)(n.p,{children:["\u53c2\u8003 ",(0,i.jsx)(n.a,{href:"#hb_mm_mc_initialize",children:"hb_mm_mc_initialize"})]}),"\n",(0,i.jsx)(n.h4,{id:"hb_mm_mc_pause",children:"hb_mm_mc_pause"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u51fd\u6570\u58f0\u660e\u3011"}),"\n",(0,i.jsx)(n.p,{children:"hb_s32 hb_mm_mc_pause(media_codec_context_t *context)"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u53c2\u6570\u63cf\u8ff0\u3011"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"[IN] media_codec_context_t *context\uff1a\u6307\u5b9acodec\u7c7b\u578b\u7684context"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u8fd4\u56de\u503c\u3011"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"0\uff1a\u64cd\u4f5c\u6210\u529f"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_UNKNOWN\uff1a \u672a\u77e5\u9519\u8bef"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_OPERATION_NOT_ALLOWED\uff1a\u64cd\u4f5c\u4e0d\u5141\u8bb8"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_INVALID_INSTANCE\uff1a\u65e0\u6548\u5b9e\u4f8b"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u529f\u80fd\u63cf\u8ff0\u3011"}),"\n",(0,i.jsx)(n.p,{children:"\u505c\u6b62\u7f16\u7801/\u89e3\u7801\u6d41\u7a0b\uff0c\u6682\u505c\u6240\u6709\u5b50\u7ebf\u7a0b\uff0c\u8c03\u7528\u6210\u529f\u540eMediaCodec\u8fdb\u5165\u5230MEDIA_CODEC_STATE_PAUSED\u72b6\u6001\u3002"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u793a\u4f8b\u4ee3\u7801\u3011"}),"\n",(0,i.jsxs)(n.p,{children:["\u53c2\u8003 ",(0,i.jsx)(n.a,{href:"#hb_mm_mc_queue_input_buffer",children:"hb_mm_mc_queue_input_buffer"})]}),"\n",(0,i.jsx)(n.h4,{id:"hb_mm_mc_flush",children:"hb_mm_mc_flush"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u51fd\u6570\u58f0\u660e\u3011"}),"\n",(0,i.jsx)(n.p,{children:"hb_s32 hb_mm_mc_flush(media_codec_context_t *context)"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u53c2\u6570\u63cf\u8ff0\u3011"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"[IN] media_codec_context_t *context\uff1a\u6307\u5b9acodec\u7c7b\u578b\u7684context"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u8fd4\u56de\u503c\u3011"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"0\uff1a\u64cd\u4f5c\u6210\u529f"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_UNKNOWN\uff1a \u672a\u77e5\u9519\u8bef"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_OPERATION_NOT_ALLOWED\uff1a\u64cd\u4f5c\u4e0d\u5141\u8bb8"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_INVALID_INSTANCE\uff1a\u65e0\u6548\u5b9e\u4f8b"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u529f\u80fd\u63cf\u8ff0\u3011"}),"\n",(0,i.jsx)(n.p,{children:"\u5237\u65b0\u8f93\u5165\u8f93\u51fabuffer\u7f13\u51b2\u533a\uff0c\u5f3a\u5236\u7f16\u7801\u5668/\u89e3\u7801\u5668\u5237\u65b0\u672a\u5904\u7406\u7684\u8f93\u5165\u8f93\u51fabuffer\uff0c\u51fd\u6570\u8c03\u7528\u540eMediaCodec\u8fdb\u5165MEDIA_CODEC_STATE_FLUSHING\u72b6\u6001\uff0c\u64cd\u4f5c\u6210\u529f\u540e\uff0cMediaCodec\u4f1a\u518d\u6b21\u8fdb\u5165MEDIA_CODEC_STATE_STARTED\u72b6\u6001\u3002"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u793a\u4f8b\u4ee3\u7801\u3011"}),"\n",(0,i.jsxs)(n.p,{children:["\u53c2\u8003 ",(0,i.jsx)(n.a,{href:"#hb_mm_mc_queue_input_buffer",children:"hb_mm_mc_queue_input_buffer"})]}),"\n",(0,i.jsx)(n.h4,{id:"hb_mm_mc_release",children:"hb_mm_mc_release"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u51fd\u6570\u58f0\u660e\u3011"}),"\n",(0,i.jsx)(n.p,{children:"hb_s32 hb_mm_mc_release(media_codec_context_t *context)"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u53c2\u6570\u63cf\u8ff0\u3011"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"[IN] media_codec_context_t *context\uff1a\u6307\u5b9acodec\u7c7b\u578b\u7684context"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u8fd4\u56de\u503c\u3011"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"0\uff1a\u64cd\u4f5c\u6210\u529f"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_UNKNOWN\uff1a \u672a\u77e5\u9519\u8bef"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_OPERATION_NOT_ALLOWED\uff1a\u64cd\u4f5c\u4e0d\u5141\u8bb8"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_INVALID_INSTANCE\uff1a\u65e0\u6548\u5b9e\u4f8b"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u529f\u80fd\u63cf\u8ff0\u3011"}),"\n",(0,i.jsx)(n.p,{children:"\u91ca\u653eMediaCodec\u5185\u90e8\u6240\u6709\u8d44\u6e90\uff0c\u7528\u6237\u9700\u8981\u5728\u8c03\u7528\u8be5\u51fd\u6570\u524d\u8c03\u7528hb_mm_mc_stop\u6765\u505c\u6b62\u7f16\u89e3\u7801\uff0c\u64cd\u4f5c\u6210\u529f\u540eMediaCodec\u8fdb\u5165MEDIA_CODEC_STATE_UNINITIALIZED\u72b6\u6001\u3002"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u793a\u4f8b\u4ee3\u7801\u3011"}),"\n",(0,i.jsxs)(n.p,{children:["\u53c2\u8003 ",(0,i.jsx)(n.a,{href:"#hb_mm_mc_initialize",children:"hb_mm_mc_initialize"})]}),"\n",(0,i.jsx)(n.h4,{id:"hb_mm_mc_get_state",children:"hb_mm_mc_get_state"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u51fd\u6570\u58f0\u660e\u3011"}),"\n",(0,i.jsx)(n.p,{children:"hb_s32 hb_mm_mc_get_state(media_codec_context_t *context,\nmedia_codec_state_t *state)"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u53c2\u6570\u63cf\u8ff0\u3011"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"[IN] media_codec_context_t *context\uff1a\u6307\u5b9acodec\u7c7b\u578b\u7684context"}),"\n",(0,i.jsx)(n.li,{children:"[OUT] media_codec_state_t *state\uff1aMediaCodec\u5f53\u524d\u72b6\u6001"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u8fd4\u56de\u503c\u3011"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"0\uff1a\u64cd\u4f5c\u6210\u529f"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_UNKNOWN\uff1a \u672a\u77e5\u9519\u8bef"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_OPERATION_NOT_ALLOWED\uff1a\u64cd\u4f5c\u4e0d\u5141\u8bb8"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_INVALID_INSTANCE\uff1a\u65e0\u6548\u5b9e\u4f8b"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_INVALID_PARAMS\uff1a\u65e0\u6548\u53c2\u6570"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u529f\u80fd\u63cf\u8ff0\u3011"}),"\n",(0,i.jsx)(n.p,{children:"\u83b7\u53d6MediaCodec\u5f53\u524d\u7684\u72b6\u6001\u3002"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u793a\u4f8b\u4ee3\u7801\u3011"}),"\n",(0,i.jsxs)(n.p,{children:["\u53c2\u8003 ",(0,i.jsx)(n.a,{href:"#hb_mm_mc_initialize",children:"hb_mm_mc_initialize"})]}),"\n",(0,i.jsx)(n.h4,{id:"hb_mm_mc_get_status",children:"hb_mm_mc_get_status"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u51fd\u6570\u58f0\u660e\u3011"}),"\n",(0,i.jsx)(n.p,{children:"hb_s32 hb_mm_mc_get_status(media_codec_context_t *context,\nmc_inter_status_t *status)"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u53c2\u6570\u63cf\u8ff0\u3011"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"[IN] media_codec_context_t *context\uff1a\u6307\u5b9acodec\u7c7b\u578b\u7684context"}),"\n",(0,i.jsx)(n.li,{children:"[OUT] mc_inter_status_t *status\uff1aMediaCodec\u5f53\u524d\u5185\u90e8\u72b6\u6001"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u8fd4\u56de\u503c\u3011"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"0\uff1a\u64cd\u4f5c\u6210\u529f"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_UNKNOWN\uff1a \u672a\u77e5\u9519\u8bef"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_OPERATION_NOT_ALLOWED\uff1a\u64cd\u4f5c\u4e0d\u5141\u8bb8"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_INVALID_INSTANCE\uff1a\u65e0\u6548\u5b9e\u4f8b"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_INVALID_PARAMS\uff1a\u65e0\u6548\u53c2\u6570"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u529f\u80fd\u63cf\u8ff0\u3011"}),"\n",(0,i.jsx)(n.p,{children:"\u83b7\u53d6MediaCodec\u5f53\u524d\u5185\u90e8\u7684\u72b6\u6001\u4fe1\u606f\u3002"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u793a\u4f8b\u4ee3\u7801\u3011"}),"\n",(0,i.jsxs)(n.p,{children:["\u53c2\u8003 ",(0,i.jsx)(n.a,{href:"#hb_mm_mc_get_fd",children:"hb_mm_mc_get_fd"})]}),"\n",(0,i.jsx)(n.h4,{id:"hb_mm_mc_queue_input_buffer",children:"hb_mm_mc_queue_input_buffer"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u51fd\u6570\u58f0\u660e\u3011"}),"\n",(0,i.jsx)(n.p,{children:"hb_s32 hb_mm_mc_queue_input_buffer(media_codec_context_t\n*context, media_codec_buffer_t *buffer, hb_s32 timeout)"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u53c2\u6570\u63cf\u8ff0\u3011"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"[IN] media_codec_context_t *context\uff1a\u6307\u5b9acodec\u7c7b\u578b\u7684context"}),"\n",(0,i.jsx)(n.li,{children:"[IN] media_codec_buffer_t *buffer\uff1a\u8f93\u5165\u7684buffer\u4fe1\u606f"}),"\n",(0,i.jsx)(n.li,{children:"[IN] hb_s32 timeout\uff1a\u8d85\u65f6\u65f6\u95f4"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u8fd4\u56de\u503c\u3011"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"0\uff1a\u64cd\u4f5c\u6210\u529f"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_UNKNOWN\uff1a \u672a\u77e5\u9519\u8bef"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_OPERATION_NOT_ALLOWED\uff1a\u64cd\u4f5c\u4e0d\u5141\u8bb8"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_INVALID_INSTANCE\uff1a\u65e0\u6548\u5b9e\u4f8b"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_INVALID_PARAMS\uff1a\u65e0\u6548\u53c2\u6570"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_INVALID_BUFFER\uff1a\u65e0\u6548buffer"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_WAIT_TIMEOUT\uff1a\u7b49\u5f85\u8d85\u65f6"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u529f\u80fd\u63cf\u8ff0\u3011"}),"\n",(0,i.jsx)(n.p,{children:"\u586b\u5145\u9700\u8981\u5904\u7406\u7684buffer\u5230MediaCodec\u4e2d\u3002"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u793a\u4f8b\u4ee3\u7801\u3011"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:'#include "hb_media_codec.h"\n\n#include "hb_media_error.h"\ntypedef struct MediaCodecTestContext {\n    media_codec_context_t *context;\n    char *inputFileName;\n    char *outputFileName;\n    int32_t duration; // s\n} MediaCodecTestContext;\nUint64 osal_gettime(void)\n{\n    struct timespec tp;\n    clock_gettime(CLOCK_MONOTONIC, &tp);\n    return ((Uint64)tp.tv_sec*1000 + tp.tv_nsec/1000000);\n}\nstatic void do_sync_encoding(void *arg) {\n    hb_s32 ret = 0;\n    FILE *inFile;\n    FILE *outFile;\n    int noMoreInput = 0;\n    int lastStream = 0;\n    Uint64 lastTime = 0;\n    Uint64 curTime = 0;\n    int needFlush = 1;\n    MediaCodecTestContext *ctx = (MediaCodecTestContext *)arg;\n    media_codec_context_t *context = ctx->context;\n    char *inputFileName = ctx->inputFileName;\n    char *outputFileName = ctx->outputFileName;\n    media_codec_state_t state = MEDIA_CODEC_STATE_NONE;\n    inFile = fopen(inputFileName, "rb");\n    if (!inFile) {\n        goto ERR;\n    }\n    outFile = fopen(outputFileName, "wb");\n    if (!outFile) {\n        goto ERR;\n    }\n    //get current time\n    lastTime = osal_gettime();\n    ret = hb_mm_mc_initialize(context);\n    if (ret) {\n        goto ERR;\n    }\n    ret = hb_mm_mc_configure(context);\n    if (ret) {\n        goto ERR;\n    }\n    mc_av_codec_startup_params_t startup_params;\n    startup_params.video_enc_startup_params.receive_frame_number = 0;\n    ret = hb_mm_mc_start(context, &startup_params);\n    if (ret) {\n        goto ERR;\n    }\n    ret = hb_mm_mc_pause(context);\n    if (ret) {\n        goto ERR;\n    }\n    do {\n        if (!noMoreInput) {\n            media_codec_buffer_t inputBuffer;\n            memset(&inputBuffer, 0x00, sizeof(media_codec_buffer_t));\n            ret = hb_mm_mc_dequeue_input_buffer(context, &inputBuffer, 100);\n            if (!ret) {\n                curTime = osal_gettime();\n                if ((curTime - lastTime)/1000 < (uint32_t)ctx->duration) {\n                    ret = fread(inputBuffer.vframe_buf.vir_ptr[0], 1,\n                    inputBuffer.vframe_buf.size, inFile);\n                    if (ret <= 0) {\n                        if(fseek(inFile, 0, SEEK_SET)) {\n                            printf("Failed to rewind input filen");\n                        } else {\n                        ret = fread(inputBuffer.vframe_buf.vir_ptr[0], 1,\n                        inputBuffer.vframe_buf.size, inFile);\n                        if (ret <= 0) {\n                            printf("Failed to read input filen");\n                        }\n                }\n            }\n        } else {\n            printf("Time up(%d)n",ctx->duration);\n            ret = 0;\n        }\n        if (!ret) {\n            printf("There is no more input data!n");\n            inputBuffer.vframe_buf.frame_end = TRUE;\n            noMoreInput = 1;\n        }\n        ret = hb_mm_mc_queue_input_buffer(context, &inputBuffer, 100);\n        if (ret) {\n            printf("Queue input buffer fail.n");\n            break;\n        } else {\n            if (ret != (int32_t)HB_MEDIA_ERR_WAIT_TIMEOUT) {\n                printf("Dequeue input buffer fail.n");\n                break;\n            }\n        }\n\n        if (!lastStream) {\n            media_codec_buffer_t outputBuffer;\n            media_codec_output_buffer_info_t info;\n            memset(&outputBuffer, 0x00, sizeof(media_codec_buffer_t));\n            memset(&info, 0x00, sizeof(media_codec_output_buffer_info_t));\n            ret = hb_mm_mc_dequeue_output_buffer(context, &outputBuffer, &info,\n            3000);\n            if (!ret && outFile) {\n                fwrite(outputBuffer.vstream_buf.vir_ptr,\n                outputBuffer.vstream_buf.size, 1, outFile);\n                ret = hb_mm_mc_queue_output_buffer(context, &outputBuffer, 100);\n                if (ret) {\n                    printf("Queue output buffer fail.n");\n                    break;\n                }\n                if (outputBuffer.vstream_buf.stream_end) {\n                    printf("There is no more output data!n");\n                    lastStream = 1;\n                    break;\n                }\n            } else {\n                if (ret != (int32_t)HB_MEDIA_ERR_WAIT_TIMEOUT) {\n                    printf("Dequeue output buffer fail.n");\n                    break;\n                }\n            }\n        }\n        if (needFlush) {\n            ret = hb_mm_mc_flush(context);\n            needFlush = 0;\n            if (ret) {\n                break;\n            }\n        }\n    }while(TRUE);\n    hb_mm_mc_stop(context);\n    hb_mm_mc_release(context);\n    context = NULL;\nERR:\n    hb_mm_mc_get_state(context, &state);\n    if (context && state !=\n        MEDIA_CODEC_STATE_UNINITIALIZED) {\n        hb_mm_mc_stop(context);\n        hb_mm_mc_release(context);\n    }\n    if (inFile)\n        fclose(inFile);\n    if (outFile)\n    fclose(outFile);\n}\nint main(int argc, char *argv[])\n{\n    hb_s32 ret = 0;\n    char outputFileName[MAX_FILE_PATH] = "./tmp.yuv";\n    char inputFileName[MAX_FILE_PATH] = "./output.stream";\n    mc_video_codec_enc_params_t *params;\n    media_codec_context_t context;\n    memset(&context, 0x00, sizeof(media_codec_context_t));\n    context.codec_id = MEDIA_CODEC_ID_H265;\n    context.encoder = TRUE;\n    params = &context.video_enc_params;\n    params->width = 640;\n    params->height = 480;\n    params->pix_fmt = MC_PIXEL_FORMAT_YUV420P;\n    params->frame_buf_count = 5;\n    params->external_frame_buf = FALSE;\n    params->bitstream_buf_count = 5;\n    params->rc_params.mode = MC_AV_RC_MODE_H265CBR;\n    ret = hb_mm_mc_get_rate_control_config(&context, &params->rc_params);\n    if (ret) {\n        return -1;\n    }\n    params->rc_params.h265_cbr_params.bit_rate = 5000;\n    params->rc_params.h265_cbr_params.frame_rate = 30;\n    params->rc_params.h265_cbr_params.intra_period = 30;\n    params->gop_params.decoding_refresh_type = 2;\n    params->gop_params.gop_preset_idx = 2;\n    params->rot_degree = MC_CCW_0;\n    params->mir_direction = MC_DIRECTION_NONE;\n    params->frame_cropping_flag = FALSE;\n    MediaCodecTestContext ctx;\n    memset(&ctx, 0x00, sizeof(ctx));\n    ctx.context = &context;\n    ctx.inputFileName = inputFileName;\n    ctx.outputFileName = outputFileName;\n    ctx.duration = 5;\n    do_sync_encoding(&ctx);\n}\n'})}),"\n",(0,i.jsx)(n.h4,{id:"hb_mm_mc_dequeue_input_buffer",children:"hb_mm_mc_dequeue_input_buffer"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u51fd\u6570\u58f0\u660e\u3011"}),"\n",(0,i.jsx)(n.p,{children:"hb_s32 hb_mm_mc_dequeue_input_buffer(media_codec_context_t\n*context, media_codec_buffer_t *buffer, hb_s32 timeout)"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u53c2\u6570\u63cf\u8ff0\u3011"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"[IN] media_codec_context_t *context\uff1a\u6307\u5b9acodec\u7c7b\u578b\u7684context"}),"\n",(0,i.jsx)(n.li,{children:"[IN] hb_s32 timeout\uff1a\u8d85\u65f6\u65f6\u95f4"}),"\n",(0,i.jsx)(n.li,{children:"[OUT] media_codec_buffer_t *buffer\uff1a\u8f93\u5165\u7684buffer\u4fe1\u606f"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u8fd4\u56de\u503c\u3011"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"0\uff1a\u64cd\u4f5c\u6210\u529f"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_UNKNOWN\uff1a \u672a\u77e5\u9519\u8bef"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_OPERATION_NOT_ALLOWED\uff1a\u64cd\u4f5c\u4e0d\u5141\u8bb8"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_INVALID_INSTANCE\uff1a\u65e0\u6548\u5b9e\u4f8b"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_INVALID_PARAMS\uff1a\u65e0\u6548\u53c2\u6570"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_INVALID_BUFFER\uff1a\u65e0\u6548buffer"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_WAIT_TIMEOUT\uff1a\u7b49\u5f85\u8d85\u65f6"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u529f\u80fd\u63cf\u8ff0\u3011"}),"\n",(0,i.jsx)(n.p,{children:"\u83b7\u53d6\u8f93\u5165\u7684buffer\u3002"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u793a\u4f8b\u4ee3\u7801\u3011"}),"\n",(0,i.jsxs)(n.p,{children:["\u53c2\u8003 ",(0,i.jsx)(n.a,{href:"#hb_mm_mc_queue_input_buffer",children:"hb_mm_mc_queue_input_buffer"})]}),"\n",(0,i.jsx)(n.h4,{id:"hb_mm_mc_queue_output_buffer",children:"hb_mm_mc_queue_output_buffer"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u51fd\u6570\u58f0\u660e\u3011"}),"\n",(0,i.jsx)(n.p,{children:"hb_s32 hb_mm_mc_queue_output_buffer(media_codec_context_t\n*context, media_codec_buffer_t *buffer, hb_s32 timeout)"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u53c2\u6570\u63cf\u8ff0\u3011"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"[IN] media_codec_context_t *context\uff1a\u6307\u5b9acodec\u7c7b\u578b\u7684context"}),"\n",(0,i.jsx)(n.li,{children:"[IN] media_codec_buffer_t *buffer\uff1a\u8f93\u51fa\u7684buffer\u4fe1\u606f"}),"\n",(0,i.jsx)(n.li,{children:"[IN] hb_s32 timeout\uff1a\u8d85\u65f6\u65f6\u95f4"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u8fd4\u56de\u503c\u3011"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"0\uff1a\u64cd\u4f5c\u6210\u529f"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_UNKNOWN\uff1a \u672a\u77e5\u9519\u8bef"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_OPERATION_NOT_ALLOWED\uff1a\u64cd\u4f5c\u4e0d\u5141\u8bb8"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_INVALID_INSTANCE\uff1a\u65e0\u6548\u5b9e\u4f8b"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_INVALID_PARAMS\uff1a\u65e0\u6548\u53c2\u6570"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_INVALID_BUFFER\uff1a\u65e0\u6548buffer"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_WAIT_TIMEOUT\uff1a\u7b49\u5f85\u8d85\u65f6"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u529f\u80fd\u63cf\u8ff0\u3011"}),"\n",(0,i.jsx)(n.p,{children:"\u8fd4\u8fd8\u5904\u7406\u5b8c\u7684output buffer\u5230MediaCodec\u4e2d\u3002"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u793a\u4f8b\u4ee3\u7801\u3011"}),"\n",(0,i.jsxs)(n.p,{children:["\u53c2\u8003 ",(0,i.jsx)(n.a,{href:"#hb_mm_mc_queue_input_buffer",children:"hb_mm_mc_queue_input_buffer"})]}),"\n",(0,i.jsx)(n.h4,{id:"hb_mm_mc_dequeue_output_buffer",children:"hb_mm_mc_dequeue_output_buffer"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u51fd\u6570\u58f0\u660e\u3011"}),"\n",(0,i.jsx)(n.p,{children:"hb_s32 hb_mm_mc_dequeue_output_buffer(media_codec_context_t\n*context, media_codec_buffer_t *buffer,\nmedia_codec_output_buffer_info_t *info, hb_s32 timeout)"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u53c2\u6570\u63cf\u8ff0\u3011"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"[IN] media_codec_context_t *context\uff1a\u6307\u5b9acodec\u7c7b\u578b\u7684context"}),"\n",(0,i.jsx)(n.li,{children:"[IN] hb_s32 timeout\uff1a\u8d85\u65f6\u65f6\u95f4"}),"\n",(0,i.jsx)(n.li,{children:"[OUT] media_codec_buffer_t *buffer\uff1a\u8f93\u51fa\u7684buffer\u4fe1\u606f"}),"\n",(0,i.jsx)(n.li,{children:"[IN] media_codec_output_buffer_info_t\n*info\uff1a\u8f93\u51fa\u6570\u636e\u6d41\u7684\u4fe1\u606f"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u8fd4\u56de\u503c\u3011"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"0\uff1a\u64cd\u4f5c\u6210\u529f"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_UNKNOWN\uff1a \u672a\u77e5\u9519\u8bef"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_OPERATION_NOT_ALLOWED\uff1a\u64cd\u4f5c\u4e0d\u5141\u8bb8"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_INVALID_INSTANCE\uff1a\u65e0\u6548\u5b9e\u4f8b"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_INVALID_PARAMS\uff1a\u65e0\u6548\u53c2\u6570"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_INVALID_BUFFER\uff1a\u65e0\u6548buffer"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_WAIT_TIMEOUT\uff1a\u7b49\u5f85\u8d85\u65f6"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u529f\u80fd\u63cf\u8ff0\u3011"}),"\n",(0,i.jsx)(n.p,{children:"\u83b7\u53d6\u8f93\u51fa\u7684buffer\u3002"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u793a\u4f8b\u4ee3\u7801\u3011"}),"\n",(0,i.jsxs)(n.p,{children:["\u53c2\u8003 ",(0,i.jsx)(n.a,{href:"#hb_mm_mc_queue_input_buffer",children:"hb_mm_mc_queue_input_buffer"})]}),"\n",(0,i.jsx)(n.h4,{id:"hb_mm_mc_get_longterm_ref_mode",children:"hb_mm_mc_get_longterm_ref_mode"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u51fd\u6570\u58f0\u660e\u3011"}),"\n",(0,i.jsx)(n.p,{children:"hb_s32 hb_mm_mc_get_longterm_ref_mode(media_codec_context_t\n*context, mc_video_longterm_ref_mode_t *params)"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u53c2\u6570\u63cf\u8ff0\u3011"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"[IN] media_codec_context_t *context\uff1a\u6307\u5b9acodec\u7c7b\u578b\u7684context"}),"\n",(0,i.jsx)(n.li,{children:"[OUT] mc_video_longterm_ref_mode_t\n*params\uff1a\u957f\u671f\u53c2\u8003\u5e27\u6a21\u5f0f\u53c2\u6570"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u8fd4\u56de\u503c\u3011"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"0\uff1a\u64cd\u4f5c\u6210\u529f"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_UNKNOWN\uff1a \u672a\u77e5\u9519\u8bef"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_INVALID_INSTANCE\uff1a\u65e0\u6548\u5b9e\u4f8b"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_INVALID_PARAMS\uff1a\u65e0\u6548\u53c2\u6570"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u529f\u80fd\u63cf\u8ff0\u3011"}),"\n",(0,i.jsx)(n.p,{children:"\u83b7\u53d6\u957f\u671f\u53c2\u8003\u5e27\u6a21\u5f0f\u7684\u53c2\u6570\uff0c\u9002\u7528\u4e8eH264/H265\u3002"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u793a\u4f8b\u4ee3\u7801\u3011"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:'#include "hb_media_codec.h"\n#include "hb_media_error.h"\n\ntypedef enum ENC_CONFIG_MESSAGE {\n    ENC_CONFIG_NONE = (0 << 0),\n    ENC_CONFIG_LONGTERM_REF = (1 << 0),\n    ENC_CONFIG_INTRA_REFRESH = (1 << 1),\n    ENC_CONFIG_RATE_CONTROL = (1 << 2),\n    ENC_CONFIG_DEBLK_FILTER = (1 << 3),\n    ENC_CONFIG_SAO = (1 << 4),\n    ENC_CONFIG_ENTROPY = (1 << 5),\n    ENC_CONFIG_VUI_TIMING = (1 << 6),\n    ENC_CONFIG_SLICE = (1 << 7),\n    ENC_CONFIG_REQUEST_IDR = (1 << 8),\n    ENC_CONFIG_SKIP_PIC = (1 << 9),\n    ENC_CONFIG_SMART_BG = (1 << 10),\n    ENC_CONFIG_MONOCHROMA = (1 << 11),\n    ENC_CONFIG_PRED_UNIT = (1 << 12),\n    ENC_CONFIG_TRANSFORM = (1 << 13),\n    ENC_CONFIG_ROI = (1 << 14),\n    ENC_CONFIG_MODE_DECISION = (1 << 15),\n    ENC_CONFIG_USER_DATA = (1 << 16),\n    ENC_CONFIG_MJPEG = (1 << 17),\n    ENC_CONFIG_JPEG = (1 << 18),\n    ENC_CONFIG_CAMERA = (1 << 19),\n    ENC_CONFIG_INSERT_USERDATA = (1 << 20),\n    ENC_CONFIG_VUI = (1 << 21),\n    ENC_CONFIG_3DNR = (1 << 22),\n    ENC_CONFIG_REQUEST_IDR_HEADER = (1 << 23),\n    ENC_CONFIG_ENABLE_IDR = (1 << 24),\n    ENC_CONFIG_TOTAL = (1 << 25),\n} ENC_CONFIG_MESSAGE;\n\ntypedef struct MediaCodecTestContext {\n    media_codec_context_t *context;\n    char *inputFileName;\n    char *outputFileName;\n    int32_t duration; // s\n    ENC_CONFIG_MESSAGE message;\n    mc_video_longterm_ref_mode_t ref_mode;\n    mc_rate_control_params_t rc_params;\n    mc_video_intra_refresh_params_t intra_refr;\n    mc_video_deblk_filter_params_t deblk_filter;\n    mc_h265_sao_params_t sao;\n    mc_h264_entropy_params_t entropy;\n    mc_video_vui_params_t vui;\n    mc_video_vui_timing_params_t vui_timing;\n    mc_video_slice_params_t slice;\n    mc_video_3dnr_enc_params_t noise_reduction;\n    mc_video_smart_bg_enc_params_t smart_bg;\n    mc_video_pred_unit_params_t pred_unit;\n    mc_video_transform_params_t transform;\n    mc_video_roi_params_t roi;\n    mc_video_mode_decision_params_t mode_decision;\n} MediaCodecTestContext;\n\nUint64 osal_gettime(void)\n{\n    struct timespec tp;\n\n    clock_gettime(CLOCK_MONOTONIC, &tp);\n\n    return ((Uint64)tp.tv_sec*1000 + tp.tv_nsec/1000000);\n}\nuint8_t uuid[] =\n    "dc45e9bd-e6d948b7-962cd820-d923eeef+HorizonAI";\nstatic void set_message(MediaCodecTestContext *ctx) {\n    int ret = 0;\n    media_codec_context_t *context = ctx->context;\n\n    mc_video_longterm_ref_mode_t *ref_mode = &ctx->ref_mode;\n    hb_mm_mc_get_longterm_ref_mode(context, ref_mode);\n    ref_mode->use_longterm = TRUE;\n    ref_mode->longterm_pic_using_period = 20;\n    ref_mode->longterm_pic_period = 30;\n    //ctx->message = ENC_CONFIG_LONGTERM_REF;\n    if (ctx->message & ENC_CONFIG_LONGTERM_REF) {\n        ret = hb_mm_mc_set_longterm_ref_mode(context, &ctx->ref_mode);\n    }\nif (ctx->message & ENC_CONFIG_INTRA_REFRESH) {\nhb_mm_mc_get_intra_refresh_config(context, &ctx->intra_refr)\n        ret = hb_mm_mc_set_intra_refresh_config(context, &ctx->intra_refr);\n}\nif (ctx->message & ENC_CONFIG_SAO) {\nhb_mm_mc_get_sao_config(context, &ctx->sao);\n        ret = hb_mm_mc_set_sao_config(context, &ctx->sao);\n    }\n\nif (ctx->message & ENC_CONFIG_ENTROPY) {\nhb_mm_mc_get_entropy_config(context, &ctx->entropy);\n        ret = hb_mm_mc_set_entropy_config(context, &ctx->entropy);\n    }\n\nif (ctx->message & ENC_CONFIG_VUI) {\nhb_mm_mc_get_vui_config(context, &ctx->vui);\n    ret = hb_mm_mc_set_vui_config(context, &ctx->vui);\n    }\n\nif (ctx->message & ENC_CONFIG_VUI_TIMING) {\nhb_mm_mc_get_vui_timing_config(context, &ctx->vui_timing);\n        ret = hb_mm_mc_set_vui_timing_config(context, &ctx->vui_timing);\n    }\n    mc_rate_control_params_t *rc_params = &ctx->rc_params;\n    rc_params->mode = context->video_enc_params.rc_params.mode;\n    hb_mm_mc_get_rate_control_config(context, rc_params);\n    switch (rc_params->mode) {\n    case MC_AV_RC_MODE_H264CBR:\n        rc_params->h264_cbr_params.bit_rate = 5000;\n        rc_params->h264_cbr_params.intra_period = 60;\n        break;\n    case MC_AV_RC_MODE_H264VBR:\n        rc_params->h264_vbr_params.intra_qp = 20;\n        rc_params->h264_vbr_params.intra_period = 30;\n        break;\n    case MC_AV_RC_MODE_H264AVBR:\n        rc_params->h264_avbr_params.intra_period = 15;\n        rc_params->h264_avbr_params.intra_qp = 25;\n        rc_params->h264_avbr_params.bit_rate = 2000;\n        rc_params->h264_avbr_params.vbv_buffer_size = 3000;\n        rc_params->h264_avbr_params.min_qp_I = 15;\n        rc_params->h264_avbr_params.max_qp_I = 50;\n        rc_params->h264_avbr_params.min_qp_P = 15;\n        rc_params->h264_avbr_params.max_qp_P = 45;\n        rc_params->h264_avbr_params.min_qp_B = 15;\n        rc_params->h264_avbr_params.max_qp_B = 48;\n        rc_params->h264_avbr_params.hvs_qp_enable = 0;\n        rc_params->h264_avbr_params.hvs_qp_scale = 2;\n        rc_params->h264_avbr_params.max_delta_qp = 5;\n        rc_params->h264_avbr_params.qp_map_enable = 0;\n        break;\n    case MC_AV_RC_MODE_H264FIXQP:\n        rc_params->h264_fixqp_params.force_qp_I = 23;\n        rc_params->h264_fixqp_params.force_qp_P = 23;\n        rc_params->h264_fixqp_params.force_qp_B = 23;\n        rc_params->h264_fixqp_params.intra_period = 23;\n        break;\n    case MC_AV_RC_MODE_H264QPMAP:\n        break;\n    case MC_AV_RC_MODE_H265CBR:\n        rc_params->h265_cbr_params.bit_rate = 5000;\n        rc_params->h265_cbr_params.intra_period = 60;\n        break;\n    case MC_AV_RC_MODE_H265VBR:\n        rc_params->h265_vbr_params.intra_qp = 20;\n        rc_params->h265_vbr_params.intra_period = 30;\n        break;\n    case MC_AV_RC_MODE_H265AVBR:\n        rc_params->h265_avbr_params.intra_period = 15;\n        rc_params->h265_avbr_params.intra_qp = 25;\n        rc_params->h265_avbr_params.bit_rate = 2000;\n        rc_params->h265_avbr_params.vbv_buffer_size = 3000;\n        rc_params->h265_avbr_params.min_qp_I = 15;\n        rc_params->h265_avbr_params.max_qp_I = 50;\n        rc_params->h265_avbr_params.min_qp_P = 15;\n        rc_params->h265_avbr_params.max_qp_P = 45;\n        rc_params->h265_avbr_params.min_qp_B = 15;\n        rc_params->h265_avbr_params.max_qp_B = 48;\n        rc_params->h265_avbr_params.hvs_qp_enable = 0;\n        rc_params->h265_avbr_params.hvs_qp_scale = 2;\n        rc_params->h265_avbr_params.max_delta_qp = 5;\n        rc_params->h265_avbr_params.qp_map_enable = 0;\n        break;\n    case MC_AV_RC_MODE_H265FIXQP:\n        rc_params->h265_fixqp_params.force_qp_I = 23;\n        rc_params->h265_fixqp_params.force_qp_P = 23;\n        rc_params->h265_fixqp_params.force_qp_B = 23;\n        rc_params->h265_fixqp_params.intra_period = 23;\n        break;\n    case MC_AV_RC_MODE_H265QPMAP:\n        break;\n    default:\n        break;\n    }\n    //ctx->message = ENC_CONFIG_RATE_CONTROL;\n    if (ctx->message & ENC_CONFIG_RATE_CONTROL) {\n        ret = hb_mm_mc_set_rate_control_config(context, &ctx->rc_params);\n    }\n\n    mc_video_deblk_filter_params_t *deblk_filter = &ctx->deblk_filter;\n    hb_mm_mc_get_deblk_filter_config(context, deblk_filter);\n    if (context->codec_id == MEDIA_CODEC_ID_H264) {\n        deblk_filter->h264_deblk.disable_deblocking_filter_idc = 2;\n        deblk_filter->h264_deblk.slice_alpha_c0_offset_div2 = 6;\n        deblk_filter->h264_deblk.slice_beta_offset_div2 = 6;\n    } else {\n        deblk_filter->h265_deblk.slice_deblocking_filter_disabled_flag = 1;\n        deblk_filter->h265_deblk.slice_beta_offset_div2 = 6;\n        deblk_filter->h265_deblk.slice_tc_offset_div2 = 6;\n        deblk_filter->h265_deblk.slice_loop_filter_across_slices_enabled_flag = 1;\n    }\n    //ctx->message = ENC_CONFIG_DEBLK_FILTER;\n    if (ctx->message & ENC_CONFIG_DEBLK_FILTER) {\n        ret = hb_mm_mc_set_deblk_filter_config(context, &ctx->deblk_filter);\n    }\n\n    if (context->codec_id == MEDIA_CODEC_ID_H264) {\n        mc_h264_entropy_params_t *entropy = &ctx->entropy;\n        hb_mm_mc_get_entropy_config(context, entropy);\n        entropy->entropy_coding_mode = 0;\n        ctx->message = ENC_CONFIG_ENTROPY;\n        if (ctx->message & ENC_CONFIG_ENTROPY) {\n            ret = hb_mm_mc_set_entropy_config(context, &ctx->entropy);\n        }\n    }\n\n    //ctx->message = ENC_CONFIG_SKIP_PIC;\n    if (ctx->message & ENC_CONFIG_SKIP_PIC) {\n        ret = hb_mm_mc_skip_pic(context, 0), (int32_t)0);\n    }\n\n    //ctx->message = ENC_CONFIG_REQUEST_IDR;\n    if (ctx->message & ENC_CONFIG_REQUEST_IDR) {\n        ret = hb_mm_mc_request_idr_frame(context);\n    }\n\n    mc_video_slice_params_t *slice = &ctx->slice;\n    hb_mm_mc_get_slice_config(context, slice);\n    if (context->codec_id == MEDIA_CODEC_ID_H264) {\n        slice->h264_slice.h264_slice_mode = 0;\n        slice->h264_slice.h264_slice_arg = 60;\n    } else {\n        slice->h265_slice.h265_dependent_slice_mode = 0;\n        slice->h265_slice.h265_dependent_slice_arg = 80;\n        slice->h265_slice.h265_independent_slice_mode = 1;\n        slice->h265_slice.h265_independent_slice_arg = 100;\n    }\n    //ctx->message = ENC_CONFIG_SLICE;\n    if (ctx->message & ENC_CONFIG_SLICE) {\n        ret = hb_mm_mc_set_slice_config(context, &ctx->slice);\n    }\n\n    mc_video_smart_bg_enc_params_t *smart_bg = &ctx->smart_bg;\n    hb_mm_mc_get_smart_bg_enc_config(context, smart_bg);\n    smart_bg->bg_detect_enable = 0;\n    smart_bg->bg_threshold_diff = 8;\n    smart_bg->bg_threshold_mean_diff = 1;\n    smart_bg->bg_lambda_qp = 32;\n    smart_bg->bg_delta_qp = 3;\n    smart_bg->s2fme_disable = 0;\n    //ctx->message = ENC_CONFIG_SMART_BG;\n    if (ctx->message & ENC_CONFIG_SMART_BG) {\n        ret = hb_mm_mc_set_smart_bg_enc_config(context, &ctx->smart_bg);\n    }\n\n    mc_video_pred_unit_params_t *pred_unit = &ctx->pred_unit;\n    hb_mm_mc_get_pred_unit_config(context, pred_unit);\n    if (context->codec_id == MEDIA_CODEC_ID_H264) {\n        pred_unit->h264_intra_pred.constrained_intra_pred_flag = 1;\n    } else {\n        pred_unit->h265_pred_unit.intra_nxn_enable = 1;\n        pred_unit->h265_pred_unit.constrained_intra_pred_flag = 1;\n        pred_unit->h265_pred_unit.strong_intra_smoothing_enabled_flag = 0;\n        pred_unit->h265_pred_unit.max_num_merge = 2;\n    }\n    //ctx->message = ENC_CONFIG_PRED_UNIT;\n    if (ctx->message & ENC_CONFIG_PRED_UNIT) {\n        ret = hb_mm_mc_set_pred_unit_config(context, &ctx->pred_unit);\n    }\n\n    mc_video_transform_params_t *transform = &ctx->transform;\n    hb_mm_mc_get_transform_config(context, transform);\n    if (context->codec_id == MEDIA_CODEC_ID_H264) {\n        transform->h264_transform.transform_8x8_enable = 1;\n        transform->h264_transform.chroma_cb_qp_offset = 4;\n        transform->h264_transform.chroma_cr_qp_offset = 3;\n        transform->h264_transform.user_scaling_list_enable = 0;\n    } else {\n        transform->h265_transform.chroma_cb_qp_offset = 6;\n        transform->h265_transform.chroma_cr_qp_offset = 5;\n        transform->h265_transform.user_scaling_list_enable = 0;\n    }\n    //ctx->message = ENC_CONFIG_TRANSFORM;\n    if (ctx->message & ENC_CONFIG_TRANSFORM) {\n        ret = hb_mm_mc_set_transform_config(context, &ctx->transform);\n    }\n\n    mc_video_roi_params_t *roi = &ctx->roi;\n    hb_mm_mc_get_roi_config(context, roi);\n    roi->roi_enable = 0;\n    //ctx->message = ENC_CONFIG_ROI;\n    if (ctx->message & ENC_CONFIG_ROI) {\n        ret = hb_mm_mc_set_roi_config(context, &ctx->roi);\n    }\n\n    mc_video_mode_decision_params_t *mode_decision = &ctx->mode_decision;\n    hb_mm_mc_get_mode_decision_config(context, mode_decision);\n    mode_decision->mode_decision_enable = FALSE;\n    mode_decision->pu04_delta_rate = 76;\n    mode_decision->pu08_delta_rate = 80;\n    mode_decision->pu16_delta_rate = 86;\n    mode_decision->pu32_delta_rate = 87;\n    mode_decision->pu04_intra_planar_delta_rate = 0;\n    mode_decision->pu04_intra_dc_delta_rate = 0;\n    mode_decision->pu04_intra_angle_delta_rate = 0;\n    mode_decision->pu08_intra_planar_delta_rate = 0;\n    mode_decision->pu08_intra_dc_delta_rate = 0;\n    mode_decision->pu08_intra_angle_delta_rate = 0;\n    mode_decision->pu16_intra_planar_delta_rate = 0;\n    mode_decision->pu16_intra_dc_delta_rate = 0;\n    mode_decision->pu16_intra_angle_delta_rate = 0;\n    mode_decision->pu32_intra_planar_delta_rate = 0;\n    mode_decision->pu32_intra_dc_delta_rate = 0;\n    mode_decision->pu32_intra_angle_delta_rate = 0;\n    mode_decision->cu08_intra_delta_rate = 0;\n    mode_decision->cu08_inter_delta_rate = 0;\n    mode_decision->cu08_merge_delta_rate = 0;\n    mode_decision->cu16_intra_delta_rate = 0;\n    mode_decision->cu16_inter_delta_rate = 0;\n    mode_decision->cu16_merge_delta_rate = 0;\n    mode_decision->cu32_intra_delta_rate = 0;\n    mode_decision->cu32_inter_delta_rate = 0;\n    mode_decision->cu32_merge_delta_rate = 0;\n    //ctx->message = ENC_CONFIG_MODE_DECISION;\n    if (ctx->message & ENC_CONFIG_MODE_DECISION) {\n        ret = hb_mm_mc_set_mode_decision_config(context, &ctx->mode_decision);\n}\n    if (ctx->message & ENC_CONFIG_INSERT_USERDATA) {\n        hb_u32 length = sizeof(uuid)/sizeof(uuid[0]);\n        ret = hb_mm_mc_insert_user_data(context, uuid, length);\n}\nif (ctx->message & ENC_CONFIG_3DNR) {\nhb_mm_mc_get_3dnr_enc_config(context, &ctx->noise_reduction);\n        ret = hb_mm_mc_set_3dnr_enc_config(context, &ctx->noise_reduction);\n}\n    if (ctx->message & ENC_CONFIG_ENABLE_IDR) {\n        // disable idr frame first\n        if (ctx->enable_idr_num) {\n            ret = hb_mm_mc_enable_idr_frame(context, 0);\n        }\n    }\n\n    if (ctx->message & ENC_CONFIG_REQUEST_IDR_HEADER) {\n        ret = hb_mm_mc_request_idr_header(context, ctx->force_idr_header);\n    }\n}\n\nstatic void do_sync_encoding(void *arg) {\n    hb_s32 ret = 0;\n    FILE *inFile;\n    FILE *outFile;\n    int noMoreInput = 0;\n    int lastStream = 0;\n    Uint64 lastTime = 0;\n    Uint64 curTime = 0;\n    int needFlush = 1;\n    MediaCodecTestContext *ctx = (MediaCodecTestContext *)arg;\n    media_codec_context_t *context = ctx->context;\n    char *inputFileName = ctx->inputFileName;\n    char *outputFileName = ctx->outputFileName;\n    media_codec_state_t state = MEDIA_CODEC_STATE_NONE;\n    inFile = fopen(inputFileName, "rb");\n    if (!inFile) {\n        goto ERR;\n    }\n    outFile = fopen(outputFileName, "wb");\n    if (!outFile) {\n        goto ERR;\n    }\n\n    //get current time\n    lastTime = osal_gettime();\n\n    ret = hb_mm_mc_initialize(context);\n    if (ret) {\n        goto ERR;\n    }\n\n    ret = hb_mm_mc_configure(context);\n    if (ret) {\n        goto ERR;\n    }\n\n    mc_av_codec_startup_params_t startup_params;\n    startup_params.video_enc_startup_params.receive_frame_number = 0;\n    ret = hb_mm_mc_start(context, &startup_params);\n    if (ret) {\n        goto ERR;\n    }\n\n    ret = hb_mm_mc_pause(context);\n    if (ret) {\n        goto ERR;\n    }\n\n    do {\n        set_message(ctx);\n        if (!noMoreInput) {\n            media_codec_buffer_t inputBuffer;\n            memset(&inputBuffer, 0x00, sizeof(media_codec_buffer_t));\n            ret = hb_mm_mc_dequeue_input_buffer(context, &inputBuffer, 100);\n            if (!ret) {\n                curTime = osal_gettime();\n                if ((curTime - lastTime)/1000 < (uint32_t)ctx->duration) {\n                    ret = fread(inputBuffer.vframe_buf.vir_ptr[0], 1,\n                        inputBuffer.vframe_buf.size, inFile);\n                    if (ret <= 0) {\n                        if(fseek(inFile, 0, SEEK_SET)) {\n                            printf("Failed to rewind input file\\n");\n                        } else {\n                            ret = fread(inputBuffer.vframe_buf.vir_ptr[0], 1,\n                                inputBuffer.vframe_buf.size, inFile);\n                            if (ret <= 0) {\n                                printf("Failed to read input file\\n");\n                            }\n                        }\n                    }\n                } else {\n                    printf("Time up(%d)\\n",ctx->duration);\n                    ret = 0;\n                }\n                if (!ret) {\n                    printf("There is no more input data!\\n");\n                    inputBuffer.vframe_buf.frame_end = TRUE;\n                    noMoreInput = 1;\n                } \n                ret = hb_mm_mc_queue_input_buffer(context, &inputBuffer, 100);\n                if (ret) {\n                    printf("Queue input buffer fail.\\n");\n                    break;\n                }\n            } else {\n                if (ret != (int32_t)HB_MEDIA_ERR_WAIT_TIMEOUT) {\n                    printf("Dequeue input buffer fail.\\n");\n                    break;\n                }\n            }\n        }\n\n        if (!lastStream) {\n            media_codec_buffer_t outputBuffer;\n            media_codec_output_buffer_info_t info;\n            memset(&outputBuffer, 0x00, sizeof(media_codec_buffer_t));\n            memset(&info, 0x00, sizeof(media_codec_output_buffer_info_t));\n            ret = hb_mm_mc_dequeue_output_buffer(context, &outputBuffer, &info, 3000);\n            if (!ret && outFile) {\n                fwrite(outputBuffer.vstream_buf.vir_ptr, outputBuffer.vstream_buf.size, 1, outFile);\n\n                ret = hb_mm_mc_queue_output_buffer(context, &outputBuffer, 100);\n                if (ret) {\n                    printf("Queue output buffer fail.\\n");\n                    break;\n                }\n                if (outputBuffer.vstream_buf.stream_end) {\n                    printf("There is no more output data!\\n");\n                    lastStream = 1;\n                    break;\n                }\n            } else {\n                if (ret != (int32_t)HB_MEDIA_ERR_WAIT_TIMEOUT) {\n                    printf("Dequeue output buffer fail.\\n");\n                    break;\n                }\n            }\n        }\n        if (needFlush) {\n            ret = hb_mm_mc_flush(context);\n            needFlush = 0;\n            if (ret) {\n                break;\n            }\n        }\n    }while(TRUE);\n\n    hb_mm_mc_stop(context);\n\n    hb_mm_mc_release(context);\n    context = NULL;\n\nERR:\n    hb_mm_mc_get_state(context, &state);\n    if (context && state != MEDIA_CODEC_STATE_UNINITIALIZED) {\n        hb_mm_mc_stop(context);\n        hb_mm_mc_release(context);\n    }\n\n    if (inFile)\n        fclose(inFile);\n\n    if (outFile)\n        fclose(outFile);\n}\n\nint main(int argc, char *argv[])\n{\n    hb_s32 ret = 0;\n    char outputFileName[MAX_FILE_PATH] = "./tmp.yuv";\n    char inputFileName[MAX_FILE_PATH] = "./output.stream";\n    mc_video_codec_enc_params_t *params;\n    media_codec_context_t context;\n\n    memset(&context, 0x00, sizeof(media_codec_context_t));\n    context.codec_id = MEDIA_CODEC_ID_H265;\n    context.encoder = TRUE;\n    params = &context.video_enc_params;\n    params->width = 640;\n    params->height = 480;\n    params->pix_fmt = MC_PIXEL_FORMAT_YUV420P;\n    params->frame_buf_count = 5;\n    params->external_frame_buf = FALSE;\n    params->bitstream_buf_count = 5;\n    params->rc_params.mode = MC_AV_RC_MODE_H265CBR;\n    ret = hb_mm_mc_get_rate_control_config(&context, &params->rc_params);\n    if (ret) {\n        return -1;\n    }\n    params->rc_params.h265_cbr_params.bit_rate = 5000;\n    params->rc_params.h265_cbr_params.frame_rate = 30;\n    params->rc_params.h265_cbr_params.intra_period = 30;\n    params->gop_params.decoding_refresh_type = 2;\n    params->gop_params.gop_preset_idx = 2;\n    params->rot_degree = MC_CCW_0;\n    params->mir_direction = MC_DIRECTION_NONE;\n    params->frame_cropping_flag = FALSE;\n\n    MediaCodecTestContext ctx;\n    memset(&ctx, 0x00, sizeof(ctx));\n    ctx.context = &context;\n    ctx.inputFileName = inputFileName;\n    ctx.outputFileName = outputFileName;\n    ctx.duration = 5;\n    do_sync_encoding(&ctx);\n}\n'})}),"\n",(0,i.jsx)(n.h4,{id:"hb_mm_mc_set_longterm_ref_mode",children:"hb_mm_mc_set_longterm_ref_mode"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u51fd\u6570\u58f0\u660e\u3011"}),"\n",(0,i.jsx)(n.p,{children:"hb_s32 hb_mm_mc_set_longterm_ref_mode(media_codec_context_t\n*context, const mc_video_longterm_ref_mode_t *params)"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u53c2\u6570\u63cf\u8ff0\u3011"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"[IN] media_codec_context_t *context\uff1a\u6307\u5b9acodec\u7c7b\u578b\u7684context"}),"\n",(0,i.jsx)(n.li,{children:"[IN] const mc_video_longterm_ref_mode_t\n*params\uff1a\u957f\u671f\u53c2\u8003\u5e27\u6a21\u5f0f\u53c2\u6570"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u8fd4\u56de\u503c\u3011"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"0\uff1a\u64cd\u4f5c\u6210\u529f"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_UNKNOWN\uff1a \u672a\u77e5\u9519\u8bef"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_OPERATION_NOT_ALLOWED\uff1a\u64cd\u4f5c\u4e0d\u5141\u8bb8"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_INVALID_INSTANCE\uff1a\u65e0\u6548\u5b9e\u4f8b"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_INVALID_PARAMS\uff1a\u65e0\u6548\u53c2\u6570"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u529f\u80fd\u63cf\u8ff0\u3011"}),"\n",(0,i.jsx)(n.p,{children:"\u8bbe\u7f6e\u957f\u671f\u53c2\u8003\u5e27\u6a21\u5f0f\u7684\u53c2\u6570\uff0c\u8be5\u53c2\u6570\u4e3a\u52a8\u6001\u53c2\u6570\uff0c\u9002\u7528\u4e8eH264/H265\u3002"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u793a\u4f8b\u4ee3\u7801\u3011"}),"\n",(0,i.jsxs)(n.p,{children:["\u53c2\u8003 ",(0,i.jsx)(n.a,{href:"#hb_mm_mc_get_longterm_ref_mode",children:"hb_mm_mc_get_longterm_ref_mode"})]}),"\n",(0,i.jsx)(n.h4,{id:"hb_mm_mc_get_intra_refresh_config",children:"hb_mm_mc_get_intra_refresh_config"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u51fd\u6570\u58f0\u660e\u3011"}),"\n",(0,i.jsx)(n.p,{children:"hb_s32 hb_mm_mc_get_intra_refresh_config(media_codec_context_t\n*context, mc_video_intra_refresh_params_t *params)"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u53c2\u6570\u63cf\u8ff0\u3011"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"[IN] media_codec_context_t *context\uff1a\u6307\u5b9acodec\u7c7b\u578b\u7684context"}),"\n",(0,i.jsx)(n.li,{children:"[OUT] mc_video_intra_refresh_params_t *params\uff1a\u5e27\u5185\u5237\u65b0\u53c2\u6570"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u8fd4\u56de\u503c\u3011"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"0\uff1a\u64cd\u4f5c\u6210\u529f"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_UNKNOWN\uff1a \u672a\u77e5\u9519\u8bef"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_INVALID_INSTANCE\uff1a\u65e0\u6548\u5b9e\u4f8b"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_INVALID_PARAMS\uff1a\u65e0\u6548\u53c2\u6570"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u529f\u80fd\u63cf\u8ff0\u3011"}),"\n",(0,i.jsx)(n.p,{children:"\u83b7\u53d6\u5e27\u5185\u5237\u65b0\u53c2\u6570\uff0c\u9002\u7528\u4e8eH264/H265\u3002"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u793a\u4f8b\u4ee3\u7801\u3011"}),"\n",(0,i.jsxs)(n.p,{children:["\u53c2\u8003 ",(0,i.jsx)(n.a,{href:"#hb_mm_mc_get_longterm_ref_mode",children:"hb_mm_mc_get_longterm_ref_mode"})]}),"\n",(0,i.jsx)(n.h4,{id:"hb_mm_mc_set_intra_refresh_config",children:"hb_mm_mc_set_intra_refresh_config"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u51fd\u6570\u58f0\u660e\u3011"}),"\n",(0,i.jsx)(n.p,{children:"hb_s32 hb_mm_mc_set_intra_refresh_config(media_codec_context_t\n*context, const mc_video_intra_refresh_params_t *params)"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u53c2\u6570\u63cf\u8ff0\u3011"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"[IN] media_codec_context_t *context\uff1a\u6307\u5b9acodec\u7c7b\u578b\u7684context"}),"\n",(0,i.jsx)(n.li,{children:"[IN] const mc_video_intra_refresh_params_t\n*params\uff1a\u5e27\u5185\u5237\u65b0\u53c2\u6570"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u8fd4\u56de\u503c\u3011"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"0\uff1a\u64cd\u4f5c\u6210\u529f"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_UNKNOWN\uff1a \u672a\u77e5\u9519\u8bef"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_OPERATION_NOT_ALLOWED\uff1a\u64cd\u4f5c\u4e0d\u5141\u8bb8"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_INVALID_INSTANCE\uff1a\u65e0\u6548\u5b9e\u4f8b"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_INVALID_PARAMS\uff1a\u65e0\u6548\u53c2\u6570"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u529f\u80fd\u63cf\u8ff0\u3011"}),"\n",(0,i.jsx)(n.p,{children:"\u8bbe\u7f6e\u5e27\u5185\u5237\u65b0\u6a21\u5f0f\u53c2\u6570\uff0c\u8be5\u53c2\u6570\u4e3a\u9759\u6001\u53c2\u6570\uff0c\u9002\u7528\u4e8eH264/H265\u3002"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u793a\u4f8b\u4ee3\u7801\u3011"}),"\n",(0,i.jsxs)(n.p,{children:["\u53c2\u8003 ",(0,i.jsx)(n.a,{href:"#hb_mm_mc_get_longterm_ref_mode",children:"hb_mm_mc_get_longterm_ref_mode"})]}),"\n",(0,i.jsx)(n.h4,{id:"hb_mm_mc_get_rate_control_config",children:"hb_mm_mc_get_rate_control_config"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u51fd\u6570\u58f0\u660e\u3011"}),"\n",(0,i.jsx)(n.p,{children:"hb_s32 hb_mm_mc_get_rate_control_config(media_codec_context_t\n*context, mc_rate_control_params_t *params)"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u53c2\u6570\u63cf\u8ff0\u3011"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"[IN] media_codec_context_t *context\uff1a\u6307\u5b9acodec\u7c7b\u578b\u7684context"}),"\n",(0,i.jsx)(n.li,{children:"[OUT] mc_rate_control_params_t *params\uff1a\u7801\u7387\u63a7\u5236\u53c2\u6570"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u8fd4\u56de\u503c\u3011"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"0\uff1a\u64cd\u4f5c\u6210\u529f"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_UNKNOWN\uff1a \u672a\u77e5\u9519\u8bef"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_INVALID_INSTANCE\uff1a\u65e0\u6548\u5b9e\u4f8b"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_INVALID_PARAMS\uff1a\u65e0\u6548\u53c2\u6570"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u529f\u80fd\u63cf\u8ff0\u3011"}),"\n",(0,i.jsx)(n.p,{children:"\u83b7\u53d6\u7801\u7387\u63a7\u5236\u53c2\u6570\uff0c\u8be5\u53c2\u6570\u4e3a\u52a8\u6001\u53c2\u6570\uff0c\u9002\u7528\u4e8eH264/H265/MJPEG\u3002"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u793a\u4f8b\u4ee3\u7801\u3011"}),"\n",(0,i.jsxs)(n.p,{children:["\u53c2\u8003 ",(0,i.jsx)(n.a,{href:"#hb_mm_mc_get_longterm_ref_mode",children:"hb_mm_mc_get_longterm_ref_mode"})]}),"\n",(0,i.jsx)(n.h4,{id:"hb_mm_mc_set_rate_control_config",children:"hb_mm_mc_set_rate_control_config"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u51fd\u6570\u58f0\u660e\u3011"}),"\n",(0,i.jsx)(n.p,{children:"hb_s32 hb_mm_mc_set_rate_control_config(media_codec_context_t\n*context, const mc_rate_control_params_t *params)"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u53c2\u6570\u63cf\u8ff0\u3011"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"[IN] media_codec_context_t *context\uff1a\u6307\u5b9acodec\u7c7b\u578b\u7684context"}),"\n",(0,i.jsx)(n.li,{children:"[IN] const mc_rate_control_params_t *params\uff1a\u7801\u7387\u63a7\u5236\u53c2\u6570"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u8fd4\u56de\u503c\u3011"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"0\uff1a\u64cd\u4f5c\u6210\u529f"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_UNKNOWN\uff1a \u672a\u77e5\u9519\u8bef"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_OPERATION_NOT_ALLOWED\uff1a\u64cd\u4f5c\u4e0d\u5141\u8bb8"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_INVALID_INSTANCE\uff1a\u65e0\u6548\u5b9e\u4f8b"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_INVALID_PARAMS\uff1a\u65e0\u6548\u53c2\u6570"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u529f\u80fd\u63cf\u8ff0\u3011"}),"\n",(0,i.jsx)(n.p,{children:"\u8bbe\u7f6e\u7801\u7387\u63a7\u5236\u53c2\u6570\uff0c\u8be5\u53c2\u6570\u4e3a\u52a8\u6001\u53c2\u6570\uff0c\u9002\u7528\u4e8eH264/H265/MJPEG\u3002"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u793a\u4f8b\u4ee3\u7801\u3011"}),"\n",(0,i.jsxs)(n.p,{children:["\u53c2\u8003 ",(0,i.jsx)(n.a,{href:"#hb_mm_mc_get_longterm_ref_mode",children:"hb_mm_mc_get_longterm_ref_mode"})]}),"\n",(0,i.jsx)(n.h4,{id:"hb_mm_mc_get_deblk_filter_config",children:"hb_mm_mc_get_deblk_filter_config"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u51fd\u6570\u58f0\u660e\u3011"}),"\n",(0,i.jsx)(n.p,{children:"hb_s32 hb_mm_mc_get_deblk_filter_config(media_codec_context_t\n*context, mc_video_deblk_filter_params_t *params)"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u53c2\u6570\u63cf\u8ff0\u3011"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"[IN] media_codec_context_t *context\uff1a\u6307\u5b9acodec\u7c7b\u578b\u7684context"}),"\n",(0,i.jsx)(n.li,{children:"[OUT] mc_video_deblk_filter_params_t * params\uff1a\u53bb\u5757\u6ee4\u6ce2\u53c2\u6570"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u8fd4\u56de\u503c\u3011"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"0\uff1a\u64cd\u4f5c\u6210\u529f"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_UNKNOWN\uff1a \u672a\u77e5\u9519\u8bef"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_INVALID_INSTANCE\uff1a\u65e0\u6548\u5b9e\u4f8b"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_INVALID_PARAMS\uff1a\u65e0\u6548\u53c2\u6570"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u529f\u80fd\u63cf\u8ff0\u3011"}),"\n",(0,i.jsx)(n.p,{children:"\u83b7\u53d6\u53bb\u5757\u6ee4\u6ce2\u53c2\u6570\uff0c\u9002\u7528\u4e8eH264/H265\u3002"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u793a\u4f8b\u4ee3\u7801\u3011"}),"\n",(0,i.jsxs)(n.p,{children:["\u53c2\u8003 ",(0,i.jsx)(n.a,{href:"#hb_mm_mc_get_longterm_ref_mode",children:"hb_mm_mc_get_longterm_ref_mode"})]}),"\n",(0,i.jsx)(n.h4,{id:"hb_mm_mc_set_deblk_filter_config",children:"hb_mm_mc_set_deblk_filter_config"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u51fd\u6570\u58f0\u660e\u3011"}),"\n",(0,i.jsx)(n.p,{children:"hb_s32 hb_mm_mc_set_deblk_filter_config(media_codec_context_t\n*context, const mc_video_deblk_filter_params_t *params)"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u53c2\u6570\u63cf\u8ff0\u3011"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"[IN] media_codec_context_t *context\uff1a\u6307\u5b9acodec\u7c7b\u578b\u7684context"}),"\n",(0,i.jsx)(n.li,{children:"[IN] const mc_video_deblk_filter_params_t\n*params\uff1a\u53bb\u5757\u6ee4\u6ce2\u53c2\u6570"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u8fd4\u56de\u503c\u3011"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"0\uff1a\u64cd\u4f5c\u6210\u529f"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_UNKNOWN\uff1a \u672a\u77e5\u9519\u8bef"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_OPERATION_NOT_ALLOWED\uff1a\u64cd\u4f5c\u4e0d\u5141\u8bb8"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_INVALID_INSTANCE\uff1a\u65e0\u6548\u5b9e\u4f8b"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_INVALID_PARAMS\uff1a\u65e0\u6548\u53c2\u6570"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u529f\u80fd\u63cf\u8ff0\u3011"}),"\n",(0,i.jsx)(n.p,{children:"\u8bbe\u7f6e\u53bb\u5757\u6ee4\u6ce2\u53c2\u6570\uff0c\u8be5\u53c2\u6570\u4e3a\u52a8\u6001\u53c2\u6570\uff0c\u9002\u7528\u4e8eH264/H265\u3002"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u793a\u4f8b\u4ee3\u7801\u3011"}),"\n",(0,i.jsxs)(n.p,{children:["\u53c2\u8003 ",(0,i.jsx)(n.a,{href:"#hb_mm_mc_get_longterm_ref_mode",children:"hb_mm_mc_get_longterm_ref_mode"})]}),"\n",(0,i.jsx)(n.h4,{id:"hb_mm_mc_get_sao_config",children:"hb_mm_mc_get_sao_config"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u51fd\u6570\u58f0\u660e\u3011"}),"\n",(0,i.jsx)(n.p,{children:"hb_s32 hb_mm_mc_get_sao_config(media_codec_context_t *context,\nmc_h265_sao_params_t *params)"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u53c2\u6570\u63cf\u8ff0\u3011"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"[IN] media_codec_context_t *context\uff1a\u6307\u5b9acodec\u7c7b\u578b\u7684context"}),"\n",(0,i.jsx)(n.li,{children:"[OUT] mc_h265_sao_params_t *params\uff1aSAO\u53c2\u6570"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u8fd4\u56de\u503c\u3011"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"0\uff1a\u64cd\u4f5c\u6210\u529f"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_UNKNOWN\uff1a \u672a\u77e5\u9519\u8bef"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_INVALID_INSTANCE\uff1a\u65e0\u6548\u5b9e\u4f8b"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_INVALID_PARAMS\uff1a\u65e0\u6548\u53c2\u6570"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u529f\u80fd\u63cf\u8ff0\u3011"}),"\n",(0,i.jsx)(n.p,{children:"\u83b7\u53d6SAO\u53c2\u6570\uff0c\u9002\u7528\u4e8eH265\u3002"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u793a\u4f8b\u4ee3\u7801\u3011"}),"\n",(0,i.jsxs)(n.p,{children:["\u53c2\u8003 ",(0,i.jsx)(n.a,{href:"#hb_mm_mc_get_longterm_ref_mode",children:"hb_mm_mc_get_longterm_ref_mode"})]}),"\n",(0,i.jsx)(n.h4,{id:"hb_mm_mc_set_sao_config",children:"hb_mm_mc_set_sao_config"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u51fd\u6570\u58f0\u660e\u3011"}),"\n",(0,i.jsx)(n.p,{children:"hb_s32 hb_mm_mc_set_sao_config(media_codec_context_t *context,\nconst mc_h265_sao_params_t *params)"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u53c2\u6570\u63cf\u8ff0\u3011"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"[IN] media_codec_context_t *context\uff1a\u6307\u5b9acodec\u7c7b\u578b\u7684context"}),"\n",(0,i.jsx)(n.li,{children:"[IN] const mc_h265_sao_params_t *params\uff1aSAO\u53c2\u6570"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u8fd4\u56de\u503c\u3011"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"0\uff1a\u64cd\u4f5c\u6210\u529f"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_UNKNOWN\uff1a \u672a\u77e5\u9519\u8bef"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_OPERATION_NOT_ALLOWED\uff1a\u64cd\u4f5c\u4e0d\u5141\u8bb8"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_INVALID_INSTANCE\uff1a\u65e0\u6548\u5b9e\u4f8b"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_INVALID_PARAMS\uff1a\u65e0\u6548\u53c2\u6570"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u529f\u80fd\u63cf\u8ff0\u3011"}),"\n",(0,i.jsx)(n.p,{children:"\u8bbe\u7f6eSAO\u53c2\u6570\uff0c\u8be5\u53c2\u6570\u4e3a\u9759\u6001\u53c2\u6570\uff0c\u9002\u7528\u4e8eH265\u3002"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u793a\u4f8b\u4ee3\u7801\u3011"}),"\n",(0,i.jsxs)(n.p,{children:["\u53c2\u8003 ",(0,i.jsx)(n.a,{href:"#hb_mm_mc_get_longterm_ref_mode",children:"hb_mm_mc_get_longterm_ref_mode"})]}),"\n",(0,i.jsx)(n.h4,{id:"hb_mm_mc_get_entropy_config",children:"hb_mm_mc_get_entropy_config"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u51fd\u6570\u58f0\u660e\u3011"}),"\n",(0,i.jsx)(n.p,{children:"hb_s32 hb_mm_mc_get_entropy_config(media_codec_context_t\n*context, mc_h264_entropy_params_t *params);"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u53c2\u6570\u63cf\u8ff0\u3011"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"[IN] media_codec_context_t *context\uff1a\u6307\u5b9acodec\u7c7b\u578b\u7684context"}),"\n",(0,i.jsx)(n.li,{children:"[IN] mc_h264_entropy_params_t *params\uff1aentropy\u53c2\u6570"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u8fd4\u56de\u503c\u3011"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"0\uff1a\u64cd\u4f5c\u6210\u529f"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_UNKNOWN\uff1a \u672a\u77e5\u9519\u8bef"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_OPERATION_NOT_ALLOWED\uff1a\u64cd\u4f5c\u4e0d\u5141\u8bb8"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_INVALID_INSTANCE\uff1a\u65e0\u6548\u5b9e\u4f8b"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_INVALID_PARAMS\uff1a\u65e0\u6548\u53c2\u6570"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u529f\u80fd\u63cf\u8ff0\u3011"}),"\n",(0,i.jsx)(n.p,{children:"\u83b7\u53d6entropy\u53c2\u6570\uff0c\u9002\u7528\u4e8eH264\u3002"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u793a\u4f8b\u4ee3\u7801\u3011"}),"\n",(0,i.jsxs)(n.p,{children:["\u53c2\u8003 ",(0,i.jsx)(n.a,{href:"#hb_mm_mc_get_longterm_ref_mode",children:"hb_mm_mc_get_longterm_ref_mode"})]}),"\n",(0,i.jsx)(n.h4,{id:"hb_mm_mc_set_entropy_config",children:"hb_mm_mc_set_entropy_config"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u51fd\u6570\u58f0\u660e\u3011"}),"\n",(0,i.jsx)(n.p,{children:"extern hb_s32 hb_mm_mc_set_entropy_config(media_codec_context_t\n*context, const mc_h264_entropy_params_t *params);"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u53c2\u6570\u63cf\u8ff0\u3011"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"[IN] media_codec_context_t *context\uff1a\u6307\u5b9acodec\u7c7b\u578b\u7684context"}),"\n",(0,i.jsx)(n.li,{children:"[IN] const mc_h264_entropy_params_t *params\uff1aentropy\u6570"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u8fd4\u56de\u503c\u3011"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"0\uff1a\u64cd\u4f5c\u6210\u529f"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_UNKNOWN\uff1a \u672a\u77e5\u9519\u8bef"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_OPERATION_NOT_ALLOWED\uff1a\u64cd\u4f5c\u4e0d\u5141\u8bb8"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_INVALID_INSTANCE\uff1a\u65e0\u6548\u5b9e\u4f8b"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_INVALID_PARAMS\uff1a\u65e0\u6548\u53c2\u6570"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u529f\u80fd\u63cf\u8ff0\u3011"}),"\n",(0,i.jsx)(n.p,{children:"\u8bbe\u7f6eentropy\u53c2\u6570\uff0c\u9002\u7528\u4e8eH264\u3002"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u793a\u4f8b\u4ee3\u7801\u3011"}),"\n",(0,i.jsxs)(n.p,{children:["\u53c2\u8003 ",(0,i.jsx)(n.a,{href:"#hb_mm_mc_get_longterm_ref_mode",children:"hb_mm_mc_get_longterm_ref_mode"})]}),"\n",(0,i.jsx)(n.h4,{id:"hb_mm_mc_get_vui_timing_config",children:"hb_mm_mc_get_vui_timing_config"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u51fd\u6570\u58f0\u660e\u3011"}),"\n",(0,i.jsx)(n.p,{children:"hb_s32 hb_mm_mc_get_vui_timing_config(media_codec_context_t\n*context, mc_video_vui_timing_params_t *params)"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u53c2\u6570\u63cf\u8ff0\u3011"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"[IN] media_codec_context_t *context\uff1a\u6307\u5b9acodec\u7c7b\u578b\u7684context"}),"\n",(0,i.jsx)(n.li,{children:"[OUT] mc_video_vui_timing_params_t *params\uff1aVUI Timing\u53c2\u6570"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u8fd4\u56de\u503c\u3011"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"0\uff1a\u64cd\u4f5c\u6210\u529f"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_UNKNOWN\uff1a \u672a\u77e5\u9519\u8bef"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_INVALID_INSTANCE\uff1a\u65e0\u6548\u5b9e\u4f8b"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_INVALID_PARAMS\uff1a\u65e0\u6548\u53c2\u6570"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u529f\u80fd\u63cf\u8ff0\u3011"}),"\n",(0,i.jsx)(n.p,{children:"\u83b7\u53d6VUI Timing\u53c2\u6570\uff0c\u9002\u7528\u4e8eH264/H265\u3002"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u793a\u4f8b\u4ee3\u7801\u3011"}),"\n",(0,i.jsxs)(n.p,{children:["\u53c2\u8003 ",(0,i.jsx)(n.a,{href:"#hb_mm_mc_get_longterm_ref_mode",children:"hb_mm_mc_get_longterm_ref_mode"})]}),"\n",(0,i.jsx)(n.h4,{id:"hb_mm_mc_set_vui_timing_config",children:"hb_mm_mc_set_vui_timing_config"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u51fd\u6570\u58f0\u660e\u3011"}),"\n",(0,i.jsx)(n.p,{children:"hb_s32 hb_mm_mc_set_vui_timing_config(media_codec_context_t\n*context, const mc_video_vui_timing_params_t *params)"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u53c2\u6570\u63cf\u8ff0\u3011"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"[IN] media_codec_context_t *context\uff1a\u6307\u5b9acodec\u7c7b\u578b\u7684context"}),"\n",(0,i.jsx)(n.li,{children:"[IN] const mc_video_vui_timing_params_t *params\uff1aVUI\nTiming\u53c2\u6570"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u8fd4\u56de\u503c\u3011"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"0\uff1a\u64cd\u4f5c\u6210\u529f"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_UNKNOWN\uff1a \u672a\u77e5\u9519\u8bef"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_OPERATION_NOT_ALLOWED\uff1a\u64cd\u4f5c\u4e0d\u5141\u8bb8"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_INVALID_INSTANCE\uff1a\u65e0\u6548\u5b9e\u4f8b"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_INVALID_PARAMS\uff1a\u65e0\u6548\u53c2\u6570"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u529f\u80fd\u63cf\u8ff0\u3011"}),"\n",(0,i.jsx)(n.p,{children:"\u8bbe\u7f6eVUI Timing\u53c2\u6570\uff0c\u8be5\u53c2\u6570\u4e3a\u9759\u6001\u53c2\u6570\uff0c\u9002\u7528\u4e8eH264/H265\u3002"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u793a\u4f8b\u4ee3\u7801\u3011"}),"\n",(0,i.jsxs)(n.p,{children:["\u53c2\u8003 ",(0,i.jsx)(n.a,{href:"#hb_mm_mc_get_longterm_ref_mode",children:"hb_mm_mc_get_longterm_ref_mode"})]}),"\n",(0,i.jsx)(n.h4,{id:"hb_mm_mc_get_slice_config",children:"hb_mm_mc_get_slice_config"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u51fd\u6570\u58f0\u660e\u3011"}),"\n",(0,i.jsx)(n.p,{children:"hb_s32 hb_mm_mc_get_slice_config(media_codec_context_t\n*context, mc_video_slice_params_t *params)"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u53c2\u6570\u63cf\u8ff0\u3011"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"[IN] media_codec_context_t *context\uff1a\u6307\u5b9acodec\u7c7b\u578b\u7684context"}),"\n",(0,i.jsx)(n.li,{children:"[OUT] mc_video_slice_params_t *params\uff1aslice\u7f16\u7801\u53c2\u6570"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u8fd4\u56de\u503c\u3011"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"0\uff1a\u64cd\u4f5c\u6210\u529f"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_UNKNOWN\uff1a \u672a\u77e5\u9519\u8bef"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_INVALID_INSTANCE\uff1a\u65e0\u6548\u5b9e\u4f8b"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_INVALID_PARAMS\uff1a\u65e0\u6548\u53c2\u6570"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u529f\u80fd\u63cf\u8ff0\u3011"}),"\n",(0,i.jsx)(n.p,{children:"\u83b7\u53d6slice\u7f16\u7801\u53c2\u6570\uff0c\u9002\u7528\u4e8eH264/H265\u3002"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u793a\u4f8b\u4ee3\u7801\u3011"}),"\n",(0,i.jsxs)(n.p,{children:["\u53c2\u8003 ",(0,i.jsx)(n.a,{href:"#hb_mm_mc_get_longterm_ref_mode",children:"hb_mm_mc_get_longterm_ref_mode"})]}),"\n",(0,i.jsx)(n.h4,{id:"hb_mm_mc_set_slice_config",children:"hb_mm_mc_set_slice_config"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u51fd\u6570\u58f0\u660e\u3011"}),"\n",(0,i.jsx)(n.p,{children:"hb_s32 hb_mm_mc_set_slice_config(media_codec_context_t\n*context, const mc_video_slice_params_t *params)"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u53c2\u6570\u63cf\u8ff0\u3011"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"[IN] media_codec_context_t *context\uff1a\u6307\u5b9acodec\u7c7b\u578b\u7684context"}),"\n",(0,i.jsx)(n.li,{children:"[IN] const mc_video_slice_params_t *params\uff1aslice\u7f16\u7801\u53c2\u6570"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u8fd4\u56de\u503c\u3011"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"0\uff1a\u64cd\u4f5c\u6210\u529f"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_UNKNOWN\uff1a \u672a\u77e5\u9519\u8bef"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_OPERATION_NOT_ALLOWED\uff1a\u64cd\u4f5c\u4e0d\u5141\u8bb8"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_INVALID_INSTANCE\uff1a\u65e0\u6548\u5b9e\u4f8b"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_INVALID_PARAMS\uff1a\u65e0\u6548\u53c2\u6570"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u529f\u80fd\u63cf\u8ff0\u3011"}),"\n",(0,i.jsx)(n.p,{children:"\u8bbe\u7f6eslice\u7f16\u7801\u53c2\u6570\uff0c\u8be5\u53c2\u6570\u4e3a\u52a8\u6001\u53c2\u6570\uff0c\u9002\u7528\u4e8eH264/H265\u3002\u9650\u5236\u6bcf\u5e27slice\u4e2a\u6570\u5c0f\u4e8e\u7b49\u4e8e1500\u3002"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u793a\u4f8b\u4ee3\u7801\u3011"}),"\n",(0,i.jsxs)(n.p,{children:["\u53c2\u8003 ",(0,i.jsx)(n.a,{href:"#hb_mm_mc_get_longterm_ref_mode",children:"hb_mm_mc_get_longterm_ref_mode"})]}),"\n",(0,i.jsx)(n.h4,{id:"hb_mm_mc_insert_user_data",children:"hb_mm_mc_insert_user_data"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u51fd\u6570\u58f0\u660e\u3011"}),"\n",(0,i.jsx)(n.p,{children:"hb_s32 hb_mm_mc_insert_user_data(media_codec_context_t *\ncontext, hb_u8 *data, hb_u32 length)"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u53c2\u6570\u63cf\u8ff0\u3011"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"[IN] media_codec_context_t *context\uff1a\u6307\u5b9acodec\u7c7b\u578b\u7684context"}),"\n",(0,i.jsx)(n.li,{children:"[IN] hb_u8 *data\uff1a\u7528\u6237\u6570\u636e"}),"\n",(0,i.jsx)(n.li,{children:"[IN] hb_u32 length\uff1a\u7528\u6237\u6570\u636e\u957f\u5ea6"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u8fd4\u56de\u503c\u3011"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"0\uff1a\u64cd\u4f5c\u6210\u529f"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_UNKNOWN\uff1a \u672a\u77e5\u9519\u8bef"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_INVALID_INSTANCE\uff1a\u65e0\u6548\u5b9e\u4f8b"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_INVALID_PARAMS\uff1a\u65e0\u6548\u53c2\u6570"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u529f\u80fd\u63cf\u8ff0\u3011"}),"\n",(0,i.jsx)(n.p,{children:"\u5728\u7f16\u7801\u6d41\u4e2d\u63d2\u5165\u7528\u6237\u6570\u636e\uff0c\u8be5\u53c2\u6570\u4e3a\u52a8\u6001\u53c2\u6570\uff0c\u9002\u7528\u4e8eH264/H265/MJPG/JPG\u3002"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u793a\u4f8b\u4ee3\u7801\u3011"}),"\n",(0,i.jsxs)(n.p,{children:["\u53c2\u8003 ",(0,i.jsx)(n.a,{href:"#hb_mm_mc_get_longterm_ref_mode",children:"hb_mm_mc_get_longterm_ref_mode"})]}),"\n",(0,i.jsx)(n.h4,{id:"hb_mm_mc_request_idr_frame",children:"hb_mm_mc_request_idr_frame"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u51fd\u6570\u58f0\u660e\u3011"}),"\n",(0,i.jsx)(n.p,{children:"hb_s32 hb_mm_mc_request_idr_frame(media_codec_context_t\n*context)"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u53c2\u6570\u63cf\u8ff0\u3011"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"[IN] media_codec_context_t *context\uff1a\u6307\u5b9acodec\u7c7b\u578b\u7684context"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u8fd4\u56de\u503c\u3011"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"0\uff1a\u64cd\u4f5c\u6210\u529f"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_UNKNOWN\uff1a \u672a\u77e5\u9519\u8bef"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_OPERATION_NOT_ALLOWED\uff1a\u64cd\u4f5c\u4e0d\u5141\u8bb8"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_INVALID_INSTANCE\uff1a\u65e0\u6548\u5b9e\u4f8b"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u529f\u80fd\u63cf\u8ff0\u3011"}),"\n",(0,i.jsx)(n.p,{children:"\u8bf7\u6c42IDR\u5e27\uff0c\u8be5\u63a5\u53e3\u53ef\u52a8\u6001\u8bbe\u7f6e\uff0c\u9002\u7528\u4e8eH264/H265\u3002"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u793a\u4f8b\u4ee3\u7801\u3011"}),"\n",(0,i.jsxs)(n.p,{children:["\u53c2\u8003 ",(0,i.jsx)(n.a,{href:"#hb_mm_mc_get_longterm_ref_mode",children:"hb_mm_mc_get_longterm_ref_mode"})]}),"\n",(0,i.jsx)(n.h4,{id:"hb_mm_mc_skip_pic",children:"hb_mm_mc_skip_pic"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u51fd\u6570\u58f0\u660e\u3011"}),"\n",(0,i.jsx)(n.p,{children:"hb_s32 hb_mm_mc_skip_pic(media_codec_context_t\n*context\uff0chb_s32 src_idx)"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u53c2\u6570\u63cf\u8ff0\u3011"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"[IN] media_codec_context_t *context\uff1a\u6307\u5b9acodec\u7c7b\u578b\u7684context"}),"\n",(0,i.jsx)(n.li,{children:"[IN] hb_s32 src_idx\uff1asource buffer\u7d22\u5f15\u503c"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u8fd4\u56de\u503c\u3011"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"0\uff1a\u64cd\u4f5c\u6210\u529f"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_UNKNOWN\uff1a \u672a\u77e5\u9519\u8bef"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_OPERATION_NOT_ALLOWED\uff1a\u64cd\u4f5c\u4e0d\u5141\u8bb8"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_INVALID_INSTANCE\uff1a\u65e0\u6548\u5b9e\u4f8b"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_INVALID_PARAMS\uff1a\u65e0\u6548\u53c2\u6570"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u529f\u80fd\u63cf\u8ff0\u3011"}),"\n",(0,i.jsx)(n.p,{children:"\u4f7f\u80fd\u6307\u5b9a\u7684\u56fe\u50cf\u7684skip\u6a21\u5f0f\u7f16\u7801\uff0c\u8be5\u63a5\u53e3\u53ef\u52a8\u6001\u8bbe\u7f6e\uff0c\u9002\u7528\u4e8eH264/H265\u3002"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u793a\u4f8b\u4ee3\u7801\u3011"}),"\n",(0,i.jsxs)(n.p,{children:["\u53c2\u8003 ",(0,i.jsx)(n.a,{href:"#hb_mm_mc_get_longterm_ref_mode",children:"hb_mm_mc_get_longterm_ref_mode"})]}),"\n",(0,i.jsx)(n.h4,{id:"hb_mm_mc_get_smart_bg_enc_config",children:"hb_mm_mc_get_smart_bg_enc_config"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u51fd\u6570\u58f0\u660e\u3011"}),"\n",(0,i.jsx)(n.p,{children:"extern hb_s32\nhb_mm_mc_get_smart_bg_enc_config(media_codec_context_t\n*context, mc_video_smart_bg_enc_params_t *params);"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u53c2\u6570\u63cf\u8ff0\u3011"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"[IN] media_codec_context_t *context\uff1a\u6307\u5b9acodec\u7c7b\u578b\u7684context"}),"\n",(0,i.jsx)(n.li,{children:"[OUT] mc_video_smart_bg_enc_params_t\n*params\uff1a\u667a\u80fd\u80cc\u666f\u7f16\u7801\u6a21\u5f0f\u53c2\u6570"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u8fd4\u56de\u503c\u3011"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"0\uff1a\u64cd\u4f5c\u6210\u529f"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_UNKNOWN\uff1a \u672a\u77e5\u9519\u8bef"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_INVALID_INSTANCE\uff1a\u65e0\u6548\u5b9e\u4f8b"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_INVALID_PARAMS\uff1a\u65e0\u6548\u53c2\u6570"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u529f\u80fd\u63cf\u8ff0\u3011"}),"\n",(0,i.jsx)(n.p,{children:"\u83b7\u53d6\u667a\u80fd\u80cc\u666f\u7f16\u7801\u53c2\u6570\uff0c\u9002\u7528\u4e8eH264/H265\u3002"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u793a\u4f8b\u4ee3\u7801\u3011"}),"\n",(0,i.jsxs)(n.p,{children:["\u53c2\u8003 ",(0,i.jsx)(n.a,{href:"#hb_mm_mc_get_longterm_ref_mode",children:"hb_mm_mc_get_longterm_ref_mode"})]}),"\n",(0,i.jsx)(n.h4,{id:"hb_mm_mc_set_smart_bg_enc_config",children:"hb_mm_mc_set_smart_bg_enc_config"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u51fd\u6570\u58f0\u660e\u3011"}),"\n",(0,i.jsx)(n.p,{children:"hb_s32 hb_mm_mc_set_smart_bg_enc_config(media_codec_context_t\n*context, const mc_video_smart_bg_enc_params_t *params);"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u53c2\u6570\u63cf\u8ff0\u3011"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"[IN] media_codec_context_t *context\uff1a\u6307\u5b9acodec\u7c7b\u578b\u7684context"}),"\n",(0,i.jsx)(n.li,{children:"[IN] const mc_video_smart_bg_enc_params_t\n*params\uff1a\u667a\u80fd\u80cc\u666f\u7f16\u7801\u6a21\u5f0f\u53c2\u6570"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u8fd4\u56de\u503c\u3011"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"0\uff1a\u64cd\u4f5c\u6210\u529f"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_UNKNOWN\uff1a \u672a\u77e5\u9519\u8bef"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_OPERATION_NOT_ALLOWED\uff1a\u64cd\u4f5c\u4e0d\u5141\u8bb8"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_INVALID_INSTANCE\uff1a\u65e0\u6548\u5b9e\u4f8b"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_INVALID_PARAMS\uff1a\u65e0\u6548\u53c2\u6570"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u529f\u80fd\u63cf\u8ff0\u3011"}),"\n",(0,i.jsx)(n.p,{children:"\u8bbe\u7f6e\u667a\u80fd\u80cc\u666f\u7f16\u7801\u53c2\u6570\uff0c\u8be5\u53c2\u6570\u4e3a\u52a8\u6001\u53c2\u6570\uff0c\u9002\u7528\u4e8eH264/H265\u3002"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u793a\u4f8b\u4ee3\u7801\u3011"}),"\n",(0,i.jsxs)(n.p,{children:["\u53c2\u8003 ",(0,i.jsx)(n.a,{href:"#hb_mm_mc_get_longterm_ref_mode",children:"hb_mm_mc_get_longterm_ref_mode"})]}),"\n",(0,i.jsx)(n.h4,{id:"hb_mm_mc_get_pred_unit_config",children:"hb_mm_mc_get_pred_unit_config"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u51fd\u6570\u58f0\u660e\u3011"}),"\n",(0,i.jsx)(n.p,{children:"hb_s32 hb_mm_mc_get_pred_unit_config(media_codec_context_t\n*context, mc_video_pred_unit_params_t *params)"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u53c2\u6570\u63cf\u8ff0\u3011"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"[IN] media_codec_context_t *context\uff1a\u6307\u5b9acodec\u7c7b\u578b\u7684context"}),"\n",(0,i.jsx)(n.li,{children:"[OUT] mc_video_pred_unit_params_t *params\uff1a\u9884\u6d4b\u5355\u5143\u53c2\u6570"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u8fd4\u56de\u503c\u3011"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"0\uff1a\u64cd\u4f5c\u6210\u529f"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_UNKNOWN\uff1a \u672a\u77e5\u9519\u8bef"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_INVALID_INSTANCE\uff1a\u65e0\u6548\u5b9e\u4f8b"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_INVALID_PARAMS\uff1a\u65e0\u6548\u53c2\u6570"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u529f\u80fd\u63cf\u8ff0\u3011"}),"\n",(0,i.jsx)(n.p,{children:"\u83b7\u53d6\u9884\u6d4b\u5355\u5143\u53c2\u6570\uff0c\u9002\u7528\u4e8eH264/H265\u3002"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u793a\u4f8b\u4ee3\u7801\u3011"}),"\n",(0,i.jsxs)(n.p,{children:["\u53c2\u8003 ",(0,i.jsx)(n.a,{href:"#hb_mm_mc_get_longterm_ref_mode",children:"hb_mm_mc_get_longterm_ref_mode"})]}),"\n",(0,i.jsx)(n.h4,{id:"hb_mm_mc_set_pred_unit_config",children:"hb_mm_mc_set_pred_unit_config"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u51fd\u6570\u58f0\u660e\u3011"}),"\n",(0,i.jsx)(n.p,{children:"hb_s32 hb_mm_mc_set_pred_unit_config(media_codec_context_t\n*context, const mc_video_pred_unit_params_t *params)"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u53c2\u6570\u63cf\u8ff0\u3011"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"[IN] media_codec_context_t *context\uff1a\u6307\u5b9acodec\u7c7b\u578b\u7684context"}),"\n",(0,i.jsx)(n.li,{children:"[IN] const mc_video_pred_unit_params_t *params\uff1a\u9884\u6d4b\u5355\u5143\u53c2\u6570"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u8fd4\u56de\u503c\u3011"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"0\uff1a\u64cd\u4f5c\u6210\u529f"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_UNKNOWN\uff1a \u672a\u77e5\u9519\u8bef"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_OPERATION_NOT_ALLOWED\uff1a\u64cd\u4f5c\u4e0d\u5141\u8bb8"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_INVALID_INSTANCE\uff1a\u65e0\u6548\u5b9e\u4f8b"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_INVALID_PARAMS\uff1a\u65e0\u6548\u53c2\u6570"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u529f\u80fd\u63cf\u8ff0\u3011"}),"\n",(0,i.jsx)(n.p,{children:"\u8bbe\u7f6e\u9884\u6d4b\u5355\u5143\u53c2\u6570\uff0c\u8be5\u53c2\u6570\u4e3a\u52a8\u6001\u53c2\u6570\uff0c\u9002\u7528\u4e8eH264/H265\u3002"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u793a\u4f8b\u4ee3\u7801\u3011"}),"\n",(0,i.jsxs)(n.p,{children:["\u53c2\u8003 ",(0,i.jsx)(n.a,{href:"#hb_mm_mc_get_longterm_ref_mode",children:"hb_mm_mc_get_longterm_ref_mode"})]}),"\n",(0,i.jsx)(n.h4,{id:"hb_mm_mc_get_transform_config",children:"hb_mm_mc_get_transform_config"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u51fd\u6570\u58f0\u660e\u3011"}),"\n",(0,i.jsx)(n.p,{children:"hb_s32 hb_mm_mc_get_transform_config(media_codec_context_t\n*context, mc_video_transform_params_t *params)"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u53c2\u6570\u63cf\u8ff0\u3011"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"[IN] media_codec_context_t *context\uff1a\u6307\u5b9acodec\u7c7b\u578b\u7684context"}),"\n",(0,i.jsx)(n.li,{children:"[OUT] mc_video_transform_params_t *params\uff1aTransform\u53c2\u6570"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u8fd4\u56de\u503c\u3011"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"0\uff1a\u64cd\u4f5c\u6210\u529f"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_UNKNOWN\uff1a \u672a\u77e5\u9519\u8bef"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_INVALID_INSTANCE\uff1a\u65e0\u6548\u5b9e\u4f8b"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_INVALID_PARAMS\uff1a\u65e0\u6548\u53c2\u6570"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u529f\u80fd\u63cf\u8ff0\u3011"}),"\n",(0,i.jsx)(n.p,{children:"\u83b7\u53d6Transform\u53c2\u6570\uff0c\u9002\u7528\u4e8eH264/H265\u3002"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u793a\u4f8b\u4ee3\u7801\u3011"}),"\n",(0,i.jsxs)(n.p,{children:["\u53c2\u8003 ",(0,i.jsx)(n.a,{href:"#hb_mm_mc_get_longterm_ref_mode",children:"hb_mm_mc_get_longterm_ref_mode"})]}),"\n",(0,i.jsx)(n.h4,{id:"hb_mm_mc_set_transform_config",children:"hb_mm_mc_set_transform_config"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u51fd\u6570\u58f0\u660e\u3011"}),"\n",(0,i.jsx)(n.p,{children:"hb_s32 hb_mm_mc_set_transform_config(media_codec_context_t\n*context, const mc_video_transform_params_t *params)"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u53c2\u6570\u63cf\u8ff0\u3011"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"[IN] media_codec_context_t *context\uff1a\u6307\u5b9acodec\u7c7b\u578b\u7684context"}),"\n",(0,i.jsx)(n.li,{children:"[IN] const mc_video_transform_params_t *params\uff1a\nTransform\u53c2\u6570"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u8fd4\u56de\u503c\u3011"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"0\uff1a\u64cd\u4f5c\u6210\u529f"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_UNKNOWN\uff1a \u672a\u77e5\u9519\u8bef"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_OPERATION_NOT_ALLOWED\uff1a\u64cd\u4f5c\u4e0d\u5141\u8bb8"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_INVALID_INSTANCE\uff1a\u65e0\u6548\u5b9e\u4f8b"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_INVALID_PARAMS\uff1a\u65e0\u6548\u53c2\u6570"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u529f\u80fd\u63cf\u8ff0\u3011"}),"\n",(0,i.jsx)(n.p,{children:"\u8bbe\u7f6eTransform\u53c2\u6570\uff0c\u8be5\u53c2\u6570\u4e3a\u52a8\u6001\u53c2\u6570\uff0c\u9002\u7528\u4e8eH264/H265\u3002"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u793a\u4f8b\u4ee3\u7801\u3011"}),"\n",(0,i.jsxs)(n.p,{children:["\u53c2\u8003 ",(0,i.jsx)(n.a,{href:"#hb_mm_mc_get_longterm_ref_mode",children:"hb_mm_mc_get_longterm_ref_mode"})]}),"\n",(0,i.jsx)(n.h4,{id:"hb_mm_mc_get_roi_config",children:"hb_mm_mc_get_roi_config"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u51fd\u6570\u58f0\u660e\u3011"}),"\n",(0,i.jsx)(n.p,{children:"hb_s32 hb_mm_mc_get_roi_config(media_codec_context_t *context,\nmc_video_roi_params_t *params)"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u53c2\u6570\u63cf\u8ff0\u3011"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"[IN] media_codec_context_t *context\uff1a\u6307\u5b9acodec\u7c7b\u578b\u7684context"}),"\n",(0,i.jsx)(n.li,{children:"[OUT] mc_video_roi_params_t *params\uff1aROI\u7f16\u7801\u53c2\u6570"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u8fd4\u56de\u503c\u3011"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"0\uff1a\u64cd\u4f5c\u6210\u529f"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_UNKNOWN\uff1a \u672a\u77e5\u9519\u8bef"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_INVALID_INSTANCE\uff1a\u65e0\u6548\u5b9e\u4f8b"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_INVALID_PARAMS\uff1a\u65e0\u6548\u53c2\u6570"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u529f\u80fd\u63cf\u8ff0\u3011"}),"\n",(0,i.jsx)(n.p,{children:"\u83b7\u53d6ROI\u7f16\u7801\u53c2\u6570\uff0c\u9002\u7528\u4e8eH264/H265\u3002"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u793a\u4f8b\u4ee3\u7801\u3011"}),"\n",(0,i.jsxs)(n.p,{children:["\u53c2\u8003 ",(0,i.jsx)(n.a,{href:"#hb_mm_mc_get_longterm_ref_mode",children:"hb_mm_mc_get_longterm_ref_mode"})]}),"\n",(0,i.jsx)(n.h4,{id:"hb_mm_mc_set_roi_config",children:"hb_mm_mc_set_roi_config"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u51fd\u6570\u58f0\u660e\u3011"}),"\n",(0,i.jsx)(n.p,{children:"hb_s32 hb_mm_mc_set_roi_config(media_codec_context_t *context,\nconst mc_video_roi_params_t *params)"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u53c2\u6570\u63cf\u8ff0\u3011"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"[IN] media_codec_context_t *context\uff1a\u6307\u5b9acodec\u7c7b\u578b\u7684context"}),"\n",(0,i.jsx)(n.li,{children:"[IN] const mc_video_roi_params_t *params\uff1aROI\u7f16\u7801\u53c2\u6570"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u8fd4\u56de\u503c\u3011"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"0\uff1a\u64cd\u4f5c\u6210\u529f"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_UNKNOWN\uff1a \u672a\u77e5\u9519\u8bef"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_OPERATION_NOT_ALLOWED\uff1a\u64cd\u4f5c\u4e0d\u5141\u8bb8"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_INVALID_INSTANCE\uff1a\u65e0\u6548\u5b9e\u4f8b"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_INVALID_PARAMS\uff1a\u65e0\u6548\u53c2\u6570"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u529f\u80fd\u63cf\u8ff0\u3011"}),"\n",(0,i.jsx)(n.p,{children:"\u8bbe\u7f6eROI\u7f16\u7801\u53c2\u6570\uff0c\u8be5\u53c2\u6570\u4e3a\u52a8\u6001\u53c2\u6570\uff0c\u9002\u7528\u4e8eH264/H265\u3002"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u793a\u4f8b\u4ee3\u7801\u3011"}),"\n",(0,i.jsxs)(n.p,{children:["\u53c2\u8003 ",(0,i.jsx)(n.a,{href:"#hb_mm_mc_get_longterm_ref_mode",children:"hb_mm_mc_get_longterm_ref_mode"})]}),"\n",(0,i.jsx)(n.h4,{id:"hb_mm_mc_get_mode_decision_config",children:"hb_mm_mc_get_mode_decision_config"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u51fd\u6570\u58f0\u660e\u3011"}),"\n",(0,i.jsx)(n.p,{children:"hb_s32 hb_mm_mc_get_mode_decision_config(media_codec_context_t\n*context, mc_video_mode_decision_params_t *params);"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u53c2\u6570\u63cf\u8ff0\u3011"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"[IN] media_codec_context_t *context\uff1a\u6307\u5b9acodec\u7c7b\u578b\u7684context"}),"\n",(0,i.jsx)(n.li,{children:"[OUT] mc_video_mode_decision_params_t *params\uff1a\u6a21\u5f0f\u51b3\u7b56\u53c2\u6570"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u8fd4\u56de\u503c\u3011"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"0\uff1a\u64cd\u4f5c\u6210\u529f"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_UNKNOWN\uff1a \u672a\u77e5\u9519\u8bef"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_INVALID_INSTANCE\uff1a\u65e0\u6548\u5b9e\u4f8b"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_INVALID_PARAMS\uff1a\u65e0\u6548\u53c2\u6570"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u529f\u80fd\u63cf\u8ff0\u3011"}),"\n",(0,i.jsx)(n.p,{children:"\u83b7\u53d6mode decision\u53c2\u6570\uff0c\u9002\u7528\u4e8eH265\u3002"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u793a\u4f8b\u4ee3\u7801\u3011"}),"\n",(0,i.jsxs)(n.p,{children:["\u53c2\u8003 ",(0,i.jsx)(n.a,{href:"#hb_mm_mc_get_longterm_ref_mode",children:"hb_mm_mc_get_longterm_ref_mode"})]}),"\n",(0,i.jsx)(n.h4,{id:"hb_mm_mc_set_mode_decision_config",children:"hb_mm_mc_set_mode_decision_config"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u51fd\u6570\u58f0\u660e\u3011"}),"\n",(0,i.jsx)(n.p,{children:"hb_s32 hb_mm_mc_set_mode_decision_config(media_codec_context_t\n*context, const mc_video_mode_decision_params_t *params);"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u53c2\u6570\u63cf\u8ff0\u3011"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"[IN] media_codec_context_t *context\uff1a\u6307\u5b9acodec\u7c7b\u578b\u7684context"}),"\n",(0,i.jsx)(n.li,{children:"[IN] const mc_video_mode_decision_params_t\n*params\uff1a\u6a21\u5f0f\u51b3\u7b56\u53c2\u6570"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u8fd4\u56de\u503c\u3011"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"0\uff1a\u64cd\u4f5c\u6210\u529f"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_UNKNOWN\uff1a \u672a\u77e5\u9519\u8bef"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_OPERATION_NOT_ALLOWED\uff1a\u64cd\u4f5c\u4e0d\u5141\u8bb8"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_INVALID_INSTANCE\uff1a\u65e0\u6548\u5b9e\u4f8b"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_INVALID_PARAMS\uff1a\u65e0\u6548\u53c2\u6570"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u529f\u80fd\u63cf\u8ff0\u3011"}),"\n",(0,i.jsx)(n.p,{children:"\u8bbe\u7f6e\u6a21\u5f0f\u51b3\u7b56\u53c2\u6570\uff0c\u8be5\u53c2\u6570\u4e3a\u52a8\u6001\u53c2\u6570\uff0c\u9002\u7528\u4e8eH265\u3002"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u793a\u4f8b\u4ee3\u7801\u3011"}),"\n",(0,i.jsxs)(n.p,{children:["\u53c2\u8003 ",(0,i.jsx)(n.a,{href:"#hb_mm_mc_get_longterm_ref_mode",children:"hb_mm_mc_get_longterm_ref_mode"})]}),"\n",(0,i.jsx)(n.h4,{id:"hb_mm_mc_get_user_data",children:"hb_mm_mc_get_user_data"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u51fd\u6570\u58f0\u660e\u3011"}),"\n",(0,i.jsx)(n.p,{children:"hb_s32 hb_mm_mc_get_user_data(media_codec_context_t *context,\nmc_user_data_buffer_t *params , hb_s32 timeout)"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u53c2\u6570\u63cf\u8ff0\u3011"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"[IN] media_codec_context_t *context\uff1a\u6307\u5b9acodec\u7c7b\u578b\u7684context"}),"\n",(0,i.jsx)(n.li,{children:"[OUT] mc_user_data_buffer_t *params\uff1a\u7528\u6237\u6570\u636e"}),"\n",(0,i.jsx)(n.li,{children:"[IN] timeout\uff1a\u8d85\u65f6\u65f6\u95f4"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u8fd4\u56de\u503c\u3011"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"0\uff1a\u64cd\u4f5c\u6210\u529f"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_UNKNOWN\uff1a \u672a\u77e5\u9519\u8bef"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_OPERATION_NOT_ALLOWED\uff1a\u64cd\u4f5c\u4e0d\u5141\u8bb8"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_INVALID_INSTANCE\uff1a\u65e0\u6548\u5b9e\u4f8b"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_INVALID_PARAMS\uff1a\u65e0\u6548\u53c2\u6570"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u529f\u80fd\u63cf\u8ff0\u3011"}),"\n",(0,i.jsx)(n.p,{children:"\u83b7\u53d6\u89e3\u7801\u6d41\u4e2d\u7684\u7528\u6237\u6570\u636e\uff0c\u9002\u7528\u4e8eH264/H265\u3002"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u793a\u4f8b\u4ee3\u7801\u3011"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:'#include "hb_media_codec.h"\n#include "hb_media_error.h"\nstatic int check_and_init_test(MediaCodecTestContext *ctx) {\n    int32_t ret = 0;\n    char *inputFileName, *outputFileName, *inputMd5FileName;\n    EXPECT_NE(ctx, nullptr);\n    EXPECT_NE(ctx->context, nullptr);\n    if (ctx == NULL || ctx->context == NULL) {\n        return -1;  \n    }\n    inputFileName = ctx->inputFileName;\n    outputFileName = ctx->outputFileName;\n    inputMd5FileName = ctx->inputMd5FileName;\n    printf("%s[%d:%d] Thread work in %s mode\\n", TAG, getpid(), gettid(),\n    ctx->workMode == THREAD_WORK_MODE_SYNC ? "sync" :\n        (ctx->workMode == THREAD_WORK_MODE_ASYNC ? "async" : "poll"));\n    printf("%s[%d:%d] InputFileName = %s\\n", TAG, getpid(), gettid(), inputFileName);\n    printf("%s[%d:%d] OutputFileName = %s\\n", TAG, getpid(), gettid(), outputFileName);\n    printf("%s[%d:%d] InputMd5File = %s\\n", TAG, getpid(), gettid(), inputMd5FileName);\n    EXPECT_NE(inputFileName, nullptr);\n    EXPECT_NE(outputFileName, nullptr);\n    if (inputFileName == NULL || outputFileName == NULL) {\n        return -1;\n    }\n    ctx->inFile = fopen(inputFileName, "rb");\n    EXPECT_NE(ctx->inFile, nullptr);\n    ctx->outFile = fopen(outputFileName, "wb+");\n    EXPECT_NE(ctx->outFile, nullptr);\n    if (ctx->inFile == NULL || ctx->outFile == NULL) {\n        return -1;\n    }\n    if (ctx->md5Test == TRUE) {\n        if (inputMd5FileName) {\n            ctx->inMd5File = fopen(inputMd5FileName, "rb");\n        }\n        EXPECT_NE(ctx->inMd5File, nullptr);\n        if (ctx->inMd5File == NULL) {\n            return -1;\n        }\n    }\n    // allocate ion buffers\n    ctx->ionFd = ion_open();\n    EXPECT_GT(ctx->ionFd, 0);\n    if (ctx->ionFd <= 0) {\n        return -1;\n    }\n    if (ctx->context->encoder == TRUE) {\n        printf("%s[%d:%d] Thread use %s buffer mode, %d rc mode\\n", TAG, getpid(), gettid(),\n        ctx->context->video_enc_params.external_frame_buf ?\n        "external" : "internal", \n        ctx->context->video_enc_params.rc_params.mode);\n        if (ctx->context->video_enc_params.external_frame_buf) {\n            ctx->exFb = (ExternalFrameBuffer *) malloc(\n            ctx->context->video_enc_params.frame_buf_count * sizeof(ExternalFrameBuffer));\n            EXPECT_NE(ctx->exFb, nullptr);\n            if (ctx->exFb == NULL) {\n                return -1;\n            }\n            for (Uint32 i=0; i<ctx->context->video_enc_params.frame_buf_count; i++) {\n                ctx->exFb[i].buf.size = ctx->context->video_enc_params.width\n                * ctx->context->video_enc_params.height * 3/2; // only for yuv420;\n                ret = allocate_ion_mem(ctx->ionFd, &ctx->exFb[i].buf);\n                EXPECT_EQ(ret, 0);\n                if (ret != 0) {\n                    return ret;\n                }\n                ctx->exFb[i].valid = 1;\n                ctx->exFb[i].src_idx = i;\n            }\n        }\n    } else {\n        printf("%s[%d:%d] Thread use %s buffer mode, %d feed mode.\\n", TAG, getpid(), gettid(),\n        ctx->context->video_dec_params.external_bitstream_buf ?\n        "external" : "internal",\n        ctx->context->video_dec_params.feed_mode);\n        if (ctx->context->video_dec_params.external_bitstream_buf) {\n            ctx->exBs = (ExternalStreamBuffer *) malloc(\n            ctx->context->video_dec_params.bitstream_buf_count * sizeof(ExternalStreamBuffer));\n            EXPECT_NE(ctx->exBs, nullptr);\n            if (ctx->exBs == NULL) {\n                return -1;\n            }\n            for (Uint32 i=0; i<ctx->context->video_dec_params.bitstream_buf_count; i++) {\n                ctx->exBs[i].buf.size = ctx->context->video_dec_params.bitstream_buf_size;\n                ret = allocate_ion_mem(ctx->ionFd, &ctx->exBs[i].buf);\n                EXPECT_EQ(ret, 0);\n                if (ret != 0) {\n                    return ret;\n                }\n                ctx->exBs[i].valid = 1;\n                ctx->exBs[i].src_idx = i;\n            }\n        }\n    }\n// open decode files\n    if (ctx->context->encoder != TRUE) {\n    if (ctx->context->video_dec_params.feed_mode == MC_FEEDING_MODE_FRAME_SIZE) {\n        ret = avformat_open_input(&ctx->avContext, ctx->inputFileName, 0, 0);\n        EXPECT_GE(ret, 0);\n        if (ret < 0) {\n            return ret;\n        }\n        ret = avformat_find_stream_info(ctx->avContext, 0);\n        EXPECT_GE(ret, 0);\n        if (ret < 0) {\n            return ret;\n        }\n        ctx->videoIndex = av_find_best_stream(ctx->avContext, AVMEDIA_TYPE_VIDEO, -1, -1, NULL, 0);\n        EXPECT_GE(ctx->videoIndex, 0);\n        if (ctx->videoIndex < 0) {\n            return -1;\n        }\n        av_init_packet(&ctx->avpacket);\n    } else {\n        if (ctx->feedingSize == 0) {\n            uint32_t KB = 1024;\n            int32_t probability10;\n            srand((uint32_t)time(NULL));\n            ctx->feedingSize = rand() % MAX_FEEDING_SIZE;\n            probability10 = (ctx->feedingSize % 100) < 10;\n            if (ctx->feedingSize < KB) {\n                if (probability10 == FALSE)\n                    ctx->feedingSize *= 100;\n                }\n            }\n            printf("%s[%d:%d] Feeding size = %d\\n", TAG,\n            getpid(), gettid(), ctx->feedingSize);\n        }\n        ctx->firstPacket = 1;\n    }\n    return 0;\n}\nstatic int check_and_release_test(MediaCodecTestContext *ctx) {\n    int32_t ret = 0;\n    int md5Match, wholeFileSize = 0;\n    uint8_t *md5Buffer = NULL;\n    EXPECT_NE(ctx, nullptr);\n    EXPECT_NE(ctx->context, nullptr);\n    EXPECT_NE(ctx->inFile, nullptr);\n    EXPECT_NE(ctx->outFile, nullptr);\n    if (ctx == NULL || ctx->context == NULL || ctx->inFile == NULL ||\n        ctx->outFile == NULL) {\n        return -1;\n    }\n    if (ctx->context->encoder != TRUE) {\n        if (ctx->context->video_dec_params.feed_mode == MC_FEEDING_MODE_FRAME_SIZE) {\n            if (ctx->avContext) {\n                avformat_close_input(&ctx->avContext);\n            }\n        }\n    }\n    if (ctx->context->encoder == TRUE) {\n        if (ctx->context->video_enc_params.external_frame_buf) {\n            if (ctx->exFb) {\n                for (Uint32 i=0; i<ctx->context->video_enc_params.frame_buf_count; i++) {\n                    ret = release_ion_mem(ctx->ionFd, &ctx->exFb[i].buf);\n                    EXPECT_EQ(ret, 0);\n                }\n                free(ctx->exFb);\n            }\n        }\n    } else {\n        if (ctx->context->video_dec_params.external_bitstream_buf) {\n            if (ctx->exBs) {\n                for (Uint32 i=0; i<ctx->context->video_dec_params.bitstream_buf_count; i++) {\n                    ret = release_ion_mem(ctx->ionFd, &ctx->exBs[i].buf);\n                    EXPECT_EQ(ret, 0);\n                }\n                free(ctx->exBs);\n            }\n        }\n    }\n    if (ctx->ionFd)\n        ion_close(ctx->ionFd);\n    if (ctx->md5Test && ctx->inMd5File) {\n        fseek(ctx->outFile, 0, SEEK_END);\n        wholeFileSize = ftell(ctx->outFile);\n        fseek(ctx->outFile, 0, SEEK_SET);\n        md5Buffer = (uint8_t *)malloc(wholeFileSize);\n        EXPECT_NE(md5Buffer, nullptr);\n        if (md5Buffer == NULL) {\n            return -1;\n        }\n        fread(md5Buffer, wholeFileSize, 1, ctx->outFile);\n        md5Match = compare_md5_value(MD5_SIZE, ctx->inMd5File,\n        md5Buffer, wholeFileSize);\n        free(md5Buffer);\n        fclose(ctx->inMd5File);\n        EXPECT_EQ(md5Match, 1);\n        if (md5Match != 1) {\n            return -1;\n        }\n    }\n    if (ctx->outFile)\n        fclose(ctx->outFile);\n    if (ctx->inFile)\n        fclose(ctx->inFile);\n    return 0;\n}\nstatic void on_vlc_buffer_message(hb_ptr userdata, hb_s32 * vlc_buf) {\n    MediaCodecTestContext *ctx = (MediaCodecTestContext *)userdata;\n    ASSERT_NE(vlc_buf, nullptr);\n    ASSERT_NE(ctx, nullptr);\n    ASSERT_GE(ctx->vlc_buf_size, 0);\n    if (ctx->testLog) {\n        printf("%s %s VLC Buffer size = %d; Reset to %d.\\n", TAG, __FUNCTION__,\n        *vlc_buf, ctx->vlc_buf_size);\n    }\n    *vlc_buf = ctx->vlc_buf_size;\n}\nstatic int read_input_streams(MediaCodecTestContext *ctx,\n    media_codec_buffer_t *inputBuffer) {\n    Uint64 curTime = 0;\n    int ret = 0, ret2 = 0;\n    Uint32 bufIdx = 0, srcIdx = 0;\n    Int32 doRead = TRUE, doRewind = FALSE;\n    uint8_t *seqHeader = NULL;\n    int seqHeaderSize = 0;\n    void *bufPtr = NULL;\n    int avalBufSize = 0;\n    EXPECT_NE(ctx, nullptr);\n    EXPECT_NE(ctx->context, nullptr);\n    EXPECT_NE(ctx->inFile, nullptr);\n    EXPECT_NE(ctx->outFile, nullptr);\n    EXPECT_NE(inputBuffer, nullptr);\n    if (ctx == NULL || ctx->context == NULL || ctx->inFile == NULL ||\n        ctx->outFile == NULL || inputBuffer == NULL) {\n        printf("%s[%d:%d] Invalid parameters(%s).\\n",\n        TAG, getpid(), gettid(), __FUNCTION__);\n        return -1;\n    }\n    if (ctx->stabilityTest || ctx->pfTest) {\n        doRewind = TRUE;\n        curTime = osal_gettime();\n        if ((curTime - ctx->testStartTime)/1000 < (uint32_t)ctx->duration) {\n            doRead = TRUE;\n        } else {\n            printf("%s[%d:%d] Time up(%d)\\n",\n            TAG, getpid(), gettid(), ctx->duration);\n            doRead = FALSE;\n            ret = 0;\n        }\n    }\n    if (ctx->context->video_dec_params.external_bitstream_buf) {\n        // release input buffer and take it as the new input buffer\n        for (bufIdx = 0;\n            bufIdx < ctx->context->video_dec_params.bitstream_buf_count;\n            bufIdx++) {\n            if (ctx->exBs[bufIdx].valid &&\n                ctx->exBs[bufIdx].src_idx == inputBuffer->vstream_buf.src_idx) {\n                srcIdx = inputBuffer->vstream_buf.src_idx;\n                break;\n            }\n        }\n        EXPECT_NE(bufIdx, ctx->context->video_dec_params.bitstream_buf_count);\n        if (bufIdx == ctx->context->video_dec_params.bitstream_buf_count) {\n            return -1;\n        }\n        bufPtr = (void *)ctx->exBs[srcIdx].buf.virt_addr;\n        if (ctx->context->video_dec_params.feed_mode == \n            MC_FEEDING_MODE_FRAME_SIZE) {\n            avalBufSize = ctx->exBs[srcIdx].buf.size;\n        } else {\n            avalBufSize = (ctx->exBs[srcIdx].buf.size < (int)ctx->feedingSize) ?\n            ctx->exBs[srcIdx].buf.size : ctx->feedingSize;\n        }\n        inputBuffer->vstream_buf.fd = ctx->exBs[srcIdx].buf.fd;\n        inputBuffer->vstream_buf.phy_ptr =\n        ctx->exBs[srcIdx].buf.phys_addr;\n        inputBuffer->vstream_buf.vir_ptr =\n        (hb_u8 *)ctx->exBs[srcIdx].buf.virt_addr;\n    } else {\n        bufPtr = (void *)inputBuffer->vstream_buf.vir_ptr;\n        if (ctx->context->video_dec_params.feed_mode == \n            MC_FEEDING_MODE_FRAME_SIZE) {\n            avalBufSize = inputBuffer->vstream_buf.size;\n        } else {\n            avalBufSize = (inputBuffer->vstream_buf.size < ctx->feedingSize) ?\n            inputBuffer->vstream_buf.size : ctx->feedingSize;\n        }\n    }\n    if (doRead == FALSE) {\n        return ret;\n    }\n    // MC_FEEDING_MODE_FRAME_SIZE mode\n    if (ctx->context->video_dec_params.feed_mode == MC_FEEDING_MODE_FRAME_SIZE) {\n        do {\n            if (ctx->avpacket.size == 0) {\n                ret = av_read_frame(ctx->avContext, &ctx->avpacket);\n                if (ret < 0 && doRewind == FALSE) {\n                    printf("%s[%d:%d] Failed to read input file (error=0x%x)\\n",\n                        TAG, getpid(), gettid(), ret);\n                }\n                if (ret < 0 && doRewind == TRUE) {\n                    avformat_close_input(&ctx->avContext);\n                    ret2 = avformat_open_input(&ctx->avContext, ctx->inputFileName, 0, 0);\n                    EXPECT_GE(ret2, 0);\n                    if (ret2 < 0) {\n                        ret = ret2;\n                        break;\n                    }\n                    /*ret = avformat_find_stream_info(ctx->avContext, 0);\n                    EXPECT_GE(ret, 0);\n                    if (ret < 0) {\n                        break;\n                    }\n                    ctx->videoIndex = av_find_best_stream(ctx->avContext, AVMEDIA_TYPE_VIDEO, -1, -1, NULL, 0);\n                    EXPECT_GE(ctx->videoIndex, 0);\n                    if (ctx->videoIndex < 0) {\n                        ret = -1;\n                        break;\n                    }*/\n                    av_init_packet(&ctx->avpacket);\n                }\n            } else {\n                if (ctx->testLog) {\n                    printf("%s[%d:%d] Reuse previous stream packet size %d\\n",\n                    TAG, getpid(), gettid(), ctx->avpacket.size);\n                }\n            }\n        } while (ret < 0 && doRewind == TRUE);\n        if (ret < 0) {\n            if (ret == AVERROR_EOF || ctx->avContext->pb->eof_reached == TRUE) {\n                printf("%s[%d:%d] End of file!\\n", TAG, getpid(), gettid());\n                ret = 0;\n            } else {\n                printf("%s[%d:%d] Failed to av_read_frame error(0x%08x)\\n",\n                TAG, getpid(), gettid(), ret);\n            }\n            return ret;\n        }\n        if (ctx->testLog) {\n            printf("%s[%d:%d] Read packet size %d\\n",\n                TAG, getpid(), gettid(), ctx->avpacket.size);\n        }\n        seqHeaderSize = 0;\n        if (ctx->firstPacket) {\n            AVCodecParameters* codec;\n            int retSize = 0;\n            codec = ctx->avContext->streams[ctx->videoIndex]->codecpar;\n            seqHeader = (uint8_t*)malloc(codec->extradata_size + 1024);\n            if (seqHeader == NULL) {\n                printf("%s[%d:%d] Failed to mallock seqHeader\\n",\n                TAG, getpid(), gettid());\n                ret = -1;\n                return ret;\n            }\n            memset((void*)seqHeader, 0x00, codec->extradata_size + 1024);\n            seqHeaderSize = build_dec_seq_header(seqHeader,\n            ctx->context->codec_id,\n            ctx->avContext->streams[ctx->videoIndex], &retSize);\n            if (seqHeaderSize < 0) {\n                printf("%s[%d:%d] Failed to build seqHeader\\n",\n                TAG, getpid(), gettid());\n                ret = -1;\n                return ret;\n            }\n            ctx->firstPacket = 0;\n        }\n        if ((ctx->avpacket.size <= avalBufSize)\n            && (seqHeaderSize <= avalBufSize)) {\n            int bufSize = 0;\n            if (seqHeaderSize) {\n                memcpy(bufPtr, seqHeader, seqHeaderSize);\n                bufSize = seqHeaderSize;\n                /*memcpy((char *)bufPtr+bufSize,ctx->avpacket.data, ctx->avpacket.size);\n                bufSize += ctx->avpacket.size;\n                av_packet_unref(&ctx->avpacket);\n                ctx->avpacket.size = 0;*/\n            } else {\n                memcpy(bufPtr,ctx->avpacket.data, ctx->avpacket.size);\n                bufSize = ctx->avpacket.size;\n                av_packet_unref(&ctx->avpacket);\n                ctx->avpacket.size = 0;\n            }\n            inputBuffer->vstream_buf.size = bufSize;\n        } else {\n            printf("%s[%d:%d] The stream buffer is too "\n            "small!\\n", TAG, getpid(), gettid());\n            return -1;\n        }\n        if (seqHeader) {\n            free(seqHeader);\n            seqHeader = NULL;\n        }\n        return 1;\n    }\n    // MC_FEEDING_MODE_STREAM_SIZE mode\n    do {\n        ret = fread(bufPtr, 1, avalBufSize, ctx->inFile);\n        if (ret <= 0 && doRewind == FALSE) {\n            printf("%s[%d:%d] Failed to read input file (error=0x%x)\\n",\n                TAG, getpid(), gettid(), ret);\n        }\n        if (ret <= 0 && doRewind == TRUE) {\n            if(fseek(ctx->inFile, 0, SEEK_SET)) {\n                printf("%s Failed to rewind input file (pid=%d, tid=%d)\\n",\n                    TAG, getpid(), gettid());\n                break;\n            }\n        }\n    } while (ret == 0 && doRewind == TRUE);\n    inputBuffer->vstream_buf.size = ret > 0 ? ret : 0;\n    return ret;\n}\nstatic int write_output_frames(MediaCodecTestContext *ctx,\n    media_codec_buffer_t *outputBuffer) {\n    int32_t ret = 0;\n    EXPECT_NE(ctx, nullptr);\n    EXPECT_NE(ctx->context, nullptr);\n    EXPECT_NE(ctx->inFile, nullptr);\n    EXPECT_NE(ctx->outFile, nullptr);\n    EXPECT_NE(outputBuffer, nullptr);\n    if (ctx == NULL || ctx->context == NULL || ctx->inFile == NULL ||\n        ctx->outFile == NULL || outputBuffer == NULL) {\n        printf("%s[%d:%d] Invalid parameters(%s).\\n",\n        TAG, getpid(), gettid(), __FUNCTION__);\n        return -1;\n    }\n    if (!ctx->stabilityTest && !ctx->pfTest) {\n        fwrite(outputBuffer->vframe_buf.vir_ptr[0], outputBuffer->vframe_buf.size,\n            1, ctx->outFile);\n    }\n    return ret;\n}\nstatic int do_decode_params_checking(MediaCodecTestContext *ctx,\n    media_codec_buffer_t *outputBuffer) {\n    media_codec_context_t *context;\n    int32_t ret = 0;\n    EXPECT_NE(ctx, nullptr);\n    EXPECT_NE(ctx->context, nullptr);\n    if (ctx == NULL || ctx->context == NULL || ctx->inFile == NULL ||\n        ctx->outFile == NULL || outputBuffer == NULL) {\n        printf("%s[%d:%d] Invalid parameters(%s).\\n",\n        TAG, getpid(), gettid(), __FUNCTION__);\n        return -1;\n    }\n    context = ctx->context;\n    if (ctx->enable_get_userdata) {\n        mc_user_data_buffer_t userdata = {0};\n        ret = hb_mm_mc_get_user_data(context, &userdata, 0);\n        if (!ret) {\n            printf("%s[%d:%d] Get userdata %d:\\n", TAG, getpid(), gettid(), userdata.size);\n            for (uint32_t i = 0; i < userdata.size; i++) {\n                if (i < 16) {\n                    printf("%s[%d:%d] userdata[i]:%x\\n", TAG, getpid(), gettid(), userdata.virt_addr[i]);\n                } else {\n                    printf("%s[%d:%d] userdata[i]:%c\\n", TAG, getpid(), gettid(), userdata.virt_addr[i]);\n                }\n            }\n            ret = hb_mm_mc_release_user_data(context, &userdata);\n        } else {\n            ret = 0;\n        }\n    }\n    return ret;\n}\nstatic void do_sync_decoding(void *arg) {\n    int ret = 0;\n    int step = 0;\n    MediaCodecTestContext *ctx = (MediaCodecTestContext *)arg;\n    media_codec_context_t *context;\n    media_codec_callback_t callback;\n    media_codec_buffer_t inputBuffer;\n    media_codec_buffer_t outputBuffer;\n    media_codec_output_buffer_info_t info;\n    int32_t decStartTime = 0, decFinishTime = 0;\n    ctx->workMode = THREAD_WORK_MODE_SYNC;\n    ASSERT_EQ(check_and_init_test(ctx), 0);\n    context = ctx->context;\n    //get current time\n    ctx->testStartTime = osal_gettime();\n    if (ctx->testLog) {\n        printf("%s[%d:%d] Step %d initialize (outFile=%s, FileFd=%p)\\n",\n            TAG, getpid(), gettid(), step++, ctx->outputFileName, ctx->outFile);\n    }\n    ret = hb_mm_mc_initialize(context);\n    ASSERT_EQ(ret, (int32_t)0);\n    callback.on_vlc_buffer_message = on_vlc_buffer_message;\n    if (ctx->vlc_buf_size > 0) {\n        ret = hb_mm_mc_set_vlc_buffer_listener(context, &callback, ctx);\n        ASSERT_EQ(ret, (int32_t)0);\n    }\n    if (ctx->testLog) {\n        printf("%s[%d:%d] Step %d configure\\n", TAG, getpid(), gettid(), step++);\n    }\n    ret = hb_mm_mc_configure(context);\n    EXPECT_EQ(ret, (int32_t)0);\n    if (ctx->testLog) {\n        printf("%s[%d:%d] Step %d start\\n", TAG, getpid(), gettid(), step++);\n    }\n    mc_av_codec_startup_params_t startup_params;\n    memset(&startup_params, 0x00, sizeof(mc_av_codec_startup_params_t));\n    ret = hb_mm_mc_start(context, &startup_params);\n    EXPECT_EQ(ret, (int32_t)0);\n    do {\n        if (!ctx->lastStream) {\n            if (ctx->testLog) {\n                printf("%s[%d:%d] Step %d dequeue input\\n", TAG, getpid(), gettid(), step++);\n            }\n            // process input buffers\n            ret = hb_mm_mc_dequeue_input_buffer(context, &inputBuffer, 3000);\n            //EXPECT_EQ(ret, (int32_t)0);\n            if (!ret) {\n                if (ctx->testLog) {\n                    printf("%s[%d:%d] input buffer viraddr %p phy addr %x, size = %d\\n",\n                    TAG, getpid(), gettid(), inputBuffer.vstream_buf.vir_ptr,\n                    inputBuffer.vstream_buf.phy_ptr,\n                    inputBuffer.vstream_buf.size);\n                }\n                if (ctx->testLog) {\n                    printf("%s[%d:%d] Step %d feed input (pid=%d, tid=%d)\\n", TAG, getpid(), gettid(), step++);\n                }\n                ret = read_input_streams(ctx, &inputBuffer);\n                if (ret <= 0) {\n                    printf("%s[%d:%d] There is no more input data(ret=%d)!\\n",\n                    TAG, getpid(), gettid(), ret);\n                    inputBuffer.vstream_buf.stream_end = TRUE;\n                    inputBuffer.vstream_buf.size = 0;\n                    ctx->lastStream = 1;\n                }\n                //EXPECT_EQ(ret, (int32_t)TRUE);\n                if (ctx->testLog) {\n                    printf("%s[%d:%d] Step %d queue input(size=%d)\\n",\n                    TAG, getpid(), gettid(), step++, inputBuffer.vstream_buf.size);\n                }\n                ret = hb_mm_mc_queue_input_buffer(context, &inputBuffer, 100);\n                EXPECT_EQ(ret, (int32_t)0);\n                if (ret != 0) {\n                    break;\n                }\n                if (ctx->delaytest) {\n                    decStartTime = osal_gettime();\n                }\n            } else {\n                if (ret != (int32_t)HB_MEDIA_ERR_WAIT_TIMEOUT) {\n                    EXPECT_EQ(ret, (int32_t)0);\n                    char info[256];\n                    hb_mm_strerror(ret, info, 256);\n                    printf("%s[%d:%d] dequeue input buffer fail.(%s)\\n", TAG, getpid(), gettid(), info);\n                    break;\n                }\n            }\n        }\n        if (!ctx->lastFrame) {\n            if (ctx->testLog) {\n            printf("%s[%d:%d] Step %d dequeue output\\n", TAG, getpid(), gettid(), step++);\n            }\n            // process output buffers\n            memset(&outputBuffer, 0x00, sizeof(media_codec_buffer_t));\n            memset(&info, 0x00, sizeof(media_codec_output_buffer_info_t));\n            ret = hb_mm_mc_dequeue_output_buffer(context, &outputBuffer, &info, 100);\n            //EXPECT_EQ(ret, (int32_t)0);\n            if (!ret) {\n                if (ctx->testLog) {\n                    printf("%s[%d:%d] output bufferviraddr %p phy addr %x, size = %d, outFile = %p\\n",\n                    TAG, getpid(), gettid(), outputBuffer.vframe_buf.vir_ptr[0],\n                    outputBuffer.vframe_buf.phy_ptr[0],\n                    outputBuffer.vframe_buf.size, ctx->outFile);\n                }\n                if (ctx->testLog) {\n                    printf("%s[%d:%d] Step %d write output file\\n", TAG, getpid(), gettid(), step++);\n                }\n                if (ctx->delaytest) {\n                    decFinishTime = osal_gettime();\n                    if ((decFinishTime - decStartTime) >= ctx->delaytime) {\n                        printf("%s[%d:%d] Decoding time is %d, more than %dms\\n",\n                        TAG, getpid(), gettid(), (decFinishTime - decStartTime), ctx->delaytime);\n                        ASSERT_LE((decFinishTime - decStartTime), ctx->delaytime);\n                    }\n                }\n                ASSERT_EQ(write_output_frames(ctx, &outputBuffer), 0);\n                if (ctx->testLog) {\n                    printf("%s[%d:%d] Step %d queue output\\n", TAG, getpid(), gettid(), step++);\n                }\n                ASSERT_EQ(do_decode_params_checking(ctx, &outputBuffer), 0);\n                ret = hb_mm_mc_queue_output_buffer(context, &outputBuffer, 100);\n                EXPECT_EQ(ret, (int32_t)0);\n                if (outputBuffer.vframe_buf.frame_end) {\n                    printf("%s[%d:%d] There is no more output data!\\n", TAG, getpid(), gettid());\n                    ctx->lastFrame = 1;\n                    break;\n                }\n                if (ret) {\n                    break;\n                }\n            } else {\n                char info[256];\n                hb_mm_strerror(ret, info, 256);\n                printf("%s[%d:%d] dequeue output buffer fail.(%s)\\n", TAG, getpid(), gettid(), info);\n                if (ret != (int32_t)HB_MEDIA_ERR_WAIT_TIMEOUT) {\n                    EXPECT_EQ(ret, (int32_t)0);\n                    break;\n                }\n                if (ctx->stabilityTest && ctx->lastStream ==1) {\n                    break;\n                }\n            }\n        }\n    }while(TRUE);\n    ret = hb_mm_mc_stop(context);\n    EXPECT_EQ(ret, (int32_t)0);\n    ret = hb_mm_mc_release(context);\n    EXPECT_EQ(ret, (int32_t)0);\n    ASSERT_EQ(check_and_release_test(ctx), 0);\n}\nint main(int argc, char *argv[])\n{\n    char outputFileName[MAX_FILE_PATH] = "input.h265";\n    char inputFileName[MAX_FILE_PATH] = "output.yuv";\n    mTestWidth = 640;\n    mTestHeight = 480;\n    mTestPixFmt = MC_PIXEL_FORMAT_YUV420P;\n    mTestFeedMode = MC_FEEDING_MODE_FRAME_SIZE;\n    mTestCodec = TEST_CODEC_ID_H265;\n    mc_video_codec_dec_params_t *params;\n    media_codec_context_t *context = (media_codec_context_t *)malloc(sizeof(media_codec_context_t ));\n    ASSERT_NE(context, nullptr);\n    memset(context, 0x00, sizeof(media_codec_context_t));\n    context->codec_id = get_codec_id(mTestCodec);\n    context->encoder = FALSE;\n    params = &context->video_dec_params;\n    params->feed_mode = mTestFeedMode;\n    params->pix_fmt = mTestPixFmt;\n    params->bitstream_buf_size = mTestWidth * mTestHeight * 3 / 2;\n    params->bitstream_buf_count = 6;\n    params->frame_buf_count = 8;\n    if (context->codec_id == MEDIA_CODEC_ID_H265) {\n        params->h265_dec_config.bandwidth_Opt = TRUE;\n        params->h265_dec_config.reorder_enable = TRUE;\n        params->h265_dec_config.skip_mode = 0;\n        params->h265_dec_config.cra_as_bla = FALSE;\n        params->h265_dec_config.dec_temporal_id_mode = 0;\n        params->h265_dec_config.target_dec_temporal_id_plus1 = 0;\n    }\n    MediaCodecTestContext ctx;\n    memset(&ctx, 0x00, sizeof(ctx));\n    ctx.context = context;\n    ctx.inputFileName = inputFileName;\n    ctx.outputFileName = outputFileName;\n    char inputMd5FileName[MAX_FILE_PATH];\n    if (ctx.md5Test) {\n        char inputMd5Suffix[MAX_FILE_PATH] = ".md5";\n        snprintf(dedicatedSuffix, MAX_FILE_PATH, "%s", "dec");\n        snprintf(inputMd5FileName, MAX_FILE_PATH, "%s%s_%s_%s%s",\n        dedicatedInputPrefix, mGlobalPixFmtName[mTestPixFmt],\n        dedicatedSuffix, mGlobalCodecName[mTestCodec], inputMd5Suffix);\n        ctx.inputMd5FileName = inputMd5FileName;\n    }\n    do_sync_decoding(&ctx);\n    if (context != NULL) {\n        free(context);\n    }\n}\n'})}),"\n",(0,i.jsx)(n.h4,{id:"hb_mm_mc_release_user_data",children:"hb_mm_mc_release_user_data"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u51fd\u6570\u58f0\u660e\u3011"}),"\n",(0,i.jsx)(n.p,{children:"hb_s32 hb_mm_mc_release_user_data(media_codec_context_t *\ncontext, const mc_user_data_buffer_t * params)"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u53c2\u6570\u63cf\u8ff0\u3011"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"[IN] media_codec_context_t *context\uff1a\u6307\u5b9acodec\u7c7b\u578b\u7684context"}),"\n",(0,i.jsx)(n.li,{children:"[IN] const mc_user_data_buffer_t * params\uff1a \u7528\u6237\u6570\u636e"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u8fd4\u56de\u503c\u3011"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"0\uff1a\u64cd\u4f5c\u6210\u529f"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_UNKNOWN\uff1a \u672a\u77e5\u9519\u8bef"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_OPERATION_NOT_ALLOWED\uff1a\u64cd\u4f5c\u4e0d\u5141\u8bb8"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_INVALID_INSTANCE\uff1a\u65e0\u6548\u5b9e\u4f8b"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_INVALID_PARAMS\uff1a\u65e0\u6548\u53c2\u6570"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u529f\u80fd\u63cf\u8ff0\u3011"}),"\n",(0,i.jsx)(n.p,{children:"\u91ca\u653e\u89e3\u7801\u6d41\u4e2d\u7684\u7528\u6237\u6570\u636e\uff0c\u9002\u7528\u4e8eH264/H265\u3002"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u793a\u4f8b\u4ee3\u7801\u3011"}),"\n",(0,i.jsxs)(n.p,{children:["\u53c2\u8003 ",(0,i.jsx)(n.a,{href:"#hb_mm_mc_get_user_data",children:"hb_mm_mc_get_user_data"})]}),"\n",(0,i.jsx)(n.h4,{id:"hb_mm_mc_get_mjpeg_config",children:"hb_mm_mc_get_mjpeg_config"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u51fd\u6570\u58f0\u660e\u3011"}),"\n",(0,i.jsx)(n.p,{children:"hb_s32 hb_mm_mc_get_mjpeg_config(media_codec_context_t\n*context, mc_mjpeg_enc_params_t *params)"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u53c2\u6570\u63cf\u8ff0\u3011"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"[IN] media_codec_context_t *context\uff1a\u6307\u5b9acodec\u7c7b\u578b\u7684context"}),"\n",(0,i.jsx)(n.li,{children:"[OUT] mc_mjpeg_enc_params_t *params\uff1aMJPEG\u7f16\u7801\u53c2\u6570"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u8fd4\u56de\u503c\u3011"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"0\uff1a\u64cd\u4f5c\u6210\u529f"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_UNKNOWN\uff1a \u672a\u77e5\u9519\u8bef"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_INVALID_INSTANCE\uff1a\u65e0\u6548\u5b9e\u4f8b"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_INVALID_PARAMS\uff1a\u65e0\u6548\u53c2\u6570"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u529f\u80fd\u63cf\u8ff0\u3011"}),"\n",(0,i.jsx)(n.p,{children:"\u83b7\u53d6MJPEG\u7f16\u7801\u53c2\u6570\uff0c\u9002\u7528\u4e8eMJPEG\u3002"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u793a\u4f8b\u4ee3\u7801\u3011"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:'#include "hb_media_codec.h"\n#include "hb_media_error.h"\nint main(int argc, char *argv[])\n{\n    int ret = 0;\n    char outputFileName[MAX_FILE_PATH];\n    char inputFileName[MAX_FILE_PATH];\n    mTestCodec = TEST_CODEC_ID_MJPEG;\n    mTestPixFmt = MC_PIXEL_FORMAT_NV12;\n    char dedicatedSuffix[MAX_FILE_PATH] = "_test";\n    char inputSuffix[MAX_FILE_PATH] = ".yuv";\n    char outputSuffixJpeg[MAX_FILE_PATH] = ".jpg";\n    char outputSuffixMjpg[MAX_FILE_PATH] = ".mjpg";\n    snprintf(inputFileName, MAX_FILE_PATH, "%s%s%s",\n        mInputSpecPrefix, mTest12Bit ? mGlobal12BPixFmtName[mTestPixFmt]\n        : mGlobalPixFmtName[mTestPixFmt], inputSuffix);\n    snprintf(outputFileName, MAX_FILE_PATH, "%s%s%s%s",\n        mOutputSpecPrefix, mTest12Bit ? mGlobal12BPixFmtName[mTestPixFmt]\n        : mGlobalPixFmtName[mTestPixFmt], dedicatedSuffix,\n    mTestCodec == TEST_CODEC_ID_JPEG ? outputSuffixJpeg : outputSuffixMjpg);\n    mc_video_codec_enc_params_t *params;\n    media_codec_context_t *context = (media_codec_context_t *)malloc(sizeof(media_codec_context_t ));\n    ASSERT_NE(context, nullptr);\n    memset(context, 0x00, sizeof(media_codec_context_t));\n    context->codec_id = mTestCodec == TEST_CODEC_ID_JPEG ?\n        MEDIA_CODEC_ID_JPEG : MEDIA_CODEC_ID_MJPEG;\n    context->encoder = TRUE;\n    params = &context->video_enc_params;\n    params->width = mTestWidth;\n    params->height = mTestHeight;\n    params->pix_fmt = mTestPixFmt;\n    params->frame_buf_count = 5;\n    params->bitstream_buf_count = 5;\n    params->rot_degree = MC_CCW_0;\n    params->mir_direction = MC_DIRECTION_NONE;\n    params->frame_cropping_flag = FALSE;\n    params->external_frame_buf = FALSE;\n    if (context->codec_id == MEDIA_CODEC_ID_MJPEG) {\n        params->rc_params.mode = MC_AV_RC_MODE_MJPEGFIXQP;\n        ret = hb_mm_mc_get_rate_control_config(context, &params->rc_params);\n        ASSERT_EQ(ret, (int32_t)0);\n        params->mjpeg_enc_config.restart_interval = mTestWidth/16;\n        params->mjpeg_enc_config.extended_sequential = mTest12Bit;\n    } else {\n        params->jpeg_enc_config.restart_interval = mTestWidth/16;\n        params->jpeg_enc_config.extended_sequential = mTest12Bit;\n    }\n    mc_mjpeg_enc_params_t mjpeg_params;\n    memset(&mjpeg_params, 0x00, sizeof(mjpeg_params));\n    ret = hb_mm_mc_get_mjpeg_config(context, &mjpeg_params);\n    ASSERT_EQ(ret, (int32_t)0);\n    ret = hb_mm_mc_initialize(context);\n    ASSERT_EQ(ret, (int32_t)0);\n    ret = hb_mm_mc_set_mjpeg_config(context, &mjpeg_params);\n    ASSERT_EQ(ret, (int32_t)0);\n    ret = hb_mm_mc_stop(context);\n    ASSERT_EQ(ret, (int32_t)0);\n    ret = hb_mm_mc_release(context);\n    ASSERT_EQ(ret, (int32_t)0);\n    if (context != NULL) {\n        free(context);\n    }\n}\n'})}),"\n",(0,i.jsx)(n.h4,{id:"hb_mm_mc_set_mjpeg_config",children:"hb_mm_mc_set_mjpeg_config"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u51fd\u6570\u58f0\u660e\u3011"}),"\n",(0,i.jsx)(n.p,{children:"hb_s32 hb_mm_mc_set_mjpeg_config(media_codec_context_t\n*context, const mc_mjpeg_enc_params_t *params)"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u53c2\u6570\u63cf\u8ff0\u3011"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"[IN] media_codec_context_t *context\uff1a\u6307\u5b9acodec\u7c7b\u578b\u7684context"}),"\n",(0,i.jsx)(n.li,{children:"[IN] const mc_mjpeg_enc_params_t *params\uff1aMJPEG\u7f16\u7801\u53c2\u6570"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u8fd4\u56de\u503c\u3011"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"0\uff1a\u64cd\u4f5c\u6210\u529f"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_UNKNOWN\uff1a \u672a\u77e5\u9519\u8bef"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_OPERATION_NOT_ALLOWED\uff1a\u64cd\u4f5c\u4e0d\u5141\u8bb8"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_INVALID_INSTANCE\uff1a\u65e0\u6548\u5b9e\u4f8b"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_INVALID_PARAMS\uff1a\u65e0\u6548\u53c2\u6570"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u529f\u80fd\u63cf\u8ff0\u3011"}),"\n",(0,i.jsx)(n.p,{children:"\u8bbe\u7f6eMJPEG\u7f16\u7801\u53c2\u6570\uff0c\u8be5\u53c2\u6570\u4e3a\u52a8\u6001\u53c2\u6570\uff0c\u9002\u7528\u4e8eMJPEG\u3002"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u793a\u4f8b\u4ee3\u7801\u3011"}),"\n",(0,i.jsxs)(n.p,{children:["\u53c2\u8003 ",(0,i.jsx)(n.a,{href:"#hb_mm_mc_get_mjpeg_config",children:"hb_mm_mc_get_mjpeg_config"})]}),"\n",(0,i.jsx)(n.h4,{id:"hb_mm_mc_get_jpeg_config",children:"hb_mm_mc_get_jpeg_config"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u51fd\u6570\u58f0\u660e\u3011"}),"\n",(0,i.jsx)(n.p,{children:"hb_s32 hb_mm_mc_get_jpeg_config(media_codec_context_t\n*context, mc_jpeg_enc_params_t *params)"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u53c2\u6570\u63cf\u8ff0\u3011"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"[IN] media_codec_context_t *context\uff1a\u6307\u5b9acodec\u7c7b\u578b\u7684context"}),"\n",(0,i.jsx)(n.li,{children:"[OUT] mc_jpeg_enc_params_t *params\uff1aJPEG\u7f16\u7801\u53c2\u6570"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u8fd4\u56de\u503c\u3011"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"0\uff1a\u64cd\u4f5c\u6210\u529f"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_UNKNOWN\uff1a \u672a\u77e5\u9519\u8bef"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_INVALID_INSTANCE\uff1a\u65e0\u6548\u5b9e\u4f8b"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_INVALID_PARAMS\uff1a\u65e0\u6548\u53c2\u6570"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u529f\u80fd\u63cf\u8ff0\u3011"}),"\n",(0,i.jsx)(n.p,{children:"\u83b7\u53d6JPEG\u7f16\u7801\u53c2\u6570\uff0c\u9002\u7528\u4e8eJPEG\u3002"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u793a\u4f8b\u4ee3\u7801\u3011"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:'#include "hb_media_codec.h"\n#include "hb_media_error.h"\nint main(int argc, char *argv[])\n{\n    int ret = 0;\n    char outputFileName[MAX_FILE_PATH];\n    char inputFileName[MAX_FILE_PATH];\n    mTestCodec = TEST_CODEC_ID_JPEG;\n    mTestPixFmt = MC_PIXEL_FORMAT_NV12;\n    char dedicatedSuffix[MAX_FILE_PATH] = "_test";\n    char inputSuffix[MAX_FILE_PATH] = ".yuv";\n    char outputSuffixJpeg[MAX_FILE_PATH] = ".jpg";\n    char outputSuffixMjpg[MAX_FILE_PATH] = ".mjpg";\n    snprintf(inputFileName, MAX_FILE_PATH, "%s%s%s",\n        mInputSpecPrefix, mTest12Bit ? mGlobal12BPixFmtName[mTestPixFmt]\n        : mGlobalPixFmtName[mTestPixFmt], inputSuffix);\n    snprintf(outputFileName, MAX_FILE_PATH, "%s%s%s%s",\n        mOutputSpecPrefix, mTest12Bit ? mGlobal12BPixFmtName[mTestPixFmt]\n        : mGlobalPixFmtName[mTestPixFmt], dedicatedSuffix,\n        mTestCodec == TEST_CODEC_ID_JPEG ? outputSuffixJpeg : outputSuffixMjpg);\n    mc_video_codec_enc_params_t *params;\n    media_codec_context_t *context = (media_codec_context_t *)malloc(sizeof(media_codec_context_t ));\n    ASSERT_NE(context, nullptr);\n    memset(context, 0x00, sizeof(media_codec_context_t));\n    context->codec_id = mTestCodec == TEST_CODEC_ID_JPEG ?\n    MEDIA_CODEC_ID_JPEG : MEDIA_CODEC_ID_MJPEG;\n    context->encoder = TRUE;\n    params = &context->video_enc_params;\n    params->width = mTestWidth;\n    params->height = mTestHeight;\n    params->pix_fmt = mTestPixFmt;\n    params->frame_buf_count = 5;\n    params->bitstream_buf_count = 5;\n    params->rot_degree = MC_CCW_0;\n    params->mir_direction = MC_DIRECTION_NONE;\n    params->frame_cropping_flag = FALSE;\n    params->external_frame_buf = FALSE;\n    if (context->codec_id == MEDIA_CODEC_ID_MJPEG) {\n        params->rc_params.mode = MC_AV_RC_MODE_MJPEGFIXQP;\n        ret = hb_mm_mc_get_rate_control_config(context, &params->rc_params);\n        ASSERT_EQ(ret, (int32_t)0);\n        params->mjpeg_enc_config.restart_interval = mTestWidth/16;\n        params->mjpeg_enc_config.extended_sequential = mTest12Bit;\n    } else {\n        params->jpeg_enc_config.restart_interval = mTestWidth/16;\n        params->jpeg_enc_config.extended_sequential = mTest12Bit;\n    }\n    mc_jpeg_enc_params_t jpeg_params;\n    memset(&jpeg_params, 0x00, sizeof(jpeg_params));\n    ret = hb_mm_mc_get_jpeg_config(context, &jpeg_params);\n    ASSERT_EQ(ret, (int32_t)0);\n    ret = hb_mm_mc_initialize(context);\n    ASSERT_EQ(ret, (int32_t)0);\n    jpeg_params.quality_factor = 30;\n    jpeg_params.restart_interval = (((params->width+15)>>4) *\n        ((params->height+15)>>4) * 2) + 1;\n    jpeg_params.crop_en = FALSE;\n    ret = hb_mm_mc_set_jpeg_config(context, &jpeg_params);\n    ASSERT_EQ(ret, (int32_t)HB_MEDIA_ERR_INVALID_PARAMS);\n    jpeg_params.restart_interval = 70;\n    ret = hb_mm_mc_set_jpeg_config(context, &jpeg_params);\n    ASSERT_EQ(ret, (int32_t)0);\n    ret = hb_mm_mc_stop(context);\n    ASSERT_EQ(ret, (int32_t)0);\n    ret = hb_mm_mc_release(context);\n    ASSERT_EQ(ret, (int32_t)0);\n    if (context != NULL) {\n        free(context);\n    }\n}\n'})}),"\n",(0,i.jsx)(n.h4,{id:"hb_mm_mc_set_jpeg_config",children:"hb_mm_mc_set_jpeg_config"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u51fd\u6570\u58f0\u660e\u3011"}),"\n",(0,i.jsx)(n.p,{children:"hb_s32 hb_mm_mc_set_jpeg_config(media_codec_context_t\n*context, const mc_jpeg_enc_params_t *params)"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u53c2\u6570\u63cf\u8ff0\u3011"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"[IN] media_codec_context_t *context\uff1a\u6307\u5b9acodec\u7c7b\u578b\u7684context"}),"\n",(0,i.jsx)(n.li,{children:"[IN] const mc_jpeg_enc_params_t *params\uff1aJPEG\u7f16\u7801\u53c2\u6570"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u8fd4\u56de\u503c\u3011"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"0\uff1a\u64cd\u4f5c\u6210\u529f"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_UNKNOWN\uff1a \u672a\u77e5\u9519\u8bef"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_OPERATION_NOT_ALLOWED\uff1a\u64cd\u4f5c\u4e0d\u5141\u8bb8"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_INVALID_INSTANCE\uff1a\u65e0\u6548\u5b9e\u4f8b"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_INVALID_PARAMS\uff1a\u65e0\u6548\u53c2\u6570"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u529f\u80fd\u63cf\u8ff0\u3011"}),"\n",(0,i.jsx)(n.p,{children:"\u8bbe\u7f6eJPEG\u7f16\u7801\u53c2\u6570\uff0c\u8be5\u53c2\u6570\u4e3a\u52a8\u6001\u53c2\u6570\uff0c\u9002\u7528\u4e8eJPEG\u3002"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u793a\u4f8b\u4ee3\u7801\u3011"}),"\n",(0,i.jsxs)(n.p,{children:["\u53c2\u8003 ",(0,i.jsx)(n.a,{href:"#hb_mm_mc_get_jpeg_config",children:"hb_mm_mc_get_jpeg_config"})]}),"\n",(0,i.jsx)(n.h4,{id:"hb_mm_mc_get_fd",children:"hb_mm_mc_get_fd"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u51fd\u6570\u58f0\u660e\u3011"}),"\n",(0,i.jsx)(n.p,{children:"hb_s32 hb_mm_mc_get_fd(media_codec_context_t * context, hb_s32\n*fd)"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u53c2\u6570\u63cf\u8ff0\u3011"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"[IN] media_codec_context_t *context\uff1a\u6307\u5b9acodec\u7c7b\u578b\u7684context"}),"\n",(0,i.jsx)(n.li,{children:"[OUT] hb_s32 *fd\uff1a\u8bbe\u5907\u8282\u70b9fd"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u8fd4\u56de\u503c\u3011"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"0\uff1a\u64cd\u4f5c\u6210\u529f"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_INVALID_INSTANCE\uff1a\u65e0\u6548\u5b9e\u4f8b"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_INVALID_PARAMS\uff1a\u65e0\u6548\u53c2\u6570"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u529f\u80fd\u63cf\u8ff0\u3011"}),"\n",(0,i.jsx)(n.p,{children:"\u83b7\u53d6\u8bbe\u5907\u8282\u70b9fd\uff0c\u53ef\u7528\u4e8eselect\u64cd\u4f5c\uff0c\u76d1\u542c\u7f16\u89e3\u7801\u7ed3\u679c\u3002"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u793a\u4f8b\u4ee3\u7801\u3011"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:'#include "hb_media_codec.h"\n#include "hb_media_error.h"\n\ntypedef struct MediaCodecTestContext {\n    media_codec_context_t *context;\n    char *inputFileName;\n    char *outputFileName;\n    int abnormal;\n    int32_t duration; // s\n} MediaCodecTestContext;\n\nUint64 osal_gettime(void)\n{\n    struct timespec tp;\n\n    clock_gettime(CLOCK_MONOTONIC, &tp);\n\n    return ((Uint64)tp.tv_sec*1000 + tp.tv_nsec/1000000);\n}\n\nstatic void do_poll_encoding_select(void *arg) {\n    hb_s32 ret = 0;\n    int pollFd = -1;\n    FILE *outFile;\n    int lastStream = 0;\n    fd_set readFds;\n    MediaCodecTestContext *ctx = (MediaCodecTestContext *)arg;\n    media_codec_context_t *context = ctx->context;\n    char *outputFileName = ctx->outputFileName;\n    mc_inter_status_t status;\n\n    outFile = fopen(outputFileName, "wb");\n    if (!outFile) {\n        goto ERR;\n    }\n\n    ret = hb_mm_mc_get_fd(context, &pollFd);\n    if (ret) {\n        goto ERR;\n    }\n\n    do {\n        FD_ZERO(&readFds);\n        FD_SET(pollFd, &readFds);\n        ret = select(pollFd+1, &readFds, NULL, NULL, NULL);\n        if (ret < 0) {\n            printf("Failed to select fd = %d.(err %s)\\n", pollFd, strerror(errno));\n            ctx->abnormal = TRUE;\n            break;\n        } else if (ret == 0) {\n            printf("Time out to select fd = %d.\\n", pollFd);\n            ctx->abnormal = TRUE;\n            break;\n        } else {\n            if (FD_ISSET(pollFd, &readFds)) {\n                ASSERT_EQ(hb_mm_mc_get_status(context, &status), (int32_t)0);\n                if (ctx->testLog) {\n                    printf("%s[%d:%d] output count %d input count %d\\n", TAG, getpid(), gettid(),\n                    status.cur_output_buf_cnt, status.cur_input_buf_cnt);\n                }\n                media_codec_buffer_t outputBuffer;\n                media_codec_output_buffer_info_t info;\n                memset(&outputBuffer, 0x00, sizeof(media_codec_buffer_t));\n                memset(&info, 0x00, sizeof(media_codec_output_buffer_info_t));\n                ret = hb_mm_mc_dequeue_output_buffer(context, &outputBuffer, &info, 100);\n                if (!ret && outFile) {\n                    fwrite(outputBuffer.vstream_buf.vir_ptr, outputBuffer.vstream_buf.size, 1, outFile);\n                    ret = hb_mm_mc_queue_output_buffer(context, &outputBuffer, 100);\n\n                    if (outputBuffer.vstream_buf.stream_end) {\n                        printf("%There is no more output data!\\n");\n                        lastStream = 1;\n                        break;\n                    }\n                    if (ret) {\n                        ctx->abnormal = TRUE;\n                        break;\n                    }\n                } else {\n                    if (ret != (int32_t)HB_MEDIA_ERR_WAIT_TIMEOUT) {\n                        printf("Dequeue output buffer fail.\\n");\n                        break;\n                    }\n                }\n            }\n        }\n    } while (!lastStream && !ctx->abnormal);\n\nERR:\n    if (pollFd) {\n        hb_mm_mc_close_fd(context, pollFd)\n    }\n    if (outFile)\n        fclose(outFile);\n}\n\nstatic void do_poll_encoding(void *arg) {\n    pthread_t thread_id;\n    void* retVal;\n    hb_s32 ret = 0;\n    FILE *inFile;\n    int noMoreInput = 0;\n    MediaCodecTestContext *ctx = (MediaCodecTestContext *)arg;\n    media_codec_context_t *context = ctx->context;\n\n    char *inputFileName = ctx->inputFileName;\n    char *outputFileName = ctx->outputFileName;\n    media_codec_state_t state = MEDIA_CODEC_STATE_NONE;\n    inFile = fopen(inputFileName, "rb");\n    if (!inFile) {\n        goto ERR;\n    }\n\n    ret = hb_mm_mc_initialize(context);\n    if (ret) {\n        goto ERR;\n    }\n\n    ret = hb_mm_mc_configure(context);\n    if (ret) {\n        goto ERR;\n    }\n\n    mc_av_codec_startup_params_t startup_params;\n    startup_params.video_enc_startup_params.receive_frame_number = 0;\n    ret = hb_mm_mc_start(context, &startup_params);\n    if (ret) {\n        goto ERR;\n    }\n\n    pthread_create(&thread_id, NULL, (void* (*)(void*))do_poll_encoding_select, ctx);\n\n    do {\n        media_codec_buffer_t inputBuffer;\n        memset(&inputBuffer, 0x00, sizeof(media_codec_buffer_t));\n        ret = hb_mm_mc_dequeue_input_buffer(context, &inputBuffer, 100);\n        if (!ret) {\n            ret = fread(inputBuffer.vframe_buf.vir_ptr[0], 1,\n                inputBuffer.vframe_buf.size, inFile);\n            if (!ret) {\n                printf("There is no more input data!\\n");\n                inputBuffer.vframe_buf.frame_end = TRUE;\n                noMoreInput = 1;\n            }\n            ret = hb_mm_mc_queue_input_buffer(context, &inputBuffer, 100);\n            if (ret) {\n                printf("Queue input buffer fail.\\n");\n                break;\n            }\n        } else {\n            if (ret != (int32_t)HB_MEDIA_ERR_WAIT_TIMEOUT) {\n                printf("Dequeue input buffer fail.\\n");\n                break;\n            }\n        }\n    }while(!noMoreInput && !ctx->abnormal);\n\n    pthread_join(thread_id, &retVal);\n\n    hb_mm_mc_stop(context);\n\n    hb_mm_mc_release(context);\n    context = NULL;\n\nERR:\n    hb_mm_mc_get_state(context, &state);\n    if (context && state != MEDIA_CODEC_STATE_UNINITIALIZED) {\n        hb_mm_mc_stop(context);\n        hb_mm_mc_release(context);\n    }\n\n    if (inFile)\n        fclose(inFile);\n}\n\nint main(int argc, char *argv[])\n{\n    hb_s32 ret = 0;\n    char outputFileName[MAX_FILE_PATH] = "./tmp.yuv";\n    char inputFileName[MAX_FILE_PATH] = "./output.stream";\n    mc_video_codec_enc_params_t *params;\n    media_codec_context_t context;\n\n    memset(&context, 0x00, sizeof(media_codec_context_t));\n    context.codec_id = MEDIA_CODEC_ID_H265;\n    context.encoder = TRUE;\n    params = &context.video_enc_params;\n    params->width = 640;\n    params->height = 480;\n    params->pix_fmt = MC_PIXEL_FORMAT_YUV420P;\n    params->frame_buf_count = 5;\n    params->external_frame_buf = FALSE;\n    params->bitstream_buf_count = 5;\n    params->rc_params.mode = MC_AV_RC_MODE_H265CBR;\n    ret = hb_mm_mc_get_rate_control_config(&context, &params->rc_params);\n    if (ret) {\n        return -1;\n    }\n    params->rc_params.h265_cbr_params.bit_rate = 5000;\n    params->rc_params.h265_cbr_params.frame_rate = 30;\n    params->rc_params.h265_cbr_params.intra_period = 30;\n    params->gop_params.decoding_refresh_type = 2;\n    params->gop_params.gop_preset_idx = 2;\n    params->rot_degree = MC_CCW_0;\n    params->mir_direction = MC_DIRECTION_NONE;\n    params->frame_cropping_flag = FALSE;\n\n    MediaCodecTestContext ctx;\n    memset(&ctx, 0x00, sizeof(ctx));\n    ctx.context = &context;\n    ctx.inputFileName = inputFileName;\n    ctx.outputFileName = outputFileName;\n    ctx.duration = 5;\n    do_poll_encoding(&ctx);\n}\n'})}),"\n",(0,i.jsx)(n.h4,{id:"hb_mm_mc_close_fd",children:"hb_mm_mc_close_fd"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u51fd\u6570\u58f0\u660e\u3011"}),"\n",(0,i.jsx)(n.p,{children:"hb_s32 hb_mm_mc_close_fd(media_codec_context_t * context,\nhb_s32 fd)"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u53c2\u6570\u63cf\u8ff0\u3011"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"[IN] media_codec_context_t *context\uff1a\u6307\u5b9acodec\u7c7b\u578b\u7684context"}),"\n",(0,i.jsx)(n.li,{children:"[IN] hb_s32 fd\uff1a\u8bbe\u5907\u8282\u70b9fd"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u8fd4\u56de\u503c\u3011"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"0\uff1a\u64cd\u4f5c\u6210\u529f"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_UNKNOWN\uff1a \u672a\u77e5\u9519\u8bef"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_OPERATION_NOT_ALLOWED\uff1a\u64cd\u4f5c\u4e0d\u5141\u8bb8"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_INVALID_INSTANCE\uff1a\u65e0\u6548\u5b9e\u4f8b"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_INVALID_PARAMS\uff1a\u65e0\u6548\u53c2\u6570"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u529f\u80fd\u63cf\u8ff0\u3011"}),"\n",(0,i.jsx)(n.p,{children:"\u5173\u95ed\u8bbe\u5907\u8282\u70b9\u3002"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u793a\u4f8b\u4ee3\u7801\u3011"}),"\n",(0,i.jsxs)(n.p,{children:["\u53c2\u8003 ",(0,i.jsx)(n.a,{href:"#hb_mm_mc_get_fd",children:"hb_mm_mc_get_fd"})]}),"\n",(0,i.jsx)(n.h4,{id:"hb_mm_mc_set_camera",children:"hb_mm_mc_set_camera"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u51fd\u6570\u58f0\u660e\u3011"}),"\n",(0,i.jsx)(n.p,{children:"hb_s32 hb_mm_mc_set_camera(media_codec_context_t *context,\nhb_s32 pipeline, hb_s32 channel_port_id)"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u53c2\u6570\u63cf\u8ff0\u3011"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"[IN] media_codec_context_t *context\uff1a\u6307\u5b9acodec\u7c7b\u578b\u7684context"}),"\n",(0,i.jsx)(n.li,{children:"[IN] hb_s32 pipeline\uff1apipeline"}),"\n",(0,i.jsx)(n.li,{children:"[IN] hb_s32 channel_port_id\uff1a\u901a\u9053\u7aef\u53e3\u53f7"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u8fd4\u56de\u503c\u3011"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"0\uff1a\u64cd\u4f5c\u6210\u529f"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_UNKNOWN\uff1a \u672a\u77e5\u9519\u8bef"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_OPERATION_NOT_ALLOWED\uff1a\u64cd\u4f5c\u4e0d\u5141\u8bb8"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_INVALID_INSTANCE\uff1a\u65e0\u6548\u5b9e\u4f8b"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_INVALID_PARAMS\uff1a\u65e0\u6548\u53c2\u6570"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u529f\u80fd\u63cf\u8ff0\u3011"}),"\n",(0,i.jsx)(n.p,{children:"\u8bbe\u7f6eVIO\u7684camera\u4fe1\u606f\uff0c\u8be5\u53c2\u6570\u4e3a\u9759\u6001\u53c2\u6570\uff0c\u9002\u7528\u4e8eH264/H265\u3002"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u793a\u4f8b\u4ee3\u7801\u3011"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:'#include "hb_media_codec.h"\n#include "hb_media_error.h"\ntypedef struct _media_codec_context {\n    media_codec_id_t codec_id;\n    hb_bool encoder;\n    hb_s32 instance_index;\n    union {\n        mc_video_codec_enc_params_t video_enc_params;\n        mc_video_codec_dec_params_t video_dec_params;\n        mc_audio_codec_enc_params_t audio_enc_params;\n        mc_audio_codec_dec_params_t audio_dec_params;\n    };\n} media_codec_context_t;\nvoid MediaCodecAPITest::init_params_H265() {\n    memset(&context, 0x00, sizeof(media_codec_context_t));\n    context.codec_id = MEDIA_CODEC_ID_H265;\n    context.encoder = TRUE;\n    params = &context.video_enc_params;\n    params->width = mGlobalWidth;\n    params->height = mGlobalHeight;\n    params->pix_fmt = mGlobalPixFmt;\n    params->frame_buf_count = 5;\n    params->external_frame_buf = FALSE;\n    params->bitstream_buf_count = 5;\n    params->rc_params.mode = MC_AV_RC_MODE_H265CBR;\n    EXPECT_EQ(hb_mm_mc_get_rate_control_config(&context, &params->rc_params), (int32_t)0);\n    params->rc_params.h265_cbr_params.bit_rate = 5000;\n    params->rc_params.h265_cbr_params.frame_rate = 30;\n    params->rc_params.h265_cbr_params.intra_period = 6;\n    params->gop_params.decoding_refresh_type = 2;\n    params->gop_params.gop_preset_idx = 2;\n    params->rot_degree = MC_CCW_0;\n    params->mir_direction = MC_DIRECTION_NONE;\n    params->frame_cropping_flag = FALSE;\n}\nint main(int argc, char *argv[])\n{\n    init_params_H265();\n    EXPECT_EQ(hb_mm_mc_initialize(&context), (int32_t)0);\n    EXPECT_EQ(hb_mm_mc_set_camera(&context, 1, 1), (int32_t)0);\n    EXPECT_EQ(hb_mm_mc_release(&context), (int32_t)0);\n}\n'})}),"\n",(0,i.jsx)(n.h4,{id:"hb_mm_mc_get_vui_config",children:"hb_mm_mc_get_vui_config"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u51fd\u6570\u58f0\u660e\u3011"}),"\n",(0,i.jsx)(n.p,{children:"hb_s32 hb_mm_mc_get_vui_config(media_codec_context_t *context,\nmc_video_vui_params_t *params)"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u53c2\u6570\u63cf\u8ff0\u3011"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"[IN] media_codec_context_t *context\uff1a\u6307\u5b9acodec\u7c7b\u578b\u7684context"}),"\n",(0,i.jsx)(n.li,{children:"[OUT] mc_video_vui_ params_t *params\uff1aVUI\u53c2\u6570"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u8fd4\u56de\u503c\u3011"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"0\uff1a\u64cd\u4f5c\u6210\u529f"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_UNKNOWN\uff1a \u672a\u77e5\u9519\u8bef"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_INVALID_INSTANCE\uff1a\u65e0\u6548\u5b9e\u4f8b"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_INVALID_PARAMS\uff1a\u65e0\u6548\u53c2\u6570"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u529f\u80fd\u63cf\u8ff0\u3011"}),"\n",(0,i.jsx)(n.p,{children:"\u83b7\u53d6VUI\u53c2\u6570\u3002"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u5176\u4ed6\u8bf4\u660e\u3011"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u5176\u5b83\u8bf4\u660e\u3011"}),"\n",(0,i.jsx)(n.p,{children:"\u76ee\u524dvideo\u7f16\u7801\u65f6\u8bbe\u7f6e\u5934\u4fe1\u606f\u4e2d\u7684\u9ed8\u8ba4color range\u4e3afull\nrange\u6a21\u5f0f\uff0c\u5982\u679c\u8bbe\u7f6elimit\nrange\u9700\u8981\u663e\u5f0f\u8c03\u7528hb_mm_mc_set_vui_config\u63a5\u53e3\u3002"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u793a\u4f8b\u4ee3\u7801\u3011"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:'#include "hb_media_codec.h"\n#include "hb_media_error.h"\ntypedef enum ENC_CONFIG_MESSAGE {\n    ENC_CONFIG_NONE = (0 << 0),\n    ENC_CONFIG_LONGTERM_REF = (1 << 0),\n    ENC_CONFIG_INTRA_REFRESH = (1 << 1),\n    ENC_CONFIG_RATE_CONTROL = (1 << 2),\n    ENC_CONFIG_DEBLK_FILTER = (1 << 3),\n    ENC_CONFIG_SAO = (1 << 4),\n    ENC_CONFIG_ENTROPY = (1 << 5),\n    ENC_CONFIG_VUI_TIMING = (1 << 6),\n    ENC_CONFIG_SLICE = (1 << 7),\n    ENC_CONFIG_REQUEST_IDR = (1 << 8),\n    ENC_CONFIG_SKIP_PIC = (1 << 9),\n    ENC_CONFIG_SMART_BG = (1 << 10),\n    ENC_CONFIG_MONOCHROMA = (1 << 11),\n    ENC_CONFIG_PRED_UNIT = (1 << 12),\n    ENC_CONFIG_TRANSFORM = (1 << 13),\n    ENC_CONFIG_ROI = (1 << 14),\n    ENC_CONFIG_MODE_DECISION = (1 << 15),\n    ENC_CONFIG_USER_DATA = (1 << 16),\n    ENC_CONFIG_MJPEG = (1 << 17),\n    ENC_CONFIG_JPEG = (1 << 18),\n    ENC_CONFIG_CAMERA = (1 << 19),\n    ENC_CONFIG_INSERT_USERDATA = (1 << 20),\n    ENC_CONFIG_VUI = (1 << 21),\n    ENC_CONFIG_3DNR = (1 << 22),\n    ENC_CONFIG_REQUEST_IDR_HEADER = (1 << 23),\n    ENC_CONFIG_ENABLE_IDR = (1 << 24),\n    ENC_CONFIG_TOTAL = (1 << 25),\n} ENC_CONFIG_MESSAGE;\ntypedef struct MediaCodecTestContext {\n    media_codec_context_t *context;\n    char *inputFileName;\n    char *outputFileName;\n    int32_t duration; // s\n    ENC_CONFIG_MESSAGE message;\n    mc_video_longterm_ref_mode_t ref_mode;\n    mc_rate_control_params_t rc_params;\n    mc_video_intra_refresh_params_t intra_refr;\n    mc_video_deblk_filter_params_t deblk_filter;\n    mc_h265_sao_params_t sao;\n    mc_h264_entropy_params_t entropy;\n    mc_video_vui_params_t vui;\n    mc_video_vui_timing_params_t vui_timing;\n    mc_video_slice_params_t slice;\n    mc_video_3dnr_enc_params_t noise_reduction;\n    mc_video_smart_bg_enc_params_t smart_bg;\n    mc_video_pred_unit_params_t pred_unit;\n    mc_video_transform_params_t transform;\n    mc_video_roi_params_t roi;\n    mc_video_mode_decision_params_t mode_decision;\n} MediaCodecTestContext;\nUint64 osal_gettime(void)\n{\n    struct timespec tp;\n    clock_gettime(CLOCK_MONOTONIC, &tp);\n    return ((Uint64)tp.tv_sec*1000 + tp.tv_nsec/1000000);\n}\nuint8_t uuid[] =\n"dc45e9bd-e6d948b7-962cd820-d923eeef+HorizonAI";\nstatic void set_message(MediaCodecTestContext *ctx) {\n    int ret = 0;\n    media_codec_context_t *context = ctx->context;\n    if (ctx->message & ENC_CONFIG_VUI) {\n        hb_mm_mc_get_vui_config(context, &ctx->vui);\n        ret = hb_mm_mc_set_vui_config(context, &ctx->vui);\n    }\n}\nstatic void do_sync_encoding(void *arg) {\n    hb_s32 ret = 0;\n    FILE *inFile;\n    FILE *outFile;\n    int noMoreInput = 0;\n    int lastStream = 0;\n    Uint64 lastTime = 0;\n    Uint64 curTime = 0;\n    int needFlush = 1;\n    MediaCodecTestContext *ctx = (MediaCodecTestContext *)arg;\n    media_codec_context_t *context = ctx->context;\n    char *inputFileName = ctx->inputFileName;\n    char *outputFileName = ctx->outputFileName;\n    media_codec_state_t state = MEDIA_CODEC_STATE_NONE;\n    inFile = fopen(inputFileName, "rb");\n    if (!inFile) {\n        goto ERR;\n    }\n    outFile = fopen(outputFileName, "wb");\n    if (!outFile) {\n        goto ERR;\n    }\n    //get current time\n    lastTime = osal_gettime();\n    ret = hb_mm_mc_initialize(context);\n    if (ret) {\n        goto ERR;\n    }\n    ret = hb_mm_mc_configure(context);\n    if (ret) {\n        goto ERR;\n    }\n    mc_av_codec_startup_params_t startup_params;\n    startup_params.video_enc_startup_params.receive_frame_number = 0;\n    ret = hb_mm_mc_start(context, &startup_params);\n    if (ret) {\n        goto ERR;\n    }\n    ret = hb_mm_mc_pause(context);\n    if (ret) {\n        goto ERR;\n    }\n    do {\n    set_message(ctx);\n    if (!noMoreInput) {\n        media_codec_buffer_t inputBuffer;\n        memset(&inputBuffer, 0x00, sizeof(media_codec_buffer_t));\n        ret = hb_mm_mc_dequeue_input_buffer(context, &inputBuffer, 100);\n        if (!ret) {\n            curTime = osal_gettime();\n            if ((curTime - lastTime)/1000 < (uint32_t)ctx->duration) {\n                ret = fread(inputBuffer.vframe_buf.vir_ptr[0], 1,\n                inputBuffer.vframe_buf.size, inFile);\n                if (ret <= 0) {\n                    if(fseek(inFile, 0, SEEK_SET)) {\n                        printf("Failed to rewind input filen");\n                    } else {\n                        ret = fread(inputBuffer.vframe_buf.vir_ptr[0], 1,\n                        inputBuffer.vframe_buf.size, inFile);\n                        if (ret <= 0) {\n                            printf("Failed to read input filen");\n                        }\n                    }\n                }\n            } else {\n                printf("Time up(%d)n",ctx->duration);\n                ret = 0;\n            }\n            if (!ret) {\n                printf("There is no more input data!n");\n                inputBuffer.vframe_buf.frame_end = TRUE;\n                noMoreInput = 1;\n            }\n            ret = hb_mm_mc_queue_input_buffer(context, &inputBuffer, 100);\n            if (ret) {\n                printf("Queue input buffer fail.n");\n                break;\n            }\n        } else {\n            if (ret != (int32_t)HB_MEDIA_ERR_WAIT_TIMEOUT) {\n                printf("Dequeue input buffer fail.n");\n                break;\n            }\n        }\n    }\n    if (!lastStream) {\n        media_codec_buffer_t outputBuffer;\n        media_codec_output_buffer_info_t info;\n        memset(&outputBuffer, 0x00, sizeof(media_codec_buffer_t));\n        memset(&info, 0x00, sizeof(media_codec_output_buffer_info_t));\n        ret = hb_mm_mc_dequeue_output_buffer(context, &outputBuffer, &info,\n        3000);\n        if (!ret && outFile) {\n            fwrite(outputBuffer.vstream_buf.vir_ptr,\n                outputBuffer.vstream_buf.size, 1, outFile);\n            ret = hb_mm_mc_queue_output_buffer(context, &outputBuffer, 100);\n            if (ret) {\n                printf("Queue output buffer fail.n");\n                break;\n            }\n            if (outputBuffer.vstream_buf.stream_end) {\n                printf("There is no more output data!n");\n                lastStream = 1;\n                break;\n            }\n        } else {\n            if (ret != (int32_t)HB_MEDIA_ERR_WAIT_TIMEOUT) {\n                printf("Dequeue output buffer fail.n");\n                break;\n            }\n        }\n    }\n    if (needFlush) {\n        ret = hb_mm_mc_flush(context);\n        needFlush = 0;\n        if (ret) {\n            break;\n        }\n    }\n}while(TRUE);\nhb_mm_mc_stop(context);\nhb_mm_mc_release(context);\ncontext = NULL;\nERR:\nhb_mm_mc_get_state(context, &state);\nif (context && state!=\n    MEDIA_CODEC_STATE_UNINITIALIZED) {\n    hb_mm_mc_stop(context);\n    hb_mm_mc_release(context);\n}\nif (inFile)\n    fclose(inFile);\nif (outFile)\n    fclose(outFile);\n}\nint main(int argc, char *argv[])\n{\n    hb_s32 ret = 0;\n    char outputFileName[MAX_FILE_PATH] = "./tmp.yuv";\n    char inputFileName[MAX_FILE_PATH] = "./output.stream";\n    mc_video_codec_enc_params_t *params;\n    media_codec_context_t context;\n    memset(&context, 0x00, sizeof(media_codec_context_t));\n    context.codec_id = MEDIA_CODEC_ID_H265;\n    context.encoder = TRUE;\n    params = &context.video_enc_params;\n    params->width = 640;\n    params->height = 480;\n    params->pix_fmt = MC_PIXEL_FORMAT_YUV420P;\n    params->frame_buf_count = 5;\n    params->external_frame_buf = FALSE;\n    params->bitstream_buf_count = 5;\n    params->rc_params.mode = MC_AV_RC_MODE_H265CBR;\n    ret = hb_mm_mc_get_rate_control_config(&context, &params->rc_params);\n    if (ret) {\n        return -1;\n    }\n    params->rc_params.h265_cbr_params.bit_rate = 5000;\n    params->rc_params.h265_cbr_params.frame_rate = 30;\n    params->rc_params.h265_cbr_params.intra_period = 30;\n    params->gop_params.decoding_refresh_type = 2;\n    params->gop_params.gop_preset_idx = 2;\n    params->rot_degree = MC_CCW_0;\n    params->mir_direction = MC_DIRECTION_NONE;\n    params->frame_cropping_flag = FALSE;\n    MediaCodecTestContext ctx;\n    memset(&ctx, 0x00, sizeof(ctx));\n    ctx.context = &context;\n    ctx.inputFileName = inputFileName;\n    ctx.outputFileName = outputFileName;\n    mc_video_vui_params_t *vui = &ctx.vui;\n    ret = hb_mm_mc_get_vui_config(context, vui);\n    if (ret != 0) {\n        return -1;\n    }\n    vui->h265_vui.video_signal_type_present_flag = 1;\n    vui->h265_vui.video_format = 0;\n    vui->h265_vui.video_full_range_flag = 0;\n    ctx.message = ENC_CONFIG_VUI;\n    do_sync_encoding(&ctx);\n}\n'})}),"\n",(0,i.jsx)(n.h4,{id:"hb_mm_mc_set_vui_config",children:"hb_mm_mc_set_vui_config"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u51fd\u6570\u58f0\u660e\u3011"}),"\n",(0,i.jsx)(n.p,{children:"hb_s32 hb_mm_mc_set_vui_config(media_codec_context_t *context,\nconst mc_video_vui_params_t *params)"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u53c2\u6570\u63cf\u8ff0\u3011"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"[IN] media_codec_context_t *context\uff1a\u6307\u5b9acodec\u7c7b\u578b\u7684context"}),"\n",(0,i.jsx)(n.li,{children:"[IN] const mc_video_vui_params_t *params\uff1aVUI\u53c2\u6570"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u8fd4\u56de\u503c\u3011"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"0\uff1a\u64cd\u4f5c\u6210\u529f"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_UNKNOWN\uff1a \u672a\u77e5\u9519\u8bef"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_OPERATION_NOT_ALLOWED\uff1a\u64cd\u4f5c\u4e0d\u5141\u8bb8"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_INVALID_INSTANCE\uff1a\u65e0\u6548\u5b9e\u4f8b"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_INVALID_PARAMS\uff1a\u65e0\u6548\u53c2\u6570"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u529f\u80fd\u63cf\u8ff0\u3011"}),"\n",(0,i.jsx)(n.p,{children:"\u8bbe\u7f6eVUI \u53c2\u6570\uff0c\u8be5\u53c2\u6570\u4e3a\u9759\u6001\u53c2\u6570\u3002"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u793a\u4f8b\u4ee3\u7801\u3011"}),"\n",(0,i.jsxs)(n.p,{children:["\u53c2\u8003 ",(0,i.jsx)(n.a,{href:"#hb_mm_mc_get_vui_config",children:"hb_mm_mc_get_vui_config"})]}),"\n",(0,i.jsx)(n.h4,{id:"hb_mm_mc_get_3dnr_enc_config",children:"hb_mm_mc_get_3dnr_enc_config"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u51fd\u6570\u58f0\u660e\u3011"}),"\n",(0,i.jsx)(n.p,{children:"hb_s32 hb_mm_mc_get_3dnr_enc_config(media_codec_context_t\n*context, mc_video_3dnr_enc_params_t *params);"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u53c2\u6570\u63cf\u8ff0\u3011"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"[IN] media_codec_context_t *context\uff1a\u6307\u5b9acodec\u7c7b\u578b\u7684context"}),"\n",(0,i.jsx)(n.li,{children:"[IN] mc_video_3dnr_enc_params_t *params\uff1a3DNR\u53c2\u6570"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u8fd4\u56de\u503c\u3011"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"0\uff1a\u64cd\u4f5c\u6210\u529f"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_UNKNOWN\uff1a \u672a\u77e5\u9519\u8bef"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_OPERATION_NOT_ALLOWED\uff1a\u64cd\u4f5c\u4e0d\u5141\u8bb8"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_INVALID_INSTANCE\uff1a\u65e0\u6548\u5b9e\u4f8b"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_INVALID_PARAMS\uff1a\u65e0\u6548\u53c2\u6570"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u529f\u80fd\u63cf\u8ff0\u3011"}),"\n",(0,i.jsx)(n.p,{children:"\u83b7\u53d63DNR\u53c2\u6570\uff0c\u8be5\u53c2\u6570\u4e3a\u52a8\u6001\u53c2\u6570\uff0c\u9002\u7528\u4e8eH265."}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u793a\u4f8b\u4ee3\u7801\u3011"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:'#include "hb_media_codec.h"\n#include "hb_media_error.h"\ntypedef enum ENC_CONFIG_MESSAGE {\n    ENC_CONFIG_NONE = (0 << 0),\n    ENC_CONFIG_LONGTERM_REF = (1 << 0),\n    ENC_CONFIG_INTRA_REFRESH = (1 << 1),\n    ENC_CONFIG_RATE_CONTROL = (1 << 2),\n    ENC_CONFIG_DEBLK_FILTER = (1 << 3),\n    ENC_CONFIG_SAO = (1 << 4),\n    ENC_CONFIG_ENTROPY = (1 << 5),\n    ENC_CONFIG_VUI_TIMING = (1 << 6),\n    ENC_CONFIG_SLICE = (1 << 7),\n    ENC_CONFIG_REQUEST_IDR = (1 << 8),\n    ENC_CONFIG_SKIP_PIC = (1 << 9),\n    ENC_CONFIG_SMART_BG = (1 << 10),\n    ENC_CONFIG_MONOCHROMA = (1 << 11),\n    ENC_CONFIG_PRED_UNIT = (1 << 12),\n    ENC_CONFIG_TRANSFORM = (1 << 13),\n    ENC_CONFIG_ROI = (1 << 14),\n    ENC_CONFIG_MODE_DECISION = (1 << 15),\n    ENC_CONFIG_USER_DATA = (1 << 16),\n    ENC_CONFIG_MJPEG = (1 << 17),\n    ENC_CONFIG_JPEG = (1 << 18),\n    ENC_CONFIG_CAMERA = (1 << 19),\n    ENC_CONFIG_INSERT_USERDATA = (1 << 20),\n    ENC_CONFIG_VUI = (1 << 21),\n    ENC_CONFIG_3DNR = (1 << 22),\n    ENC_CONFIG_REQUEST_IDR_HEADER = (1 << 23),\n    ENC_CONFIG_ENABLE_IDR = (1 << 24),\n    ENC_CONFIG_TOTAL = (1 << 25),\n} ENC_CONFIG_MESSAGE;\ntypedef struct MediaCodecTestContext {\n    media_codec_context_t *context;\n    char *inputFileName;\n    char *outputFileName;\n    int32_t duration; // s\n    ENC_CONFIG_MESSAGE message;\n    mc_video_longterm_ref_mode_t ref_mode;\n    mc_rate_control_params_t rc_params;\n    mc_video_intra_refresh_params_t intra_refr;\n    mc_video_deblk_filter_params_t deblk_filter;\n    mc_h265_sao_params_t sao;\n    mc_h264_entropy_params_t entropy;\n    mc_video_vui_params_t vui;\n    mc_video_vui_timing_params_t vui_timing;\n    mc_video_slice_params_t slice;\n    mc_video_3dnr_enc_params_t noise_reduction;\n    mc_video_smart_bg_enc_params_t smart_bg;\n    mc_video_pred_unit_params_t pred_unit;\n    mc_video_transform_params_t transform;\n    mc_video_roi_params_t roi;\n    mc_video_mode_decision_params_t mode_decision;\n} MediaCodecTestContext;\nUint64 osal_gettime(void)\n{\n    struct timespec tp;\n    clock_gettime(CLOCK_MONOTONIC, &tp);\n    return ((Uint64)tp.tv_sec*1000 + tp.tv_nsec/1000000);\n}\nuint8_t uuid[] =\n"dc45e9bd-e6d948b7-962cd820-d923eeef+HorizonAI";\nstatic void set_message(MediaCodecTestContext *ctx) {\n    int ret = 0;\n    media_codec_context_t *context = ctx->context;\n    if (ctx->message & ENC_CONFIG_VUI) {\n        hb_mm_mc_get_vui_config(context, &ctx->vui);\n        ret = hb_mm_mc_set_vui_config(context, &ctx->vui);\n    }\n}\nstatic void do_sync_encoding(void *arg) {\n    hb_s32 ret = 0;\n    FILE *inFile;\n    FILE *outFile;\n    int noMoreInput = 0;\n    int lastStream = 0;\n    Uint64 lastTime = 0;\n    Uint64 curTime = 0;\n    int needFlush = 1;\n    MediaCodecTestContext *ctx = (MediaCodecTestContext *)arg;\n    media_codec_context_t *context = ctx->context;\n    char *inputFileName = ctx->inputFileName;\n    char *outputFileName = ctx->outputFileName;\n    media_codec_state_t state = MEDIA_CODEC_STATE_NONE;\n    inFile = fopen(inputFileName, "rb");\n    if (!inFile) {\n        goto ERR;\n    }\n    outFile = fopen(outputFileName, "wb");\n    if (!outFile) {\n        goto ERR;\n    }\n    //get current time\n    lastTime = osal_gettime();\n    ret = hb_mm_mc_initialize(context);\n    if (ret) {\n        goto ERR;\n    }\n    ret = hb_mm_mc_configure(context);\n    if (ret) {\n        goto ERR;\n    }\n    mc_av_codec_startup_params_t startup_params;\n    startup_params.video_enc_startup_params.receive_frame_number = 0;\n    ret = hb_mm_mc_start(context, &startup_params);\n    if (ret) {\n        goto ERR;\n    }\n    ret = hb_mm_mc_pause(context);\n    if (ret) {\n        goto ERR;\n    }\n    do {\n    set_message(ctx);\n    if (!noMoreInput) {\n        media_codec_buffer_t inputBuffer;\n        memset(&inputBuffer, 0x00, sizeof(media_codec_buffer_t));\n        ret = hb_mm_mc_dequeue_input_buffer(context, &inputBuffer, 100);\n        if (!ret) {\n            curTime = osal_gettime();\n            if ((curTime - lastTime)/1000 < (uint32_t)ctx->duration) {\n                ret = fread(inputBuffer.vframe_buf.vir_ptr[0], 1,\n                inputBuffer.vframe_buf.size, inFile);\n                if (ret <= 0) {\n                    if(fseek(inFile, 0, SEEK_SET)) {\n                        printf("Failed to rewind input filen");\n                    } else {\n                        ret = fread(inputBuffer.vframe_buf.vir_ptr[0], 1,\n                        inputBuffer.vframe_buf.size, inFile);\n                        if (ret <= 0) {\n                            printf("Failed to read input filen");\n                        }\n                    }\n                }\n            } else {\n                printf("Time up(%d)n",ctx->duration);\n                ret = 0;\n            }\n            if (!ret) {\n                printf("There is no more input data!n");\n                inputBuffer.vframe_buf.frame_end = TRUE;\n                noMoreInput = 1;\n            }\n            ret = hb_mm_mc_queue_input_buffer(context, &inputBuffer, 100);\n            if (ret) {\n                printf("Queue input buffer fail.n");\n                break;\n            }\n        } else {\n            if (ret != (int32_t)HB_MEDIA_ERR_WAIT_TIMEOUT) {\n                printf("Dequeue input buffer fail.n");\n                break;\n            }\n        }\n    }\n    if (!lastStream) {\n        media_codec_buffer_t outputBuffer;\n        media_codec_output_buffer_info_t info;\n        memset(&outputBuffer, 0x00, sizeof(media_codec_buffer_t));\n        memset(&info, 0x00, sizeof(media_codec_output_buffer_info_t));\n        ret = hb_mm_mc_dequeue_output_buffer(context, &outputBuffer, &info,\n        3000);\n        if (!ret && outFile) {\n            fwrite(outputBuffer.vstream_buf.vir_ptr,\n                outputBuffer.vstream_buf.size, 1, outFile);\n            ret = hb_mm_mc_queue_output_buffer(context, &outputBuffer, 100);\n            if (ret) {\n                printf("Queue output buffer fail.n");\n                break;\n            }\n            if (outputBuffer.vstream_buf.stream_end) {\n                printf("There is no more output data!n");\n                lastStream = 1;\n                break;\n            }\n        } else {\n            if (ret != (int32_t)HB_MEDIA_ERR_WAIT_TIMEOUT) {\n                printf("Dequeue output buffer fail.n");\n                break;\n            }\n        }\n    }\n    if (needFlush) {\n        ret = hb_mm_mc_flush(context);\n        needFlush = 0;\n        if (ret) {\n            break;\n        }\n    }\n}while(TRUE);\nhb_mm_mc_stop(context);\nhb_mm_mc_release(context);\ncontext = NULL;\nERR:\nhb_mm_mc_get_state(context, &state);\nif (context && state!=\n    MEDIA_CODEC_STATE_UNINITIALIZED) {\n    hb_mm_mc_stop(context);\n    hb_mm_mc_release(context);\n}\nif (inFile)\n    fclose(inFile);\nif (outFile)\n    fclose(outFile);\n}\nint main(int argc, char *argv[])\n{\n    hb_s32 ret = 0;\n    char outputFileName[MAX_FILE_PATH] = "./tmp.yuv";\n    char inputFileName[MAX_FILE_PATH] = "./output.stream";\n    mc_video_codec_enc_params_t *params;\n    media_codec_context_t context;\n    memset(&context, 0x00, sizeof(media_codec_context_t));\n    context.codec_id = MEDIA_CODEC_ID_H265;\n    context.encoder = TRUE;\n    params = &context.video_enc_params;\n    params->width = 640;\n    params->height = 480;\n    params->pix_fmt = MC_PIXEL_FORMAT_YUV420P;\n    params->frame_buf_count = 5;\n    params->external_frame_buf = FALSE;\n    params->bitstream_buf_count = 5;\n    params->rc_params.mode = MC_AV_RC_MODE_H265CBR;\n    ret = hb_mm_mc_get_rate_control_config(&context, &params->rc_params);\n    if (ret) {\n        return -1;\n    }\n    params->rc_params.h265_cbr_params.bit_rate = 5000;\n    params->rc_params.h265_cbr_params.frame_rate = 30;\n    params->rc_params.h265_cbr_params.intra_period = 30;\n    params->gop_params.decoding_refresh_type = 2;\n    params->gop_params.gop_preset_idx = 2;\n    params->rot_degree = MC_CCW_0;\n    params->mir_direction = MC_DIRECTION_NONE;\n    params->frame_cropping_flag = FALSE;\n    MediaCodecTestContext ctx;\n    memset(&ctx, 0x00, sizeof(ctx));\n    ctx.context = &context;\n    ctx.inputFileName = inputFileName;\n    ctx.outputFileName = outputFileName;\n    mc_video_3dnr_enc_params_t *noise_rd = &ctx.noise_reduction;\n    ret = hb_mm_mc_get_3dnr_enc_config(context, noise_rd);\n    noise_rd->nr_y_enable = 0;\n    noise_rd->nr_cb_enable = 0;\n    noise_rd->nr_cr_enable = 0;\n    noise_rd->nr_est_enable = 0;\n    ctx.message = ENC_CONFIG_3DNR;\n    do_sync_encoding(&ctx);\n}\n'})}),"\n",(0,i.jsx)(n.h4,{id:"hb_mm_mc_set_3dnr_enc_config",children:"hb_mm_mc_set_3dnr_enc_config"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u51fd\u6570\u58f0\u660e\u3011"}),"\n",(0,i.jsx)(n.p,{children:"hb_s32 hb_mm_mc_set_3dnr_enc_config(media_codec_context_t\n*context, const mc_video_3dnr_enc_params_t *params);"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u53c2\u6570\u63cf\u8ff0\u3011"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"[IN] media_codec_context_t *context\uff1a\u6307\u5b9acodec\u7c7b\u578b\u7684context"}),"\n",(0,i.jsx)(n.li,{children:"[IN] const mc_video_3dnr_enc_params_t *params\uff1a3DNR\u53c2\u6570"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u8fd4\u56de\u503c\u3011"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"0\uff1a\u64cd\u4f5c\u6210\u529f"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_UNKNOWN\uff1a \u672a\u77e5\u9519\u8bef"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_OPERATION_NOT_ALLOWED\uff1a\u64cd\u4f5c\u4e0d\u5141\u8bb8"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_INVALID_INSTANCE\uff1a\u65e0\u6548\u5b9e\u4f8b"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_INVALID_PARAMS\uff1a\u65e0\u6548\u53c2\u6570"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u529f\u80fd\u63cf\u8ff0\u3011"}),"\n",(0,i.jsx)(n.p,{children:"\u8bbe\u7f6e3DNR\u53c2\u6570\uff0c\u8be5\u53c2\u6570\u4e3a\u52a8\u6001\u53c2\u6570\uff0c\u9002\u7528\u4e8eH265\u3002"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u793a\u4f8b\u4ee3\u7801\u3011"}),"\n",(0,i.jsxs)(n.p,{children:["\u53c2\u8003 ",(0,i.jsx)(n.a,{href:"#hb_mm_mc_get_3dnr_enc_config",children:"hb_mm_mc_get_3dnr_enc_config"})]}),"\n",(0,i.jsx)(n.h4,{id:"hb_mm_mc_request_idr_header",children:"hb_mm_mc_request_idr_header"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u51fd\u6570\u58f0\u660e\u3011"}),"\n",(0,i.jsx)(n.p,{children:"hb_s32 hb_mm_mc_request_idr_header(media_codec_context_t\n*context, hb_u32 force_header)"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u53c2\u6570\u63cf\u8ff0\u3011"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"[IN] media_codec_context_t *context\uff1a\u6307\u5b9acodec\u7c7b\u578b\u7684context"}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"[IN] hb_u32 force_header\uff1a"}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"0 : No froced header(VPS/SPS/PPS)"}),"\n",(0,i.jsx)(n.p,{children:"1 : Forced header before IDR frame"}),"\n",(0,i.jsx)(n.p,{children:"2 : Forced header before I frame for H264 or forced header before\nCRA and IDR frame for H265"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u8fd4\u56de\u503c\u3011"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"0\uff1a\u64cd\u4f5c\u6210\u529f"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_UNKNOWN\uff1a \u672a\u77e5\u9519\u8bef"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_OPERATION_NOT_ALLOWED\uff1a\u64cd\u4f5c\u4e0d\u5141\u8bb8"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_INVALID_INSTANCE\uff1a\u65e0\u6548\u5b9e\u4f8b"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_INVALID_PARAMS\uff1a\u65e0\u6548\u53c2\u6570"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u529f\u80fd\u63cf\u8ff0\u3011"}),"\n",(0,i.jsx)(n.p,{children:"\u8bf7\u6c42\u5e27\u5934IDR\u5e27\u5934\u4fe1\u606f\uff0c\u9002\u7528\u4e8eH264/H265\u3002"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u793a\u4f8b\u4ee3\u7801\u3011"}),"\n",(0,i.jsxs)(n.p,{children:["\u53c2\u8003 ",(0,i.jsx)(n.a,{href:"#hb_mm_mc_get_longterm_ref_mode",children:"hb_mm_mc_get_longterm_ref_mode"})]}),"\n",(0,i.jsx)(n.h4,{id:"hb_mm_mc_enable_idr_frame",children:"hb_mm_mc_enable_idr_frame"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u51fd\u6570\u58f0\u660e\u3011"}),"\n",(0,i.jsx)(n.p,{children:"hb_s32 hb_mm_mc_enable_idr_frame(media_codec_context_t\n*context, hb_bool enable)"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u53c2\u6570\u63cf\u8ff0\u3011"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"[IN] media_codec_context_t *context\uff1a\u6307\u5b9acodec\u7c7b\u578b\u7684context"}),"\n",(0,i.jsx)(n.li,{children:"[IN] hb_bool enable\uff1a0\uff1a\u4e0d\u4f7f\u80fd\uff1b1\uff1a\u4f7f\u80fd\uff1b"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u8fd4\u56de\u503c\u3011"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"0\uff1a\u64cd\u4f5c\u6210\u529f"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_UNKNOWN\uff1a \u672a\u77e5\u9519\u8bef"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_OPERATION_NOT_ALLOWED\uff1a\u64cd\u4f5c\u4e0d\u5141\u8bb8"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_INVALID_INSTANCE\uff1a\u65e0\u6548\u5b9e\u4f8b"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_INVALID_PARAMS\uff1a\u65e0\u6548\u53c2\u6570"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u529f\u80fd\u63cf\u8ff0\u3011"}),"\n",(0,i.jsx)(n.p,{children:"\u4f7f\u80fdIDR\u5e27\uff0c\u9002\u7528\u4e8eH264/H265\u3002"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u793a\u4f8b\u4ee3\u7801\u3011"}),"\n",(0,i.jsxs)(n.p,{children:["\u53c2\u8003 ",(0,i.jsx)(n.a,{href:"#hb_mm_mc_get_longterm_ref_mode",children:"hb_mm_mc_get_longterm_ref_mode"})]}),"\n",(0,i.jsx)(n.h4,{id:"hb_mm_mc_register_audio_encoder",children:"hb_mm_mc_register_audio_encoder"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u51fd\u6570\u58f0\u660e\u3011"}),"\n",(0,i.jsx)(n.p,{children:"hb_s32 hb_mm_mc_register_audio_encoder(hb_s32 *handle,\nmc_audio_encode_param_t *encoder)"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u53c2\u6570\u63cf\u8ff0\u3011"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"[IN] hb_s32 *handle\uff1a\u7f16\u7801\u5668\u53e5\u67c4"}),"\n",(0,i.jsx)(n.li,{children:"[IN] mc_audio_encode_param_t *encoder\uff1aaudio\u7f16\u7801\u5668\u63cf\u8ff0\u7b26\uff1b"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u8fd4\u56de\u503c\u3011"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"0\uff1a\u64cd\u4f5c\u6210\u529f"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_UNKNOWN\uff1a \u672a\u77e5\u9519\u8bef"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_OPERATION_NOT_ALLOWED\uff1a\u64cd\u4f5c\u4e0d\u5141\u8bb8"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_INVALID_INSTANCE\uff1a\u65e0\u6548\u5b9e\u4f8b"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_INVALID_PARAMS\uff1a\u65e0\u6548\u53c2\u6570"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u529f\u80fd\u63cf\u8ff0\u3011"}),"\n",(0,i.jsx)(n.p,{children:"\u6ce8\u518caudio\u7f16\u7801\u5668\uff0c\u9002\u7528\u4e8eAudio\u3002"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u793a\u4f8b\u4ee3\u7801\u3011"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:'#include "hb_media_codec.h"\n#include "hb_media_error.h"\n#include "include/aac.h"\nint main(int argc, char *argv[])\n{\n    mc_audio_codec_enc_params_t *params;\n    media_codec_context_t context;\n    memset(&context, 0x00, sizeof(media_codec_context_t));\n    context.codec_id = MEDIA_CODEC_ID_AAC;\n    context.encoder = TRUE;\n    params = &context.audio_enc_params;\n    params->bit_rate = 128000;\n    params->frame_buf_count = 5;\n    params->packet_count = 5;\n    params->sample_fmt = MC_AV_SAMPLE_FMT_S16;\n    params->sample_rate = MC_AV_SAMPLE_RATE_16000;\n    params->channel_layout = MC_AV_CHANNEL_LAYOUT_STEREO;\n    params->channels = 2;\n    mc_aac_enc_config_t config;\n    config.profile = MC_AAC_PROFILE_LOW;\n    config.type = MC_AAC_DATA_TYPE_ADTS;\n    params->enc_config = &config;\n    int ret;\n    int handle;\n    mc_audio_encode_param_t encoder;\n    encoder.ff_type = MEDIA_CODEC_ID_AAC;\n    snprintf(encoder.ff_codec_name, sizeof(encoder.ff_codec_name), "aacenc");\n    encoder.ff_audio_open_encoder = ff_audio_aac_open_encoder;\n    encoder.ff_audio_encode_frame = ff_audio_aac_encode_frm;\n    encoder.ff_audio_close_encoder = ff_audio_aac_close_encoder;\n    ret = hb_mm_mc_register_audio_encoder(&handle, &encoder);\n    printf("handle = %d\\n", handle);\n    ASSERT_EQ(ret, 0);\n    ret = hb_mm_mc_unregister_audio_encoder(handle);\n    ASSERT_EQ(ret, 0);\n}\n'})}),"\n",(0,i.jsx)(n.h4,{id:"hb_mm_mc_unregister_audio_encoder",children:"hb_mm_mc_unregister_audio_encoder"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u51fd\u6570\u58f0\u660e\u3011"}),"\n",(0,i.jsx)(n.p,{children:"hb_s32 hb_mm_mc_unregister_audio_encoder(hb_s32 handle)"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u53c2\u6570\u63cf\u8ff0\u3011"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"[IN] hb_s32 *handle\uff1a\u7f16\u7801\u5668\u53e5\u67c4"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u8fd4\u56de\u503c\u3011"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"0\uff1a\u64cd\u4f5c\u6210\u529f"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_UNKNOWN\uff1a \u672a\u77e5\u9519\u8bef"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_OPERATION_NOT_ALLOWED\uff1a\u64cd\u4f5c\u4e0d\u5141\u8bb8"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_INVALID_INSTANCE\uff1a\u65e0\u6548\u5b9e\u4f8b"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_INVALID_PARAMS\uff1a\u65e0\u6548\u53c2\u6570"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u529f\u80fd\u63cf\u8ff0\u3011"}),"\n",(0,i.jsx)(n.p,{children:"\u6ce8\u9500audio\u7f16\u7801\u5668\uff0c\u9002\u7528\u4e8eAudio\u3002"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u793a\u4f8b\u4ee3\u7801\u3011"}),"\n",(0,i.jsxs)(n.p,{children:["\u53c2\u8003 ",(0,i.jsx)(n.a,{href:"#hb_mm_mc_register_audio_encoder",children:"hb_mm_mc_register_audio_encoder"})]}),"\n",(0,i.jsx)(n.h4,{id:"hb_mm_mc_register_audio_decoder",children:"hb_mm_mc_register_audio_decoder"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u51fd\u6570\u58f0\u660e\u3011"}),"\n",(0,i.jsx)(n.p,{children:"hb_s32 hb_mm_mc_register_audio_decoder(hb_s32 *handle,\nmc_audio_decode_param_t *decoder)"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u53c2\u6570\u63cf\u8ff0\u3011"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"[IN] hb_s32 *handle\uff1a\u89e3\u7801\u5668\u53e5\u67c4"}),"\n",(0,i.jsx)(n.li,{children:"[IN] mc_audio_decode_param_t *decoder\uff1aaudio\u89e3\u7801\u5668\u63cf\u8ff0\u7b26\uff1b"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u8fd4\u56de\u503c\u3011"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"0\uff1a\u64cd\u4f5c\u6210\u529f"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_UNKNOWN\uff1a \u672a\u77e5\u9519\u8bef"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_OPERATION_NOT_ALLOWED\uff1a\u64cd\u4f5c\u4e0d\u5141\u8bb8"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_INVALID_INSTANCE\uff1a\u65e0\u6548\u5b9e\u4f8b"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_INVALID_PARAMS\uff1a\u65e0\u6548\u53c2\u6570"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u529f\u80fd\u63cf\u8ff0\u3011"}),"\n",(0,i.jsx)(n.p,{children:"\u6ce8\u518caudio\u89e3\u7801\u5668\uff0c\u9002\u7528\u4e8eAudio\u3002"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u793a\u4f8b\u4ee3\u7801\u3011"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:'#include "hb_media_codec.h"\n#include "hb_media_error.h"\n#include "include/aac.h"\nint main(int argc, char *argv[])\n{\n    mc_audio_codec_dec_params_t *params;\n    media_codec_context_t context;\n    memset(&context, 0x00, sizeof(media_codec_context_t));\n    context.codec_id = MEDIA_CODEC_ID_AAC;\n    context.encoder = FALSE;\n    params = &context.audio_dec_params;\n    params->feed_mode = MC_FEEDING_MODE_FRAME_SIZE;\n    params->packet_buf_size = 1024;\n    params->packet_count = 5;\n    params->frame_cache_size = 5;\n    params->frame_buf_count = 5;\n    mc_aac_dec_config_t config;\n    config.sample_rate = MC_AV_SAMPLE_RATE_8000;\n    config.channels = 1;\n    config.sample_fmt = MC_AV_SAMPLE_FMT_S16;\n    params->dec_config = &config;\n    mc_audio_decode_param_t decoder;\n    decoder.ff_type = MEDIA_CODEC_ID_AAC;\n    snprintf(decoder.ff_codec_name, sizeof(decoder.ff_codec_name), "aacdec");\n    decoder.ff_audio_open_decoder = ff_audio_aac_open_decoder;\n    decoder.ff_audio_decode_frame = ff_audio_aac_decode_frm;\n    decoder.ff_audio_close_decoder = ff_audio_aac_close_decoder;\n    ret = hb_mm_mc_register_audio_decoder(&handle, &decoder);\n    ASSERT_EQ(ret, 0);\n    ret = hb_mm_mc_unregister_audio_decoder(handle);\n    ASSERT_EQ(ret, 0);\n}\n'})}),"\n",(0,i.jsx)(n.h4,{id:"hb_mm_mc_unregister_audio_decoder",children:"hb_mm_mc_unregister_audio_decoder"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u51fd\u6570\u58f0\u660e\u3011"}),"\n",(0,i.jsx)(n.p,{children:"hb_s32 hb_mm_mc_unregister_audio_decoder(hb_s32 handle)"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u53c2\u6570\u63cf\u8ff0\u3011"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"[IN] hb_s32 *handle\uff1a\u89e3\u7801\u5668\u53e5\u67c4\uff1b"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u8fd4\u56de\u503c\u3011"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"0\uff1a\u64cd\u4f5c\u6210\u529f"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_UNKNOWN\uff1a \u672a\u77e5\u9519\u8bef"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_OPERATION_NOT_ALLOWED\uff1a\u64cd\u4f5c\u4e0d\u5141\u8bb8"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_INVALID_INSTANCE\uff1a\u65e0\u6548\u5b9e\u4f8b"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_INVALID_PARAMS\uff1a\u65e0\u6548\u53c2\u6570"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u529f\u80fd\u63cf\u8ff0\u3011"}),"\n",(0,i.jsx)(n.p,{children:"\u6ce8\u9500audio\u89e3\u7801\u5668\uff0c\u9002\u7528\u4e8eAudio\u3002"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u793a\u4f8b\u4ee3\u7801\u3011"}),"\n",(0,i.jsxs)(n.p,{children:["\u53c2\u8003 ",(0,i.jsx)(n.a,{href:"#hb_mm_mc_register_audio_decoder",children:"hb_mm_mc_register_audio_decoder"})]}),"\n",(0,i.jsx)(n.h4,{id:"hb_mm_mc_get_explicit_header_config",children:"hb_mm_mc_get_explicit_header_config"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u51fd\u6570\u58f0\u660e\u3011"}),"\n",(0,i.jsx)(n.p,{children:"hb_s32 hb_mm_mc_get_explicit_header_config\n(media_codec_context_t *context, hb_s32 *status)"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u53c2\u6570\u63cf\u8ff0\u3011"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"[IN] media_codec_context_t *context\uff1a\u6307\u5b9acodec\u7c7b\u578b\u7684context"}),"\n",(0,i.jsx)(n.li,{children:"[OUT] hb_s32 *status\uff1a\u4f7f\u80fd/\u4e0d\u4f7f\u80fd\u5934\u4fe1\u606f\u548cIDR\u5e27\u7f16\u7801\u6210\u4e00\u5e27"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u8fd4\u56de\u503c\u3011"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"0\uff1a\u64cd\u4f5c\u6210\u529f"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_UNKNOWN\uff1a \u672a\u77e5\u9519\u8bef"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_INVALID_INSTANCE\uff1a\u65e0\u6548\u5b9e\u4f8b"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_INVALID_PARAMS\uff1a\u65e0\u6548\u53c2\u6570"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u529f\u80fd\u63cf\u8ff0\u3011"}),"\n",(0,i.jsx)(n.p,{children:"\u83b7\u53d6\u5934\u4fe1\u606f\u548cIDR\u5e27\u662f\u5426\u7f16\u7801\u6210\u4e00\u5e27\u7684\u914d\u7f6e\uff0c0\uff1aIDR\u548c\u5934\u4fe1\u606f\u72ec\u7acb\uff0c1\uff1aIDR\u548c\u5934\u4fe1\u606f\u5408\u6210\u4e00\u5e27\uff0c\u9002\u7528\u4e8eH264/H265\u3002"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u793a\u4f8b\u4ee3\u7801\u3011"}),"\n",(0,i.jsxs)(n.p,{children:["\u53c2\u8003 ",(0,i.jsx)(n.a,{href:"#hb_mm_mc_get_longterm_ref_mode",children:"hb_mm_mc_get_longterm_ref_mode"})]}),"\n",(0,i.jsx)(n.h4,{id:"hb_mm_mc_set_explicit_header_config",children:"hb_mm_mc_set_explicit_header_config"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u51fd\u6570\u58f0\u660e\u3011"}),"\n",(0,i.jsx)(n.p,{children:"hb_s32 hb_mm_mc_set_explicit_header_config\n(media_codec_context_t *context, hb_s32 status)"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u53c2\u6570\u63cf\u8ff0\u3011"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"[IN] media_codec_context_t *context\uff1a\u6307\u5b9acodec\u7c7b\u578b\u7684context"}),"\n",(0,i.jsx)(n.li,{children:"[IN] hb_s32 status\uff1a\u4f7f\u80fd/\u4e0d\u4f7f\u80fd\u5934\u4fe1\u606f\u548cIDR\u5e27\u7f16\u7801\u6210\u4e00\u5e27"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u8fd4\u56de\u503c\u3011"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"0\uff1a\u64cd\u4f5c\u6210\u529f"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_UNKNOWN\uff1a \u672a\u77e5\u9519\u8bef"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_OPERATION_NOT_ALLOWED\uff1a\u64cd\u4f5c\u4e0d\u5141\u8bb8"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_INVALID_INSTANCE\uff1a\u65e0\u6548\u5b9e\u4f8b"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_INVALID_PARAMS\uff1a\u65e0\u6548\u53c2\u6570"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u529f\u80fd\u63cf\u8ff0\u3011"}),"\n",(0,i.jsx)(n.p,{children:"\u4f7f\u80fd/\u4e0d\u4f7f\u80fd\u5934\u4fe1\u606f\u548cI\u5e27\u7f16\u7801\u6210\u4e00\u5e27\uff0c\u8be5\u53c2\u6570\u4e3a\u9759\u6001\u53c2\u6570\uff0c0\uff1aIDR\u548c\u5934\u4fe1\u606f\u72ec\u7acb\uff0c1\uff1aIDR\u548c\u5934\u4fe1\u606f\u5408\u6210\u4e00\u5e27\uff0c\u9002\u7528\u4e8eH264/H265\u3002"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u793a\u4f8b\u4ee3\u7801\u3011"}),"\n",(0,i.jsxs)(n.p,{children:["\u53c2\u8003 ",(0,i.jsx)(n.a,{href:"#hb_mm_mc_get_longterm_ref_mode",children:"hb_mm_mc_get_longterm_ref_mode"})]}),"\n",(0,i.jsx)(n.h4,{id:"hb_mm_mc_get_roi_avg_qp",children:"hb_mm_mc_get_roi_avg_qp"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u51fd\u6570\u58f0\u660e\u3011"}),"\n",(0,i.jsx)(n.p,{children:"hb_s32 hb_mm_mc_get_roi_avg_qp(media_codec_context_t *\ncontext, hb_u32 * params)"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u53c2\u6570\u63cf\u8ff0\u3011"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"[IN] media_codec_context_t *context\uff1a\u6307\u5b9acodec\u7c7b\u578b\u7684context"}),"\n",(0,i.jsx)(n.li,{children:"[OUT] hb_u32 *params\uff1aROI \u5e73\u5747QP"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u8fd4\u56de\u503c\u3011"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"0\uff1a\u64cd\u4f5c\u6210\u529f"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_UNKNOWN\uff1a \u672a\u77e5\u9519\u8bef"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_INVALID_INSTANCE\uff1a\u65e0\u6548\u5b9e\u4f8b"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_INVALID_PARAMS\uff1a\u65e0\u6548\u53c2\u6570"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u529f\u80fd\u63cf\u8ff0\u3011"}),"\n",(0,i.jsx)(n.p,{children:"\u83b7\u53d6ROI \u5e73\u5747QP\u503c\uff0c0\uff1a\u4ee3\u8868\u8be5\u503c\u7531\u7528\u6237\u8bbe\u5b9a\u5f97QPMAP\u51b3\u5b9a\uff0c\u9002\u7528\u4e8eH264/H265\u3002"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u793a\u4f8b\u4ee3\u7801\u3011"}),"\n",(0,i.jsxs)(n.p,{children:["\u53c2\u8003 ",(0,i.jsx)(n.a,{href:"#hb_mm_mc_get_longterm_ref_mode",children:"hb_mm_mc_get_longterm_ref_mode"})]}),"\n",(0,i.jsx)(n.h4,{id:"hb_mm_mc_set_roi_avg_qp",children:"hb_mm_mc_set_roi_avg_qp"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u51fd\u6570\u58f0\u660e\u3011"}),"\n",(0,i.jsx)(n.p,{children:"hb_s32 hb_mm_mc_set_roi_avg_qp(media_codec_context_t *\ncontext, hb_u32 params)"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u53c2\u6570\u63cf\u8ff0\u3011"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"[IN] media_codec_context_t *context\uff1a\u6307\u5b9acodec\u7c7b\u578b\u7684context"}),"\n",(0,i.jsx)(n.li,{children:"[IN] hb_u32 params\uff1aROI\u5e73\u5747QP\u503c"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u8fd4\u56de\u503c\u3011"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"0\uff1a\u64cd\u4f5c\u6210\u529f"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_UNKNOWN\uff1a \u672a\u77e5\u9519\u8bef"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_OPERATION_NOT_ALLOWED\uff1a\u64cd\u4f5c\u4e0d\u5141\u8bb8"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_INVALID_INSTANCE\uff1a\u65e0\u6548\u5b9e\u4f8b"}),"\n",(0,i.jsx)(n.li,{children:"HB_MEDIA_ERR_INVALID_PARAMS\uff1a\u65e0\u6548\u53c2\u6570"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u529f\u80fd\u63cf\u8ff0\u3011"}),"\n",(0,i.jsx)(n.p,{children:"\u8bbe\u7f6eROI\u7f16\u7801\u5e73\u5747QP\u503c\uff0c\u8be5\u53c2\u6570\u4e3a\u52a8\u6001\u53c2\u6570\uff0c0\uff1a\u8868\u793a\u4f7f\u7528\u8bbe\u7f6e\u7684QP\nMap\u4e2d\u6240\u6709\u503c\u5f97\u5e73\u5747\u503c\uff0c\u8be5\u503c\u5728RC\u6a21\u5f0f\u4e3aCBR\u6216\u8005AVBR\u65f6\u624d\u80fd\u4f7f\u7f16\u7801\u6548\u679c\u751f\u6548\uff0c\u9002\u7528\u4e8eH264/H265\u3002"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u793a\u4f8b\u4ee3\u7801\u3011"}),"\n",(0,i.jsxs)(n.p,{children:["\u53c2\u8003 ",(0,i.jsx)(n.a,{href:"#hb_mm_mc_get_longterm_ref_mode",children:"hb_mm_mc_get_longterm_ref_mode"})]}),"\n",(0,i.jsx)(n.h3,{id:"\u4e3b\u8981\u53c2\u6570\u8bf4\u660e",children:"\u4e3b\u8981\u53c2\u6570\u8bf4\u660e"}),"\n",(0,i.jsx)(n.h4,{id:"media_codec_state_t",children:"media_codec_state_t"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u63cf\u8ff0\u3011"}),"\n",(0,i.jsx)(n.p,{children:"\u5b9a\u4e49Media codec\u7684\u5185\u90e8\u5de5\u4f5c\u72b6\u6001\u3002"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u5b9a\u4e49\u3011"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"typedef enum _media_codec_state {\n    MEDIA_CODEC_STATE_NONE = -1,\n    MEDIA_CODEC_STATE_UNINITIALIZED,\n    MEDIA_CODEC_STATE_INITIALIZED,\n    MEDIA_CODEC_STATE_CONFIGURED,\n    MEDIA_CODEC_STATE_STARTED,\n    MEDIA_CODEC_STATE_PAUSED,\n    MEDIA_CODEC_STATE_FLUSHING,\n    MEDIA_CODEC_STATE_ERROR,\n    MEDIA_CODEC_STATE_TOTAL,\n} media_codec_state_t;\n"})}),"\n",(0,i.jsx)(n.h4,{id:"media_codec_id_t",children:"media_codec_id_t"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u63cf\u8ff0\u3011"}),"\n",(0,i.jsx)(n.p,{children:"\u5b9a\u4e49MediaCodec\u652f\u6301\u7684codec id\u3002"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u5b9a\u4e49\u3011"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"typedef enum _media_codec_id {\n    MEDIA_CODEC_ID_NONE = -1,\n    /* Video Codecs */\n    MEDIA_CODEC_ID_H264,\n    MEDIA_CODEC_ID_H265,\n    MEDIA_CODEC_ID_MJPEG,\n    MEDIA_CODEC_ID_JPEG,\n    /* Audio Codecs */\n    MEDIA_CODEC_ID_FLAC,\n    MEDIA_CODEC_ID_PCM_MULAW,\n    MEDIA_CODEC_ID_PCM_ALAW,\n    MEDIA_CODEC_ID_ADPCM_G726,\n    MEDIA_CODEC_ID_ADPCM,\n    MEDIA_CODEC_ID_AAC,\n    MEDIA_CODEC_ID_MP3,\n    MEDIA_CODEC_ID_MP2,\n    MEDIA_CODEC_ID_TAK,\n    MEDIA_CODEC_ID_AC3,\n    MEDIA_CODEC_ID_WMA,\n    MEDIA_CODEC_ID_AMR,\n    MEDIA_CODEC_ID_APE,\n    MEDIA_CODEC_ID_G729,\n    MEDIA_CODEC_ID_G723,\n    MEDIA_CODEC_ID_G722,\n    MEDIA_CODEC_ID_IAC,\n    MEDIA_CODEC_ID_RALF,\n    MEDIA_CODEC_ID_QDMC,\n    MEDIA_CODEC_ID_DTS,\n    MEDIA_CODEC_ID_GSM,\n    MEDIA_CODEC_ID_TTA,\n    MEDIA_CODEC_ID_QCELP,\n    MEDIA_CODEC_ID_MLP,\n    MEDIA_CODEC_ID_ATRAC1,\n    MEDIA_CODEC_ID_IMC,\n    MEDIA_CODEC_ID_EAC,\n    MEDIA_CODEC_ID_MP1,\n    MEDIA_CODEC_ID_SIPR,\n    MEDIA_CODEC_ID_OPUS,\n    MEDIA_CODEC_ID_CELT,\n    MEDIA_CODEC_ID_MOV_TEXT,\n    MEDIA_CODEC_ID_TOTAL,\n} media_codec_id_t;\n"})}),"\n",(0,i.jsx)(n.h4,{id:"mc_video_rate_control_mode_t",children:"mc_video_rate_control_mode_t"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u63cf\u8ff0\u3011"}),"\n",(0,i.jsx)(n.p,{children:"\u5b9a\u4e49\u89c6\u9891\u7684\u7801\u7387\u63a7\u5236\u65b9\u5f0f\uff0c\u76ee\u524d\u53ea\u652f\u6301H264/H265\u548cMJPEG\u7f16\u7801\u901a\u9053\u7684\u7801\u7387\u63a7\u5236\u3002"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u5b9a\u4e49\u3011"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"typedef enum _mc_video_rate_control_mode {\n    MC_AV_RC_MODE_NONE = -1,\n    MC_AV_RC_MODE_H264CBR,\n    MC_AV_RC_MODE_H264VBR,\n    MC_AV_RC_MODE_H264AVBR,\n    MC_AV_RC_MODE_H264FIXQP,\n    MC_AV_RC_MODE_H264QPMAP,\n    MC_AV_RC_MODE_H265CBR,\n    MC_AV_RC_MODE_H265VBR,\n    MC_AV_RC_MODE_H265AVBR,\n    MC_AV_RC_MODE_H265FIXQP,\n    MC_AV_RC_MODE_H265QPMAP,\n    MC_AV_RC_MODE_MJPEGFIXQP,\n    MC_AV_RC_MODE_TOTAL,\n} mc_video_rate_control_mode_t;\n"})}),"\n",(0,i.jsx)(n.h4,{id:"mc_h264_cbr_params_t",children:"mc_h264_cbr_params_t"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u63cf\u8ff0\u3011"}),"\n",(0,i.jsx)(n.p,{children:"\u5b9a\u4e49H264\u7684CBR\u63a7\u5236\u65b9\u5f0f\u4e0b\u7684\u53ef\u8c03\u8282\u7684\u53c2\u6570\u96c6\u3002"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u5b9a\u4e49\u3011"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"typedef struct _mc_h264_cbr_params {\n    hb_u32 intra_period;\n    hb_u32 intra_qp;\n    hb_u32 bit_rate;\n    hb_u32 frame_rate;\n    hb_u32 initial_rc_qp;\n    hb_s32 vbv_buffer_size;\n    hb_u32 mb_level_rc_enalbe;\n    hb_u32 min_qp_I;\n    hb_u32 max_qp_I;\n    hb_u32 min_qp_P;\n    hb_u32 max_qp_P;\n    hb_u32 min_qp_B;\n    hb_u32 max_qp_B;\n    hb_u32 hvs_qp_enable;\n    hb_s32 hvs_qp_scale;\n    hb_u32 max_delta_qp;\n    hb_bool qp_map_enable;\n} mc_h264_cbr_params_t;\n"})}),"\n",(0,i.jsx)(n.h4,{id:"mc_h264_vbr_params_t",children:"mc_h264_vbr_params_t"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u63cf\u8ff0\u3011"}),"\n",(0,i.jsx)(n.p,{children:"\u5b9a\u4e49H264\u7684VBR\u63a7\u5236\u65b9\u5f0f\u4e0b\u7684\u53ef\u8c03\u8282\u7684\u53c2\u6570\u96c6\u3002"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u5b9a\u4e49\u3011"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"typedef struct _mc_h264_vbr_params {\n    hb_u32 intra_period;\n    hb_u32 intra_qp;\n    hb_u32 frame_rate;\n    hb_bool qp_map_enable;\n} mc_h264_vbr_params_t;\n"})}),"\n",(0,i.jsx)(n.h4,{id:"mc_h264_avbr_params_t",children:"mc_h264_avbr_params_t"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u63cf\u8ff0\u3011"}),"\n",(0,i.jsx)(n.p,{children:"\u5b9a\u4e49H264\u7684AVBR\u63a7\u5236\u65b9\u5f0f\u4e0b\u7684\u53ef\u8c03\u8282\u7684\u53c2\u6570\u96c6\u3002"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u5b9a\u4e49\u3011"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"typedef struct _mc_h264_avbr_params {\n    hb_u32 intra_period;\n    hb_u32 intra_qp;\n    hb_u32 bit_rate;\n    hb_u32 frame_rate;\n    hb_u32 initial_rc_qp;\n    hb_s32 vbv_buffer_size;\n    hb_u32 mb_level_rc_enalbe;\n    hb_u32 min_qp_I;\n    hb_u32 max_qp_I;\n    hb_u32 min_qp_P;\n    hb_u32 max_qp_P;\n    hb_u32 min_qp_B;\n    hb_u32 max_qp_B;\n    hb_u32 hvs_qp_enable;\n    hb_s32 hvs_qp_scale;\n    hb_u32 max_delta_qp;\n    hb_bool qp_map_enable;\n} mc_h264_avbr_params_t;\n"})}),"\n",(0,i.jsx)(n.h4,{id:"mc_h264_fix_qp_params_t",children:"mc_h264_fix_qp_params_t"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u63cf\u8ff0\u3011"}),"\n",(0,i.jsx)(n.p,{children:"\u5b9a\u4e49H264\u7684FixQP\u63a7\u5236\u65b9\u5f0f\u4e0b\u7684\u53ef\u8c03\u8282\u7684\u53c2\u6570\u96c6\u3002"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u5b9a\u4e49\u3011"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"typedef struct _mc_h264_fix_qp_params {\n    hb_u32 intra_period;\n    hb_u32 frame_rate;\n    hb_u32 force_qp_I;\n    hb_u32 force_qp_P;\n    hb_u32 force_qp_B;\n} mc_h264_fix_qp_params_t;\n"})}),"\n",(0,i.jsx)(n.h4,{id:"mc_h264_qp_map_params_t",children:"mc_h264_qp_map_params_t"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u63cf\u8ff0\u3011"}),"\n",(0,i.jsx)(n.p,{children:"\u5b9a\u4e49H264\u7684QPMAP\u63a7\u5236\u65b9\u5f0f\u4e0b\u7684\u53ef\u8c03\u8282\u7684\u53c2\u6570\u96c6\u3002"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u5b9a\u4e49\u3011"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"typedef struct _mc_h264_qp_map_params {\n    hb_u32 intra_period;\n    hb_u32 frame_rate;\n    hb_byte qp_map_array;\n    hb_u32 qp_map_array_count;\n} mc_h264_qp_map_params_t;\n"})}),"\n",(0,i.jsx)(n.h4,{id:"mc_h265_cbr_params_t",children:"mc_h265_cbr_params_t"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u63cf\u8ff0\u3011"}),"\n",(0,i.jsx)(n.p,{children:"\u5b9a\u4e49H265\u7684CBR\u63a7\u5236\u65b9\u5f0f\u4e0b\u7684\u53ef\u8c03\u8282\u7684\u53c2\u6570\u96c6\u3002"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u5b9a\u4e49\u3011"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"typedef struct _mc_h265_cbr_params {\n    hb_u32 intra_period;\n    hb_u32 intra_qp;\n    hb_u32 bit_rate;\n    hb_u32 frame_rate;\n    hb_u32 initial_rc_qp;\n    hb_s32 vbv_buffer_size;\n    hb_u32 ctu_level_rc_enalbe;\n    hb_u32 min_qp_I;\n    hb_u32 max_qp_I;\n    hb_u32 min_qp_P;\n    hb_u32 max_qp_P;\n    hb_u32 min_qp_B;\n    hb_u32 max_qp_B;\n    hb_u32 hvs_qp_enable;\n    hb_s32 hvs_qp_scale;\n    hb_u32 max_delta_qp;\n    hb_bool qp_map_enable;\n} mc_h265_cbr_params_t;\n"})}),"\n",(0,i.jsx)(n.h4,{id:"mc_h265_vbr_params_t",children:"mc_h265_vbr_params_t"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u63cf\u8ff0\u3011"}),"\n",(0,i.jsx)(n.p,{children:"\u5b9a\u4e49H265\u7684VBR\u63a7\u5236\u65b9\u5f0f\u4e0b\u7684\u53ef\u8c03\u8282\u7684\u53c2\u6570\u96c6\u3002"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u5b9a\u4e49\u3011"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"typedef struct _mc_h265_vbr_params {\n    hb_u32 intra_period;\n    hb_u32 intra_qp;\n    hb_u32 frame_rate;\n    hb_bool qp_map_enable;\n} mc_h265_vbr_params_t;\n"})}),"\n",(0,i.jsx)(n.h4,{id:"mc_h265_avbr_params_t",children:"mc_h265_avbr_params_t"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u63cf\u8ff0\u3011"}),"\n",(0,i.jsx)(n.p,{children:"\u5b9a\u4e49H265\u7684AVBR\u63a7\u5236\u65b9\u5f0f\u4e0b\u7684\u53ef\u8c03\u8282\u7684\u53c2\u6570\u96c6\u3002"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u5b9a\u4e49\u3011"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"typedef struct _mc_h265_avbr_params {\n    hb_u32 intra_period;\n    hb_u32 intra_qp;\n    hb_u32 bit_rate;\n    hb_u32 frame_rate;\n    hb_u32 initial_rc_qp;\n    hb_s32 vbv_buffer_size;\n    hb_u32 ctu_level_rc_enalbe;\n    hb_u32 min_qp_I;\n    hb_u32 max_qp_I;\n    hb_u32 min_qp_P;\n    hb_u32 max_qp_P;\n    hb_u32 min_qp_B;\n    hb_u32 max_qp_B;\n    hb_u32 hvs_qp_enable;\n    hb_s32 hvs_qp_scale;\n    hb_u32 max_delta_qp;\n    hb_bool qp_map_enable;\n} mc_h265_avbr_params_t;\n"})}),"\n",(0,i.jsx)(n.h4,{id:"mc_h265_fix_qp_params_t",children:"mc_h265_fix_qp_params_t"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u63cf\u8ff0\u3011"}),"\n",(0,i.jsx)(n.p,{children:"\u5b9a\u4e49H265\u7684FixQP\u63a7\u5236\u65b9\u5f0f\u4e0b\u7684\u53ef\u8c03\u8282\u7684\u53c2\u6570\u96c6\u3002"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u5b9a\u4e49\u3011"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"typedef struct _mc_h265_fix_qp_params {\n    hb_u32 intra_period;\n    hb_u32 frame_rate;\n    hb_u32 force_qp_I;\n    hb_u32 force_qp_P;\n    hb_u32 force_qp_B;\n} mc_h265_fix_qp_params_t;\n"})}),"\n",(0,i.jsx)(n.h4,{id:"mc_h265_qp_map_params_t",children:"mc_h265_qp_map_params_t"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u63cf\u8ff0\u3011"}),"\n",(0,i.jsx)(n.p,{children:"\u5b9a\u4e49H265\u7684QPMAP\u63a7\u5236\u65b9\u5f0f\u4e0b\u7684\u53ef\u8c03\u8282\u7684\u53c2\u6570\u96c6\u3002"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u5b9a\u4e49\u3011"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"typedef struct _mc_h265_qp_map_params {\n    hb_u32 intra_period;\n    hb_u32 frame_rate;\n    hb_byte qp_map_array;\n    hb_u32 qp_map_array_count;\n} mc_h265_qp_map_params_t;\n"})}),"\n",(0,i.jsx)(n.h4,{id:"mc_mjpeg_fix_qp_params_t",children:"mc_mjpeg_fix_qp_params_t"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u63cf\u8ff0\u3011"}),"\n",(0,i.jsx)(n.p,{children:"\u5b9a\u4e49MJPEG\u7684FixQP\u63a7\u5236\u65b9\u5f0f\u4e0b\u7684\u53ef\u8c03\u8282\u7684\u53c2\u6570\u96c6\u3002"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u5b9a\u4e49\u3011"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"typedef struct _mc_mjpeg_fix_qp_params {\n    hb_u32 frame_rate;\n    hb_u32 quality_factor;\n} mc_mjpeg_fix_qp_params_t;\n"})}),"\n",(0,i.jsx)(n.h4,{id:"mc_video_custom_gop_pic_params_t",children:"mc_video_custom_gop_pic_params_t"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u63cf\u8ff0\u3011"}),"\n",(0,i.jsx)(n.p,{children:"\u5b9a\u4e49\u81ea\u5b9a\u4e49\u7684GOP\u7ed3\u6784\u8868\u7684\u6570\u636e\u7ed3\u6784\u3002"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u5b9a\u4e49\u3011"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"typedef struct _mc_video_custom_gop_pic_params {\n    hb_u32 pic_type;\n    hb_s32 poc_offset;\n    hb_u32 pic_qp;\n    hb_s32 num_ref_picL0;\n    hb_s32 ref_pocL0;\n    hb_s32 ref_pocL1;\n    hb_u32 temporal_id;\n} mc_video_custom_gop_pic_params_t;\n"})}),"\n",(0,i.jsx)(n.h4,{id:"mc_inter_status_t",children:"mc_inter_status_t"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u63cf\u8ff0\u3011"}),"\n",(0,i.jsx)(n.p,{children:"\u5b9a\u4e49media codec\u5185\u90e8\u72b6\u6001\u4fe1\u606f"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u5b9a\u4e49\u3011"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"typedef struct _mc_inter_status {\n    hb_u32 cur_input_buf_cnt;\n    hb_u64 cur_input_buf_size;\n    hb_u32 cur_output_buf_cnt;\n    hb_u64 cur_output_buf_size;\n    hb_u32 left_recv_frame;\n    hb_u32 left_enc_frame;\n    hb_u32 total_input_buf_cnt;\n    hb_u32 total_output_buf_cnt;\n    hb_s32 pipeline;\n    hb_s32 channel_port_id;\n} mc_inter_status_t;\n"})}),"\n",(0,i.jsx)(n.h4,{id:"media_codec_context_t",children:"media_codec_context_t"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u63cf\u8ff0\u3011"}),"\n",(0,i.jsx)(n.p,{children:"\u5b9a\u4e49Media codec\u7684\u4e0a\u4e0b\u6587\u3002"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u5b9a\u4e49\u3011"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"typedef struct _media_codec_context {\n    media_codec_id_t codec_id;\n    hb_bool encoder;\n    hb_s32 instance_index;\n    union {\n        mc_video_codec_enc_params_t video_enc_params;\n        mc_video_codec_dec_params_t video_dec_params;\n        mc_audio_codec_enc_params_t audio_enc_params;\n        mc_audio_codec_dec_params_t audio_dec_params;\n    };\n    hb_ptr vpf_context;\n    mc_video_cmd_prio_t priority;\n} media_codec_context_t;\n"})}),"\n",(0,i.jsx)(n.h4,{id:"mc_video_codec_enc_params_t",children:"mc_video_codec_enc_params_t"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u63cf\u8ff0\u3011"}),"\n",(0,i.jsx)(n.p,{children:"\u5b9a\u4e49\u89c6\u9891\u7f16\u7801\u5668\u7684\u7f16\u7801\u53c2\u6570\uff0c\u89c6\u9891\u7f16\u7801\u5668\u7c7b\u578b\u5305\u62ecH264\uff0cH265\uff0cMJPEG\u548cJPEG\u3002"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u5b9a\u4e49\u3011"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"typedef struct _mc_video_codec_enc_params {\n    hb_s32 width, height;\n    mc_pixel_format_t pix_fmt;\n    hb_u32 frame_buf_count;\n    hb_bool external_frame_buf;\n    hb_u32 bitstream_buf_count;\n    hb_u32 bitstream_buf_size;\n    mc_rate_control_params_t rc_params;\n    mc_video_gop_params_t gop_params;\n    mc_rotate_degree_t rot_degree;\n    mc_mirror_direction_t mir_direction;\n    hb_u32 frame_cropping_flag;\n    mc_av_codec_rect_t crop_rect;\n    hb_bool enable_user_pts;\n    union {\n        mc_h264_enc_config_t h264_enc_config;\n        mc_h265_enc_config_t h265_enc_config;\n        mc_mjpeg_enc_config_t mjpeg_enc_config;\n        mc_jpeg_enc_config_t jpeg_enc_config;\n    };\n} mc_video_codec_enc_params_t;\n"})}),"\n",(0,i.jsx)(n.h4,{id:"mc_video_codec_dec_params_t",children:"mc_video_codec_dec_params_t"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u63cf\u8ff0\u3011"}),"\n",(0,i.jsx)(n.p,{children:"\u5b9a\u4e49\u89c6\u9891\u89e3\u7801\u5668\u7684\u89e3\u7801\u53c2\u6570\uff0c\u89c6\u9891\u89e3\u7801\u5668\u7c7b\u578b\u5305\u62ecH264\uff0cH265\uff0cMJPEG\u548cJPEG\u3002"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u5b9a\u4e49\u3011"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"typedef struct _mc_video_codec_dec_params {\n    mc_av_stream_feeding_mode_t feed_mode;\n    mc_pixel_format_t pix_fmt;\n    hb_u32 bitstream_buf_size;\n    hb_u32 bitstream_buf_count;\n    hb_bool external_bitstream_buf;\n    hb_u32 frame_buf_count;\n    union {\n        mc_h264_dec_config_t h264_dec_config;\n        mc_h265_dec_config_t h265_dec_config;\n        mc_mjpeg_dec_config_t mjpeg_dec_config;\n        mc_jpeg_dec_config_t jpeg_dec_config;\n    };\n} mc_video_codec_dec_params_t;\n"})}),"\n",(0,i.jsx)(n.h4,{id:"mc_audio_codec_enc_params_t",children:"mc_audio_codec_enc_params_t"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u63cf\u8ff0\u3011"}),"\n",(0,i.jsx)(n.p,{children:"\u5b9a\u4e49audio codec\u7684\u7f16\u7801\u53c2\u6570\u3002"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u5b9a\u4e49\u3011"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"typedef struct _mc_audio_codec_enc_params {\n    hb_u32 bit_rate;\n    hb_s32 frame_size;\n    hb_s32 frame_buf_count;\n    hb_s32 packet_count;\n    mc_audio_sample_format_t sample_fmt;\n    mc_audio_sample_rate_t sample_rate;\n    mc_audio_channel_layout_t channel_layout;\n    hb_s32 channels;\n    hb_ptr enc_config;\n} mc_audio_codec_enc_params_t;\n"})}),"\n",(0,i.jsx)(n.h4,{id:"mc_audio_codec_dec_params_t",children:"mc_audio_codec_dec_params_t"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u63cf\u8ff0\u3011"}),"\n",(0,i.jsx)(n.p,{children:"\u5b9a\u4e49audio codec\u7684\u89e3\u7801\u53c2\u6570\u3002"}),"\n",(0,i.jsx)(n.p,{children:"\u3010\u5b9a\u4e49\u3011"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"typedef struct _mc_audio_codec_dec_params {\n    mc_av_stream_feeding_mode_t feed_mode;\n    hb_s32 packet_buf_size;\n    hb_s32 packet_count;\n    hb_s32 frame_cache_size;\n    hb_s32 internal_frame_size;\n    hb_s32 frame_buf_count;\n    hb_ptr dec_config;\n} mc_audio_codec_dec_params_t;\n"})}),"\n",(0,i.jsx)(n.h3,{id:"\u8fd4\u56de\u503c\u8bf4\u660e",children:"\u8fd4\u56de\u503c\u8bf4\u660e"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"\u9519\u8bef\u7801"}),(0,i.jsx)(n.th,{children:"\u5b8f\u5b9a\u4e49"}),(0,i.jsx)(n.th,{children:"\u63cf\u8ff0"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"0xF0000001"}),(0,i.jsx)(n.td,{children:"HB_MEDIA_ERR_UNKNOWN"}),(0,i.jsx)(n.td,{children:"\u672a\u77e5\u7684\u9519\u8bef"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"0xF0000002"}),(0,i.jsx)(n.td,{children:"HB_MEDIA_ERR_CODEC_NOT_FOUND"}),(0,i.jsx)(n.td,{children:"\u627e\u4e0d\u5230\u5bf9\u5e94\u7684codec"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"0xF0000003"}),(0,i.jsx)(n.td,{children:"HB_MEDIA_ERR_CODEC_OPEN_FAIL"}),(0,i.jsx)(n.td,{children:"\u65e0\u6cd5\u6253\u5f00codec\u8bbe\u5907"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"0xF0000004"}),(0,i.jsx)(n.td,{children:"HB_MEDIA_ERR_CODEC_RESPONSE_TIMEOUT"}),(0,i.jsx)(n.td,{children:"codec\u54cd\u5e94\u8d85\u65f6"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"0xF0000005"}),(0,i.jsx)(n.td,{children:"HB_MEDIA_ERR_CODEC_INIT_FAIL"}),(0,i.jsx)(n.td,{children:"codec\u521d\u59cb\u5316\u5931\u8d25"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"0xF0000006"}),(0,i.jsx)(n.td,{children:"HB_MEDIA_ERR_OPERATION_NOT_ALLOWED"}),(0,i.jsx)(n.td,{children:"\u64cd\u4f5c\u4e0d\u5141\u8bb8"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"0xF0000007"}),(0,i.jsx)(n.td,{children:"HB_MEDIA_ERR_INSUFFICIENT_RES"}),(0,i.jsx)(n.td,{children:"\u5185\u90e8\u5185\u5b58\u8d44\u6e90\u4e0d\u8db3"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"0xF0000008"}),(0,i.jsx)(n.td,{children:"HB_MEDIA_ERR_NO_FREE_INSTANCE"}),(0,i.jsx)(n.td,{children:"\u6ca1\u6709\u53ef\u7528\u7684insta nce\uff08VPU\u6700\u591a32\u4e2a\uff0cJPU\u6700 \u591a64\u4e2a\uff0cAudio\u6700\u591a32\u4e2a\uff09"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"0xF0000009"}),(0,i.jsx)(n.td,{children:"HB_MEDIA_ERR_INVALID_PARAMS"}),(0,i.jsx)(n.td,{children:"\u65e0\u6548\u7684\u53c2\u6570"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"0xF000000A"}),(0,i.jsx)(n.td,{children:"HB_MEDIA_ERR_INVALID_INSTANCE"}),(0,i.jsx)(n.td,{children:"\u65e0\u6548\u7684\u5b9e\u4f8b"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"0xF000000B"}),(0,i.jsx)(n.td,{children:"HB_MEDIA_ERR_INVALID_BUFFER"}),(0,i.jsx)(n.td,{children:"\u65e0\u6548\u7684buffer"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"0xF000000C"}),(0,i.jsx)(n.td,{children:"HB_MEDIA_ERR_INVALID_COMMAND"}),(0,i.jsx)(n.td,{children:"\u65e0\u6548\u7684\u6307\u4ee4"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"0xF000000D"}),(0,i.jsx)(n.td,{children:"HB_MEDIA_ERR_WAIT_TIMEOUT"}),(0,i.jsx)(n.td,{children:"\u7b49\u5f85\u8d85\u65f6"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"0xF000000E"}),(0,i.jsx)(n.td,{children:"HB_MEDIA_ERR_FILE_OPERATION_FAILURE"}),(0,i.jsx)(n.td,{children:"\u6587\u4ef6\u64cd\u4f5c\u5931\u8d25"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"0xF000000F"}),(0,i.jsx)(n.td,{children:"HB_MEDIA_ERR_PARAMS_SET_FAILURE"}),(0,i.jsx)(n.td,{children:"\u53c2\u6570\u8bbe\u7f6e\u5931\u8d25"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"0xF0000010"}),(0,i.jsx)(n.td,{children:"HB_MEDIA_ERR_PARAMS_GET_FAILURE"}),(0,i.jsx)(n.td,{children:"\u53c2\u6570\u83b7\u53d6\u5931\u8d25"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"0xF0000011"}),(0,i.jsx)(n.td,{children:"HB_MEDIA_ERR_CODING_FAILED"}),(0,i.jsx)(n.td,{children:"\u7f16\u89e3\u7801\u5931\u8d25"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"0xF0000012"}),(0,i.jsx)(n.td,{children:"HB_MEDIA_ERR_OUTPUT_BUF_FULL"}),(0,i.jsx)(n.td,{children:"\u8f93\u51fabuffer\u6ee1"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"0xF0000013"}),(0,i.jsx)(n.td,{children:"HB_MEDIA_ERR_UNSUPPORTED_FEATURE"}),(0,i.jsx)(n.td,{children:"\u4e0d\u652f\u6301\u7684\u529f\u80fd"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"0xF0000014"}),(0,i.jsx)(n.td,{children:"HB_MEDIA_ERR_INVALID_PRIORITY"}),(0,i.jsx)(n.td,{children:"\u4e0d\u652f\u6301\u7684\u4f18\u5148\u7ea7"})]})]})]}),"\n",(0,i.jsx)(n.h2,{id:"codec-sample",children:"Codec sample"}),"\n",(0,i.jsx)(n.h3,{id:"\u7f16\u7801\u793a\u4f8b",children:"\u7f16\u7801\u793a\u4f8b"}),"\n",(0,i.jsx)(n.h4,{id:"\u529f\u80fd\u6982\u8ff0",children:"\u529f\u80fd\u6982\u8ff0"}),"\n",(0,i.jsx)(n.p,{children:"\u7f16\u7801 yuv \u56fe\u50cf, \u751f\u6210 h264/h265 \u89c6\u9891\u6216 jpg \u56fe\u7247\u3002"}),"\n",(0,i.jsx)(n.h5,{id:"\u8f6f\u4ef6\u67b6\u6784\u8bf4\u660e",children:"\u8f6f\u4ef6\u67b6\u6784\u8bf4\u660e"}),"\n",(0,i.jsx)(n.p,{children:"\u91c7\u7528MediaCodec\u7684poll\u6a21\u5f0f\u6765\u89e3\u8026\u8f93\u5165\u548c\u8f93\u51fa\uff0c\u53ef\u4f7f\u7f16\u7801\u5e27\u7387\u6027\u80fd\u8fbe\u5230\u6700\u4f18\u3002\n\u5728\u4e3b\u7ebf\u7a0b\u4e2d\u704cYUV\u6570\u636e\uff1a\u53d6\u51fa\u4e00\u4e2a\u7a7a\u7684input\nbuffer\uff0c\u914d\u7f6eYUV\u6570\u636e\u7684\u5730\u5740\u4fe1\u606f\uff08\u5982phys addr\uff09\uff0c\u518dqueue input\nbuffer\u5e76\u901a\u77e5\u7f16\u7801\u5668\u5904\u7406\u8be5\u5e27\u6570\u636e\uff1b\n\u53e6\u4e00\u4e2a\u7ebf\u7a0b\u53d6\u8f93\u51fa\u7801\u6d41\uff1a\u901a\u8fc7select\u63a5\u6536\u786c\u4ef6\u7f16\u7801\u5b8c\u6210\u901a\u77e5\uff0c\u53d6\u51fa\u4e00\u4e2a\u786c\u4ef6\u586b\u6ee1\u8f93\u51fa\u7801\u6d41\u7684output\nbuffer\uff0c\u5c06\u7f16\u7801\u7ed3\u679c\u5199\u5230\u6587\u4ef6\u4e2d\u540e\u5f52\u8fd8output buffer\u3002"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{src:"https://rdk-doc.oss-cn-beijing.aliyuncs.com/doc/img/07_Advanced_development/03_multimedia_development/02_S100/codec/encoder2.png",alt:"image"})}),"\n",(0,i.jsx)(n.h5,{id:"\u786c\u4ef6\u6570\u636e\u6d41\u8bf4\u660e",children:"\u786c\u4ef6\u6570\u636e\u6d41\u8bf4\u660e"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{src:"https://rdk-doc.oss-cn-beijing.aliyuncs.com/doc/img/07_Advanced_development/03_multimedia_development/02_S100/codec/encoder1.png",alt:"image"})}),"\n",(0,i.jsx)(n.h5,{id:"\u4ee3\u7801\u4f4d\u7f6e\u53ca\u76ee\u5f55\u7ed3\u6784",children:"\u4ee3\u7801\u4f4d\u7f6e\u53ca\u76ee\u5f55\u7ed3\u6784"}),"\n",(0,i.jsx)(n.p,{children:"sample\u4ee3\u7801\u4f4d\u7f6e\u5728\u5de5\u7a0b\u76ee\u5f55source/hobot-sp-samples/debian/app/multimedia_demo/codec_demo\u3002"}),"\n",(0,i.jsx)(n.p,{children:"\u76ee\u5f55\u7ed3\u6784\u5982\u4e0b\uff1a"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"\u251c\u2500\u2500 README.md\n\u2514\u2500\u2500 sample_venc_vdec\n    \u251c\u2500\u2500 input_3840x2160_yuv420p.h264\n    \u251c\u2500\u2500 input_3840x2160_yuv420p.yuv\n    \u251c\u2500\u2500 Makefile\n    \u251c\u2500\u2500 sample.c\n    \u251c\u2500\u2500 sample_common.c\n    \u251c\u2500\u2500 sample.h\n    \u251c\u2500\u2500 sample_vdec.c\n    \u2514\u2500\u2500 sample_venc.c\n"})}),"\n",(0,i.jsx)(n.p,{children:"\u6839\u76ee\u5f55\u5305\u542bREADME.md\uff0c\u7b80\u8981\u4ecb\u7ecd\u7f16\u8bd1\u547d\u4ee4\uff0c\u8fd0\u884c\u5e2e\u52a9\u4fe1\u606f\u53ca\u547d\u4ee4\u3002"}),"\n",(0,i.jsx)(n.p,{children:"sample_venc_devc\u4e0b\u7684Makefile\u7528\u4e8e\u8be5\u76ee\u5f55\u4e0b\u7684\u7f16\u8bd1\u3002\u5176\u4e2d\uff0csample.c\u662fmain\u5165\u53e3\u7684\u6240\u5728\u6587\u4ef6\uff0csample_common\u5305\u542b\u4e86\u4e00\u4e9b\u5171\u7528\u7684api\uff0csample_venc.c\u5305\u542b\u7f16\u7801\u76f8\u5173\u51fd\u6570\uff0csample_vdec.c\u5305\u542b\u89e3\u7801\u76f8\u5173\u51fd\u6570\u3002"}),"\n",(0,i.jsx)(n.h4,{id:"\u7f16\u8bd1",children:"\u7f16\u8bd1"}),"\n",(0,i.jsx)(n.h5,{id:"\u7f16\u8bd1\u73af\u5883",children:"\u7f16\u8bd1\u73af\u5883"}),"\n",(0,i.jsx)(n.p,{children:"\u677f\u7aef\u5728\u5b89\u88c5hobot-sp-samples_*.deb\u5305\u540e\uff0c\u4f1a\u5305\u542bcodec_demo\u6e90\u7801\u5185\u5bb9\u3002"}),"\n",(0,i.jsx)(n.h5,{id:"\u7f16\u8bd1\u8bf4\u660e",children:"\u7f16\u8bd1\u8bf4\u660e"}),"\n",(0,i.jsx)(n.p,{children:"\u672csample\u4e3b\u8981\u4f9d\u8d56libmm\u63d0\u4f9b\u7684API\u5934\u6587\u4ef6\uff1a"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:'#include "hb_media_codec.h"\n#include "hb_media_error.h"\n'})}),"\n",(0,i.jsx)(n.p,{children:"\u7f16\u8bd1\u4f9d\u8d56\u7684\u5e93\u6709\u5982\u4e0b\uff1a"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"LIBS += -lpthread -ldl -lhbmem -lalog  -lmultimedia\nLIBS += -lavformat -lavcodec -lavutil -lswresample\n"})}),"\n",(0,i.jsx)(n.p,{children:"\u7f16\u8bd1\u547d\u4ee4:"}),"\n",(0,i.jsx)(n.p,{children:"\u677f\u7aef\u8fdb\u5165/app/multimedia_demo/codec_demo/sample_venc_vdec\u76ee\u5f55\u3002"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"make\n"})}),"\n",(0,i.jsx)(n.h4,{id:"\u8fd0\u884c",children:"\u8fd0\u884c"}),"\n",(0,i.jsx)(n.h5,{id:"\u652f\u6301\u5e73\u53f0",children:"\u652f\u6301\u5e73\u53f0"}),"\n",(0,i.jsx)(n.p,{children:"RDKS100\u3002"}),"\n",(0,i.jsx)(n.h5,{id:"\u677f\u7aef\u90e8\u7f72\u53ca\u914d\u7f6e",children:"\u677f\u7aef\u90e8\u7f72\u53ca\u914d\u7f6e"}),"\n",(0,i.jsxs)(n.p,{children:["\u5237\u5199\u7cfb\u7edf\u8f6f\u4ef6\u955c\u50cf\u540e\uff0c\u672csample\u7684\u6e90\u7801\u4f4d\u4e8e\u677f\u7aef\u8def\u5f84\uff1a",(0,i.jsx)(n.code,{children:"/app/multimedia_demo/codec_demo/sample_venc_vdec"}),"\uff1b"]}),"\n",(0,i.jsx)(n.p,{children:"\u53ef\u80fd\u9700\u8981\u7528\u5230\u7684\u8d44\u6e90\uff1a"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"\u8f93\u5165YUV\u56fe\u50cf\u9ed8\u8ba4\u5305\u542b4K\u683c\u5f0f\u7684YUV\u88f8\u6d41\u53caH264\u6587\u4ef6\uff0c\u5982\u679c\u6d4b\u8bd5\u5176\u4ed6\u6d4b\u8bd5\u8bf7\u7528\u6237\u81ea\u884c\u4e0a\u4f20\uff1b"}),"\n"]}),"\n",(0,i.jsx)(n.h5,{id:"\u8fd0\u884c\u6307\u5357",children:"\u8fd0\u884c\u6307\u5357"}),"\n",(0,i.jsx)(n.h6,{id:"\u8fd0\u884c\u53c2\u6570\u8bf4\u660e",children:"\u8fd0\u884c\u53c2\u6570\u8bf4\u660e"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"sample_codec"})," \uff1a \u5e94\u7528\u7a0b\u5e8f\u540d\u5b57"]}),"\n",(0,i.jsx)(n.p,{children:"-m\uff1a\u7f16\u7801\u6216\u89e3\u7801\uff0c\u9ed8\u8ba4\u7f16\u7801\uff0c 0\uff1a encoder 1\uff1a decoder"}),"\n",(0,i.jsx)(n.p,{children:"-c\uff1a\u7f16\u89e3\u7801\u5668\u7c7b\u578b\uff0c\u9ed8\u8ba4H264\uff0c 0\uff1aH264 1\uff1aH265 2\uff1amjpg 3\uff1ajpg"}),"\n",(0,i.jsx)(n.p,{children:"-w\uff1a\u56fe\u50cf\u5bbd\u5ea6\uff0c\u9ed8\u8ba43840"}),"\n",(0,i.jsx)(n.p,{children:"-h\uff1a\u56fe\u50cf\u9ad8\u5ea6\uff0c\u9ed8\u8ba42160"}),"\n",(0,i.jsx)(n.p,{children:"-p\uff1a\u7f16\u89e3\u7801\u56fe\u50cf\u683c\u5f0f\uff0c\u9ed8\u8ba4nv12\uff0c 0\uff1ayuv420p 1\uff1anv12 2\uff1anv21"}),"\n",(0,i.jsx)(n.p,{children:"-n\uff1a\u6d4b\u8bd5\u7ebf\u7a0b\u6570\u91cf\uff0c\u9ed8\u8ba41\u4e2a"}),"\n",(0,i.jsxs)(n.p,{children:["-i\uff1a\u8f93\u5165\u6587\u4ef6\u7684\u8def\u5f84\uff0c\u9ed8\u8ba4",(0,i.jsx)(n.code,{children:"./input_${w}x${h}_${pixfmt}<_thread_idx>.yuv"})]}),"\n",(0,i.jsxs)(n.p,{children:["-o\uff1a\u8f93\u51fa\u6587\u4ef6\u7684\u8def\u5f84\uff0c\u9ed8\u8ba4",(0,i.jsx)(n.code,{children:"./output_${w}x${h}_${pixfmt}<_thread_idx>.{code_type}"})]}),"\n",(0,i.jsx)(n.p,{children:"-H\uff1a\u6253\u5370\u5e2e\u52a9\u4fe1\u606f"}),"\n",(0,i.jsx)(n.h6,{id:"\u5e2e\u52a9\u83dc\u5355",children:"\u5e2e\u52a9\u83dc\u5355"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"Usage: ./sample_codec\n        -m --samplemode sample mode, default encoder, {0-encoder, 1-decoder}\n        -c --codecid codec id, default h264, {0-h264, 1-h265, 2-mjpeg, 3-jpeg}\n        -w --width width, default 3840\n        -h --height height, default 2160\n        -p --pixfmt pix fmt, default nv12, {0-yuv420p, 1-nv12, ..}\n        -n --threadnum test thread number, default 1\n        -i --inputfile input file name, default ./input_${w}x${h}_${pixfmt}<_thread_idx>.yuv\n        -o --outputfile output file name, default ./output_${w}x${h}_${pixfmt}<_thread_idx>.{code_type}\n        -H --help print usage\n"})}),"\n",(0,i.jsx)(n.h6,{id:"\u8fd0\u884c\u65b9\u6cd5",children:"\u8fd0\u884c\u65b9\u6cd5"}),"\n",(0,i.jsx)(n.p,{children:"\u8f93\u5165\u6e90\u51c6\u5907\uff1a\u5c06\u6d4b\u8bd5\u6587\u4ef6(\u5982input_3840x2160_nv12.yuv)\u5230\u5f53\u524d\u76ee\u5f55 \u6216\n\u7528-i\u6307\u5b9a\u6587\u4ef6\u8def\u5f84\uff1b"}),"\n",(0,i.jsx)(n.p,{children:"\u7f16\u7801\u4e00\u8def 3840x2160 \u7684YUV\u56fe\u50cf\u5e8f\u5217\uff0c\u751f\u6210 H264 \u89c6\u9891\u7801\u6d41"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"/app/multimedia_demo/codec_demo/sample_venc_vdec/sample_codec\n"})}),"\n",(0,i.jsx)(n.p,{children:"\u7f16\u7801\u4e00\u8def 1920x1080 \u7684YUV\u56fe\u50cf\u5e8f\u5217\uff0c\u751f\u6210 H265 \u89c6\u9891\u7801\u6d41"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"/app/multimedia_demo/codec_demo/sample_venc_vdec/sample_codec -c 1 -w 1920 -h 1080\n"})}),"\n",(0,i.jsx)(n.p,{children:"\u7f16\u7801\u4e00\u5f20 1920x1088 \u7684YUV\u56fe\u50cf\uff0c\u751f\u6210 jpg \u56fe\u7247"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"/app/multimedia_demo/codec_demo/sample_venc_vdec/sample_codec -c 3 -w 1920 -h 1088\n"})}),"\n",(0,i.jsx)(n.p,{children:"\u7f16\u7801\u4e24\u8def 3840x2160 \u7684YUV\u56fe\u50cf\u5e8f\u5217\uff0c\u751f\u6210 H265 \u89c6\u9891"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"/app/multimedia_demo/codec_demo/sample_venc_vdec/sample_codec -c 1 -n 2\n"})}),"\n",(0,i.jsx)(n.p,{children:"\u7f16\u7801\u56db\u8def 1920x1080 \u7684YUV\u56fe\u50cf\u5e8f\u5217\uff0c\u751f\u6210 H265 \u89c6\u9891"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"/app/multimedia_demo/codec_demo/sample_venc_vdec/sample_codec -c 1 -w 1920 -h 1080 -n 4\n"})}),"\n",(0,i.jsxs)(n.p,{children:["VPU CROP\u8bfb\u5165\u5e76\u7f16\u7801\uff1a\u5c061920x1300\uff08\u56fe\u50cf\u5c3a\u5bf8\u4e0d\u6ee1\u8db3\u5bf9\u9f50\u8981\u6c42\uff09\u8f93\u5165\u6309",(0,i.jsx)(n.code,{children:"{x=200, y=300, w=1280, h=720}"}),"\u5927\u5c0f\u8bfb\u5165\u6570\u636e\u5e76\u7f16\u7801\u751f\u6210 H265 \u89c6\u9891"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"/app/multimedia_demo/codec_demo/sample_venc_vdec/sample_codec -c 1 -w 1920 -h 1300\n"})}),"\n",(0,i.jsx)(n.h6,{id:"\u8fd0\u884c\u7ed3\u679c\u8bf4\u660e",children:"\u8fd0\u884c\u7ed3\u679c\u8bf4\u660e"}),"\n",(0,i.jsx)(n.p,{children:"\u5982\u4e0b\u56fe\u6240\u793a\u4e3a\u8fd0\u884c\u6210\u529f"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{src:"https://rdk-doc.oss-cn-beijing.aliyuncs.com/doc/img/07_Advanced_development/03_multimedia_development/02_S100/codec/encoder3.png",alt:"image"})}),"\n",(0,i.jsx)(n.p,{children:"\u67e5\u770b\u751f\u6210\u7684h264/h265/jpg\u662f\u5426\u6b63\u5e38"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{src:"https://rdk-doc.oss-cn-beijing.aliyuncs.com/doc/img/07_Advanced_development/03_multimedia_development/02_S100/codec/encoder4.png",alt:"image"})}),"\n",(0,i.jsx)(n.h3,{id:"\u89e3\u7801\u793a\u4f8b",children:"\u89e3\u7801\u793a\u4f8b"}),"\n",(0,i.jsx)(n.h4,{id:"\u529f\u80fd\u6982\u8ff0-1",children:"\u529f\u80fd\u6982\u8ff0"}),"\n",(0,i.jsx)(n.p,{children:"\u89e3\u7801h264/h265\u89c6\u9891\u6216jpg\u56fe\u7247\uff0c\u751f\u6210yuv\u56fe\u50cf\u3002"}),"\n",(0,i.jsx)(n.h5,{id:"\u8f6f\u4ef6\u67b6\u6784",children:"\u8f6f\u4ef6\u67b6\u6784"}),"\n",(0,i.jsx)(n.p,{children:"\u91c7\u7528MediaCodec\u7684poll\u6a21\u5f0f\u6765\u89e3\u8026\u8f93\u5165\u548c\u8f93\u51fa\uff0c\u53ef\u4f7f\u89e3\u7801\u5e27\u7387\u6027\u80fd\u8fbe\u5230\u6700\u4f18\u3002\n\u5728\u4e3b\u7ebf\u7a0b\u4e2d\u704c\u7801\u6d41\u6570\u636e\uff1a\u53d6\u51fa\u4e00\u4e2a\u7a7a\u7684input\nbuffer\uff0c\u914d\u7f6e\u7801\u6d41\u6570\u636e\u7684\u5730\u5740\u4fe1\u606f\uff08\u5982phys addr\uff09\uff0c\u518dqueue input\nbuffer\u5e76\u901a\u77e5\u89e3\u7801\u5668\u5904\u7406\u8be5\u5e27\u6570\u636e\uff1b\n\u53e6\u4e00\u4e2a\u7ebf\u7a0b\u53d6\u8f93\u51faYUV\u56fe\u50cf\uff1a\u901a\u8fc7select\u63a5\u6536\u786c\u4ef6\u89e3\u7801\u5b8c\u6210\u901a\u77e5\uff0c\u53d6\u51fa\u4e00\u4e2a\u786c\u4ef6\u586b\u6ee1\u8f93\u51fa\u56fe\u50cf\u7684output\nbuffer\uff0c\u5c06\u89e3\u7801\u7ed3\u679c\u5199\u5230\u6587\u4ef6\u4e2d\u540e\u5f52\u8fd8output buffer\u3002"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{src:"https://rdk-doc.oss-cn-beijing.aliyuncs.com/doc/img/07_Advanced_development/03_multimedia_development/02_S100/codec/decoder2.png",alt:"image"})}),"\n",(0,i.jsx)(n.h5,{id:"\u786c\u4ef6\u6570\u636e\u6d41\u8bf4\u660e-1",children:"\u786c\u4ef6\u6570\u636e\u6d41\u8bf4\u660e"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{src:"https://rdk-doc.oss-cn-beijing.aliyuncs.com/doc/img/07_Advanced_development/03_multimedia_development/02_S100/codec/decoder1.png",alt:"image"})}),"\n",(0,i.jsx)(n.h5,{id:"\u4ee3\u7801\u4f4d\u7f6e\u53ca\u76ee\u5f55\u7ed3\u6784-1",children:"\u4ee3\u7801\u4f4d\u7f6e\u53ca\u76ee\u5f55\u7ed3\u6784"}),"\n",(0,i.jsx)(n.p,{children:"sample\u4ee3\u7801\u4f4d\u7f6e\u5728\u5de5\u7a0b\u76ee\u5f55source/hobot-sp-samples/debian/app/multimedia_demo/codec_demo\u3002"}),"\n",(0,i.jsx)(n.p,{children:"\u76ee\u5f55\u7ed3\u6784\u5982\u4e0b\uff1a"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"\u251c\u2500\u2500 README.md\n\u2514\u2500\u2500 sample_venc_vdec\n    \u251c\u2500\u2500 input_3840x2160_yuv420p.h264\n    \u251c\u2500\u2500 input_3840x2160_yuv420p.yuv\n    \u251c\u2500\u2500 Makefile\n    \u251c\u2500\u2500 sample.c\n    \u251c\u2500\u2500 sample_common.c\n    \u251c\u2500\u2500 sample.h\n    \u251c\u2500\u2500 sample_vdec.c\n    \u2514\u2500\u2500 sample_venc.c\n"})}),"\n",(0,i.jsx)(n.p,{children:"\u6839\u76ee\u5f55\u5305\u542bREADME.md\uff0c\u7b80\u8981\u4ecb\u7ecd\u7f16\u8bd1\u547d\u4ee4\uff0c\u8fd0\u884c\u5e2e\u52a9\u4fe1\u606f\u53ca\u547d\u4ee4\u3002"}),"\n",(0,i.jsx)(n.p,{children:"sample_venc_devc\u4e0b\u7684Makefile\u7528\u4e8e\u8be5\u76ee\u5f55\u4e0b\u7684\u7f16\u8bd1\u3002\u5176\u4e2d\uff0csample.c\u662fmain\u5165\u53e3\u7684\u6240\u5728\u6587\u4ef6\uff0csample_common\u5305\u542b\u4e86\u4e00\u4e9b\u5171\u7528\u7684api\uff0csample_venc.c\u5305\u542b\u7f16\u7801\u76f8\u5173\u51fd\u6570\uff0csample_vdec.c\u5305\u542b\u89e3\u7801\u76f8\u5173\u51fd\u6570\u3002"}),"\n",(0,i.jsx)(n.h4,{id:"\u7f16\u8bd1-1",children:"\u7f16\u8bd1"}),"\n",(0,i.jsx)(n.h5,{id:"\u7f16\u8bd1\u73af\u5883-1",children:"\u7f16\u8bd1\u73af\u5883"}),"\n",(0,i.jsx)(n.p,{children:"\u677f\u7aef\u5728\u5b89\u88c5hobot-sp-samples_*.deb\u5305\u540e\uff0c\u4f1a\u5305\u542bcodec_demo\u6e90\u7801\u5185\u5bb9\u3002"}),"\n",(0,i.jsx)(n.h5,{id:"\u7f16\u8bd1\u8bf4\u660e-1",children:"\u7f16\u8bd1\u8bf4\u660e"}),"\n",(0,i.jsx)(n.p,{children:"\u672csample\u4e3b\u8981\u4f9d\u8d56libmm\u63d0\u4f9b\u7684API\u5934\u6587\u4ef6\uff1a"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:'#include "hb_media_codec.h"\n#include "hb_media_error.h"\n'})}),"\n",(0,i.jsx)(n.p,{children:"\u7f16\u8bd1\u4f9d\u8d56\u7684\u5e93\u6709\u5982\u4e0b\uff1a"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"LIBS += -lpthread -ldl -lhbmem -lalog  -lmultimedia\nLIBS += -lavformat -lavcodec -lavutil -lswresample\n"})}),"\n",(0,i.jsx)(n.p,{children:"\u7f16\u8bd1\u547d\u4ee4:"}),"\n",(0,i.jsx)(n.p,{children:"\u677f\u7aef\u8fdb\u5165/app/multimedia_demo/codec_demo/sample_venc_vdec\u76ee\u5f55\u3002"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"make\n"})}),"\n",(0,i.jsx)(n.h4,{id:"\u8fd0\u884c-1",children:"\u8fd0\u884c"}),"\n",(0,i.jsx)(n.h5,{id:"\u652f\u6301\u5e73\u53f0-1",children:"\u652f\u6301\u5e73\u53f0"}),"\n",(0,i.jsx)(n.p,{children:"RDKS100\u3002"}),"\n",(0,i.jsx)(n.h5,{id:"\u677f\u7aef\u90e8\u7f72\u53ca\u914d\u7f6e-1",children:"\u677f\u7aef\u90e8\u7f72\u53ca\u914d\u7f6e"}),"\n",(0,i.jsxs)(n.p,{children:["\u5237\u5199\u7cfb\u7edf\u8f6f\u4ef6\u955c\u50cf\u540e\uff0c\u672csample\u7684\u6e90\u7801\u4f4d\u4e8e\u677f\u7aef\u8def\u5f84\uff1a",(0,i.jsx)(n.code,{children:"/app/multimedia_demo/codec_demo/sample_venc_vdec"}),"\uff1b"]}),"\n",(0,i.jsx)(n.p,{children:"\u53ef\u80fd\u9700\u8981\u7528\u5230\u7684\u8d44\u6e90\uff1a"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"\u8f93\u5165YUV\u56fe\u50cf\u9ed8\u8ba4\u5305\u542b4K\u683c\u5f0f\u7684YUV\u88f8\u6d41\u53caH264\u6587\u4ef6\uff0c\u5982\u679c\u6d4b\u8bd5\u5176\u4ed6\u6d4b\u8bd5\u8bf7\u7528\u6237\u81ea\u884c\u4e0a\u4f20\uff1b"}),"\n"]}),"\n",(0,i.jsx)(n.h5,{id:"\u8fd0\u884c\u6307\u5357-1",children:"\u8fd0\u884c\u6307\u5357"}),"\n",(0,i.jsx)(n.h6,{id:"\u8fd0\u884c\u53c2\u6570\u8bf4\u660e-1",children:"\u8fd0\u884c\u53c2\u6570\u8bf4\u660e"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"sample_codec"})," \uff1a \u5e94\u7528\u7a0b\u5e8f\u540d\u5b57"]}),"\n",(0,i.jsx)(n.p,{children:"-m\uff1a\u7f16\u7801\u6216\u89e3\u7801\uff0c\u9ed8\u8ba4\u7f16\u7801\uff0c 0\uff1a encoder 1\uff1a decoder"}),"\n",(0,i.jsx)(n.p,{children:"-c\uff1a\u7f16\u89e3\u7801\u5668\u7c7b\u578b\uff0c\u9ed8\u8ba4H264\uff0c 0\uff1aH264 1\uff1aH265 2\uff1amjpg 3\uff1ajpg"}),"\n",(0,i.jsx)(n.p,{children:"-w\uff1a\u56fe\u50cf\u5bbd\u5ea6\uff0c\u9ed8\u8ba43840"}),"\n",(0,i.jsx)(n.p,{children:"-h\uff1a\u56fe\u50cf\u9ad8\u5ea6\uff0c\u9ed8\u8ba42160"}),"\n",(0,i.jsx)(n.p,{children:"-p\uff1a\u7f16\u89e3\u7801\u56fe\u50cf\u683c\u5f0f\uff0c\u9ed8\u8ba4nv12\uff0c 0\uff1ayuv420p 1\uff1anv12 2\uff1anv21"}),"\n",(0,i.jsx)(n.p,{children:"-n\uff1a\u6d4b\u8bd5\u7ebf\u7a0b\u6570\u91cf\uff0c\u9ed8\u8ba41\u4e2a"}),"\n",(0,i.jsxs)(n.p,{children:["-i\uff1a\u8f93\u5165\u6587\u4ef6\u7684\u8def\u5f84\uff0c\u9ed8\u8ba4",(0,i.jsx)(n.code,{children:"./input_${w}x${h}_${pixfmt}<_thread_idx>.yuv"})]}),"\n",(0,i.jsxs)(n.p,{children:["-o\uff1a\u8f93\u51fa\u6587\u4ef6\u7684\u8def\u5f84\uff0c\u9ed8\u8ba4",(0,i.jsx)(n.code,{children:"./output_${w}x${h}_${pixfmt}<_thread_idx>.{code_type}"})]}),"\n",(0,i.jsx)(n.p,{children:"-H\uff1a\u6253\u5370\u5e2e\u52a9\u4fe1\u606f"}),"\n",(0,i.jsx)(n.h6,{id:"\u5e2e\u52a9\u83dc\u5355-1",children:"\u5e2e\u52a9\u83dc\u5355"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"Usage: ./sample_codec\n        -m --samplemode sample mode, default encoder, {0-encoder, 1-decoder}\n        -c --codecid codec id, default h264, {0-h264, 1-h265, 2-mjpeg, 3-jpeg}\n        -w --width width, default 3840\n        -h --height height, default 2160\n        -p --pixfmt pix fmt, default nv12, {0-yuv420p, 1-nv12, ..}\n        -n --threadnum test thread number, default 1\n        -i --inputfile input file name, default ./input_${w}x${h}_${pixfmt}<_thread_idx>.yuv\n        -o --outputfile output file name, default ./output_${w}x${h}_${pixfmt}<_thread_idx>.{code_type}\n        -H --help print usage\n"})}),"\n",(0,i.jsx)(n.h6,{id:"\u8fd0\u884c\u65b9\u6cd5-1",children:"\u8fd0\u884c\u65b9\u6cd5"}),"\n",(0,i.jsx)(n.p,{children:"\u8f93\u5165\u6e90\u51c6\u5907\uff1a\u5c06\u6d4b\u8bd5\u6587\u4ef6(\u5982input_3840x2160_nv12.h264)\u5230\u5f53\u524d\u76ee\u5f55 \u6216\n\u7528-i\u6307\u5b9a\u6587\u4ef6\u8def\u5f84\uff1b"}),"\n",(0,i.jsx)(n.p,{children:"\u89e3\u7801\u4e00\u8def 3840x2160 \u7684 h264 \u89c6\u9891, \u751f\u6210 yuv \u56fe\u50cf"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"/app/multimedia_demo/codec_demo/sample_venc_vdec/sample_codec -m 1\n"})}),"\n",(0,i.jsx)(n.p,{children:"\u89e3\u7801\u4e00\u8def 1920x1080 \u7684 h265 \u89c6\u9891, \u751f\u6210 yuv \u56fe\u50cf"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"/app/multimedia_demo/codec_demo/sample_venc_vdec/sample_codec -m 1 -c 1 -w 1920 -h 1080\n"})}),"\n",(0,i.jsx)(n.p,{children:"\u89e3\u7801\u4e00\u5f20 1920x1088 \u7684 jpg \u56fe\u7247, \u751f\u6210 yuv \u56fe\u50cf"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"/app/multimedia_demo/codec_demo/sample_venc_vdec/sample_codec -m 1 -c 3 -w 1920 -h 1088\n"})}),"\n",(0,i.jsx)(n.p,{children:"\u89e3\u7801\u4e24\u8def 3840x2160 \u7684 h264 \u89c6\u9891, \u751f\u6210 yuv \u56fe\u50cf"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"/app/multimedia_demo/codec_demo/sample_venc_vdec/sample_codec -m 1 -n 2 -i\n"})}),"\n",(0,i.jsx)(n.p,{children:"\u89e3\u7801\u56db\u8def 1920x1080 \u7684 h265 \u89c6\u9891, \u751f\u6210 yuv \u56fe\u50cf"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"/app/multimedia_demo/codec_demo/sample_venc_vdec/sample_codec -m 1 -c 1 -n 4 -w 1920 -h 1080\n"})}),"\n",(0,i.jsx)(n.h6,{id:"\u8fd0\u884c\u7ed3\u679c\u8bf4\u660e-1",children:"\u8fd0\u884c\u7ed3\u679c\u8bf4\u660e"}),"\n",(0,i.jsx)(n.p,{children:"\u5982\u4e0b\u56fe\u6240\u793a\u4e3a\u8fd0\u884c\u6210\u529f"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{src:"https://rdk-doc.oss-cn-beijing.aliyuncs.com/doc/img/07_Advanced_development/03_multimedia_development/02_S100/codec/decoder3.png",alt:"image"})}),"\n",(0,i.jsx)(n.p,{children:"\u4f7f\u7528yuvplayer\u67e5\u770b\u751f\u6210\u7684yuv\u56fe\u50cf\u6587\u4ef6\u662f\u5426\u6b63\u5e38"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{src:"https://rdk-doc.oss-cn-beijing.aliyuncs.com/doc/img/07_Advanced_development/03_multimedia_development/02_S100/codec/decoder4.png",alt:"image"})})]})}function m(e={}){const{wrapper:n}={...(0,c.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(a,{...e})}):a(e)}}}]);