"use strict";(self.webpackChunkrdk_doc=self.webpackChunkrdk_doc||[]).push([[94526],{28453:(e,n,i)=>{i.d(n,{R:()=>o,x:()=>d});var s=i(96540);const t={},r=s.createContext(t);function o(e){const n=s.useContext(r);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:o(e.components),s.createElement(r.Provider,{value:n},e.children)}},85003:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>a,contentTitle:()=>d,default:()=>l,frontMatter:()=>o,metadata:()=>s,toc:()=>c});const s=JSON.parse('{"id":"Basic_Application/03_40pin_user_guide/spi","title":"3.3.6 SPI Application","description":"The RDK S100 exposes the SPI0 bus on physical pins 19, 21, 23, 24, 26 of the 40PIN header, supporting two chip selects with an I/O voltage of 3.3V.","source":"@site/i18n/en/docusaurus-plugin-content-docs-docs_s/current/03_Basic_Application/03_40pin_user_guide/06_spi.md","sourceDirName":"03_Basic_Application/03_40pin_user_guide","slug":"/Basic_Application/03_40pin_user_guide/spi","permalink":"/rdk_doc/en/rdk_s/Basic_Application/03_40pin_user_guide/spi","draft":false,"unlisted":false,"tags":[],"version":"current","lastUpdatedAt":1768581666000,"sidebarPosition":6,"frontMatter":{"sidebar_position":6},"sidebar":"tutorialSidebar","previous":{"title":"3.3.5 I2C Application","permalink":"/rdk_doc/en/rdk_s/Basic_Application/03_40pin_user_guide/i2c"},"next":{"title":"3.4.1 Reference Examples (Python)","permalink":"/rdk_doc/en/rdk_s/Basic_Application/multi_media/pydev_vio_demo"}}');var t=i(74848),r=i(28453);const o={sidebar_position:6},d="3.3.6 SPI Application",a={},c=[{value:"Loopback Test",id:"loopback-test",level:2},{value:"Hardware Connection",id:"hardware-connection",level:3},{value:"Test Procedure",id:"test-procedure",level:3},{value:"Test Code",id:"test-code",level:2}];function p(e){const n={admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",img:"img",li:"li",p:"p",pre:"pre",ul:"ul",...(0,r.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"336-spi-application",children:"3.3.6 SPI Application"})}),"\n",(0,t.jsxs)(n.p,{children:["The RDK S100 exposes the ",(0,t.jsx)(n.code,{children:"SPI0"})," bus on physical pins ",(0,t.jsx)(n.code,{children:"19, 21, 23, 24, 26"})," of the 40PIN header, supporting two chip selects with an I/O voltage of 3.3V."]}),"\n",(0,t.jsxs)(n.p,{children:["Please refer to ",(0,t.jsx)(n.code,{children:"/app/40pin_samples/test_spi.py"})," for detailed information on how to use SPI."]}),"\n",(0,t.jsx)(n.admonition,{type:"tip",children:(0,t.jsxs)(n.p,{children:["The pins mentioned below are provided as examples only. Port values may differ across platforms; always verify against your actual hardware setup. Alternatively, you can directly use the code under the ",(0,t.jsx)(n.code,{children:"/app/40pin_samples/"})," directory, which has already been verified on the board."]})}),"\n",(0,t.jsx)(n.h2,{id:"loopback-test",children:"Loopback Test"}),"\n",(0,t.jsx)(n.p,{children:"Connect MISO and MOSI together physically in hardware, then run the SPI test program to perform write and read operations. The expected result is that the data read back should be exactly identical to the data written."}),"\n",(0,t.jsx)(n.h3,{id:"hardware-connection",children:"Hardware Connection"}),"\n",(0,t.jsx)(n.p,{children:"Directly connect MISO and MOSI together using a jumper wire:"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{src:"https://rdk-doc.oss-cn-beijing.aliyuncs.com/doc/img/03_Basic_Application/03_40pin_user_guide/image/40pin_user_guide/image-rdk_s100_spi.png",alt:"image-20220512101915524"})}),"\n",(0,t.jsx)(n.h3,{id:"test-procedure",children:"Test Procedure"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Run ",(0,t.jsx)(n.code,{children:"python3 /app/40pin_samples/test_spi.py"})]}),"\n",(0,t.jsxs)(n.li,{children:["Select the bus number and chip select number from the printed list of SPI controllers as input options. For example, to test ",(0,t.jsx)(n.code,{children:"spidev0.0"}),", enter ",(0,t.jsx)(n.code,{children:"0"})," for both ",(0,t.jsx)(n.code,{children:"bus num"})," and ",(0,t.jsx)(n.code,{children:"cs num"}),", then press Enter:"]}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"List of enabled spi controllers:\n/dev/spidev0.0  /dev/spidev0.1\nPlease input SPI bus num:0\nPlease input SPI cs num:0\n"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Once the program runs correctly, it will continuously print ",(0,t.jsx)(n.code,{children:"0x55 0xAA"}),". If it prints ",(0,t.jsx)(n.code,{children:"0x00 0x00"})," instead, the SPI loopback test has failed."]}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"Starting demo now! Press CTRL+C to exit\n0x55 0xAA\n0x55 0xAA\n"})}),"\n",(0,t.jsx)(n.h2,{id:"test-code",children:"Test Code"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:'#!/usr/bin/env python3\n\nimport sys\nimport signal\nimport os\nimport time\n\n# Import the spidev module\nimport spidev\n\ndef signal_handler(signal, frame):\n    sys.exit(0)\n\ndef BytesToHex(Bytes):\n    return \'\'.join(["0x%02X " % x for x in Bytes]).strip()\n\ndef spidevTest():\n    # Set SPI bus number (0, 1, 2) and chip select (0, 1)\n    spi_bus = input("Please input SPI bus num:")\n    spi_device = input("Please input SPI cs num:")\n    # Create an object of the spidev class to access spidev-based Python functions.\n    spi = spidev.SpiDev()\n    # Open the SPI bus handle\n    spi.open(int(spi_bus), int(spi_device))\n\n    # Set SPI frequency to 12MHz\n    spi.max_speed_hz = 12000000\n\n    print("Starting demo now! Press CTRL+C to exit")\n\n    # Send [0x55, 0xAA]; the received data should also be [0x55, 0xAA]\n    try:\n        while True:\n            resp = spi.xfer2([0x55, 0xAA])\n            print(BytesToHex(resp))\n            time.sleep(1)\n\n    except KeyboardInterrupt:\n        spi.close()\n\nif __name__ == \'__main__\':\n    signal.signal(signal.SIGINT, signal_handler)\n    print("List of enabled spi controllers:")\n    os.system(\'ls /dev/spidev*\')\n\n    spidevTest()\n\n'})})]})}function l(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(p,{...e})}):p(e)}}}]);