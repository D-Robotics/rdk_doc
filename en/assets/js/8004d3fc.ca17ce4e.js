"use strict";(self.webpackChunkrdk_doc=self.webpackChunkrdk_doc||[]).push([[98669],{9175:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>d,contentTitle:()=>o,default:()=>m,frontMatter:()=>t,metadata:()=>r,toc:()=>p});const r=JSON.parse('{"id":"Robot_development/tros_dev/zero_copy","title":"5.5.1 \u4f7f\u7528\u201czero-copy\u201d","description":"\u529f\u80fd\u80cc\u666f","source":"@site/docs/05_Robot_development/05_tros_dev/zero_copy.md","sourceDirName":"05_Robot_development/05_tros_dev","slug":"/Robot_development/tros_dev/zero_copy","permalink":"/rdk_doc/Robot_development/tros_dev/zero_copy","draft":false,"unlisted":false,"tags":[],"version":"current","lastUpdatedAt":1756804952000,"sidebarPosition":1,"frontMatter":{"sidebar_position":1},"sidebar":"tutorialSidebar","previous":{"title":"5.4.10 \u89c6\u89c9\u8bed\u97f3\u76d2\u5b50","permalink":"/rdk_doc/Robot_development/apps/hobot_llamacpp"},"next":{"title":"5.5.2 \u6a21\u578b\u63a8\u7406","permalink":"/rdk_doc/Robot_development/tros_dev/ai_predict"}}');var l=s(74848),i=s(28453),c=s(11470),a=s(19365);const t={sidebar_position:1},o="5.5.1 \u4f7f\u7528\u201czero-copy\u201d",d={},p=[{value:"\u529f\u80fd\u80cc\u666f",id:"\u529f\u80fd\u80cc\u666f",level:2},{value:"\u524d\u7f6e\u6761\u4ef6",id:"\u524d\u7f6e\u6761\u4ef6",level:2},{value:"\u4efb\u52a1\u5185\u5bb9",id:"\u4efb\u52a1\u5185\u5bb9",level:2},{value:"1. \u521b\u5efapackage",id:"1-\u521b\u5efapackage",level:3},{value:"2. \u521b\u5efa\u81ea\u5b9a\u4e49\u6d88\u606f",id:"2-\u521b\u5efa\u81ea\u5b9a\u4e49\u6d88\u606f",level:3},{value:"2.1 \u65b0\u5efa\u6d88\u606f\u6587\u4ef6",id:"21-\u65b0\u5efa\u6d88\u606f\u6587\u4ef6",level:4},{value:"2.2 \u7f16\u8bd1\u4f9d\u8d56",id:"22-\u7f16\u8bd1\u4f9d\u8d56",level:4},{value:"2.3 \u7f16\u8bd1\u811a\u672c",id:"23-\u7f16\u8bd1\u811a\u672c",level:4},{value:"3. \u521b\u5efa\u6d88\u606f\u53d1\u5e03\u8282\u70b9",id:"3-\u521b\u5efa\u6d88\u606f\u53d1\u5e03\u8282\u70b9",level:3},{value:"3.1 \u65b0\u5efa\u6d88\u606f\u53d1\u5e03\u8282\u70b9\u6587\u4ef6",id:"31-\u65b0\u5efa\u6d88\u606f\u53d1\u5e03\u8282\u70b9\u6587\u4ef6",level:4},{value:"3.2 \u7f16\u8bd1\u4f9d\u8d56",id:"32-\u7f16\u8bd1\u4f9d\u8d56",level:4},{value:"3.3 \u7f16\u8bd1\u811a\u672c",id:"33-\u7f16\u8bd1\u811a\u672c",level:4},{value:"4. \u521b\u5efa\u6d88\u606f\u63a5\u6536\u8282\u70b9",id:"4-\u521b\u5efa\u6d88\u606f\u63a5\u6536\u8282\u70b9",level:3},{value:"4.1 \u65b0\u5efa\u6d88\u606f\u63a5\u6536\u8282\u70b9\u6587\u4ef6",id:"41-\u65b0\u5efa\u6d88\u606f\u63a5\u6536\u8282\u70b9\u6587\u4ef6",level:4},{value:"4.2 \u7f16\u8bd1\u811a\u672c",id:"42-\u7f16\u8bd1\u811a\u672c",level:4},{value:"5. \u7f16\u8bd1",id:"5-\u7f16\u8bd1",level:3},{value:"6. \u8fd0\u884c",id:"6-\u8fd0\u884c",level:3},{value:"\u672c\u8282\u603b\u7ed3",id:"\u672c\u8282\u603b\u7ed3",level:2},{value:"\u4f7f\u7528\u9650\u5236",id:"\u4f7f\u7528\u9650\u5236",level:2}];function u(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...e.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(n.header,{children:(0,l.jsx)(n.h1,{id:"551-\u4f7f\u7528zero-copy",children:"5.5.1 \u4f7f\u7528\u201czero-copy\u201d"})}),"\n","\n",(0,l.jsx)(n.h2,{id:"\u529f\u80fd\u80cc\u666f",children:"\u529f\u80fd\u80cc\u666f"}),"\n",(0,l.jsx)(n.p,{children:"\u901a\u4fe1\u662f\u673a\u5668\u4eba\u5f00\u53d1\u5f15\u64ce\u7684\u57fa\u7840\u529f\u80fd\uff0c\u539f\u751fROS2 Foxy\u8fdb\u884c\u5927\u6570\u636e\u91cf\u901a\u4fe1\u65f6\u5b58\u5728\u65f6\u5ef6\u8f83\u5927\u3001\u7cfb\u7edf\u8d1f\u8f7d\u8f83\u9ad8\u7b49\u95ee\u9898\u3002TogetheROS.Bot Foxy\u57fa\u4e8eRDK\u7cfb\u7edf\u8f6f\u4ef6\u5e93hbmem\u5b9e\u73b0\u4e86\u201czero-copy\u201d\u529f\u80fd\uff0c\u6570\u636e\u8de8\u8fdb\u7a0b\u4f20\u8f93\u96f6\u62f7\u8d1d\uff0c\u53ef\u5927\u5927\u51cf\u5c11\u5927\u5757\u6570\u636e\u4f20\u8f93\u5ef6\u65f6\u548c\u7cfb\u7edf\u8d44\u6e90\u5360\u7528\u3002\u672c\u8282\u4ecb\u7ecd\u5982\u4f55\u4f7f\u7528tros.b Foxy\u548cHumble\u521b\u5efapublisher\u548csubscriber node\u8fdb\u884c\u5927\u5757\u6570\u636e\u4f20\u8f93\uff0c\u5e76\u8ba1\u7b97\u4f20\u8f93\u5ef6\u65f6\u3002"}),"\n",(0,l.jsx)(n.admonition,{type:"info",children:(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"tros.b Foxy\u7248\u672c\u57fa\u4e8eROS2 Foxy\u65b0\u589e\u4e86\u201czero-copy\u201d\u529f\u80fd\u3002"}),"\n",(0,l.jsxs)(n.li,{children:["tros.b Humble\u7248\u672c\u4f7f\u7528\u7684\u662fROS2 Humble\u7684\u201czero-copy\u201d\u529f\u80fd\uff0c\u5177\u4f53\u4f7f\u7528\u65b9\u6cd5\u8bf7\u53c2\u8003ROS2\u5b98\u65b9",(0,l.jsx)(n.a,{href:"https://docs.ros.org/en/humble/Tutorials/Advanced/FastDDS-Configuration.html#",children:"\u6587\u6863"}),"\u548c",(0,l.jsx)(n.a,{href:"https://github.com/ros2/demos/blob/humble/demo_nodes_cpp/src/topics/talker_loaned_message.cpp",children:"\u4ee3\u7801"}),"\u3002"]}),"\n"]})}),"\n",(0,l.jsx)(n.h2,{id:"\u524d\u7f6e\u6761\u4ef6",children:"\u524d\u7f6e\u6761\u4ef6"}),"\n",(0,l.jsxs)(n.p,{children:["\u5df2\u6309\u7167",(0,l.jsx)(n.a,{href:"/docs/05_Robot_development/01_quick_start/install_tros.md",children:"\u5b89\u88c5"}),"\u6210\u529f\u5b89\u88c5tros.b\uff0c\u5e76\u5df2\u638c\u63e1ROS2 node\uff0ctopic\uff0cqos\u7b49\u57fa\u7840\u77e5\u8bc6\uff0c\u4ee5\u53ca\u5982\u4f55\u521b\u5efapackage\u548c\u4f7f\u7528\u81ea\u5b9a\u4e49\u6d88\u606f\uff0c\u5177\u4f53\u6559\u7a0b\u53ef\u89c1",(0,l.jsx)(n.a,{href:"https://docs.ros.org/en/foxy/Tutorials.html",children:"ROS2\u5b98\u65b9\u6587\u6863"}),"\u3002"]}),"\n",(0,l.jsxs)(n.p,{children:["ROS2\u8f6f\u4ef6\u5305\u6784\u5efa\u3001\u7f16\u8bd1\u7b49\u5de5\u5177\u3002\u5b89\u88c5\u547d\u4ee4\uff1a",(0,l.jsx)(n.code,{children:"sudo apt install ros-dev-tools"})]}),"\n",(0,l.jsx)(n.h2,{id:"\u4efb\u52a1\u5185\u5bb9",children:"\u4efb\u52a1\u5185\u5bb9"}),"\n",(0,l.jsx)(n.h3,{id:"1-\u521b\u5efapackage",children:"1. \u521b\u5efapackage"}),"\n",(0,l.jsxs)(n.p,{children:["\u6253\u5f00\u4e00\u4e2a\u65b0\u7684\u7ec8\u7aef\uff0csource tros.b setup\u811a\u672c\uff0c\u786e\u4fdd",(0,l.jsx)(n.code,{children:"ros2"}),"\u547d\u4ee4\u53ef\u4ee5\u8fd0\u884c\u3002"]}),"\n",(0,l.jsxs)(c.A,{groupId:"tros-distro",children:[(0,l.jsx)(a.A,{value:"foxy",label:"Foxy",children:(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"source /opt/tros/setup.bash\n"})})}),(0,l.jsx)(a.A,{value:"humble",label:"Humble",children:(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"source /opt/tros/humble/setup.bash\n"})})})]}),"\n",(0,l.jsxs)(n.p,{children:["\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u521b\u5efa\u4e00\u4e2aworkspace\uff0c\u8be6\u7ec6\u4ecb\u7ecd\u53ef\u89c1ROS2 \u5b98\u65b9\u6559\u7a0b",(0,l.jsx)(n.a,{href:"https://docs.ros.org/en/foxy/Tutorials/Workspace/Creating-A-Workspace.html",children:"Creating a workspace"}),"\u3002"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-shell",children:"mkdir -p ~/dev_ws/src\ncd ~/dev_ws/src\n"})}),"\n",(0,l.jsx)(n.p,{children:"\u8fd0\u884c\u4ee5\u4e0b\u547d\u4ee4\u521b\u5efa\u4e00\u4e2apackage"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-shell",children:"ros2 pkg create --build-type ament_cmake hbmem_pubsub\n"})}),"\n",(0,l.jsx)(n.h3,{id:"2-\u521b\u5efa\u81ea\u5b9a\u4e49\u6d88\u606f",children:"2. \u521b\u5efa\u81ea\u5b9a\u4e49\u6d88\u606f"}),"\n",(0,l.jsx)(n.h4,{id:"21-\u65b0\u5efa\u6d88\u606f\u6587\u4ef6",children:"2.1 \u65b0\u5efa\u6d88\u606f\u6587\u4ef6"}),"\n",(0,l.jsxs)(n.p,{children:["\u8fd0\u884c\u4ee5\u4e0b\u547d\u4ee4\uff0c\u521b\u5efa",(0,l.jsx)(n.code,{children:"msg"}),"\u76ee\u5f55\u7528\u6765\u5b58\u653e\u81ea\u5b9a\u4e49\u6d88\u606f\u6587\u4ef6"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-shell",children:"cd ~/dev_ws/src/hbmem_pubsub\nmkdir msg\n"})}),"\n",(0,l.jsxs)(n.p,{children:["\u5728",(0,l.jsx)(n.code,{children:"msg"}),"\u76ee\u5f55\u4e0b\u65b0\u5efa",(0,l.jsx)(n.code,{children:"SampleMessage.msg"}),"\u6587\u4ef6\uff0c\u5177\u4f53\u5185\u5bb9\u5982\u4e0b:"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-idl",children:"int32 index\nuint64 time_stamp\nuint8[4194304] data\n\nuint32 MAX_SIZE=4194304\n"})}),"\n",(0,l.jsx)(n.h4,{id:"22-\u7f16\u8bd1\u4f9d\u8d56",children:"2.2 \u7f16\u8bd1\u4f9d\u8d56"}),"\n",(0,l.jsxs)(n.p,{children:["\u8fd4\u56de\u5230",(0,l.jsx)(n.code,{children:"~/dev_ws/src/hbmem_pubsub"}),"\u76ee\u5f55\uff0c\u4fee\u6539",(0,l.jsx)(n.code,{children:"package.xml"}),"\uff0c\u5728",(0,l.jsx)(n.code,{children:"<buildtool_depend>ament_cmake</buildtool_depend>"}),"\u4e0b\u9762\u6dfb\u52a0\u4ee5\u4e0b\u5185\u5bb9\uff1a"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-xml",children:"<build_depend>rosidl_default_generators</build_depend>\n<exec_depend>rosidl_default_runtime</exec_depend>\n<member_of_group>rosidl_interface_packages</member_of_group>\n"})}),"\n",(0,l.jsx)(n.h4,{id:"23-\u7f16\u8bd1\u811a\u672c",children:"2.3 \u7f16\u8bd1\u811a\u672c"}),"\n",(0,l.jsxs)(n.p,{children:["\u4fee\u6539",(0,l.jsx)(n.code,{children:"CMakeLists.txt"}),"\uff0c\u5728",(0,l.jsx)(n.code,{children:"# find_package(<dependency> REQUIRED)"}),"\u4e0b\u9762\u6dfb\u52a0\u4ee5\u4e0b\u5185\u5bb9\uff0c\u8fdb\u884cmsg\u7f16\u8bd1:"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-cmake",children:'find_package(rosidl_default_generators REQUIRED)\nrosidl_generate_interfaces(${PROJECT_NAME}\n  "msg/SampleMessage.msg"\n)\n'})}),"\n",(0,l.jsx)(n.h3,{id:"3-\u521b\u5efa\u6d88\u606f\u53d1\u5e03\u8282\u70b9",children:"3. \u521b\u5efa\u6d88\u606f\u53d1\u5e03\u8282\u70b9"}),"\n",(0,l.jsx)(n.h4,{id:"31-\u65b0\u5efa\u6d88\u606f\u53d1\u5e03\u8282\u70b9\u6587\u4ef6",children:"3.1 \u65b0\u5efa\u6d88\u606f\u53d1\u5e03\u8282\u70b9\u6587\u4ef6"}),"\n",(0,l.jsxs)(n.p,{children:["\u5728",(0,l.jsx)(n.code,{children:"~/dev_ws/src/hbmem_pubsub/src"}),"\u76ee\u5f55\u4e0b\u65b0\u5efa",(0,l.jsx)(n.code,{children:" publisher_hbmem.cpp"}),"\u6587\u4ef6\uff0c\u7528\u6765\u521b\u5efapublisher node\uff0c\u5177\u4f53\u4ee3\u7801\u548c\u89e3\u91ca\u5982\u4e0b\uff1a"]}),"\n",(0,l.jsxs)(c.A,{groupId:"tros-distro",children:[(0,l.jsx)(a.A,{value:"foxy",label:"Foxy",children:(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-c++",children:'#include <chrono>\n#include <functional>\n#include <memory>\n#include <string>\n\n#include "rclcpp/rclcpp.hpp"\n#include "hbmem_pubsub/msg/sample_message.hpp"\n\nusing namespace std::chrono_literals;\n\nclass MinimalHbmemPublisher  : public rclcpp::Node {\n public:\n  MinimalHbmemPublisher () : Node("minimal_hbmem_publisher"), count_(0) {\n    // \u521b\u5efapublisher_hbmem\uff0ctopic\u4e3a"topic"\n    publisher_ = this->create_publisher_hbmem<hbmem_pubsub::msg::SampleMessage>(\n        "topic", rclcpp::SensorDataQoS());\n\n    // \u5b9a\u65f6\u5668\uff0c\u6bcf\u969440\u6beb\u79d2\u8c03\u7528\u4e00\u6b21timer_callback\u8fdb\u884c\u6d88\u606f\u53d1\u9001\n    timer_ = this->create_wall_timer(\n        40ms, std::bind(&MinimalHbmemPublisher ::timer_callback, this));\n  }\n\n private:\n  // \u5b9a\u65f6\u5668\u56de\u8c03\u51fd\u6570\n  void timer_callback() {\n    // \u83b7\u53d6\u8981\u53d1\u9001\u7684\u6d88\u606f\n    auto loanedMsg = publisher_->borrow_loaned_message();\n    // \u5224\u65ad\u6d88\u606f\u662f\u5426\u53ef\u7528\uff0c\u53ef\u80fd\u51fa\u73b0\u83b7\u53d6\u6d88\u606f\u5931\u8d25\u5bfc\u81f4\u6d88\u606f\u4e0d\u53ef\u7528\u7684\u60c5\u51b5\n    if (loanedMsg.is_valid()) {\n      // \u5f15\u7528\u65b9\u5f0f\u83b7\u53d6\u5b9e\u9645\u7684\u6d88\u606f\n      auto& msg = loanedMsg.get();\n      \n      // \u83b7\u53d6\u5f53\u524d\u65f6\u95f4\uff0c\u5355\u4f4d\u4e3aus\n      auto time_now =\n          std::chrono::duration_cast<std::chrono::microseconds>(\n              std::chrono::steady_clock::now().time_since_epoch()).count();\n      \n      // \u5bf9\u6d88\u606f\u7684index\u548ctime_stamp\u8fdb\u884c\u8d4b\u503c\n      msg.index = count_;\n      msg.time_stamp = time_now;\n      \n      // \u6253\u5370\u53d1\u9001\u6d88\u606f\n      RCLCPP_INFO(this->get_logger(), "message: %d", msg.index);\n      publisher_->publish(std::move(loanedMsg));\n      // \u6ce8\u610f\uff0c\u53d1\u9001\u540e\uff0cloanedMsg\u5df2\u4e0d\u53ef\u7528\n      // \u8ba1\u6570\u5668\u52a0\u4e00\n      count_++;\n    } else {\n      // \u83b7\u53d6\u6d88\u606f\u5931\u8d25\uff0c\u4e22\u5f03\u8be5\u6d88\u606f\n      RCLCPP_INFO(this->get_logger(), "Failed to get LoanMessage!");\n    }\n  }\n  \n  // \u5b9a\u65f6\u5668\n  rclcpp::TimerBase::SharedPtr timer_;\n\n  // hbmem publisher\n  rclcpp::PublisherHbmem<hbmem_pubsub::msg::SampleMessage>::SharedPtr publisher_;\n  \n  // \u8ba1\u6570\u5668\n  size_t count_;\n};\n\nint main(int argc, char * argv[])\n{\n  rclcpp::init(argc, argv);\n  rclcpp::spin(std::make_shared<MinimalHbmemPublisher>());\n  rclcpp::shutdown();\n  return 0;\n}\n'})})}),(0,l.jsx)(a.A,{value:"humble",label:"Humble",children:(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-c++",children:'#include <chrono>\n#include <functional>\n#include <memory>\n#include <string>\n\n#include "rclcpp/rclcpp.hpp"\n#include "hbmem_pubsub/msg/sample_message.hpp"\n\nusing namespace std::chrono_literals;\n\nclass MinimalHbmemPublisher  : public rclcpp::Node {\n public:\n  MinimalHbmemPublisher () : Node("minimal_hbmem_publisher"), count_(0) {\n    // \u521b\u5efapublisher_hbmem\uff0ctopic\u4e3a"topic"\n    publisher_ = this->create_publisher<hbmem_pubsub::msg::SampleMessage>(\n        "topic", rclcpp::SensorDataQoS());\n\n    // \u5b9a\u65f6\u5668\uff0c\u6bcf\u969440\u6beb\u79d2\u8c03\u7528\u4e00\u6b21timer_callback\u8fdb\u884c\u6d88\u606f\u53d1\u9001\n    timer_ = this->create_wall_timer(\n        40ms, std::bind(&MinimalHbmemPublisher ::timer_callback, this));\n  }\n\n private:\n  // \u5b9a\u65f6\u5668\u56de\u8c03\u51fd\u6570\n  void timer_callback() {\n    // \u83b7\u53d6\u8981\u53d1\u9001\u7684\u6d88\u606f\n    auto loanedMsg = publisher_->borrow_loaned_message();\n    // \u5224\u65ad\u6d88\u606f\u662f\u5426\u53ef\u7528\uff0c\u53ef\u80fd\u51fa\u73b0\u83b7\u53d6\u6d88\u606f\u5931\u8d25\u5bfc\u81f4\u6d88\u606f\u4e0d\u53ef\u7528\u7684\u60c5\u51b5\n    if (loanedMsg.is_valid()) {\n      // \u5f15\u7528\u65b9\u5f0f\u83b7\u53d6\u5b9e\u9645\u7684\u6d88\u606f\n      auto& msg = loanedMsg.get();\n      \n      // \u83b7\u53d6\u5f53\u524d\u65f6\u95f4\uff0c\u5355\u4f4d\u4e3aus\n      auto time_now =\n          std::chrono::duration_cast<std::chrono::microseconds>(\n              std::chrono::steady_clock::now().time_since_epoch()).count();\n      \n      // \u5bf9\u6d88\u606f\u7684index\u548ctime_stamp\u8fdb\u884c\u8d4b\u503c\n      msg.index = count_;\n      msg.time_stamp = time_now;\n      \n      // \u6253\u5370\u53d1\u9001\u6d88\u606f\n      RCLCPP_INFO(this->get_logger(), "message: %d", msg.index);\n      publisher_->publish(std::move(loanedMsg));\n      // \u6ce8\u610f\uff0c\u53d1\u9001\u540e\uff0cloanedMsg\u5df2\u4e0d\u53ef\u7528\n      // \u8ba1\u6570\u5668\u52a0\u4e00\n      count_++;\n    } else {\n      // \u83b7\u53d6\u6d88\u606f\u5931\u8d25\uff0c\u4e22\u5f03\u8be5\u6d88\u606f\n      RCLCPP_INFO(this->get_logger(), "Failed to get LoanMessage!");\n    }\n  }\n  \n  // \u5b9a\u65f6\u5668\n  rclcpp::TimerBase::SharedPtr timer_;\n\n  // hbmem publisher\n  rclcpp::Publisher<hbmem_pubsub::msg::SampleMessage>::SharedPtr publisher_;\n  \n  // \u8ba1\u6570\u5668\n  size_t count_;\n};\n\nint main(int argc, char * argv[])\n{\n  rclcpp::init(argc, argv);\n  rclcpp::spin(std::make_shared<MinimalHbmemPublisher>());\n  rclcpp::shutdown();\n  return 0;\n}\n'})})})]}),"\n",(0,l.jsx)(n.h4,{id:"32-\u7f16\u8bd1\u4f9d\u8d56",children:"3.2 \u7f16\u8bd1\u4f9d\u8d56"}),"\n",(0,l.jsxs)(n.p,{children:["\u8fd4\u56de\u5230",(0,l.jsx)(n.code,{children:"~/dev_ws/src/hbmem_pubsub"}),"\u76ee\u5f55\uff0c\u4fee\u6539",(0,l.jsx)(n.code,{children:"package.xml"}),"\uff0c\u5728",(0,l.jsx)(n.code,{children:"<member_of_group>rosidl_interface_packages</member_of_group>"}),"  \u4e0b\u9762\u589e\u52a0",(0,l.jsx)(n.code,{children:"rclcpp"}),"\u4f9d\u8d56\uff1a"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-xml",children:"  <depend>rclcpp</depend>\n"})}),"\n",(0,l.jsx)(n.h4,{id:"33-\u7f16\u8bd1\u811a\u672c",children:"3.3 \u7f16\u8bd1\u811a\u672c"}),"\n",(0,l.jsxs)(n.p,{children:["\u4fee\u6539",(0,l.jsx)(n.code,{children:"CMakeLists.txt"}),"\uff0c\u5728",(0,l.jsx)(n.code,{children:"rosidl_generate_interfaces"}),"\u8bed\u53e5\u4e0b\u9762\u6dfb\u52a0\u4ee5\u4e0b\u5185\u5bb9\uff0c\u5b8c\u6210publisher\u7f16\u8bd1\uff1a"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-cmake",children:'find_package(rclcpp REQUIRED)\n\nadd_executable(talker src/publisher_hbmem.cpp)\nament_target_dependencies(talker rclcpp)\nrosidl_target_interfaces(talker\n  ${PROJECT_NAME} "rosidl_typesupport_cpp")\n\ninstall(TARGETS\n  talker\n  DESTINATION lib/${PROJECT_NAME})\n'})}),"\n",(0,l.jsx)(n.h3,{id:"4-\u521b\u5efa\u6d88\u606f\u63a5\u6536\u8282\u70b9",children:"4. \u521b\u5efa\u6d88\u606f\u63a5\u6536\u8282\u70b9"}),"\n",(0,l.jsx)(n.h4,{id:"41-\u65b0\u5efa\u6d88\u606f\u63a5\u6536\u8282\u70b9\u6587\u4ef6",children:"4.1 \u65b0\u5efa\u6d88\u606f\u63a5\u6536\u8282\u70b9\u6587\u4ef6"}),"\n",(0,l.jsxs)(n.p,{children:["\u5728",(0,l.jsx)(n.code,{children:"~/dev_ws/src/hbmem_pubsub/src"}),"\u76ee\u5f55\u4e0b\u65b0\u5efa",(0,l.jsx)(n.code,{children:"  subscriber_hbmem.cpp"}),"\u6587\u4ef6\uff0c\u7528\u6765\u521b\u5efasubscriber node\uff0c\u5177\u4f53\u4ee3\u7801\u548c\u89e3\u91ca\u5982\u4e0b\uff1a"]}),"\n",(0,l.jsxs)(c.A,{groupId:"tros-distro",children:[(0,l.jsx)(a.A,{value:"foxy",label:"Foxy",children:(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-c++",children:'#include <memory>\n\n#include "rclcpp/rclcpp.hpp"\n#include "hbmem_pubsub/msg/sample_message.hpp"\n\nclass MinimalHbmemSubscriber  : public rclcpp::Node {\n public:\n  MinimalHbmemSubscriber () : Node("minimal_hbmem_subscriber") {\n    // \u521b\u5efasubscription_hbmem\uff0ctopic\u4e3a"sample"\n    // \u6d88\u606f\u56de\u8c03\u51fd\u6570\u4e3atopic_callback\n    subscription_ =\n        this->create_subscription_hbmem<hbmem_pubsub::msg::SampleMessage>(\n            "topic", rclcpp::SensorDataQoS(),\n            std::bind(&MinimalHbmemSubscriber ::topic_callback, this,\n                      std::placeholders::_1));\n  }\n\n private:\n  // \u6d88\u606f\u56de\u8c03\u51fd\u6570\n  void topic_callback(\n      const hbmem_pubsub::msg::SampleMessage::SharedPtr msg) const {\n    // \u6ce8\u610f\uff0cmsg\u53ea\u80fd\u5728\u56de\u8c03\u51fd\u6570\u4e2d\u4f7f\u7528\uff0c\u56de\u8c03\u51fd\u6570\u8fd4\u56de\u540e\uff0c\u8be5\u6d88\u606f\u5c31\u4f1a\u88ab\u91ca\u653e\n    // \u83b7\u53d6\u5f53\u524d\u65f6\u95f4\n    auto time_now =\n        std::chrono::duration_cast<std::chrono::microseconds>(\n            std::chrono::steady_clock::now().time_since_epoch())\n            .count();\n    // \u8ba1\u7b97\u5ef6\u65f6\u5e76\u6253\u5370\u51fa\u6765\n    RCLCPP_INFO(this->get_logger(), "msg %d, time cost %dus", msg->index,\n                time_now - msg->time_stamp);\n  }\n  \n  // hbmem subscription\n  rclcpp::SubscriptionHbmem<hbmem_pubsub::msg::SampleMessage>::SharedPtr\n      subscription_;\n};\n\n\nint main(int argc, char * argv[])\n{\n  rclcpp::init(argc, argv);\n  rclcpp::spin(std::make_shared<MinimalHbmemSubscriber>());\n  rclcpp::shutdown();\n  return 0;\n}\n'})})}),(0,l.jsx)(a.A,{value:"humble",label:"Humble",children:(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-c++",children:'#include <memory>\n\n#include "rclcpp/rclcpp.hpp"\n#include "hbmem_pubsub/msg/sample_message.hpp"\n\nclass MinimalHbmemSubscriber  : public rclcpp::Node {\n public:\n  MinimalHbmemSubscriber () : Node("minimal_hbmem_subscriber") {\n    // \u521b\u5efasubscription_hbmem\uff0ctopic\u4e3a"sample"\n    // \u6d88\u606f\u56de\u8c03\u51fd\u6570\u4e3atopic_callback\n    subscription_ =\n        this->create_subscription<hbmem_pubsub::msg::SampleMessage>(\n            "topic", rclcpp::SensorDataQoS(),\n            std::bind(&MinimalHbmemSubscriber ::topic_callback, this,\n                      std::placeholders::_1));\n  }\n\n private:\n  // \u6d88\u606f\u56de\u8c03\u51fd\u6570\n  void topic_callback(\n      const hbmem_pubsub::msg::SampleMessage::SharedPtr msg) const {\n    // \u6ce8\u610f\uff0cmsg\u53ea\u80fd\u5728\u56de\u8c03\u51fd\u6570\u4e2d\u4f7f\u7528\uff0c\u56de\u8c03\u51fd\u6570\u8fd4\u56de\u540e\uff0c\u8be5\u6d88\u606f\u5c31\u4f1a\u88ab\u91ca\u653e\n    // \u83b7\u53d6\u5f53\u524d\u65f6\u95f4\n    auto time_now =\n        std::chrono::duration_cast<std::chrono::microseconds>(\n            std::chrono::steady_clock::now().time_since_epoch())\n            .count();\n    // \u8ba1\u7b97\u5ef6\u65f6\u5e76\u6253\u5370\u51fa\u6765\n    RCLCPP_INFO(this->get_logger(), "msg %d, time cost %dus", msg->index,\n                time_now - msg->time_stamp);\n  }\n  \n  // hbmem subscription\n  rclcpp::Subscription<hbmem_pubsub::msg::SampleMessage>::SharedPtr\n      subscription_;\n};\n\n\nint main(int argc, char * argv[])\n{\n  rclcpp::init(argc, argv);\n  rclcpp::spin(std::make_shared<MinimalHbmemSubscriber>());\n  rclcpp::shutdown();\n  return 0;\n}\n'})})})]}),"\n",(0,l.jsx)(n.h4,{id:"42-\u7f16\u8bd1\u811a\u672c",children:"4.2 \u7f16\u8bd1\u811a\u672c"}),"\n",(0,l.jsxs)(n.p,{children:["\u8fd4\u56de\u5230",(0,l.jsx)(n.code,{children:"~/dev_ws/src/hbmem_pubsub"}),"\u76ee\u5f55\uff0c\u4e4b\u524d\u5df2\u7ecf\u5728",(0,l.jsx)(n.code,{children:"package.xml"}),"\u4e2d\u589e\u52a0",(0,l.jsx)(n.code,{children:"rclcpp"}),"\u4f9d\u8d56\uff0c\u6545\u4e0d\u9700\u8981\u9700\u6539",(0,l.jsx)(n.code,{children:"package.xml"}),"\u3002"]}),"\n",(0,l.jsxs)(n.p,{children:["\u4fee\u6539",(0,l.jsx)(n.code,{children:"CMakeLists.txt"}),"\uff0c\u5728",(0,l.jsx)(n.code,{children:"install"}),"\u8bed\u53e5\u4e0b\u9762\u6dfb\u52a0\u4ee5\u4e0b\u5185\u5bb9\uff0c\u5b8c\u6210subscriber\u7f16\u8bd1\uff1a"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-cmake",children:'add_executable(listener src/subscriber_hbmem.cpp)\nament_target_dependencies(listener rclcpp)\nrosidl_target_interfaces(listener\n  ${PROJECT_NAME} "rosidl_typesupport_cpp")\n\ninstall(TARGETS\n  listener\n  DESTINATION lib/${PROJECT_NAME})\n'})}),"\n",(0,l.jsx)(n.h3,{id:"5-\u7f16\u8bd1",children:"5. \u7f16\u8bd1"}),"\n",(0,l.jsx)(n.p,{children:"\u6574\u4e2aworkspace\u76ee\u5f55\u7ed3\u6784\u5982\u4e0b\uff1a"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-shell",children:"dev_ws/\n\u2514\u2500\u2500 src\n    \u2514\u2500\u2500 hbmem_pubsub\n        \u251c\u2500\u2500 CMakeLists.txt\n        \u251c\u2500\u2500 include\n        \u2502\xa0\xa0 \u2514\u2500\u2500 hbmem_pubsub\n        \u251c\u2500\u2500 msg\n        \u2502\xa0\xa0 \u2514\u2500\u2500 SampleMessage.msg\n        \u251c\u2500\u2500 package.xml\n        \u2514\u2500\u2500 src\n            \u251c\u2500\u2500 publisher_hbmem.cpp\n            \u2514\u2500\u2500 subscriber_hbmem.cpp\n"})}),"\n",(0,l.jsxs)(n.p,{children:["\u5b8c\u6574\u7684",(0,l.jsx)(n.code,{children:"package.xml"}),"\u5185\u5bb9\u5982\u4e0b\uff1a"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-xml",children:'<?xml version="1.0"?>\n<?xml-model href="http://download.ros.org/schema/package_format3.xsd" schematypens="http://www.w3.org/2001/XMLSchema"?>\n<package format="3">\n  <name>hbmem_pubsub</name>\n  <version>0.0.0</version>\n  <description>TODO: Package description</description>\n  <maintainer email="root@todo.todo">root</maintainer>\n  <license>TODO: License declaration</license>\n\n  <buildtool_depend>ament_cmake</buildtool_depend>\n\n  <build_depend>rosidl_default_generators</build_depend>\n  <exec_depend>rosidl_default_runtime</exec_depend>\n  <member_of_group>rosidl_interface_packages</member_of_group>\n\n  <depend>rclcpp</depend>\n\n  <test_depend>ament_lint_auto</test_depend>\n  <test_depend>ament_lint_common</test_depend>\n\n  <export>\n    <build_type>ament_cmake</build_type>\n  </export>\n</package>\n\n'})}),"\n",(0,l.jsxs)(n.p,{children:["\u5b8c\u6574\u7684",(0,l.jsx)(n.code,{children:"CMakeLists.txt"}),"\u5185\u5bb9\u5982\u4e0b\uff1a"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-cmake",children:'cmake_minimum_required(VERSION 3.5)\nproject(hbmem_pubsub)\n\n# Default to C99\nif(NOT CMAKE_C_STANDARD)\n  set(CMAKE_C_STANDARD 99)\nendif()\n\n# Default to C++14\nif(NOT CMAKE_CXX_STANDARD)\n  set(CMAKE_CXX_STANDARD 14)\nendif()\n\nif(CMAKE_COMPILER_IS_GNUCXX OR CMAKE_CXX_COMPILER_ID MATCHES "Clang")\n  add_compile_options(-Wall -Wextra -Wpedantic)\nendif()\n\n# find dependencies\nfind_package(ament_cmake REQUIRED)\n# uncomment the following section in order to fill in\n# further dependencies manually.\n# find_package(<dependency> REQUIRED)\nfind_package(rosidl_default_generators REQUIRED)\n\nrosidl_generate_interfaces(${PROJECT_NAME}\n  "msg/SampleMessage.msg"\n)\n\nfind_package(rclcpp REQUIRED)\n\nadd_executable(talker src/publisher_hbmem.cpp)\nament_target_dependencies(talker rclcpp)\nrosidl_target_interfaces(talker\n  ${PROJECT_NAME} "rosidl_typesupport_cpp")\n\ninstall(TARGETS\n  talker\n  DESTINATION lib/${PROJECT_NAME})\n\nadd_executable(listener src/subscriber_hbmem.cpp)\nament_target_dependencies(listener rclcpp)\nrosidl_target_interfaces(listener\n  ${PROJECT_NAME} "rosidl_typesupport_cpp")\n\ninstall(TARGETS\n  listener\n  DESTINATION lib/${PROJECT_NAME})\n\nif(BUILD_TESTING)\n  find_package(ament_lint_auto REQUIRED)\n  # the following line skips the linter which checks for copyrights\n  # uncomment the line when a copyright and license is not present in all source files\n  #set(ament_cmake_copyright_FOUND TRUE)\n  # the following line skips cpplint (only works in a git repo)\n  # uncomment the line when this package is not in a git repo\n  #set(ament_cmake_cpplint_FOUND TRUE)\n  ament_lint_auto_find_test_dependencies()\nendif()\n\nament_package()\n\n'})}),"\n",(0,l.jsxs)(n.p,{children:["\u5728workspace\u6839\u76ee\u5f55",(0,l.jsx)(n.code,{children:"~/dev_ws"}),"\uff0c\u7f16\u8bd1package:"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-shell",children:"colcon build --packages-select hbmem_pubsub\n"})}),"\n",(0,l.jsxs)(n.p,{children:["\u82e5\u63d0\u793a",(0,l.jsx)(n.code,{children:"colcon"}),"\u547d\u4ee4\u672a\u5b89\u88c5\uff0c\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u5b89\u88c5\u5373\u53ef\uff1a"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-shell",children:"sudo apt install ros-dev-tools\n"})}),"\n",(0,l.jsx)(n.h3,{id:"6-\u8fd0\u884c",children:"6. \u8fd0\u884c"}),"\n",(0,l.jsxs)(n.p,{children:["\u6253\u5f00\u4e00\u4e2a\u65b0\u7684\u7ec8\u7aef\uff0c",(0,l.jsx)(n.code,{children:"cd"}),"\u5230",(0,l.jsx)(n.code,{children:"dev_ws"}),"\u76ee\u5f55\uff0csource tros.b\u548c\u5f53\u524dworkspace setup\u6587\u4ef6\uff1a"]}),"\n",(0,l.jsxs)(c.A,{groupId:"tros-distro",children:[(0,l.jsx)(a.A,{value:"foxy",label:"Foxy",children:(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"source /opt/tros/setup.bash\ncd ~/dev_ws\n. install/setup.bash\n# \u8fd0\u884ctalker node:\nros2 run hbmem_pubsub talker\n"})})}),(0,l.jsx)(a.A,{value:"humble",label:"Humble",children:(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"source /opt/tros/humble/setup.bash\ncd ~/dev_ws\n. install/setup.bash\nexport RMW_IMPLEMENTATION=rmw_fastrtps_cpp\nexport FASTRTPS_DEFAULT_PROFILES_FILE=/opt/tros/humble/lib/hobot_shm/config/shm_fastdds.xml\nexport RMW_FASTRTPS_USE_QOS_FROM_XML=1\nexport ROS_DISABLE_LOANED_MESSAGES=0\n# \u8fd0\u884ctalker node:\nros2 run hbmem_pubsub talker\n"})})})]}),"\n",(0,l.jsx)(n.p,{children:"\u7ec8\u7aef\u4e0a\u4f1a\u51fa\u73b0\u5982\u4e0b\u6253\u5370\uff1a"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-text",children:"[INFO] [1649227473.431381673] [minimal_hbmem_publisher]: message: 0\n[INFO] [1649227473.470746697] [minimal_hbmem_publisher]: message: 1\n[INFO] [1649227473.510923361] [minimal_hbmem_publisher]: message: 2\n[INFO] [1649227473.550886783] [minimal_hbmem_publisher]: message: 3\n[INFO] [1649227473.590664377] [minimal_hbmem_publisher]: message: 4\n[INFO] [1649227473.630857041] [minimal_hbmem_publisher]: message: 5\n"})}),"\n",(0,l.jsxs)(n.p,{children:["\u518d\u6253\u5f00\u4e00\u4e2a\u65b0\u7684\u7ec8\u7aef\uff0c\u540c\u6837",(0,l.jsx)(n.code,{children:"cd"}),"\u5230",(0,l.jsx)(n.code,{children:"dev_ws"}),"\u76ee\u5f55\uff0c\u7136\u540esouce setup\u6587\u4ef6\uff0c\u4e4b\u540e\u8fd0\u884clistener node:"]}),"\n",(0,l.jsxs)(c.A,{groupId:"tros-distro",children:[(0,l.jsx)(a.A,{value:"foxy",label:"Foxy",children:(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"source /opt/tros/setup.bash\ncd ~/dev_ws\n. install/setup.bash\n\nros2 run hbmem_pubsub listener\n"})})}),(0,l.jsx)(a.A,{value:"humble",label:"Humble",children:(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"source /opt/tros/humble/setup.bash\ncd ~/dev_ws\n. install/setup.bash\nexport RMW_IMPLEMENTATION=rmw_fastrtps_cpp\nexport FASTRTPS_DEFAULT_PROFILES_FILE=/opt/tros/humble/lib/hobot_shm/config/shm_fastdds.xml\nexport RMW_FASTRTPS_USE_QOS_FROM_XML=1\nexport ROS_DISABLE_LOANED_MESSAGES=0\nros2 run hbmem_pubsub listener\n"})})})]}),"\n",(0,l.jsx)(n.p,{children:"\u7ec8\u7aef\u4e0a\u4f1a\u6709\u5982\u4e0b\u6253\u5370\uff0c\u8868\u660esubscriber\u5df2\u6210\u529f\u63a5\u6536\u5230publisher\u53d1\u9001\u7684\u6d88\u606f\uff1a"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-text",children:"[INFO] [1649227450.387089523] [minimal_hbmem_subscriber]: msg 10, time cost 1663us\n[INFO] [1649227450.427071280] [minimal_hbmem_subscriber]: msg 11, time cost 1713us\n[INFO] [1649227450.466993413] [minimal_hbmem_subscriber]: msg 12, time cost 1622us\n[INFO] [1649227450.507029960] [minimal_hbmem_subscriber]: msg 13, time cost 1666us\n[INFO] [1649227450.546146910] [minimal_hbmem_subscriber]: msg 14, time cost 998us\n[INFO] [1649227450.587002681] [minimal_hbmem_subscriber]: msg 15, time cost 1768us\n"})}),"\n",(0,l.jsxs)(n.p,{children:["\u4f7f\u7528",(0,l.jsx)(n.code,{children:"Ctrl+C"}),"\u53ef\u7ed3\u675f\u6bcf\u4e2aNode\u7684\u8fd0\u884c\u3002"]}),"\n",(0,l.jsx)(n.h2,{id:"\u672c\u8282\u603b\u7ed3",children:"\u672c\u8282\u603b\u7ed3"}),"\n",(0,l.jsxs)(c.A,{groupId:"tros-distro",children:[(0,l.jsxs)(a.A,{value:"foxy",label:"Foxy",children:[(0,l.jsx)(n.p,{children:"\u5982\u679c\u4f60\u5df2\u7ecf\u638c\u63e1ROS2\u7684publisher\u548csubscriber\u4f7f\u7528\u65b9\u5f0f\uff0c\u90a3\u4e48\u5f88\u5bb9\u6613\u5207\u6362\u5230\u4f7f\u7528\u57fa\u4e8ehbmem\u96f6\u62f7\u8d1d\u7684publisher\u548csubscriber\uff0c\u4f7f\u7528\u65f6\u53ea\u9700\u8981\u505a\u4ee5\u4e0b\u6539\u52a8\uff1a"}),(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"rclcpp::Publisher"})," \u6539\u4e3a ",(0,l.jsx)(n.strong,{children:"rclcpp::PublisherHbmem"})]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"create_publisher"})," \u6539\u4e3a ",(0,l.jsx)(n.strong,{children:"create_publisher_hbmem"})]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"rclcpp::Subscription"})," \u6539\u4e3a ",(0,l.jsx)(n.strong,{children:"rclcpp::SubscriptionHbmem"})]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"create_subscription"})," \u6539\u4e3a ",(0,l.jsx)(n.strong,{children:"create_subscription_hbmem"})]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"publisher"}),"\u53d1\u9001\u6d88\u606f\u524d\u8981\u5148\u8c03\u7528",(0,l.jsx)(n.strong,{children:"borrow_loaned_message"}),"\u83b7\u53d6\u6d88\u606f\uff0c\u7136\u540e",(0,l.jsx)(n.strong,{children:"\u786e\u8ba4\u6d88\u606f\u662f\u5426\u53ef\u7528"}),"\uff0c\u82e5\u53ef\u7528\uff0c\u518d\u8fdb\u884c\u8d4b\u503c\uff0c\u53d1\u9001"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"subscription"}),"\u5728\u56de\u8c03\u51fd\u6570\u4e2d\u5904\u7406\u63a5\u6536\u5230\u7684\u6d88\u606f\uff0c\u4e14",(0,l.jsx)(n.strong,{children:"\u63a5\u6536\u5230\u7684\u6d88\u606f\u53ea\u80fd\u5728\u56de\u8c03\u51fd\u6570\u4e2d\u4f7f\u7528"}),"\uff0c\u56de\u8c03\u51fd\u6570\u6267\u884c\u5b8c\uff0c\u8be5\u6d88\u606f\u5c31\u4f1a\u91ca\u653e"]}),"\n"]}),(0,l.jsx)(n.p,{children:"\u6ce8\u610f\uff1a"}),(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsx)(n.p,{children:"\u4f7f\u7528\u57fa\u4e8ehbmem\u7684\u96f6\u62f7\u8d1d\u4f1a\u5360\u7528ion\u5185\u5b58\uff0c\u82e5\u521b\u5efa\u591a\u4e2a\u8f83\u5927\u6d88\u606f\u7684publisher\uff0c\u53ef\u80fd\u51fa\u73b0ion\u5185\u5b58\u4e0d\u591f\u7528\uff0c\u5bfc\u81f4\u521b\u5efa\u5931\u8d25\u95ee\u9898\u3002"}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsx)(n.p,{children:"\u521b\u5efapublisher\u65f6\u4f1a\u4e00\u6b21\u6027\u7533\u8bf7KEEPLAST\u7684\u4e09\u500d\u4e2a\u6d88\u606f\u5927\u5c0f\u7684ion\u5185\u5b58\uff08\u6700\u5927\u4e3a256MB\uff09\uff0c\u7528\u4e8e\u6d88\u606f\u7684\u4f20\u8f93\uff0c\u4e4b\u540e\u4e0d\u4f1a\u518d\u52a8\u6001\u7533\u8bf7\u3002\u82e5subscriber\u7aef\u6d88\u606f\u5904\u7406\u51fa\u9519\u6216\u8005\u672a\u53ca\u65f6\u5904\u7406\uff0c\u5219\u4f1a\u51fa\u73b0\u6d88\u606fbuffer\u90fd\u88ab\u5360\u7528\uff0cpublisher\u4e00\u76f4\u83b7\u53d6\u4e0d\u5230\u53ef\u7528\u6d88\u606f\u7684\u60c5\u51b5\u3002"}),"\n"]}),"\n"]})]}),(0,l.jsxs)(a.A,{value:"humble",label:"Humble",children:[(0,l.jsx)(n.p,{children:"\u5982\u679c\u4f60\u5df2\u7ecf\u638c\u63e1ROS2\u7684publisher\u548csubscriber\u4f7f\u7528\u65b9\u5f0f\uff0c\u90a3\u4e48\u5f88\u5bb9\u6613\u5207\u6362\u5230\u4f7f\u7528\u96f6\u62f7\u8d1d\u7684publisher\u548csubscriber\uff0c\u4f7f\u7528\u65f6\u53ea\u9700\u8981\u505a\u4ee5\u4e0b\u6539\u52a8\uff1a"}),(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"publisher"}),"\u53d1\u9001\u6d88\u606f\u524d\u8981\u5148\u8c03\u7528",(0,l.jsx)(n.strong,{children:"borrow_loaned_message"}),"\u83b7\u53d6\u6d88\u606f\uff0c\u7136\u540e",(0,l.jsx)(n.strong,{children:"\u786e\u8ba4\u6d88\u606f\u662f\u5426\u53ef\u7528"}),"\uff0c\u82e5\u53ef\u7528\uff0c\u518d\u8fdb\u884c\u8d4b\u503c\uff0c\u53d1\u9001"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"subscription"}),"\u5728\u56de\u8c03\u51fd\u6570\u4e2d\u5904\u7406\u63a5\u6536\u5230\u7684\u6d88\u606f\uff0c\u4e14",(0,l.jsx)(n.strong,{children:"\u63a5\u6536\u5230\u7684\u6d88\u606f\u53ea\u80fd\u5728\u56de\u8c03\u51fd\u6570\u4e2d\u4f7f\u7528"}),"\uff0c\u56de\u8c03\u51fd\u6570\u6267\u884c\u5b8c\uff0c\u8be5\u6d88\u606f\u5c31\u4f1a\u91ca\u653e"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"\u8fd0\u884c"}),"\u7a0b\u5e8f\u524d\uff0c\u4f7f\u7528export\u547d\u4ee4\u5728\u8fd0\u884c\u7ec8\u7aef\u4e0b\u914d\u7f6e\u96f6\u62f7\u8d1d\u73af\u5883\u3002"]}),"\n"]})]})]}),"\n",(0,l.jsx)(n.h2,{id:"\u4f7f\u7528\u9650\u5236",children:"\u4f7f\u7528\u9650\u5236"}),"\n",(0,l.jsx)(n.p,{children:"\u548cROS2\u7684publisher/subscriber\u6570\u636e\u4f20\u8f93\u65b9\u5f0f\u76f8\u6bd4\uff0c\u4f7f\u7528\u96f6\u62f7\u8d1d\u4f20\u8f93\u5b58\u5728\u4ee5\u4e0b\u9650\u5236\uff1a"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"QOS History\u53ea\u652f\u6301KEEPLAST\uff0c\u4e0d\u652f\u6301KEEPALL\uff0c\u4e14KEEPLAST\u4e0d\u80fd\u8bbe\u7f6e\u592a\u5927\uff0c\u6709\u5185\u5b58\u9650\u5236\uff0c\u76ee\u524d\u8bbe\u7f6e\u4e3a\u6700\u5927\u5360\u7528256M\u5185\u5b58"}),"\n",(0,l.jsxs)(n.li,{children:["\u4f20\u8f93\u7684\u6d88\u606f\u5927\u5c0f\u662f\u56fa\u5b9a\u7684\uff0c\u5373\u6d88\u606f\u7684",(0,l.jsx)(n.code,{children:"sizeof"}),"\u503c\u662f\u4e0d\u53d8\u7684\uff0c\u4e0d\u80fd\u5305\u542b\u53ef\u53d8\u957f\u5ea6\u7c7b\u578b\u6570\u636e\uff0c\u4f8b\u5982\uff1astring\uff0c\u52a8\u6001\u6570\u7ec4"]}),"\n",(0,l.jsx)(n.li,{children:"\u5bf9\u4e8eTROS Humble\u7248\u672c\uff0c\u63a8\u8350QOS Reliability\u4f7f\u7528RMW_QOS_POLICY_RELIABILITY_BEST_EFFORT\uff08\u5efa\u8bae\u76f4\u63a5\u4f7f\u7528rclcpp::SensorDataQoS()\u8bbe\u7f6eQOS\uff09\uff0cRMW_QOS_POLICY_RELIABILITY_RELIABLE\u5728\u591a\u79cd\u901a\u4fe1\u65b9\u5f0f\u4e0b\u5b58\u5728\u7a33\u5b9a\u6027\u95ee\u9898\u3002"}),"\n",(0,l.jsx)(n.li,{children:"\u53ea\u80fd\u7528\u4e8e\u540c\u4e00\u8bbe\u5907\u8fdb\u7a0b\u95f4\u901a\u4fe1\uff0c\u4e0d\u53ef\u8de8\u8bbe\u5907\u4f20\u8f93"}),"\n",(0,l.jsx)(n.li,{children:"publisher\u6d88\u606f\u8981\u5148\u83b7\u53d6\u518d\u8d4b\u503c\u53d1\u9001\uff0c\u4e14\u8981\u5224\u65ad\u662f\u5426\u83b7\u53d6\u6210\u529f"}),"\n",(0,l.jsx)(n.li,{children:"subscriber\u6536\u5230\u7684\u6d88\u606f\u6709\u6548\u671f\u4ec5\u9650\u56de\u8c03\u51fd\u6570\u4e2d\uff0c\u4e0d\u80fd\u5728\u56de\u8c03\u51fd\u6570\u4e4b\u5916\u4f7f\u7528"}),"\n"]})]})}function m(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,l.jsx)(n,{...e,children:(0,l.jsx)(u,{...e})}):u(e)}},11470:(e,n,s)=>{s.d(n,{A:()=>S});var r=s(96540),l=s(34164),i=s(23104),c=s(56347),a=s(205),t=s(57485),o=s(31682),d=s(70679);function p(e){return r.Children.toArray(e).filter(e=>"\n"!==e).map(e=>{if(!e||(0,r.isValidElement)(e)&&function(e){const{props:n}=e;return!!n&&"object"==typeof n&&"value"in n}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)})?.filter(Boolean)??[]}function u(e){const{values:n,children:s}=e;return(0,r.useMemo)(()=>{const e=n??function(e){return p(e).map(({props:{value:e,label:n,attributes:s,default:r}})=>({value:e,label:n,attributes:s,default:r}))}(s);return function(e){const n=(0,o.XI)(e,(e,n)=>e.value===n.value);if(n.length>0)throw new Error(`Docusaurus error: Duplicate values "${n.map(e=>e.value).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e},[n,s])}function m({value:e,tabValues:n}){return n.some(n=>n.value===e)}function h({queryString:e=!1,groupId:n}){const s=(0,c.W6)(),l=function({queryString:e=!1,groupId:n}){if("string"==typeof e)return e;if(!1===e)return null;if(!0===e&&!n)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return n??null}({queryString:e,groupId:n});return[(0,t.aZ)(l),(0,r.useCallback)(e=>{if(!l)return;const n=new URLSearchParams(s.location.search);n.set(l,e),s.replace({...s.location,search:n.toString()})},[l,s])]}function b(e){const{defaultValue:n,queryString:s=!1,groupId:l}=e,i=u(e),[c,t]=(0,r.useState)(()=>function({defaultValue:e,tabValues:n}){if(0===n.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(e){if(!m({value:e,tabValues:n}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${e}" but none of its children has the corresponding value. Available values are: ${n.map(e=>e.value).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return e}const s=n.find(e=>e.default)??n[0];if(!s)throw new Error("Unexpected error: 0 tabValues");return s.value}({defaultValue:n,tabValues:i})),[o,p]=h({queryString:s,groupId:l}),[b,_]=function({groupId:e}){const n=function(e){return e?`docusaurus.tab.${e}`:null}(e),[s,l]=(0,d.Dv)(n);return[s,(0,r.useCallback)(e=>{n&&l.set(e)},[n,l])]}({groupId:l}),g=(()=>{const e=o??b;return m({value:e,tabValues:i})?e:null})();(0,a.A)(()=>{g&&t(g)},[g]);return{selectedValue:c,selectValue:(0,r.useCallback)(e=>{if(!m({value:e,tabValues:i}))throw new Error(`Can't select invalid tab value=${e}`);t(e),p(e),_(e)},[p,_,i]),tabValues:i}}var _=s(92303);const g={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};var x=s(74848);function j({className:e,block:n,selectedValue:s,selectValue:r,tabValues:c}){const a=[],{blockElementScrollPositionUntilNextRender:t}=(0,i.a_)(),o=e=>{const n=e.currentTarget,l=a.indexOf(n),i=c[l].value;i!==s&&(t(n),r(i))},d=e=>{let n=null;switch(e.key){case"Enter":o(e);break;case"ArrowRight":{const s=a.indexOf(e.currentTarget)+1;n=a[s]??a[0];break}case"ArrowLeft":{const s=a.indexOf(e.currentTarget)-1;n=a[s]??a[a.length-1];break}}n?.focus()};return(0,x.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,l.A)("tabs",{"tabs--block":n},e),children:c.map(({value:e,label:n,attributes:r})=>(0,x.jsx)("li",{role:"tab",tabIndex:s===e?0:-1,"aria-selected":s===e,ref:e=>{a.push(e)},onKeyDown:d,onClick:o,...r,className:(0,l.A)("tabs__item",g.tabItem,r?.className,{"tabs__item--active":s===e}),children:n??e},e))})}function f({lazy:e,children:n,selectedValue:s}){const i=(Array.isArray(n)?n:[n]).filter(Boolean);if(e){const e=i.find(e=>e.props.value===s);return e?(0,r.cloneElement)(e,{className:(0,l.A)("margin-top--md",e.props.className)}):null}return(0,x.jsx)("div",{className:"margin-top--md",children:i.map((e,n)=>(0,r.cloneElement)(e,{key:n,hidden:e.props.value!==s}))})}function v(e){const n=b(e);return(0,x.jsxs)("div",{className:(0,l.A)("tabs-container",g.tabList),children:[(0,x.jsx)(j,{...n,...e}),(0,x.jsx)(f,{...n,...e})]})}function S(e){const n=(0,_.A)();return(0,x.jsx)(v,{...e,children:p(e.children)},String(n))}},19365:(e,n,s)=>{s.d(n,{A:()=>c});s(96540);var r=s(34164);const l={tabItem:"tabItem_Ymn6"};var i=s(74848);function c({children:e,hidden:n,className:s}){return(0,i.jsx)("div",{role:"tabpanel",className:(0,r.A)(l.tabItem,s),hidden:n,children:e})}},28453:(e,n,s)=>{s.d(n,{R:()=>c,x:()=>a});var r=s(96540);const l={},i=r.createContext(l);function c(e){const n=r.useContext(i);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:c(e.components),r.createElement(i.Provider,{value:n},e.children)}}}]);