"use strict";(self.webpackChunkrdk_doc=self.webpackChunkrdk_doc||[]).push([[16477],{11470:(e,n,t)=>{t.d(n,{A:()=>w});var s=t(96540),r=t(34164),o=t(23104),a=t(56347),i=t(205),l=t(57485),c=t(31682),d=t(70679);function u(e){return s.Children.toArray(e).filter(e=>"\n"!==e).map(e=>{if(!e||(0,s.isValidElement)(e)&&function(e){const{props:n}=e;return!!n&&"object"==typeof n&&"value"in n}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)})?.filter(Boolean)??[]}function h(e){const{values:n,children:t}=e;return(0,s.useMemo)(()=>{const e=n??function(e){return u(e).map(({props:{value:e,label:n,attributes:t,default:s}})=>({value:e,label:n,attributes:t,default:s}))}(t);return function(e){const n=(0,c.XI)(e,(e,n)=>e.value===n.value);if(n.length>0)throw new Error(`Docusaurus error: Duplicate values "${n.map(e=>e.value).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e},[n,t])}function m({value:e,tabValues:n}){return n.some(n=>n.value===e)}function p({queryString:e=!1,groupId:n}){const t=(0,a.W6)(),r=function({queryString:e=!1,groupId:n}){if("string"==typeof e)return e;if(!1===e)return null;if(!0===e&&!n)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return n??null}({queryString:e,groupId:n});return[(0,l.aZ)(r),(0,s.useCallback)(e=>{if(!r)return;const n=new URLSearchParams(t.location.search);n.set(r,e),t.replace({...t.location,search:n.toString()})},[r,t])]}function b(e){const{defaultValue:n,queryString:t=!1,groupId:r}=e,o=h(e),[a,l]=(0,s.useState)(()=>function({defaultValue:e,tabValues:n}){if(0===n.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(e){if(!m({value:e,tabValues:n}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${e}" but none of its children has the corresponding value. Available values are: ${n.map(e=>e.value).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return e}const t=n.find(e=>e.default)??n[0];if(!t)throw new Error("Unexpected error: 0 tabValues");return t.value}({defaultValue:n,tabValues:o})),[c,u]=p({queryString:t,groupId:r}),[b,g]=function({groupId:e}){const n=function(e){return e?`docusaurus.tab.${e}`:null}(e),[t,r]=(0,d.Dv)(n);return[t,(0,s.useCallback)(e=>{n&&r.set(e)},[n,r])]}({groupId:r}),f=(()=>{const e=c??b;return m({value:e,tabValues:o})?e:null})();(0,i.A)(()=>{f&&l(f)},[f]);return{selectedValue:a,selectValue:(0,s.useCallback)(e=>{if(!m({value:e,tabValues:o}))throw new Error(`Can't select invalid tab value=${e}`);l(e),u(e),g(e)},[u,g,o]),tabValues:o}}var g=t(92303);const f={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};var v=t(74848);function x({className:e,block:n,selectedValue:t,selectValue:s,tabValues:a}){const i=[],{blockElementScrollPositionUntilNextRender:l}=(0,o.a_)(),c=e=>{const n=e.currentTarget,r=i.indexOf(n),o=a[r].value;o!==t&&(l(n),s(o))},d=e=>{let n=null;switch(e.key){case"Enter":c(e);break;case"ArrowRight":{const t=i.indexOf(e.currentTarget)+1;n=i[t]??i[0];break}case"ArrowLeft":{const t=i.indexOf(e.currentTarget)-1;n=i[t]??i[i.length-1];break}}n?.focus()};return(0,v.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,r.A)("tabs",{"tabs--block":n},e),children:a.map(({value:e,label:n,attributes:s})=>(0,v.jsx)("li",{role:"tab",tabIndex:t===e?0:-1,"aria-selected":t===e,ref:e=>{i.push(e)},onKeyDown:d,onClick:c,...s,className:(0,r.A)("tabs__item",f.tabItem,s?.className,{"tabs__item--active":t===e}),children:n??e},e))})}function j({lazy:e,children:n,selectedValue:t}){const o=(Array.isArray(n)?n:[n]).filter(Boolean);if(e){const e=o.find(e=>e.props.value===t);return e?(0,s.cloneElement)(e,{className:(0,r.A)("margin-top--md",e.props.className)}):null}return(0,v.jsx)("div",{className:"margin-top--md",children:o.map((e,n)=>(0,s.cloneElement)(e,{key:n,hidden:e.props.value!==t}))})}function _(e){const n=b(e);return(0,v.jsxs)("div",{className:(0,r.A)("tabs-container",f.tabList),children:[(0,v.jsx)(x,{...n,...e}),(0,v.jsx)(j,{...n,...e})]})}function w(e){const n=(0,g.A)();return(0,v.jsx)(_,{...e,children:u(e.children)},String(n))}},19365:(e,n,t)=>{t.d(n,{A:()=>a});t(96540);var s=t(34164);const r={tabItem:"tabItem_Ymn6"};var o=t(74848);function a({children:e,hidden:n,className:t}){return(0,o.jsx)("div",{role:"tabpanel",className:(0,s.A)(r.tabItem,t),hidden:n,children:e})}},28453:(e,n,t)=>{t.d(n,{R:()=>a,x:()=>i});var s=t(96540);const r={},o=s.createContext(r);function a(e){const n=s.useContext(o);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function i(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:a(e.components),s.createElement(o.Provider,{value:n},e.children)}},35884:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>d,contentTitle:()=>c,default:()=>m,frontMatter:()=>l,metadata:()=>s,toc:()=>u});const s=JSON.parse('{"id":"Robot_development/boxs/audio/sensevoice_ros2","title":"Sensevoice","description":"Introduction","source":"@site/i18n/en/docusaurus-plugin-content-docs/current/05_Robot_development/03_boxs/audio/sensevoice_ros2.md","sourceDirName":"05_Robot_development/03_boxs/audio","slug":"/Robot_development/boxs/audio/sensevoice_ros2","permalink":"/rdk_doc/en/Robot_development/boxs/audio/sensevoice_ros2","draft":false,"unlisted":false,"tags":[],"version":"current","lastUpdatedAt":1757049643000,"sidebarPosition":2,"frontMatter":{"sidebar_position":2},"sidebar":"tutorialSidebar","previous":{"title":"Intelligent Voice","permalink":"/rdk_doc/en/Robot_development/boxs/audio/hobot_audio"},"next":{"title":"Bloom Large Language Model","permalink":"/rdk_doc/en/Robot_development/boxs/generate/hobot_llm"}}');var r=t(74848),o=t(28453),a=t(11470),i=t(19365);const l={sidebar_position:2},c="Sensevoice",d={},u=[{value:"Introduction",id:"introduction",level:2},{value:"Supported Platforms",id:"supported-platforms",level:2},{value:"Preparation",id:"preparation",level:2},{value:"Usage",id:"usage",level:2},{value:"Result Analysis",id:"result-analysis",level:2}];function h(e){const n={a:"a",code:"code",em:"em",h1:"h1",h2:"h2",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,o.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"sensevoice",children:"Sensevoice"})}),"\n","\n",(0,r.jsx)(n.h2,{id:"introduction",children:"Introduction"}),"\n",(0,r.jsxs)(n.p,{children:["The D-Robotics intelligent voice algorithm adopts SenseVoiceGGUF, subscribes to audio data and sends it to SenseVoiceGGUF for processing, and then publishes messages such as ",(0,r.jsx)(n.strong,{children:"command word recognition"}),", and ",(0,r.jsx)(n.strong,{children:"ASR\uff08Automatic Speech Recognition\uff09"}),". The implementation of intelligent voice function corresponds to the ",(0,r.jsx)(n.strong,{children:"sensevoice_ros2"})," package of TogetheROS.Bot, which is suitable for 3.5mm micphone and USB speaker supported by RDK."]}),"\n",(0,r.jsxs)(n.p,{children:["Code repository:  (",(0,r.jsx)(n.a,{href:"https://github.com/D-Robotics/sensevoice_ros2.git",children:"https://github.com/D-Robotics/sensevoice_ros2.git"}),")"]}),"\n",(0,r.jsx)(n.p,{children:"Application scenarios: The intelligent voice algorithm can recognize custom command words in audio, interpret speech content as corresponding instructions or convert it into text, and can achieve functions such as voice control and speech translation. It is mainly used in areas such as smart home, intelligent cockpit, and smart wearables."}),"\n",(0,r.jsxs)(n.p,{children:["Example of voice-controlled car movement: ",(0,r.jsx)(n.a,{href:"../../apps/car_audio_control",children:"Voice-controlled car movement"})]}),"\n",(0,r.jsx)(n.h2,{id:"supported-platforms",children:"Supported Platforms"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Platform"}),(0,r.jsx)(n.th,{children:"System"}),(0,r.jsx)(n.th,{children:"Function"})]})}),(0,r.jsx)(n.tbody,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"RDK X5\uff0cRDK X5 module"}),(0,r.jsx)(n.td,{children:"Ubuntu 22.04 (Humble)"}),(0,r.jsx)(n.td,{children:"Start the audio module algorithm and display the results in the terminal"})]})})]}),"\n",(0,r.jsx)(n.h2,{id:"preparation",children:"Preparation"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"The RDK has been burned with the  Ubuntu 20.04/22.04 system image provided by D-Robotics."}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"The TogetheROS.Bot has been successfully installed on the RDK."}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"The intelligent voice 2 algorithm package has been successfully installed on the RDK, installation command:"}),"\n",(0,r.jsx)(a.A,{groupId:"tros-distro",children:(0,r.jsx)(i.A,{value:"humble",label:"Humble",children:(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"sudo apt update\nsudo apt install tros-humble-sensevoice-ros2\n"})})})}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"The audio board is correctly connected to the 3.5mm headphone jack of RDK X5."}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"Connect the USB speaker correctly to the USB port of RDK X5."}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"usage",children:"Usage"}),"\n",(0,r.jsxs)(n.p,{children:["After the smart voice sensevoice_ros2 package starts running, it will capture audio from the microphone array and send the captured audio data to the smart voice algorithm SDK module for intelligent processing. It will output command words, ASR results, and other smart information. command words are published as ",(0,r.jsx)(n.code,{children:"audio_msg::msg::SmartAudioData"})," type messages, while ASR results are published as ",(0,r.jsx)(n.code,{children:"std_msgs::msg::String"})," type messages."]}),"\n",(0,r.jsxs)(n.p,{children:["The smart voice function supports ASR recognition after denoising the raw audio. The default command words are defined in the ",(0,r.jsx)(n.em,{children:"config/cmd_word.json"})," file under the root directory of the smart voice function module, which are set in chinese as:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n    "cmd_word": [\n        "\u5411\u524d\u8d70",\n        "\u5411\u540e\u9000",\n        "\u5411\u5de6\u8f6c",\n        "\u5411\u53f3\u8f6c",\n        "\u505c\u6b62\u8fd0\u52a8"\n    ]\n}\n'})}),"\n",(0,r.jsx)(n.p,{children:"The command words can be configured according to your needs. It is recommended to use Chinese command words, preferably phrases that are easy to pronounce, with a length of 3 to 5 characters."}),"\n",(0,r.jsx)(n.p,{children:"To run the sensevoice_ros2 package on the RDK:"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:"Configure the tros.b environment and launch the application"}),"\n"]}),"\n",(0,r.jsx)(a.A,{groupId:"tros-distro",children:(0,r.jsx)(i.A,{value:"humble",label:"Humble",children:(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-shell",children:'# Configure the tros.b environment\nsource /opt/tros/humble/setup.bash\n\n# Start the launch file\nros2 launch sensevoice_ros2 sensevoice_ros2.launch.py micphone_name:="plughw:0,0"\n'})})})}),"\n",(0,r.jsx)(n.h2,{id:"result-analysis",children:"Result Analysis"}),"\n",(0,r.jsx)(n.p,{children:"The following information is outputted on the terminal:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-text",children:"alsa_device_init, snd_pcm_open. handle((nil)), name(plughw:0,0), direct(1), mode(0)\nsnd_pcm_open succeed. name(plughw:0,0), handle(0xaaaad1248290)\nRate set to 16000Hz (requested 16000Hz)\nBuffer size range from 32 to 131072\nPeriod size range from 16 to 1024\nRequested period size 512 frames\nPeriods = 4\nwas set period_size = 512\nwas set buffer_size = 2048\nalsa_device_init. hwparams(0xaaaad12484a0), swparams(0xaaaad124a7a0)\n"})}),"\n",(0,r.jsx)(n.p,{children:"The above log shows that the audio device initialization is successful, and the audio device is opened for audio collection."}),"\n",(0,r.jsx)(n.p,{children:'When a person speaks the Chinese command words ""\u5411\u524d\u8d70", "\u5411\u5de6\u8f6c", "\u5411\u53f3\u8f6c", "\u5411\u540e\u9000" one by one next to the microphone, the speech algorithm SDK outputs the recognition results after intelligent processing, and the log shows the following:'}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-text",children:"cost time :769 ms\n[WARN] [1745810610.317172494] [sensevoice_ros2]: recv cmd word:\u5411\u524d\u8d70\nresult_str:\u5411\u524d\u8d70,\n[WARN] [1745810610.479493615] [sensevoice_ros2]: asr msg:\u5411\u524d\u8d70,\nresult_str:\u5411\u524d\u8d70,\ncost time :785 ms\n[WARN] [1745810614.078700989] [sensevoice_ros2]: recv cmd word:\u5411\u5de6\u8f6c\nresult_str:\u5411\u5de6\u8f6c,\n[WARN] [1745810614.187793932] [sensevoice_ros2]: asr msg:\u5411\u5de6\u8f6c,\nresult_str:\u5411\u5de6\u8f6c,\ncost time :761 ms\n[WARN] [1745810616.453310236] [sensevoice_ros2]: recv cmd word:\u5411\u53f3\u8f6c\nresult_str:\u5411\u53f3\u8f6c,\n[WARN] [1745810616.587498515] [sensevoice_ros2]: asr msg:\u5411\u53f3\u8f6c,\nresult_str:\u5411\u53f3\u8f6c,\ncost time :737 ms\n[WARN] [1745810618.700084757] [sensevoice_ros2]: recv cmd word:\u5411\u540e\u9000\nresult_str:\u5411\u540e\u9000,\n[WARN] [1745810618.857481535] [sensevoice_ros2]: asr msg:\u5411\u540e\u9000,\nresult_str:\u5411\u540e\u9000,\n\n"})}),"\n",(0,r.jsxs)(n.p,{children:["The default topic name for the smart audio messages published by hobot_audio is: ",(0,r.jsx)(n.strong,{children:"/audio_smart"})," and ",(0,r.jsx)(n.strong,{children:"/audio_asr"}),", and the ",(0,r.jsx)(n.code,{children:"ros2 topic list"})," result is:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-shell",children:"$ ros2 topic list\n/audio_smart\n/audio_asr\n"})})]})}function m(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(h,{...e})}):h(e)}}}]);