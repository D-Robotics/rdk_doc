<!doctype html>
<html lang="zh-Hans" dir="ltr" class="docs-wrapper plugin-docs plugin-id-docs_s docs-version-current docs-doc-page docs-doc-id-Advanced_development/linux_development/driver_development_s100/driver_ipc" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.8.1">
<title data-rh="true">IPC模块介绍 | RDK DOC</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://developer.d-robotics.cc/rdk_doc/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://developer.d-robotics.cc/rdk_doc/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://developer.d-robotics.cc/rdk_doc/rdk_s/Advanced_development/linux_development/driver_development_s100/driver_ipc"><meta data-rh="true" property="og:locale" content="zh_Hans"><meta data-rh="true" property="og:locale:alternate" content="en"><meta data-rh="true" name="docusaurus_locale" content="zh-Hans"><meta data-rh="true" name="docsearch:language" content="zh-Hans"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-docs_s-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-docs_s-current"><meta data-rh="true" property="og:title" content="IPC模块介绍 | RDK DOC"><meta data-rh="true" name="description" content="IPC（Inter-Processor Communication）模块是用于多核之间的通信，支持同构核和异构核之间的通信，软件上基于buffer-ring进行共享内存的管理，硬件上基于MailBox实现核间中断。IPCF具有多路通道，大数据传输，适用多种平台的特点。RPMSG基于开源协议框架，支持Acore与VDSP的核间通信。"><meta data-rh="true" property="og:description" content="IPC（Inter-Processor Communication）模块是用于多核之间的通信，支持同构核和异构核之间的通信，软件上基于buffer-ring进行共享内存的管理，硬件上基于MailBox实现核间中断。IPCF具有多路通道，大数据传输，适用多种平台的特点。RPMSG基于开源协议框架，支持Acore与VDSP的核间通信。"><link data-rh="true" rel="icon" href="/rdk_doc/img/logo.png"><link data-rh="true" rel="canonical" href="https://developer.d-robotics.cc/rdk_doc/rdk_s/Advanced_development/linux_development/driver_development_s100/driver_ipc"><link data-rh="true" rel="alternate" href="https://developer.d-robotics.cc/rdk_doc/rdk_s/Advanced_development/linux_development/driver_development_s100/driver_ipc" hreflang="zh-Hans"><link data-rh="true" rel="alternate" href="https://developer.d-robotics.cc/rdk_doc/en/rdk_s/Advanced_development/linux_development/driver_development_s100/driver_ipc" hreflang="en"><link data-rh="true" rel="alternate" href="https://developer.d-robotics.cc/rdk_doc/rdk_s/Advanced_development/linux_development/driver_development_s100/driver_ipc" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"7. 进阶开发","item":"https://developer.d-robotics.cc/rdk_doc/rdk_s/Advanced_development"},{"@type":"ListItem","position":2,"name":"7.2. Linux开发指南","item":"https://developer.d-robotics.cc/rdk_doc/rdk_s/linux_development"},{"@type":"ListItem","position":3,"name":"7.2.4 RDK S100驱动开发指南","item":"https://developer.d-robotics.cc/rdk_doc/rdk_s/driver_development_s100"},{"@type":"ListItem","position":4,"name":"IPC模块介绍","item":"https://developer.d-robotics.cc/rdk_doc/rdk_s/Advanced_development/linux_development/driver_development_s100/driver_ipc"}]}</script><script src="https://hm.baidu.com/hm.js?24dd63cad43b63889ea6bede5fd1ab9e" async></script><link rel="stylesheet" href="/rdk_doc/assets/css/styles.0fbd7d27.css">
<script src="/rdk_doc/assets/js/runtime~main.c7ade84c.js" defer="defer"></script>
<script src="/rdk_doc/assets/js/main.d9d5ddc9.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t="light";var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",e||t),document.documentElement.setAttribute("data-theme-choice",e||t)}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="跳到主要内容"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">跳到主要内容</a></div><nav aria-label="主导航" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="切换导航栏" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a href="https://d-robotics.cc/" target="_blank" rel="noopener noreferrer" class="navbar__brand"><div class="navbar__logo"><img src="/rdk_doc/img/logo.png" alt="地瓜机器人社区 logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/rdk_doc/img/logo.png" alt="地瓜机器人社区 logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">D-Robotics</b></a><a class="navbar__item navbar__link" href="/rdk_doc/RDK">RDK X3 / X5</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/rdk_doc/rdk_s/RDK">RDK S100</a><a href="https://developer.d-robotics.cc/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Community<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a href="https://github.com/D-Robotics" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link"><svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" class="iconLanguage_nlXk"><path fill="currentColor" d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></svg>CN</a><ul class="dropdown__menu"><li><a href="/rdk_doc/rdk_s/Advanced_development/linux_development/driver_development_s100/driver_ipc" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" lang="zh-Hans">CN</a></li><li><a href="/rdk_doc/en/rdk_s/Advanced_development/linux_development/driver_development_s100/driver_ipc" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="en">EN</a></li></ul></div><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="切换浅色/暗黑模式（当前为system mode）"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><div class="navbar__search searchBarContainer_NW3z" dir="ltr"><input placeholder="搜索" aria-label="Search" class="navbar__search-input searchInput_YFbd" value=""><div class="loadingRing_RJI3 searchBarLoadingRing_YnHq"><div></div><div></div><div></div><div></div></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper"><div class="docsWrapper_hBAB"><button aria-label="回到顶部" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="文档侧边栏" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/rdk_doc/rdk_s/RDK">D-Robotics RDK 套件</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/rdk_doc/rdk_s/Quick_start">1. 快速开始</a><button aria-label="展开侧边栏分类 &#x27;1. 快速开始&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/rdk_doc/rdk_s/System_configuration">2. 系统配置</a><button aria-label="展开侧边栏分类 &#x27;2. 系统配置&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/rdk_doc/rdk_s/Basic_Application">3. 基础应用开发</a><button aria-label="展开侧边栏分类 &#x27;3. 基础应用开发&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/rdk_doc/rdk_s/Basic_Development">4. 算法应用开发</a><button aria-label="展开侧边栏分类 &#x27;4. 算法应用开发&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/rdk_doc/rdk_s/Robot_development">5. 机器人应用开发</a><button aria-label="展开侧边栏分类 &#x27;5. 机器人应用开发&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/rdk_doc/rdk_s/Application_case">6. 应用开发指南</a><button aria-label="展开侧边栏分类 &#x27;6. 应用开发指南&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" href="/rdk_doc/rdk_s/Advanced_development">7. 进阶开发</a><button aria-label="折叠侧边栏分类 &#x27;7. 进阶开发&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/rdk_doc/rdk_s/hardware_development">7.1 硬件开发指南</a><button aria-label="展开侧边栏分类 &#x27;7.1 硬件开发指南&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" tabindex="0" href="/rdk_doc/rdk_s/linux_development">7.2. Linux开发指南</a><button aria-label="折叠侧边栏分类 &#x27;7.2. Linux开发指南&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/rdk_doc/rdk_s/Advanced_development/linux_development/environment_build">7.2.1 开发环境搭建及编译说明</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/rdk_doc/rdk_s/Advanced_development/linux_development/kernel_headers">7.2.2 内核头文件</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/rdk_doc/rdk_s/Advanced_development/linux_development/realtime_kernel">7.2.3 应用实时内核</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" tabindex="0" href="/rdk_doc/rdk_s/driver_development_s100">7.2.4 RDK S100驱动开发指南</a><button aria-label="折叠侧边栏分类 &#x27;7.2.4 RDK S100驱动开发指南&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/rdk_doc/rdk_s/Advanced_development/linux_development/driver_development_s100/uboot_kernel_config">配置U-Boot和Kernel选项参数</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/rdk_doc/rdk_s/Advanced_development/linux_development/driver_development_s100/driver_uart_dev">UART驱动调试指南</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/rdk_doc/rdk_s/Advanced_development/linux_development/driver_development_s100/driver_i2c_dev">I2C调试指南</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/rdk_doc/rdk_s/Advanced_development/linux_development/driver_development_s100/driver_gpio_dev">GPIO使用</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/rdk_doc/rdk_s/Advanced_development/linux_development/driver_development_s100/driver_pinctrl_dev">Pinctrl调试指南</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/rdk_doc/rdk_s/Advanced_development/linux_development/driver_development_s100/driver_ipc">IPC模块介绍</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/rdk_doc/rdk_s/Advanced_development/linux_development/driver_development_s100/driver_spi_dev">SPI调试指南</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/rdk_doc/rdk_s/Advanced_development/linux_development/driver_development_s100/driver_pwm">PWM 驱动调试指南</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/rdk_doc/rdk_s/Advanced_development/linux_development/driver_development_s100/driver_thermal_dev">Thermal 系统</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/rdk_doc/rdk_s/Advanced_development/linux_development/driver_development_s100/driver_lowpower">低功耗模式调试指南</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/rdk_doc/rdk_s/Advanced_development/linux_development/driver_development_s100/driver_audio">音频调试指南</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/rdk_doc/rdk_s/Advanced_development/linux_development/driver_development_s100/driver_timesync">时间同步 方案</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/rdk_doc/rdk_s/13_driver_pcie">PCIe使用指南</a><button aria-label="展开侧边栏分类 &#x27;PCIe使用指南&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/rdk_doc/rdk_s/Advanced_development/linux_development/driver_development_s100/driver_wifi">WiFi驱动调试指南</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/rdk_doc/rdk_s/15_driver_hbmem">HBMEM使用指南</a><button aria-label="展开侧边栏分类 &#x27;HBMEM使用指南&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/rdk_doc/rdk_s/hardware_unit_test">7.2.5 硬件单元测试</a><button aria-label="展开侧边栏分类 &#x27;7.2.5 硬件单元测试&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/rdk_doc/rdk_s/Advanced_development/linux_development/OTA">7.2.6 OTA</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/rdk_doc/rdk_s/Advanced_development/linux_development/kernel_debug">7.2.7 Linux调试功能介绍</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/rdk_doc/rdk_s/03_multimedia_development">7.3 多媒体开发指南</a><button aria-label="展开侧边栏分类 &#x27;7.3 多媒体开发指南&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/rdk_doc/rdk_s/04_toolchain_development">7.4 算法工具链开发指南</a><button aria-label="展开侧边栏分类 &#x27;7.4 算法工具链开发指南&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/rdk_doc/rdk_s/05_MCU_development">7.5 MCU开发指南</a><button aria-label="展开侧边栏分类 &#x27;7.5 MCU开发指南&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/rdk_doc/rdk_s/Advanced_development/rdk_gen">7.6 RDK S100构建系统开发指南</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/rdk_doc/rdk_s/FAQ">8. 常见问题</a><button aria-label="展开侧边栏分类 &#x27;8. 常见问题&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/rdk_doc/rdk_s/Appendix">9. 附录</a><button aria-label="展开侧边栏分类 &#x27;9. 附录&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/rdk_doc/rdk_s/Release_Note/roadmap">10. 版本发布</a></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="页面路径"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="主页面" class="breadcrumbs__link" href="/rdk_doc/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/rdk_doc/rdk_s/Advanced_development"><span>7. 进阶开发</span></a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/rdk_doc/rdk_s/linux_development"><span>7.2. Linux开发指南</span></a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/rdk_doc/rdk_s/driver_development_s100"><span>7.2.4 RDK S100驱动开发指南</span></a></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">IPC模块介绍</span></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">本页总览</button></div><div class="theme-doc-markdown markdown"><header><h1>IPC模块介绍</h1></header>
<p>IPC（Inter-Processor Communication）模块是用于多核之间的通信，支持同构核和异构核之间的通信，软件上基于buffer-ring进行共享内存的管理，硬件上基于MailBox实现核间中断。IPCF具有多路通道，大数据传输，适用多种平台的特点。RPMSG基于开源协议框架，支持Acore与VDSP的核间通信。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="ipcf软硬件组件框图">IPCF软硬件组件框图<a href="#ipcf软硬件组件框图" class="hash-link" aria-label="IPCF软硬件组件框图的直接链接" title="IPCF软硬件组件框图的直接链接">​</a></h2>
<p>Acore与MCU之间的核间通信，Acore侧主要使用IPCFHAL，MCU侧使用IPCF，其中IPCFHAL是基于IPCF封装了一层接口，用于用户态与内核态的数据传递。</p>
<p><img decoding="async" loading="lazy" src="https://rdk-doc.oss-cn-beijing.aliyuncs.com/doc/img/07_Advanced_development/02_linux_development/driver_development_s100/linux-ipc.jpg" alt="IPCF软硬件组件框图" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="ipc典型使用场景">IPC典型使用场景<a href="#ipc典型使用场景" class="hash-link" aria-label="IPC典型使用场景的直接链接" title="IPC典型使用场景的直接链接">​</a></h2>
<p><img decoding="async" loading="lazy" src="https://rdk-doc.oss-cn-beijing.aliyuncs.com/doc/img/07_Advanced_development/02_linux_development/driver_development_s100/imageipcscen.png" alt="IPC典型使用场景图" class="img_ev3q"></p>
<p>IPC典型应用场景有OTA模块、诊断模块、规控、CANHAL等。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="ipc实例分配方案">IPC实例分配方案<a href="#ipc实例分配方案" class="hash-link" aria-label="IPC实例分配方案的直接链接" title="IPC实例分配方案的直接链接">​</a></h2>
<p>IPC Acore侧实例编号范围为[0-34]，分别用于Acore与MCU通信的实例[0-14]、Acore与VDSP通信的实例[22-24]、Acore与BPU通信的实例[32-34]，其余实例做其它私有用途。Acore与MCU通信可使用实例[0-8]，实例[4-6]默认为客户预留，若用户不需要CANHAL、规控等业务，可以自行修改配置文件。S100中AOCRE与MCU的IPC通信情况可以查阅 <a href="/rdk_doc/rdk_s/Advanced_development/mcu_development/S100/mcu_ipc">MCU IPC使用指南</a> 中的IPC 使用情况章节。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="acore侧配置实例方法">Acore侧配置实例方法<a href="#acore侧配置实例方法" class="hash-link" aria-label="Acore侧配置实例方法的直接链接" title="Acore侧配置实例方法的直接链接">​</a></h3>
<p>Acore侧配置实例可通过设备树文件配置，配置路径为：</p>
<div class="language-dts codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-dts codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">source/hobot-drivers/kernel-dts/drobot-s100-ipc.dtsi</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">source/hobot-drivers/kernel-dts/include/drobot_s100_ipc.h</span><br></span></code></pre></div></div>
<p>设备树配置信息如下（仅供参考）：</p>
<div class="language-dts codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-dts codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ipcfhal_cfg: ipcfhal_cfg {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    status = &quot;okay&quot;; #节点状态，不需要改动</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    compatible = &quot;hobot,hobot-ipcfhal&quot;;  #节点属性，不可改动</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /****************instance--num_chans--num_bufs--buf_size****************/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ipc-ins = &lt;&amp;ipc_instance0	8	8	0x2000&gt;, #(Acore&amp;MCU)用于CANHAL</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &lt;&amp;ipc_instance1	8	8	0x1000&gt;, #(Acore&amp;MCU)用于规控</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &lt;&amp;ipc_instance2	2	8	0x800&gt;, #(Acore&amp;MCU)用于规控</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &lt;&amp;ipc_instance3	8	8	0x1000&gt;, #(Acore&amp;MCU)用于crypto</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &lt;&amp;ipc_instance4	8	8	0x1000&gt;, #(Acore&amp;MCU)空闲，用户可自行配置</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &lt;&amp;ipc_instance5	8	8	0x1000&gt;, #(Acore&amp;MCU)空闲，用户可自行配置</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &lt;&amp;ipc_instance6	8	8	0x1000&gt;, #(Acore&amp;MCU)空闲，用户可自行配置</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &lt;&amp;ipc_instance7	8	8	0x1000&gt;, #(Acore&amp;MCU)透传uart，spi，i2c等外设和运行mcu侧cmd应用</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &lt;&amp;ipc_instance8	8	8	0x1000&gt;, #(Acore&amp;MCU)部分空闲，用户可自行配置</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &lt;&amp;ipc_instance9	2	5	0x400&gt;,  #(Acore&amp;MCU)私有实例，内部预留</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &lt;&amp;ipc_instance10	1	5	0x200&gt;, #(Acore&amp;MCU)私有实例，内部预留</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &lt;&amp;ipc_instance22	8	8	0x1000&gt;, #(Acore&amp;VDSP)VDSP预留，暂未对客户开放</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &lt;&amp;ipc_instance23	8	8	0x1000&gt;, #(Acore&amp;VDSP)VDSP预留，暂未对客户开放</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &lt;&amp;ipc_instance24	8	8	0x1000&gt;; #(Acore&amp;VDSP)VDSP预留，暂未对客户开放</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">};</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="设备树配置说明">设备树配置说明<a href="#设备树配置说明" class="hash-link" aria-label="设备树配置说明的直接链接" title="设备树配置说明的直接链接">​</a></h3>
<p>设备树ipcfhal_cfg节点默认配置了一些实例的属性：</p>
<ul>
<li>属性中第一列表示实例编号，必须唯一且在有效范围</li>
<li>属性的第二列表示该实例分配的通道数量，用户可以自行配置，最大值为32个</li>
<li>属性的第三列表示每个通道的缓冲buf的个数，用户可以自行配置，最大值为1024个，但受控制空间大小的限制。属性第四列表示缓冲buf的大小，单位是Bytes，用户可以自行配置，通道个数*缓冲buf个数*buf大小需要小于等于0.5MB（目前每个实例预分配了1MB的数据空间，暂不扩增）。</li>
</ul>
<p>单个实例的设备树节点如下：</p>
<div class="language-dts codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-dts codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">#Not used, User can apply for it</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ipc_instance3: ipc_instance3 {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        status = &quot;okay&quot;; #节点状态，不需要改动</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        compatible = &quot;hobot,hobot-ipc&quot;; #节点属性，不可改动</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        mbox-names = &quot;mbox-chan&quot;; #mailbox名字属性，不可改动</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        mboxes = &lt;&amp;mailbox0 3 19 3&gt;; #mailbox通信方向，实例5和实例6需要改动，其它实例不需要改动</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        instance = &lt;3&gt;; #实例id，不需要改动</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        data_local_addr = /bits/ 64 &lt;IPC_INS3_DATA_LOCAL&gt;; #Acore数据段，实例5和实例6需要改动，其  它实例不需要改动</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        data_remote_addr = /bits/ 64 &lt;IPC_INS3_DATA_REMOTE&gt;; #MCU数据段，实例5和实例6需要改动，其它实例不需要改动</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        data_size = &lt;IPC_SINGLE_DATA_SIZE&gt;; #数据段大小，不可改动，单位Bytes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ctrl_local_addr = /bits/ 64 &lt;IPC_INS3_CTRL_LOCAL&gt;; #Acore控制段，实例5和实例6需要改动，其它实例不需要改动</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ctrl_remote_addr = /bits/ 64 &lt;IPC_INS3_CTRL_REMOTE&gt;; #MCU控制段，实例5和实例6需要改动，其它实例不需要改动</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ctrl_size = &lt;IPC_SINGLE_CTRL_SIZE&gt;; #数据段大小，不可改动，单位Bytes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">};</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre></div></div>
<p>由于实例5和实例6内部用于测试，外部客户若需要使用，需要自行配置，配置信息如下，不需要改动。</p>
<div class="language-dts codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-dts codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ipc_instance5: ipc_instance5 {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        status = &quot;okay&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        compatible = &quot;hobot,hobot-ipc&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        mbox-names = &quot;mbox-chan&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        mboxes = &lt;&amp;mailbox0 5 21 5&gt;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        instance = &lt;5&gt;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        data_local_addr = /bits/ 64 &lt;IPC_INS5_DATA_LOCAL&gt;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        data_remote_addr = /bits/ 64 &lt;IPC_INS5_DATA_REMOTE&gt;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        data_size = &lt;IPC_SINGLE_DATA_SIZE&gt;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ctrl_local_addr = /bits/ 64 &lt;IPC_INS5_CTRL_LOCAL&gt;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ctrl_remote_addr = /bits/ 64 &lt;IPC_INS5_CTRL_REMOTE&gt;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ctrl_size = &lt;IPC_SINGLE_CTRL_SIZE&gt;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">};</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ipc_instance6: ipc_instance6 {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        status = &quot;okay&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        compatible = &quot;hobot,hobot-ipc&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        mbox-names = &quot;mbox-chan&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        mboxes = &lt;&amp;mailbox0 6 22 6&gt;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        instance = &lt;6&gt;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        data_local_addr = /bits/ 64 &lt;IPC_INS6_DATA_LOCAL&gt;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        data_remote_addr = /bits/ 64 &lt;IPC_INS6_DATA_REMOTE&gt;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        data_size = &lt;IPC_SINGLE_DATA_SIZE&gt;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ctrl_local_addr = /bits/ 64 &lt;IPC_INS6_CTRL_LOCAL&gt;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ctrl_remote_addr = /bits/ 64 &lt;IPC_INS6_CTRL_REMOTE&gt;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ctrl_size = &lt;IPC_SINGLE_CTRL_SIZE&gt;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">};</span><br></span></code></pre></div></div>
<p><strong>设备树配置注意事项:</strong></p>
<ul>
<li>实例3~8数据段默认预分配了1MB空间，Acore侧使用0.5MB，MCU侧使用0.5MB，所以通道个数*缓冲buf个数*buf大小需要小于等于0.5MB。</li>
<li>实例3~8控制段默认预分配了5KB空间，Acore侧使用2.5KB，MCU侧使用2.5KB，存放环形buf的控制信息和状态信息，所以(缓冲buf个数+2)*16*通道个数+8需要小于等于2.5KB。</li>
<li>实例5~6用于地瓜机器人内部测试，用户可按照上面配置，修改设备树节点即可。 // TODO:可以完全放开给到客户</li>
<li>每个实例的通道数量需要小于等于32，缓冲buf个数需要小于等于1024，同时需要满足前两点的不等式。</li>
<li>多个业务使用同一个实例的不同通道或者使用不同实例对传输影响不大，主要是参考buf_size/buf_num是否合适以及业务的开发和维护是否方便。</li>
<li>底层Mailbox中断分配不支持修改。</li>
<li>Acore与MCU的通道个数、缓冲buf个数和大小需要保持一致，数据段和控制段的local和remote需要相反。</li>
<li>实例的控制段首地址存储实例是否初始化的状态，可用于判断实例是否初始化，其中Acore默认启动kernel时完成初始化。</li>
<li>若用户需要自行分配数据段和地址段，则需要修改Acore设备树文件、Uboot设备树文件以及MCU配置文件。</li>
<li>在同一个 channel 中，发送（push）和接收（pop）使用独立的 ring buffer 和中断机制，因此收发操作是相互独立、互不影响的。</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="用户态ipc应用和配置文件的使用方法">用户态IPC应用和配置文件的使用方法<a href="#用户态ipc应用和配置文件的使用方法" class="hash-link" aria-label="用户态IPC应用和配置文件的使用方法的直接链接" title="用户态IPC应用和配置文件的使用方法的直接链接">​</a></h2>
<p>IPC Sample实现Acore与MCU之间的IPC收发通信，展示IPC多实例多通道多线程的使用示例。</p>
<p><img decoding="async" loading="lazy" src="https://rdk-doc.oss-cn-beijing.aliyuncs.com/doc/img/07_Advanced_development/02_linux_development/driver_development_s100/sampleframeware.png" alt="Acore与MCU之间的IPC收发通信" class="img_ev3q"></p>
<p>Sample软件架构图中Acore使用libipcfhal的接口进行数据收发，底层基于ipcf的驱动，MCU直接使用ipcf的接口进行收发。其中由于Acore侧有多套IPC接口，便于区分，分别描述为IPCFHAL、RPMSG、IPCF，MCU侧只有一套IPC接口， 因此IPCF在MCU侧文档统一描述为IPC。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="硬件数据流说明">硬件数据流说明<a href="#硬件数据流说明" class="hash-link" aria-label="硬件数据流说明的直接链接" title="硬件数据流说明的直接链接">​</a></h3>
<p>Sample的共享内存数据流和中断信号流</p>
<p><img decoding="async" loading="lazy" src="https://rdk-doc.oss-cn-beijing.aliyuncs.com/doc/img/07_Advanced_development/02_linux_development/driver_development_s100/sampledataflow.png" alt="共享内存数据流和中断信号流" class="img_ev3q"></p>
<p>Sample中Acore与MCU通过共享内存传输数据，通过mailbox中断通知双方。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="acore侧sample代码位置与目录结构">Acore侧Sample代码位置与目录结构<a href="#acore侧sample代码位置与目录结构" class="hash-link" aria-label="Acore侧Sample代码位置与目录结构的直接链接" title="Acore侧Sample代码位置与目录结构的直接链接">​</a></h3>
<p><strong>代码路径：</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># Sample源码路径</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">${SDK}/source/hobot-io-samples/debian/app/ipcbox_sample  # ipc C++  Sample</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">${SDK}/source/hobot-io-samples/debian/app/pyhbipchal_sample # ipc python Sample</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">${SDK}/source/hobot-io/debian/app/pyhbipchal # ipc C++库为转换pyhton库源码</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 源码随固件一同打包，可在S100自行编译, 路径如下</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">${S100}/app/ipcbox_sample</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">${S100}/app/pyhbipchal_sample</span><br></span></code></pre></div></div>
<p><strong>目录结构：</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">root@ubuntu:/app/ipcbox_sample# tree .</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">├── ipcbox_runcmd # 运行mcu侧cmd命令Sample</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│   ├── Makefile # Sample编译框架</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│   ├── ipcbox_runcmd.cpp # Sample代码</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│   └── ipcfhal_sample_config.json # Sample配置文件</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">└── ipcbox_uart # ipc透传uart Sample</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ├── Makefile # Sample编译框架</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ├── ipcbox_uart.cpp # Sample代码</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    └── ipcfhal_sample_config.json # Sample配置文件</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="api流程说明">API流程说明<a href="#api流程说明" class="hash-link" aria-label="API流程说明的直接链接" title="API流程说明的直接链接">​</a></h3>
<p>Acore与MCU(IRQ方式)之间API Sample运行流程图
<img decoding="async" loading="lazy" src="https://rdk-doc.oss-cn-beijing.aliyuncs.com/doc/img/07_Advanced_development/02_linux_development/driver_development_s100/sampleirqapi.png" alt="Acore与MCU(IRQ方式)之间API Sample运行流程图" class="img_ev3q"></p>
<p>Acore与MCU(POLL方式)之间API Sample运行流程图
<img decoding="async" loading="lazy" src="https://rdk-doc.oss-cn-beijing.aliyuncs.com/doc/img/07_Advanced_development/02_linux_development/driver_development_s100/samplepollapi.png" alt="Acore与MCU(POLL方式)之间API Sample运行流程图" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="通路配置">通路配置<a href="#通路配置" class="hash-link" aria-label="通路配置的直接链接" title="通路配置的直接链接">​</a></h3>
<p>可以增加Json文件中的通道数量config_num，并增加通道信息，本Sample未支持增加通道的功能，若需要增加通道，需要修改Acore和MCU两侧配置文件。</p>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;log_level&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> # 日志等级，可省略</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;config_num&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">4</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> # 配置通道数量</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;config_num_max&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">256</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> #配置通道数量最大值</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;config_0&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> # 配置通道</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token property" style="color:#36acaa">&quot;name&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;cpu2mcu_ins7ch0&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> # 通道名字</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token property" style="color:#36acaa">&quot;instance&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">7</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> # 实例id</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token property" style="color:#36acaa">&quot;channel&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> # 通道id</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token property" style="color:#36acaa">&quot;pkg_size_max&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">4096</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> # 发送包最大字节，推荐小于等于4096Bytes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token property" style="color:#36acaa">&quot;fifo_size&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">64000</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> # 缓冲fifo的大小，取决于需要缓冲的个数</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token property" style="color:#36acaa">&quot;fifo_type&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> # 缓冲fifo的类型，仅支持</span><span class="token number" style="color:#36acaa">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token property" style="color:#36acaa">&quot;ipcf_dev_path&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token string" style="color:#e3116c">&quot;/dev/ipcdrv&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> # 字符设备驱动，仅支持/dev/ipcdrv</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token property" style="color:#36acaa">&quot;ipcf_dev_name&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token string" style="color:#e3116c">&quot;ipcdrv&quot;</span><span class="token plain"> # 字符设备驱动名字，仅支持ipcdrv</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;config_1&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token property" style="color:#36acaa">&quot;name&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;cpu2mcu_ins7ch1&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token property" style="color:#36acaa">&quot;instance&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">7</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token property" style="color:#36acaa">&quot;channel&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token property" style="color:#36acaa">&quot;pkg_size_max&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">4096</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token property" style="color:#36acaa">&quot;fifo_size&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">64000</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token property" style="color:#36acaa">&quot;fifo_type&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token property" style="color:#36acaa">&quot;ipcf_dev_path&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token string" style="color:#e3116c">&quot;/dev/ipcdrv&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token property" style="color:#36acaa">&quot;ipcf_dev_name&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token string" style="color:#e3116c">&quot;ipcdrv&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;config_2&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token property" style="color:#36acaa">&quot;name&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;cpu2mcu_ins8ch0&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token property" style="color:#36acaa">&quot;instance&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">8</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token property" style="color:#36acaa">&quot;channel&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token property" style="color:#36acaa">&quot;pkg_size_max&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">4096</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token property" style="color:#36acaa">&quot;fifo_size&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">64000</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token property" style="color:#36acaa">&quot;fifo_type&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token property" style="color:#36acaa">&quot;ipcf_dev_path&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token string" style="color:#e3116c">&quot;/dev/ipcdrv&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token property" style="color:#36acaa">&quot;ipcf_dev_name&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token string" style="color:#e3116c">&quot;ipcdrv&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;config_3&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token property" style="color:#36acaa">&quot;name&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;cpu2mcu_ins8ch1&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token property" style="color:#36acaa">&quot;instance&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">8</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token property" style="color:#36acaa">&quot;channel&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token property" style="color:#36acaa">&quot;pkg_size_max&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">4096</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token property" style="color:#36acaa">&quot;fifo_size&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">64000</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token property" style="color:#36acaa">&quot;fifo_type&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token property" style="color:#36acaa">&quot;ipcf_dev_path&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token string" style="color:#e3116c">&quot;/dev/ipcdrv&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token property" style="color:#36acaa">&quot;ipcf_dev_name&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token string" style="color:#e3116c">&quot;ipcdrv&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="实例说明">实例说明<a href="#实例说明" class="hash-link" aria-label="实例说明的直接  链接" title="实例说明的直接链接">​</a></h3>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="错误码定义">错误码定义<a href="#错误码定义" class="hash-link" aria-label="错误码定义的直接链接" title="错误码定义的直接链接">​</a></h3>
<table><thead><tr><th>错误码宏定义</th><th>错误码值</th><th>中文说明</th></tr></thead><tbody><tr><td><code>IPCF_HAL_E_OK</code></td><td>0</td><td>操作成功</td></tr><tr><td><code>IPCF_HAL_E_NOK</code></td><td>1</td><td>操作失败</td></tr><tr><td><code>IPCF_HAL_E_CONFIG_FAIL</code></td><td>2</td><td>配置失败</td></tr><tr><td><code>IPCF_HAL_E_WRONG_CONFIGURATION</code></td><td>3</td><td>配置错误</td></tr><tr><td><code>IPCF_HAL_E_NULL_POINTER</code></td><td>4</td><td>传入了空指针参数</td></tr><tr><td><code>IPCF_HAL_E_PARAM_INVALID</code></td><td>5</td><td>参数无效</td></tr><tr><td><code>IPCF_HAL_E_LENGTH_TOO_SMALL</code></td><td>6</td><td>长度过小</td></tr><tr><td><code>IPCF_HAL_E_INIT_FAILED</code></td><td>7</td><td>初始化失败</td></tr><tr><td><code>IPCF_HAL_E_UNINIT</code></td><td>8</td><td>在未初始化前调用</td></tr><tr><td><code>IPCF_HAL_E_BUFFER_OVERFLOW</code></td><td>9</td><td>源地址或目标地址缓冲区溢出</td></tr><tr><td><code>IPCF_HAL_E_ALLOC_FAIL</code></td><td>10</td><td>资源分配失败</td></tr><tr><td><code>IPCF_HAL_E_TIMEOUT</code></td><td>11</td><td>操作超时</td></tr><tr><td><code>IPCF_HAL_E_REINIT</code></td><td>12</td><td>重复初始化</td></tr><tr><td><code>IPCF_HAL_E_BUSY</code></td><td>13</td><td>系统繁忙</td></tr><tr><td><code>IPCF_HAL_E_CHANNEL_INVALID</code></td><td>14</td><td><strong>数据写入通道状态异常：内核态RingBuffer已达容量上限，导致数据写入操作失败，建议等待1-2ms后重试操作;</strong><br><strong>数据读取通道状态异常：内核态RingBuffer已空，导致数据读取操作失败，建议等待1-2ms后重试操作</strong></td></tr></tbody></table>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="c-应用">C++ 应用<a href="#c-应用" class="hash-link" aria-label="C++ 应用的直接链接" title="C++ 应用的直接链接">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="runcmd应用">RunCmd应用<a href="#runcmd应用" class="hash-link" aria-label="RunCmd应用的直接链接" title="RunCmd应用的直接链接">​</a></h4>
<p>此sample实现了对读取了ADC chanel的电压。</p>
<ol>
<li>开机进入S100后，打开应用目录/app/ipcbox_sample/ipcbox_runcmd</li>
<li>编译：make</li>
<li>运行: ./ipcbox_runcmd</li>
<li>出现<code>Extracted adc data:{&quot;adc_ch&quot;:1,&quot;adc_result&quot;:2411,&quot;adc_mv&quot;:1059}</code>打印则测试通过</li>
</ol>
<p>其中表示adc对应pin口，adc_mv表示读出来的电压值</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">root@ubuntu:/app/ipcbox_sample/ipcbox_runcmd# ./ipcbox_runcmd</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[INFO][hb_ipcf_hal.cpp:282] [channel] cpu2mcu_ins7ch0 [ins] 7 [id] 0 init success.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[INFO][hb_ipcf_hal.cpp:333] [channel] cpu2mcu_ins7ch0 [ins] 7 [id] 0 config success.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[INFO][hb_ipcf_hal.cpp:282] [channel] cpu2mcu_ins7ch1 [ins] 7 [id] 1 init success.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[INFO][hb_ipcf_hal.cpp:333] [channel] cpu2mcu_ins7ch1 [ins] 7 [id] 1 config success.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Extracted adc data:{&quot;adc_ch&quot;:1,&quot;adc_result&quot;:2411,&quot;adc_mv&quot;:1059}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">TxCmdItem(96)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">44 2D 49 50 43 42 4F 58 01 00 00 00 55 07 00 00</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">69 70 63 73 65 6E 64 5F 61 64 63 20 31 00 00 00</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">60 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">rx_packet(160):D-IPCBOX</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">44 2D 49 50 43 42 4F 58 01 00 00 00 4B 10 00 00</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">A0 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">7B 22 61 64 63 5F 63 68 22 3A 31 2C 22 61 64 63</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">5F 72 65 73 75 6C 74 22 3A 32 34 31 31 2C 22 61</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">64 63 5F 6D 76 22 3A 31 30 35 39 7D 00 00 00 00</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">00 C9 F5 5A 58 13 C3 E8 F0 1C E7 DE FF FF 00 00</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CC 74 22 8A FF FF 00 00 74 47 67 8A FF FF 00 00</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">A4 0F 1F D4 AA AA 00 00 06 00 00 00 01 00 00 00</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">58 1D E7 DE FF FF 00 00 58 1D E7 DE FF FF 00 00</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">01 00 00 00 00 00 00 00 D8 1C 20 D4 AA AA 00 00</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">40 C0 69 8A FF FF 00 00 A4 0F 1F D4 AA AA 00 00</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[INFO][hb_ipcf_hal.cpp:553] [channel] cpu2mcu_ins7ch0 [ins] 7 [id] 0 deinit success.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[INFO][hb_ipcf_hal.cpp:553] [channel] cpu2mcu_ins7ch1 [ins] 7 [id] 1 deinit success.</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="uart透传">Uart透传<a href="#uart透 传" class="hash-link" aria-label="Uart透传的直接链接" title="Uart透传的直接链接">​</a></h4>
<p>此sample实现了对Uart5的透传，测试时需要将uart5的TX和RX短接。</p>
<ol>
<li>开机进入S100后，打开应用目录cd /app/ipcbox_sample/ipcbox_uart</li>
<li>编译：make</li>
<li>运行: ./ipcbox_uart</li>
<li>出现tx_data and rx_data are identical.打印则测试通过, 参考log如下：</li>
</ol>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># ./ipcbox_uart</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[INFO][hb_ipcf_hal.cpp:282] [channel] cpu2mcu_ins7ch4 [ins] 7 [id] 4 init success.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[INFO][hb_ipcf_hal.cpp:333] [channel] cpu2mcu_ins7ch4 [ins] 7 [id] 4 config success.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">tx_data(64)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">69 70 63 5F 72 75 6E 63 6D 64 5F 73 65 6E 64 20</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">37 20 30 20 31 32 33 34 35 36 37 38 39 20 31 30</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">rx_data(64)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">69 70 63 5F 72 75 6E 63 6D 64 5F 73 65 6E 64 20</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">37 20 30 20 31 32 33 34 35 36 37 38 39 20 31 30</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">tx_data and rx_data are identical.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[INFO][hb_ipcf_hal.cpp:553] [channel] cpu2mcu_ins7ch4 [ins] 7 [id] 4 deinit success.</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="python应用">Python应用<a href="#python应用" class="hash-link" aria-label="Python应用的直接链接" title="Python应用的直接链接">​</a></h3>
<p>S100提供python库文件使用IPC，其原理为通过pybind11调用C++接口，函数名与宏定义等两端保持一致。</p>
<ol>
<li>包的导入</li>
</ol>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">import pyhbipchal as pyipc</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import pyhbipchal_utils as ipc_utils</span><br></span></code></pre></div></div>
<ol start="2">
<li>源码路径</li>
</ol>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">root@ubuntu:/app/pyhbipchal_sample# tree</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">├── ipcfhal_sample_config.json // 配置文件，用于初始化ipc</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">├── pyhbipchal_test.py // 使用pyhbipchal库编写基础python应用测试过用例</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">├── pyhbipchal_utils.py // pyhbipchal_utils对象源码，pyhbipchal进行二次封装,相较于pyhbipchal更符合pyhton的编程习惯</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">└── pyhbipchal_utils_test.py // pyhbipchal_utils测试用例</span><br></span></code></pre></div></div>
<ol start="3">
<li>示例</li>
</ol>
<p>测试python库的效果与C++提供的接口是否一致</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">root@ubuntu:/app/pyhbipchal_sample# python pyhbipchal_test.py</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Library version: 1.0.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">====================test error code==================</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">IPCF_HAL_E_OK (0): General OK</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">IPCF_HAL_E_NOK (-1): General Not OK</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">IPCF_HAL_E_CONFIG_FAIL (-2): Config fail</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">IPCF_HAL_E_WRONG_CONFIGURATION (-3): Wrong configuration</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">IPCF_HAL_E_NULL_POINTER (-4): A null pointer was passed as an argument</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">IPCF_HAL_E_PARAM_INVALID (-5): A parameter was invalid</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">IPCF_HAL_E_LENGTH_TOO_SMALL (-6): Length too small</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">IPCF_HAL_E_INIT_FAILED (-7): Initialization failed</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">IPCF_HAL_E_UNINIT (-8): Called before initialization</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">IPCF_HAL_E_BUFFER_OVERFLOW (-9): Source address or destination address Buffer overflow</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">IPCF_HAL_E_ALLOC_FAIL (-10): Source alloc fail</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">IPCF_HAL_E_TIMEOUT (-11): Expired the time out</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">IPCF_HAL_E_REINIT (-12): Re initilize</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">IPCF_HAL_E_BUSY (-13): Busy</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">IPCF_HAL_E_CHANNEL_INVALID (-14): Channel is invalid</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">=====================test OK=======================</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[INFO][hb_ipcf_hal.cpp:282] [channel] cpu2mcu_ins7ch4 [ins] 7 [id] 4 init success.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[INFO][hb_ipcf_hal.cpp:333] [channel] cpu2mcu_ins7ch4 [ins] 7 [id] 4 config success.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">tx_data(64)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">69 70 63 5F 72 75 6E 63 6D 64 5F 73 65 6E 64 20</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">37 20 30 20 31 32 33 34 35 36 37 38 39 20 31 30</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">rx_data(64)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">69 70 63 5F 72 75 6E 63 6D 64 5F 73 65 6E 64 20</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">37 20 30 20 31 32 33 34 35 36 37 38 39 20 31 30</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">tx_data and rx_data are identical.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[INFO][hb_ipcf_hal.cpp:553] [channel] cpu2mcu_ins7ch4 [ins] 7 [id] 4 deinit success.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">root@ubuntu:/app/pyhbipchal_sample#</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre></div></div>
<p>测试pyhbipchal_utils包的IPC通信功能是否正常。</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">root@ubuntu:/app/pyhbipchal_sample# python pyhbipchal_utils_test.py</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[INFO][hb_ipcf_hal.cpp:282] [channel] cpu2mcu_ins7ch4 [ins] 7 [id] 4 init success.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[INFO][hb_ipcf_hal.cpp:333] [channel] cpu2mcu_ins7ch4 [ins] 7 [id] 4 config success.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Tx: b&#x27;ipc_runcmd_send 7 0 123456789 10&#x27; | Rx: b&#x27;ipc_runcmd_send 7 0 123456789 10&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[INFO][hb_ipcf_hal.cpp:553] [channel] cpu2mcu_ins7ch4 [ins] 7 [id] 4 deinit success.</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="acore与mcu的传输流程">Acore与MCU的传输流程<a href="#acore与mcu的传输流程" class="hash-link" aria-label="Acore与MCU的传输流程的直接链接" title="Acore与MCU的传输流程的直接链接">​</a></h2>
<p>Acore与MCU IPC通信使用MCU MDMA将数据在DDR与MCU SRAM之间搬运，MCU发送数据到Acore的流程中，MCU先使用MDMA将数据从SRAM搬运到DDR，再发送中断通知， Acore发送数据到MCU的流程中，MCU收到中断通知后，使用MDMA将数据从DDR搬运到SRAM。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="mcu发送数据到acore">MCU发送数据到Acore<a href="#mcu发送数据到acore" class="hash-link" aria-label="MCU发送数据到Acore的直接链接" title="MCU发送数据到Acore的直接链接">​</a></h3>
<p><img decoding="async" loading="lazy" src="https://rdk-doc.oss-cn-beijing.aliyuncs.com/doc/img/07_Advanced_development/02_linux_development/driver_development_s100/imager52a78.png" alt="MCU发送数据到Acore" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="acore发送数据到mcu">Acore发送数据到MCU<a href="#acore发送数据到mcu" class="hash-link" aria-label="Acore发送数据到MCU的直接链接" title="Acore发送数据到MCU的直接链接">​</a></h3>
<p><img decoding="async" loading="lazy" src="https://rdk-doc.oss-cn-beijing.aliyuncs.com/doc/img/07_Advanced_development/02_linux_development/driver_development_s100/imagea78r52.png" alt="Acore发送数据到MCU" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="ipcfhal接口使用序列">IPCFHAL接口使用序列<a href="#ipcfhal接口使用序列" class="hash-link" aria-label="IPCFHAL接口使用序列的直接链接" title="IPCFHAL接口使用序列的直接链接">​</a></h3>
<p><img decoding="async" loading="lazy" src="https://rdk-doc.oss-cn-beijing.aliyuncs.com/doc/img/07_Advanced_development/02_linux_development/driver_development_s100/imageipcfhalapi.png" alt="Acore发送数据到MCU" class="img_ev3q"></p>
<p>IPCFHAL在Acore与MCU通信时，MCU侧用户使用IPCF接口。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="ipcfhal使用注意事项">IPCFHAL使用注意事项<a href="#ipcfhal使用注意事项" class="hash-link" aria-label="IPCFHAL使用注意事项的直接链接" title="IPCFHAL使用注意事项的直接链接">​</a></h3>
<ul>
<li>ipcfhal同一个通道不支持多进程；若使用多线程收发，收发时序和逻辑需要用户保障。</li>
<li>MCU侧SRAM fifo 太小仅用于内部使用。出于节省SRAM的角度，客户可以使用DDR方案。</li>
<li>Acore侧每个实例的中断对应的优先级不可配置，MCU可配置。</li>
<li>若应用对系统调度延时的波动比较敏感，可调整应用程序的调度策略为SCHED_FIFO。</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="ipcfhal调试方法">IPCFHAL调试方法<a href="#ipcfhal调试方法" class="hash-link" aria-label="IPCFHAL调试方法的直接链接" title="IPCFHAL调试方法的直接链接">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="调试日志">调试日志<a href="#调试日志" class="hash-link" aria-label="调试日志的直接链接" title="调试日志的直接链接">​</a></h4>
<p>IPCFHAL及底层的IPCF、Mailbox驱动都提供了较完整的log信息，若有调试问题，可查看log输出，帮助定位问题。</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="error-code-api-返回值">error code (api 返回值)<a href="#error-code-api-返回值" class="hash-link" aria-label="error code (api 返回值)的直接链接" title="error code (api 返回值)的直接链接">​</a></h4>
<p>IPCFHAL定义了一些error code，覆盖了常见的错误类型，可使用接口：hb_ipcfhal_trans_err将error code转换为错误描述。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="sysfs调试节点acore侧">sysfs调试节点(Acore侧)<a href="#sysfs调试节点acore侧" class="hash-link" aria-label="sysfs调试节点(Acore侧)的直接链接" title="sysfs调试节点(Acore侧)的直接链接">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="statistic调试节点">statistic调试节点<a href="#statistic调试节点" class="hash-link" aria-label="statistic调试节点的直接链接" title="statistic调试节点的直接链接">​</a></h3>
<p>打印统计的通信信息，包括pkg，pkg_len，err_acq，err_shm_tx，err_cb。</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="节点路径">【节点路径】<a href="#节点路径" class="hash-link" aria-label="【节点路径】的直接链接" title="【节点路径】的直接链接">​</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">//ins-X表示insid，若insid是5，则为ins-5</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/sys/kernel/debug/ipcdrv-ins-5/statistic</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="节点作用">【节点作用】<a href="#节点作用" class="hash-link" aria-label="【节点作用】的直接链接" title="【节点作用】的直接链接">​</a></h4>
<div class="language-c codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-c codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">//以instance为单位，统计所有channel接收&amp;发送的count</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">struct</span><span class="token plain"> </span><span class="token class-name">ipc_statistic_t</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token class-name">uint32_t</span><span class="token plain"> acq_cnt</span><span class="token punctuation" style="color:#393A34">;</span><span class="token comment" style="color:#999988;font-style:italic">/**&lt; tx: acquire buf count*/</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token class-name">uint32_t</span><span class="token plain"> shm_tx_cnt</span><span class="token punctuation" style="color:#393A34">;</span><span class="token comment" style="color:#999988;font-style:italic">/**&lt; tx: send count*/</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token class-name">uint32_t</span><span class="token plain"> cb_cnt</span><span class="token punctuation" style="color:#393A34">;</span><span class="token comment" style="color:#999988;font-style:italic">/**&lt; rx: callback count*/</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token class-name">uint32_t</span><span class="token plain"> err_acq</span><span class="token punctuation" style="color:#393A34">;</span><span class="token comment" style="color:#999988;font-style:italic">/**&lt; tx: error acquire buf count*/</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token class-name">uint32_t</span><span class="token plain"> err_shm_tx</span><span class="token punctuation" style="color:#393A34">;</span><span class="token comment" style="color:#999988;font-style:italic">/**&lt; tx: error send count*/</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token class-name">uint32_t</span><span class="token plain"> err_cb</span><span class="token punctuation" style="color:#393A34">;</span><span class="token comment" style="color:#999988;font-style:italic">/**&lt; rx: error callback count*/</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token class-name">uint32_t</span><span class="token plain"> packages</span><span class="token punctuation" style="color:#393A34">;</span><span class="token comment" style="color:#999988;font-style:italic">/**&lt; tx/rx: packages count*/</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token class-name">uint64_t</span><span class="token plain"> datalen</span><span class="token punctuation" style="color:#393A34">;</span><span class="token comment" style="color:#999988;font-style:italic">/**&lt; tx/rx: datalen*/</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="节点使用">【节点使用】<a href="#节点使用" class="hash-link" aria-label="【节点使用】的直接链接" title="【 节点使用】的直接链接">​</a></h4>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">//方法一：直接操作sys节点</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//通道完成初始化，未收发数据时, enable</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo 0 &gt; /sys/kernel/debug/ipcdrv-ins-5/statistic</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//收发数据结束，且通道未去初始化时，get</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cat /sys/kernel/debug/ipcdrv-ins-5/statistic</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//方法二：使用open/write/read/close操作</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">fd= open(/sys/kernel/debug/ipcdrv-ins-5/statistic, O_RDWR);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">write(fd, buf, 1024);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//tx/rx，收发数据</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">read(fd, buf, 1024);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">close(fd);</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="log">【log】<a href="#log" class="hash-link" aria-label="【log】的直接链接" title="【log】的直接链接">​</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">DataLink:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                pkg              pkg_len    err_acq err_shm_tx     err_cb</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        INS5CH0 TX:              1                   32          0          0          0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        INS5CH0 RX:              1                   32          0          0          0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        INS5CH1 TX:              0                    0          0          0          0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        INS5CH1 RX:              0                    0          0          0          0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        INS5CH2 TX:              0                    0          0          0          0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        INS5CH2 RX:              0                    0          0          0          0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        INS5CH3 TX:              0                    0          0          0          0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        INS5CH3 RX:              0                    0          0          0          0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        INS5CH4 TX:              0                    0          0          0          0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        INS5CH4 RX:              0                    0          0          0          0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        INS5CH5 TX:              0                    0          0          0          0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        INS5CH5 RX:              0                    0          0          0          0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        INS5CH6 TX:              0                    0          0          0          0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        INS5CH6 RX:              0                    0          0          0          0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        INS5CH7 TX:              0                    0          0          0          0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        INS5CH7 RX:              0                    0          0          0          0</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="tsdump调试节点">tsdump调试节点<a href="#tsdump调试节点" class="hash-link" aria-label="tsdump调试节点的直接链接" title="tsdump调试节点的直接链接">​</a></h3>
<p>以channel为单位，收发数据时打印时间戳。</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="节点路径-1">【节点路径】<a href="#节点路径-1" class="hash-link" aria-label="【节点路径】的直接链接" title="【节点路径】的直接链接">​</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">//ins-X表示insid，若insid是5，则为ins-5</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/sys/kernel/debug/ipcdrv-ins-5/tsdump</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="节点作用-1">【节点作用】<a href="#节点作用-1" class="hash-link" aria-label="【节点作用】的直接链接" title="【节点作用】的直接链接">​</a></h4>
<div class="language-c codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-c codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">//以channel为单位，使能收发数据时，打印时间戳log</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token class-name">int32_t</span><span class="token plain"> tsdump</span><span class="token punctuation" style="color:#393A34">;</span><span class="token comment" style="color:#999988;font-style:italic">/**&lt; &gt;=0, 使能指定channel的时间戳打印log， &lt;0, 关闭时间戳log*/</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="节 点使用-1">【节点使用】<a href="#节点使用-1" class="hash-link" aria-label="【节点使用】的直接链接" title="【节点使用】的直接链接">​</a></h4>
<div class="language-c codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-c codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">//方法一：直接操作sys节点</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">//通道完成初始化，未收发数据时, enable</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">/</span><span class="token plain">sys</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">kernel</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">debug</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">ipcdrv</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">ins</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">5</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">tsdump</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">//收发数据过程中，会打印时间戳log</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">//收发数据结束，且通道未去初始化时，get</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cat </span><span class="token operator" style="color:#393A34">/</span><span class="token plain">sys</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">kernel</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">debug</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">ipcdrv</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">ins</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">5</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">tsdump</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">//方法二：使用open/write/read/close操作</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">fd</span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">open</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">sys</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">kernel</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">debug</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">ipcdrv</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">ins</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">5</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">tsdump</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> O_RDWR</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">write</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">fd</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> buf</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1024</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">//tx/rx，打印时间戳log</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">read</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">fd</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> buf</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1024</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">close</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">fd</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="log-1">【log】<a href="#log-1" class="hash-link" aria-label="【log】的直接链接" title="【log】的直接链接">​</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[ 1173.246630] ipc-shm-hal: dev_print_timestamp()[515]: [5][0] tx wt sta: 1717558158.887241446</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[ 1173.246642] ipc-shm-hal: dev_print_timestamp()[515]: [5][0] tx wt end: 1717558158.887253646</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[ 1173.246717] ipc-shm-hal: dev_print_timestamp()[515]: [5][0] rx cb sta: 1717558158.887327971</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[ 1173.246723] ipc-shm-hal: dev_print_timestamp()[515]: [5][0] rx cb end: 1717558158.887334796</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[ 1173.246725] ipc-shm-hal: dev_print_timestamp()[515]: [5][0] rx rd sta: 1717558158.887336446</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[ 1173.246727] ipc-shm-hal: dev_print_timestamp()[515]: [5][0] rx sm sta: 1717558158.887338496</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[ 1173.246729] ipc-shm-hal: dev_print_timestamp()[515]: [5][0] rx sm end: 1717558158.887340121</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[ 1173.246730] ipc-shm-hal: dev_print_timestamp()[515]: [5][0] rx rd end: 1717558158.887341646</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">libipcfhal-test: TestBody() [2328] info :</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">tsdump: 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">libipcfhal-test: TestBody() [2329] info :</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">tsdump: 0</span><br></span></code></pre></div></div>
<p>wdump调试节点
以channel为单位，打印发送的数据。</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="节点路径-2">【节点路径】<a href="#节点路径-2" class="hash-link" aria-label="【节点路径】的直接链接" title="【节点路径】的直接链接">​</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">//ins-X表示insid，若insid是5，则为ins-5</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/sys/kernel/debug/ipcdrv-ins-5/wdump</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="节点作用-2">【节点作用】<a href="#节点作用-2" class="hash-link" aria-label="【节点作用】的直接链接" title="【节点作用】的直接链接">​</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">//以channel为单位，使能发送数据dump，打印发送的数据</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//打印的长度取决于dumplen，若未配置dumplen，则默认打印全部</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">int32_t wdump;/**&lt; =chan_id, 使能发送dump， 否则, 关闭发送dump*/</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="节点使用-2">【节点使用】<a href="#节点使用-2" class="hash-link" aria-label="【节点使用】的直接链接" title="【节点使用】的直接链接">​</a></h4>
<div class="language-c codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-c codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">//方法一：直接操作sys节点</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">//通道完成初始化，未发送数据时, enable</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">/</span><span class="token plain">sys</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">kernel</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">debug</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">ipcdrv</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">ins</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">5</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">wdump</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">//发送数据过程中，会打印发送的数据</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">//收发数据结束，且通道未去初始化时，get</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cat </span><span class="token operator" style="color:#393A34">/</span><span class="token plain">sys</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">kernel</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">debug</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">ipcdrv</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">ins</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">5</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">wdump</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">//方法二：使用open/write/read/close操作</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">fd</span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">open</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">sys</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">kernel</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">debug</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">ipcdrv</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">ins</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">5</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">wdump</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> O_RDWR</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">write</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">fd</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> buf</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1024</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">//tx/rx，打印发送的数据</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">read</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">fd</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> buf</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1024</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">close</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">fd</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="log-2">【log】<a href="#log-2" class="hash-link" aria-label="【log】的直接链接" title="【log】的直接链接">​</a></h4>
<div class="language-c codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-c codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1022.271650</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> ipc</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">shm</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">hal</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">hal_ipc_shm_write</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">926</span><span class="token punctuation" style="color:#393A34">]</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">5</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> tx size </span><span class="token number" style="color:#36acaa">32</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1022.271666</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> ipc</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">shm</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">hal</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">ipcf_dump_data</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">519</span><span class="token punctuation" style="color:#393A34">]</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> dump info</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> tx data len</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">32</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> mul</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> remain</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1022.271700</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> ipc</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">shm</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">hal</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">ipcf_dump_data</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">522</span><span class="token punctuation" style="color:#393A34">]</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0x0000</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">00</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">01</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">02</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">03</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">04</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">05</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">06</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">07</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">00</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">00</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">00</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">00</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">00</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">00</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">00</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">00</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">00</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">00</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">00</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">00</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">00</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">00</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">00</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">00</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">00</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">00</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">00</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">00</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">00</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">00</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">00</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">00</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1022.273489</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> ipc</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">shm</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">hal</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">hal_ipc_shm_write</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">926</span><span class="token punctuation" style="color:#393A34">]</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">6</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> tx size </span><span class="token number" style="color:#36acaa">32</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1022.273505</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> ipc</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">shm</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">hal</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">ipcf_dump_data</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">519</span><span class="token punctuation" style="color:#393A34">]</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> dump info</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> tx data len</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">32</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> mul</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> remain</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1022.273733</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> ipc</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">shm</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">hal</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">ipcf_dump_data</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">522</span><span class="token punctuation" style="color:#393A34">]</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0x0000</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">00</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">01</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">02</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">03</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">04</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">05</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">06</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">07</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">00</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">00</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">00</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">00</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">00</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">00</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">00</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">00</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">00</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">00</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">00</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">00</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">00</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">00</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">00</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">00</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">00</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">00</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">00</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">00</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">00</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">00</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">00</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">00</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">libipcfhal</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">test</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">TestBody</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">2403</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> info </span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">wdump</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">libipcfhal</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">test</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">TestBody</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">2404</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> info </span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">wdump</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="rdump调试节点">rdump调试节点<a href="#rdump 调试节点" class="hash-link" aria-label="rdump调试节点的直接链接" title="rdump调试节点的直接链接">​</a></h3>
<p>以channel为单位，打印接收的数据。</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="节点路径-3">【节点路径】<a href="#节点路径-3" class="hash-link" aria-label="【节点路径】的直接链接" title="【节点路径】的直接链接">​</a></h4>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">//ins-X表示insid，若insid是5，则为ins-5</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/sys/kernel/debug/ipcdrv-ins-5/rdump</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="节点作用-3">【节点作用】<a href="#节点作用-3" class="hash-link" aria-label="【节点作用】的直接链接" title="【节点作用】的直接链接">​</a></h4>
<div class="language-c codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-c codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">//以channel为单位，使能接收数据dump，打印接收的数据</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">//打印的长度取决于dumplen，若未配置dumplen，则默认打  印全部</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token class-name">uint32_t</span><span class="token plain"> rdump</span><span class="token punctuation" style="color:#393A34">;</span><span class="token comment" style="color:#999988;font-style:italic">/**&lt; =chan_id, 使能接收dump，否则，关闭接收dump*/</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="节点使用-3">【节点使用】<a href="#节点使用-3" class="hash-link" aria-label="【节点使用】的直接链接" title="【节点使用】的直接链接">​</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">//方法一：直接操作sys节点</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//通道完成初始化，未收发数据时, enable</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo 0 &gt; /sys/kernel/debug/ipcdrv-ins-5/rdump</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//发送数据过程中，会打印接收的数据</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//收发数据结束，且通道未去初始化时，get</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cat /sys/kernel/debug/ipcdrv-ins-5/rdump</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//方法二：使用open/write/read/close操作</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">fd= open(/sys/kernel/debug/ipcdrv-ins-5/rdump, O_RDWR);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">write(fd, buf, DEV_README_BUFSIZE);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//tx/rx，打印接收的数据</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">read(fd, buf, DEV_README_BUFSIZE);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">close(fd);</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="log-3">【log】<a href="#log-3" class="hash-link" aria-label="【log】的直接链接" title="【log】的直接链接">​</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[  983.730497] ipc-shm-hal: data_callback()[803]: [6][0] callback size 32</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[  983.730524] ipc-shm-hal: ipcf_dump_data()[519]: dump info: callback rx len[32] mul[1] remain[0]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[  983.730540] ipc-shm-hal: ipcf_dump_data()[522]: 0x0000: 00 01 02 03 04 05 06 07 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[  983.731415] ipc-shm-hal: data_callback()[803]: [5][0] callback size 32</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[  983.731431] ipc-shm-hal: ipcf_dump_data()[519]: dump info: callback rx len[32] mul[1] remain[0]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[  983.731443] ipc-shm-hal: ipcf_dump_data()[522]: 0x0000: 00 01 02 03 04 05 06 07 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">libipcfhal-test: TestBody() [2478] info :</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">rdump: 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">libipcfhal-test: TestBody() [2479] info :</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">rdump: 0</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="dumplen调试节点">dumplen调试节点<a href="#dumplen调试节点" class="hash-link" aria-label="dumplen调试节点的直接链接" title="dumplen调试节点的直接链接">​</a></h3>
<p>以channel为单位，配置dump数据长度。
【节点路径】</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">//ins-X表示insid，若insid是5，则为ins-5</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/sys/kernel/debug/ipcdrv-ins-5/dumplen</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="节点作用-4">【节点作用】<a href="#节点作用-4" class="hash-link" aria-label="【节点作用】的直接链接" title="【节点作用】的直接链接">​</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">//以channel为单位，配置dump数据的长度</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//dumplen&gt;0且dumplen&lt;data_len时有效</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//前提条件是使能wdump或rdump</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">uint32_t dumplen;/**&lt; dump数据时，打印数据的字节数*/</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="节点使用-4">【节点使用】<a href="#节点使用-4" class="hash-link" aria-label="【节点使用】的直接链接" title="【节点使用】的直接链接">​</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">//方法一：直接操作sys节点</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//通道完成初始化，未发送数据时, enable</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo 0 &gt; /sys/kernel/debug/ipcdrv-ins-5/dumplen</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//发送数据过程中，会打印发送的数据</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//收发数据结束，且通道未去初始化时，get</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cat /sys/kernel/debug/ipcdrv-ins-5/dumplen</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//方法二：使用open/write/read/close操作</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">fd= open(/sys/kernel/debug/ipcdrv-ins-5/dumplen, O_RDWR);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">write(fd, buf, DEV_README_BUFSIZE);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//tx/rx，打印发送的数据</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">read(fd, buf, DEV_README_BUFSIZE);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">close(fd);</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="log-4">【log】<a href="#log-4" class="hash-link" aria-label="【log】的直接链接" title="【log】的直接链接">​</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[  852.898250] ipc-shm-hal: hal_ipc_shm_write()[926]: [5][0] tx size 32</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[  852.898283] ipc-shm-hal: ipcf_dump_data()[519]: dump info: tx data len[16] mul[0] remain[16]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[  852.898315] ipc-shm-hal: ipcf_dump_data()[539]: 0x0000: 00 01 02 03 04 05 06 07 00 00 00 00 00 00 00 00</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[  852.898519] ipc-shm-hal: data_callback()[803]: [6][0] callback size 32</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[  852.898542] ipc-shm-hal: ipcf_dump_data()[519]: dump info: callback rx len[16] mul[0] remain[16]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[  852.898571] ipc-shm-hal: ipcf_dump_data()[539]: 0x0000: 00 01 02 03 04 05 06 07 00 00 00 00 00 00 00 00</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[  853.900076] ipc-shm-hal: hal_ipc_shm_write()[926]: [6][0] tx size 32</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[  853.900112] ipc-shm-hal: ipcf_dump_data()[519]: dump info: tx data len[16] mul[0] remain[16]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[  853.900143] ipc-shm-hal: ipcf_dump_data()[539]: 0x0000: 00 01 02 03 04 05 06 07 00 00 00 00 00 00 00 00</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[  853.900359] ipc-shm-hal: data_callback()[803]: [5][0] callback size 32</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[  853.900373] ipc-shm-hal: ipcf_dump_data()[519]: dump info: callback rx len[16] mul[0] remain[16]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[  853.900401] ipc-shm-hal: ipcf_dump_data()[539]: 0x0000: 00 01 02 03 04 05 06 07 00 00 00 00 00 00 00 00</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">libipcfhal-test: TestBody() [2576] info :</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dumplen: 16</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">libipcfhal-test: TestBody() [2577] info :</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dumplen: 16</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">libipcfhal-test: TestBody() [2584] info :</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">rdump: 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">libipcfhal-test: TestBody() [2585] info :</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">rdump: 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">libipcfhal-test: TestBody() [2592] info :</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">wdump: 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">libipcfhal-test: TestBody() [2593] info :</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">wdump: 0</span><br></span></code></pre></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"></div><div class="col lastUpdated_JAkA"><span class="theme-last-updated">最后<!-- -->于 <b><time datetime="2025-09-10T11:29:27.000Z" itemprop="dateModified">2025年9月10日</time></b> <!-- -->更新</span></div></div></footer></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="文件选项卡"><a class="pagination-nav__link pagination-nav__link--prev" href="/rdk_doc/rdk_s/Advanced_development/linux_development/driver_development_s100/driver_pinctrl_dev"><div class="pagination-nav__sublabel">上一页</div><div class="pagination-nav__label">Pinctrl调试指南</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/rdk_doc/rdk_s/Advanced_development/linux_development/driver_development_s100/driver_spi_dev"><div class="pagination-nav__sublabel">下一页</div><div class="pagination-nav__label">SPI调试指南</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#ipcf软硬件组件框图" class="table-of-contents__link toc-highlight">IPCF软硬件组件框图</a></li><li><a href="#ipc典型使用场景" class="table-of-contents__link toc-highlight">IPC典型使用场景</a></li><li><a href="#ipc实例分配方案" class="table-of-contents__link toc-highlight">IPC实例分配方案</a><ul><li><a href="#acore侧配置实例方法" class="table-of-contents__link toc-highlight">Acore侧配置实例方法</a></li><li><a href="#设备树配置说明" class="table-of-contents__link toc-highlight">设备树配置说明</a></li></ul></li><li><a href="#用户态ipc应用和配置文件的使用方法" class="table-of-contents__link toc-highlight">用户态IPC应用和配置文件的使用方法</a><ul><li><a href="#硬件数据流说明" class="table-of-contents__link toc-highlight">硬件数据流说明</a></li><li><a href="#acore侧sample代码位置与目录结构" class="table-of-contents__link toc-highlight">Acore侧Sample代码位置与目录结构</a></li><li><a href="#api流程说明" class="table-of-contents__link toc-highlight">API流程说明</a></li><li><a href="#通路配置" class="table-of-contents__link toc-highlight">通路配置</a></li><li><a href="#实例说明" class="table-of-contents__link toc-highlight">实例说明</a></li><li><a href="#错误码定义" class="table-of-contents__link toc-highlight">错误码定义</a></li><li><a href="#c-应用" class="table-of-contents__link toc-highlight">C++ 应用</a><ul><li><a href="#runcmd应用" class="table-of-contents__link toc-highlight">RunCmd应用</a></li><li><a href="#uart透传" class="table-of-contents__link toc-highlight">Uart透传</a></li></ul></li><li><a href="#python应用" class="table-of-contents__link toc-highlight">Python应用</a></li></ul></li><li><a href="#acore与mcu的传输流程" class="table-of-contents__link toc-highlight">Acore与MCU的传输流程</a><ul><li><a href="#mcu发送数据到acore" class="table-of-contents__link toc-highlight">MCU发送数据到Acore</a></li><li><a href="#acore发送数据到mcu" class="table-of-contents__link toc-highlight">Acore发送数据到MCU</a></li><li><a href="#ipcfhal接口使用序列" class="table-of-contents__link toc-highlight">IPCFHAL接口使用序列</a></li><li><a href="#ipcfhal使用注意事项" class="table-of-contents__link toc-highlight">IPCFHAL使用注意事项</a></li><li><a href="#ipcfhal调试方法" class="table-of-contents__link toc-highlight">IPCFHAL调试方法</a><ul><li><a href="#调试日志" class="table-of-contents__link toc-highlight">调试日志</a></li><li><a href="#error-code-api-返回值" class="table-of-contents__link toc-highlight">error code (api 返回值)</a></li></ul></li></ul></li><li><a href="#sysfs调试节点acore侧" class="table-of-contents__link toc-highlight">sysfs调试节点(Acore侧)</a><ul><li><a href="#statistic调试节点" class="table-of-contents__link toc-highlight">statistic调试节点</a><ul><li><a href="#节点路径" class="table-of-contents__link toc-highlight">【节点路径】</a></li><li><a href="#节点作用" class="table-of-contents__link toc-highlight">【节点作用】</a></li><li><a href="#节点使用" class="table-of-contents__link toc-highlight">【节点使用】</a></li><li><a href="#log" class="table-of-contents__link toc-highlight">【log】</a></li></ul></li><li><a href="#tsdump调试节点" class="table-of-contents__link toc-highlight">tsdump调试节点</a><ul><li><a href="#节点路径-1" class="table-of-contents__link toc-highlight">【节点路径】</a></li><li><a href="#节点作用-1" class="table-of-contents__link toc-highlight">【节点作用】</a></li><li><a href="#节点使用-1" class="table-of-contents__link toc-highlight">【节点使用】</a></li><li><a href="#log-1" class="table-of-contents__link toc-highlight">【log】</a></li><li><a href="#节点路径-2" class="table-of-contents__link toc-highlight">【节点路径】</a></li><li><a href="#节点作用-2" class="table-of-contents__link toc-highlight">【节点作用】</a></li><li><a href="#节点使用-2" class="table-of-contents__link toc-highlight">【节点使用】</a></li><li><a href="#log-2" class="table-of-contents__link toc-highlight">【log】</a></li></ul></li><li><a href="#rdump调试节点" class="table-of-contents__link toc-highlight">rdump调试节点</a><ul><li><a href="#节点路径-3" class="table-of-contents__link toc-highlight">【节点路径】</a></li><li><a href="#节点作用-3" class="table-of-contents__link toc-highlight">【节点作用】</a></li><li><a href="#节点使用-3" class="table-of-contents__link toc-highlight">【节点使用】</a></li><li><a href="#log-3" class="table-of-contents__link toc-highlight">【log】</a></li></ul></li><li><a href="#dumplen调试节点" class="table-of-contents__link toc-highlight">dumplen调试节点</a><ul><li><a href="#节点作用-4" class="table-of-contents__link toc-highlight">【节点作用】</a></li><li><a href="#节点使用-4" class="table-of-contents__link toc-highlight">【节点使用】</a></li><li><a href="#log-4" class="table-of-contents__link toc-highlight">【log】</a></li></ul></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class="footer__title">友情链接</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://www.guyuehome.com/" target="_blank" rel="noopener noreferrer" class="footer__link-item">古月居<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">联系我们</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/D-Robotics" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://space.bilibili.com/437998606" target="_blank" rel="noopener noreferrer" class="footer__link-item">BiLiBiLi<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 D-Robotics.</div></div></div></footer></div>
</body>
</html>