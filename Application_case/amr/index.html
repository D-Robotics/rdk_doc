<!doctype html>
<html lang="zh-Hans" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-Application_case/amr" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.8.1">
<title data-rh="true">6.2 AMR开发指南 | RDK DOC</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://developer.d-robotics.cc/rdk_doc/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://developer.d-robotics.cc/rdk_doc/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://developer.d-robotics.cc/rdk_doc/Application_case/amr"><meta data-rh="true" property="og:locale" content="zh_Hans"><meta data-rh="true" property="og:locale:alternate" content="en"><meta data-rh="true" name="docusaurus_locale" content="zh-Hans"><meta data-rh="true" name="docsearch:language" content="zh-Hans"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="6.2 AMR开发指南 | RDK DOC"><meta data-rh="true" name="description" content="自主移动机器人（Autonomous Mobile Robot，AMR）是一类能够在环境中自主导航和执行任务的机器人。AMR 不同于自动导航车辆 (AGV)，AGV依赖于轨道或预定义路线，并且通常需要操作员监督。AMR 通过多传感器融合、人工智能、机器学习等多种技术来理解环境并在其中导航，不受有线电源的限制。因其高度灵活的移动能力和智能导航系统，AMR在工业自动化、物流、医疗等领域得到了广泛应用。"><meta data-rh="true" property="og:description" content="自主移动机器人（Autonomous Mobile Robot，AMR）是一类能够在环境中自主导航和执行任务的机器人。AMR 不同于自动导航车辆 (AGV)，AGV依赖于轨道或预定义路线，并且通常需要操作员监督。AMR 通过多传感器融合、人工智能、机器学习等多种技术来理解环境并在其中导航，不受有线电源的限制。因其高度灵活的移动能力和智能导航系统，AMR在工业自动化、物流、医疗等领域得到了广泛应用。"><link data-rh="true" rel="icon" href="/rdk_doc/img/logo.png"><link data-rh="true" rel="canonical" href="https://developer.d-robotics.cc/rdk_doc/Application_case/amr"><link data-rh="true" rel="alternate" href="https://developer.d-robotics.cc/rdk_doc/Application_case/amr" hreflang="zh-Hans"><link data-rh="true" rel="alternate" href="https://developer.d-robotics.cc/rdk_doc/en/Application_case/amr" hreflang="en"><link data-rh="true" rel="alternate" href="https://developer.d-robotics.cc/rdk_doc/Application_case/amr" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"6. 应用开发指南","item":"https://developer.d-robotics.cc/rdk_doc/Application_case"},{"@type":"ListItem","position":2,"name":"6.2 AMR开发指南","item":"https://developer.d-robotics.cc/rdk_doc/Application_case/amr"}]}</script><script src="https://hm.baidu.com/hm.js?24dd63cad43b63889ea6bede5fd1ab9e" async></script><link rel="stylesheet" href="/rdk_doc/assets/css/styles.0fbd7d27.css">
<script src="/rdk_doc/assets/js/runtime~main.3ceba6ce.js" defer="defer"></script>
<script src="/rdk_doc/assets/js/main.4925797b.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t="light";var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",e||t),document.documentElement.setAttribute("data-theme-choice",e||t)}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="跳到主要内容"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">跳到主要内容</a></div><nav aria-label="主导航" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="切换导航栏" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a href="https://d-robotics.cc/" target="_blank" rel="noopener noreferrer" class="navbar__brand"><div class="navbar__logo"><img src="/rdk_doc/img/logo.png" alt="地瓜机器人社区 logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/rdk_doc/img/logo.png" alt="地瓜机器人社区 logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">D-Robotics</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/rdk_doc/RDK">RDK X3 / X5</a><a class="navbar__item navbar__link" href="/rdk_doc/rdk_s/RDK">RDK S100</a><a href="https://developer.d-robotics.cc/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Community<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a href="https://github.com/D-Robotics" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link"><svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" class="iconLanguage_nlXk"><path fill="currentColor" d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></svg>CN</a><ul class="dropdown__menu"><li><a href="/rdk_doc/Application_case/amr" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" lang="zh-Hans">CN</a></li><li><a href="/rdk_doc/en/Application_case/amr" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="en">EN</a></li></ul></div><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="切换浅色/暗黑模式（当前为system mode）"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><div class="navbar__search searchBarContainer_NW3z" dir="ltr"><input placeholder="搜索" aria-label="Search" class="navbar__search-input searchInput_YFbd" value=""><div class="loadingRing_RJI3 searchBarLoadingRing_YnHq"><div></div><div></div><div></div><div></div></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper"><div class="docsWrapper_hBAB"><button aria-label="回到顶部" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="文档侧边栏" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/rdk_doc/RDK">D-Robotics RDK套件</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/rdk_doc/Quick_start">1. 快速开始</a><button aria-label="展开侧边栏分类 &#x27;1. 快速开始&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/rdk_doc/System_configuration">2. 系统配置</a><button aria-label="展开侧边栏分类 &#x27;2. 系统配置&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/rdk_doc/Basic_Application">3. 基础应用开发 </a><button aria-label="展开侧边栏分类 &#x27;3. 基础应用开发 &#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/rdk_doc/Basic_Development">4. 算法应用开发</a><button aria-label="展开侧边栏分类 &#x27;4. 算法应用开发&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/rdk_doc/Robot_development">5. 机器人应用开发</a><button aria-label="展开侧边栏分类 &#x27;5. 机器人应用开发&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" href="/rdk_doc/Application_case">6. 应用开发指南</a><button aria-label="折叠侧边栏分类 &#x27;6. 应用开发指南&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/rdk_doc/Application_case/line_follower">6.1 深度学习巡线小车</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/rdk_doc/Application_case/amr">6.2 AMR开发指南</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/rdk_doc/Advanced_development">7. 进阶开发</a><button aria-label="展开侧边栏分类 &#x27;7. 进阶开发&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/rdk_doc/FAQ">8. 常见问题</a><button aria-label="展开侧边栏分类 &#x27;8. 常见问题&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/rdk_doc/Appendix">9. 附录</a><button aria-label="展开侧边栏分类 &#x27;9. 附录&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/rdk_doc/Release_Note/release_note">10. 版本发布</a></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="页面路径"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="主页面" class="breadcrumbs__link" href="/rdk_doc/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/rdk_doc/Application_case"><span>6. 应用开发指南</span></a></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">6.2 AMR开发指南</span></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">本页总览</button></div><div class="theme-doc-markdown markdown"><header><h1>6.2 AMR开发指南</h1></header>
<p>自主移动机器人（Autonomous Mobile Robot，AMR）是一类能够在环境中自主导航和执行任务的机器人。AMR 不同于自动导航车辆 (AGV)，AGV依赖于轨道或预定义路线，并且通常需要操作员监督。AMR 通过多传感器融合、人工智能、机器学习等多种技术来理解环境并在其中导航，不受有线电源的限制。因其 高度灵活的移动能力和智能导航系统，AMR在工业自动化、物流、医疗等领域得到了广泛应用。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="1--样例介绍">1.  样例介绍<a href="#1--样例介绍" class="hash-link" aria-label="1.  样例介绍的直接链接" title="1.  样例介绍的直接链接">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="11-外观效果">1.1 外观效果<a href="#11-外观效果" class="hash-link" aria-label="1.1 外观效果的直接链接" title="1.1 外观效果的直接链接">​</a></h3>
<p><img decoding="async" loading="lazy" src="https://rdk-doc.oss-cn-beijing.aliyuncs.com/doc/img/06_Application_case/amr/appearance.png" alt="" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="12-功能框架">1.2 功能框架<a href="#12-功能框架" class="hash-link" aria-label="1.2 功能框架的直接链接" title="1.2 功能框架的直接链接">​</a></h3>
<p><img decoding="async" loading="lazy" src="https://rdk-doc.oss-cn-beijing.aliyuncs.com/doc/img/06_Application_case/amr/amr_framework.jpg" alt="" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="2-样例组装">2. 样例组装<a href="#2-样例组装" class="hash-link" aria-label="2. 样例组装的直接链接" title="2. 样例组装的直接链接">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="21-组件清单">2.1 组件清单<a href="#21-组件清单" class="hash-link" aria-label="2.1 组件清单的直接链接" title="2.1 组件清单的直接链接">​</a></h3>
<table><thead><tr><th>名称</th><th>数量</th><th>备注</th></tr></thead><tbody><tr><td>RDK X5</td><td>1</td><td>地瓜</td></tr><tr><td>AMR底盘（舵轮）+上装+螺丝零件</td><td>1</td><td>煜禾森</td></tr><tr><td>单线激光雷达</td><td>1</td><td>氪见</td></tr><tr><td>tof摄像头</td><td>1</td><td>光鉴</td></tr><tr><td>双目摄像头（230ai）</td><td>1</td><td>地瓜配件</td></tr><tr><td>IMU（BMI088）</td><td>1</td><td> 地瓜配件</td></tr><tr><td>usb转网口转换器</td><td>1</td><td></td></tr><tr><td>0.3m网线</td><td>1</td><td></td></tr><tr><td>12v转5V4A(MAX 5A)</td><td>1</td><td></td></tr><tr><td>tof相机支架（3D打印）</td><td>1</td><td></td></tr><tr><td>双目相机支架（3D打印）</td><td>1</td><td></td></tr><tr><td>盖板（3D打印）</td><td>1</td><td></td></tr><tr><td>m2*16螺丝+m2螺母</td><td>1</td><td></td></tr></tbody></table>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="22-组装步骤讲解">2.2 组装步骤讲解<a href="#22-组装步骤讲解" class="hash-link" aria-label="2.2 组装步骤讲解的直接链接" title="2.2 组装步骤讲解的直接链接">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="221-底盘上装安装">2.2.1 底盘上装安装<a href="#221-底盘上装安装" class="hash-link" aria-label="2.2.1 底盘上装安装的直接链接" title="2.2.1 底盘上装安装的直接链接">​</a></h4>
<p>原生底盘无法安装摄像头以及存放各种线缆，所以需要另外的上装接入底盘，只需将上装底部的两个孔位对齐底盘安装滑轨上的零件，锁紧螺丝即可</p>
<p><img decoding="async" loading="lazy" src="https://rdk-doc.oss-cn-beijing.aliyuncs.com/doc/img/06_Application_case/amr/upper_shell.jpg" alt="" class="img_ev3q"></p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="222-rdk-x5接线">2.2.2 RDK X5接线<a href="#222-rdk-x5接线" class="hash-link" aria-label="2.2.2 RDK X5接线的直接链接" title="2.2.2 RDK X5接线的直接链接">​</a></h4>
<p>所有传感器以及底盘都直接接入RDK X5，需要注意双目摄像头使用的是两根同面的22pin排线，请按照下图所示方向安装</p>
<p><img decoding="async" loading="lazy" src="https://rdk-doc.oss-cn-beijing.aliyuncs.com/doc/img/06_Application_case/amr/RDK-X5_connection.jpg" alt="" class="img_ev3q"></p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="223-盖板安装">2.2.3 盖板安装<a href="#223-盖板安装" class="hash-link" aria-label="2.2.3 盖板安装的直接链接" title="2.2.3 盖板安装的直接链接">​</a></h4>
<p>盖板为3D打印件（图纸见文末附件），主要用于安装RDK X5并且收纳其余线缆。黄框位置四个安装孔用于安装RDK X5，安装位置在上盖板的背面。红框位置的安装孔对齐底盘安装滑轨上的零件，锁紧螺丝即可。</p>
<p><img decoding="async" loading="lazy" src="https://rdk-doc.oss-cn-beijing.aliyuncs.com/doc/img/06_Application_case/amr/cover_board.jpg" alt="" class="img_ev3q"></p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="224-激光雷达模块接入">2.2.4 激光雷达模块接入<a href="#224-激光雷达模块接入" class="hash-link" aria-label="2.2.4 激光雷达模块接入的直接链接" title="2.2.4 激光雷达模块接入的直接链接">​</a></h4>
<p>先将激光雷达安装至载板上，螺丝从载板背面安装，然后将接线穿过载板上的孔洞（右图中黄框所示）连接电源管理器。电源管理器安装在载板背面，螺丝从载板正面安装（如左图红框所示），安装完成后接入网线以及12V电源，网线与电源线穿过上装的孔洞（右图中红框所示）。</p>
<p><img decoding="async" loading="lazy" src="https://rdk-doc.oss-cn-beijing.aliyuncs.com/doc/img/06_Application_case/amr/lidar.jpg" alt="" class="img_ev3q"></p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="225-摄像头安装">2.2.5 摄像头安装<a href="#225-摄像头安装" class="hash-link" aria-label="2.2.5 摄像头安装的直接链接" title="2.2.5 摄像头安装的直接链接">​</a></h4>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="1-tof摄像头安装">1. tof摄像头安装<a href="#1-tof摄像头安装" class="hash-link" aria-label="1. tof摄像头安装的直接链接" title="1. tof摄像头安装的直接链接">​</a></h5>
<p>首先将tof摄像头、3D打印件、钣金支架连接在一起，注意3D打印件凹槽朝下。连接完成后将整体塞入上装上方凹槽，电源线与信 号线从上装内部孔洞穿过（图3黄框）。钣金件的螺丝孔位（图1红框）与上装内部螺丝孔位（图3红框）对齐，锁紧螺丝即可。</p>
<p><img decoding="async" loading="lazy" src="https://rdk-doc.oss-cn-beijing.aliyuncs.com/doc/img/06_Application_case/amr/tof_cam.jpg" alt="" class="img_ev3q"></p>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="2-双目摄像头安装">2. 双目摄像头安装<a href="#2-双目摄像头安装" class="hash-link" aria-label="2. 双目摄像头安装的直接链接" title="2. 双目摄像头安装的直接链接">​</a></h5>
<p>先将双目摄像头与3D打印件连接，然后接入底盘尾部的钣金支架即可</p>
<p><img decoding="async" loading="lazy" src="https://rdk-doc.oss-cn-beijing.aliyuncs.com/doc/img/06_Application_case/amr/mipi_cam.jpg" alt="" class="img_ev3q"></p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="226-电源说明">2.2.6 电源说明<a href="#226-电源说明" class="hash-link" aria-label="2.2.6 电源说明的直接链接" title="2.2.6 电源说明的直接链接">​</a></h4>
<p>底盘上提供12V的电源。12V提供给雷达，tof摄像头以及变压器，变压器输出5V提供给RDK X5</p>
<p><img decoding="async" loading="lazy" src="https://rdk-doc.oss-cn-beijing.aliyuncs.com/doc/img/06_Application_case/amr/power.jpg" alt="" class="img_ev3q"></p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="227-其他部件安装">2.2.7 其他部件安装<a href="#227-其他部件安装" class="hash-link" aria-label="2.2.7 其他部件安装的直接链接" title="2.2.7 其他部件安装的直接链接">​</a></h4>
<p><img decoding="async" loading="lazy" src="https://rdk-doc.oss-cn-beijing.aliyuncs.com/doc/img/06_Application_case/amr/other.jpg" alt="" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="3-运行环境准备">3. 运行环境准备<a href="#3-运行环境准备" class="hash-link" aria-label="3. 运行环境准备的直接链接" title="3. 运行环境准备的直接链接"> ​</a></h2>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>注意</div><div class="admonitionContent_BuS1"><p>tof相机、激光雷达、底盘、imu请根据实际设备型号获取代码或者功能包，此处仅提供地瓜配件imu的源代码。</p></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="31-传感器检查">3.1 传感器检查<a href="#31-传感器检查" class="hash-link" aria-label="3.1 传感器检查的直接链接" title="3.1 传感器检查的直接链接">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="311-双目摄像头">3.1.1 双目摄像头<a href="#311-双目摄像头" class="hash-link" aria-label="3.1.1 双目摄像头的直接链接" title="3.1.1 双目摄像头的直接链接">​</a></h4>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">#检查i2c设备</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">root@ubuntu:~# i2cdetect -y -r 4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     0  1  2  3  4  5  6  7  8  9  a  b  c  d  e  f</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">00:                         -- -- -- -- -- -- -- --</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">10: -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">20: -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">30: -- -- 32 -- -- -- -- -- -- -- -- -- -- -- -- --</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">40: -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">50: 50 -- -- -- -- -- -- -- 58 -- -- -- -- -- -- --</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">60: -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">70: -- -- -- -- -- -- -- --</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">root@ubuntu:~# i2cdetect -y -r 6</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     0  1  2  3  4  5  6  7  8  9  a  b  c  d  e  f</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">00:                         -- -- -- -- -- -- -- --</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">10: -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">20: -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">30: 30 -- -- -- -- -- -- -- -- -- -- -- -- -- -- --</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">40: -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">50: 50 -- -- -- -- -- -- -- 58 -- -- -- -- -- -- --</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">60: -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">70: -- -- -- -- -- -- -- --</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="312-雷达">3.1.2 雷达<a href="#312-雷达" class="hash-link" aria-label="3.1.2 雷达的直接链接" title="3.1.2 雷达的直接链接">​</a></h4>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">#确保雷达与板子的网关与掩码一致，确认是否能ping通</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ping 雷达ip</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="313-底盘">3.1.3 底盘<a href="#313-底盘" class="hash-link" aria-label="3.1.3 底盘的直接链接" title="3.1.3 底盘的直接链接">​</a></h4>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">#启动can设备，请根据具体can设备号以及波特率设置</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ip link set can1 up type can bitrate 500000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#检查设备，会有如下输出：can1: &lt;NOARP,UP,LOWER_UP&gt; mtu 16 qdisc mq state UP mode DEFAULT group default qlen 10link/can </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ip link show can1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#检查能否获取can数据，请根据具体can设备号设置</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">candump can1</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="314-imu">3.1.4 IMU<a href="#314-imu" class="hash-link" aria-label="3.1.4 IMU的直接链接" title="3.1.4 IMU的直接链接">​</a></h4>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">#检查i2c设备 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">root@ubuntu:~# i2cdetect -y -r 5</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     0  1  2  3  4  5  6  7  8  9  a  b  c  d  e  f</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">00:                         -- -- -- -- -- -- -- --</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">10: -- -- -- -- -- -- -- -- -- 19 -- -- -- -- -- --</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">20: -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">30: -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">40: -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">50: -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">60: -- -- -- -- -- -- -- -- -- 69 -- -- -- -- -- --</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">70: -- -- -- -- -- -- -- --</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#获取imu数据(会打印三个数，且随着imu的位姿变化)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cat /sys/devices/virtual/input/input2/acc_bal</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cat /sys/devices/virtual/input/input2/gry_bal</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="32-功能安装">3.2 功能安装<a href="#32-功能安装" class="hash-link" aria-label="3.2 功能安装的直接链接" title="3.2 功能安装的直接链接">​</a></h3>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sudo apt -y tros-hobot-nav2 ros-foxy-navigation2 ros-foxy-nav-msgs</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="33-源码获取无安装包的功能需编译源码">3.3 源码获取（无安装包的功能，需编译源码）<a href="#33-源码获取无安装包的功能需编译源码" class="hash-link" aria-label="3.3 源码获取（无安装包的功能，需编译源码）的直接链接" title="3.3 源码获取（无安装包的功能，需编译源码）的直接链接">​</a></h3>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">mkdir -p ~/amr_ws/src &amp;&amp; cd src</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#tofSLAM </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">git clone https://github.com/wunuo1/Tofslam_ros2.git</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#点云过滤</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">git clone https://github.com/wunuo1/voxel_filter.git</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#指定位置导航</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">git clone https://github.com/wunuo1/pose_setter.git</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#双目深度</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">git clone https://github.com/D-Robotics/hobot_stereonet.git</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="34-代码编译">3.4 代码编译<a href="#34-代码编译" class="hash-link" aria-label="3.4 代码编译的直接链接" title="3.4 代码编译的直接链接">​</a></h3>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cd ~/amr_ws</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">source /opt/tros/humble/setup.bash</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">colcon build</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="35-传感器标定">3.5 传感器标定<a href="#35-传感器标定" class="hash-link" aria-label="3.5 传感器标定的直接链接" title="3.5 传感器标定的直接链接">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="351-标定前准备">3.5.1 标定前准备<a href="#351-标定前准备" class="hash-link" aria-label="3.5.1 标定前准备的直接链接" title="3.5.1 标定前准备的直接链接">​</a></h4>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="1-标定环境准备标定工具为kalibr此处提供包含kalibr以及其他标定脚本的dokcer">1. 标定环境准备（标定工具为kalibr，此处提供包含kalibr以及其他标定脚本的dokcer）<a href="#1-标定环境准备标定  工具为kalibr此处提供包含kalibr以及其他标定脚本的dokcer" class="hash-link" aria-label="1. 标定环境准备（标定工具为kalibr，此处提供包含kalibr以及其他标定脚本的dokcer）的直接链接" title="1. 标定环境准备（标定工具为kalibr，此处提供包含kalibr以及其他标定脚本的dokcer）的直接链接">​</a></h5>
<h6 class="anchor anchorWithStickyNavbar_LWe7" id="i-下载docker文件">i. 下载docker文件<a href="#i-下载docker文件" class="hash-link" aria-label="i. 下载docker文件的直接链接" title="i. 下载docker文件的直接链接">​</a></h6>
<p>链接: <a href="https://pan.baidu.com/s/1oXegKORgWi8Kzf4kdQXL2g?pwd=ur2z" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1oXegKORgWi8Kzf4kdQXL2g?pwd=ur2z</a>
提取码: ur2z</p>
<h6 class="anchor anchorWithStickyNavbar_LWe7" id="ii-创建环境">ii. 创建环境<a href="#ii-创建环境" class="hash-link" aria-label="ii. 创建环境的直接链接" title="ii. 创建环境的直接链接">​</a></h6>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">#加载docker</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">docker load -i ubuntu18.04_calibration.tar</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#检查docker是否加载成功（出现TAG为calibration的镜像）</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">docker images</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#从image生成containe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">docker run -it --privileged -v /home/nuo.wu/share_dir:/share_dir -e DISPLAY=$DISPLAY -e GDK_SCALE -e GDK_DPI_SCALE --net=host ubuntu18.04:calibration /bin/bash</span><br></span></code></pre></div></div>
<h6 class="anchor anchorWithStickyNavbar_LWe7" id="iiidocker支持界面显示">iii.docker支持界面显示<a href="#iiidocker支持界面显示" class="hash-link" aria-label="iii.docker支持界面显示的直接链接" title="iii.docker支持界面显示的直接链接">​</a></h6>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># 在host端运行</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">xhost +local:docker</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 在host端运行以下指令</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo $DISPLAY</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 在docker运行以下指令</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo $DISPLAY</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 查看两者输出是否相同</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 若两者输出不同,若host端显示的结果是:0, 则在docker里运行以下  指令</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">export DISPLAY=:0</span><br></span></code></pre></div></div>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="2-准备标定板并配置参数">2. 准备标定板并配置参数<a href="#2-准备标定板并配置参数" class="hash-link" aria-label="2. 准备标定板并配置参数的直接链接" title="2. 准备标定板并配置参数的直接链接">​</a></h5>
<p>棋盘格或aprilgrid均可（aprilgrid文件见附件）。棋盘格尺寸方格边长&gt;=10cm为宜，且为避免标定时棋盘格角点提取/连线出错问题，棋盘格行列应不同。aprilgrid标定板数据采集时比较方便，操作简单，但对图像质量的要求较高，则目前阶段还是建议使用棋盘格。标定板外尺寸&gt; 1m。</p>
<p><img decoding="async" loading="lazy" src="https://rdk-doc.oss-cn-beijing.aliyuncs.com/doc/img/06_Application_case/amr/cal_board.jpg" alt="" class="img_ev3q"></p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">#设置aprilgrid.yaml文件</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">target_type: &#x27;aprilgrid&#x27; #gridtype</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">tagCols: 6               #number of apriltags</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">tagRows: 6               #number of apriltags</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">tagSize: 0.024           #size of apriltag, edge to edge [m]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">tagSpacing: 0.3083          #ratio of space between tags to tagSize</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">codeOffset: 0            #code offset for the first tag in the aprilboard</span><br></span></code></pre></div></div>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">#设置棋盘格标定板参数，其中targetCols，targetRows分别为每列、每行的内点数，如格子数为9列x8列，则内角点数为8列x7列。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">target_type: &#x27;checkboard&#x27; </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">targetCols: 8 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">targetRows: 7  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">rawSpacingMeters: 0.1        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">colSpacingMeters: 0.1    </span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="352-双目摄像头内参标定双目深度算法使用">3.5.2 双目摄像头内参标定（双目深度算法使用）<a href="#352-双目摄像头内参标定双目深度算法使用" class="hash-link" aria-label="3.5.2 双目摄像头内参标定（双目深度算法使用）的直接链接" title="3.5.2 双目摄像头内参标定（双目深度算法使用）的直接链接">​</a></h4>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="1-标定数据采集">1. 标定数  据采集<a href="#1-标定数据采集" class="hash-link" aria-label="1. 标定数据采集的直接链接" title="1. 标定数据采集的直接链接">​</a></h5>
<p>不同的距离移动相机或标定板，确保标定板尽可能覆盖图像的FOV范围，移动过程中，棋盘格标定板不要移出画面。稳慢速移动相机或标定板，避免图像因运动导致的模糊。</p>
<h6 class="anchor anchorWithStickyNavbar_LWe7" id="i-启动双目摄像头">i. 启动双目摄像头<a href="#i-启动双目摄像头" class="hash-link" aria-label="i. 启动双目摄像头的直接链接" title="i. 启动双目摄像头的直接链接">​</a></h6>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">source /opt/tros/humble/setup.bash</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ros2 run mipi_cam mipi_cam --ros-args -p device_mode:=&quot;dual&quot; -p out_format:=&quot;nv12&quot; -p dual_combine:=2 -p framerate:=10.0 --log-level warn</span><br></span></code></pre></div></div>
<h6 class="anchor anchorWithStickyNavbar_LWe7" id="ii-ros1与ros2消息转换并保存图像数据集ubuntu2004系统已安装ros1与ros2">ii. ros1与ros2消息转换并保存图像数据集（ubuntu20.04系统，已安装ros1与ros2）<a href="#ii-ros1与ros2消息转换并保存图像数据集ubuntu2004系统已安装ros1与ros2" class="hash-link" aria-label="ii. ros1与ros2消息转换并保存图像数据集（ubuntu20.04系统，已安装ros1与ros2）的直接链接" title="ii. ros1与ros2消息转换并保存图像数据集（ubuntu20.04系统，已安装ros1与ros2）的直接链接">​</a></h6>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">#安装ros1_bridge</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sudo apt update</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sudo apt install ros-foxy-ros1-bridge</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#启动终端</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">source /opt/ros/noetic/setup.bash</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">roscore</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#启动新终端</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">source /opt/ros/noetic/setup.bash</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">source /opt/ros/foxy/setup.bash</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ros2 run ros1_bridge dynamic_bridge --bridge-all-topics=false --bridge-topic sensor_msgs/msg/Image /image_combine_raw</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#启动新终端 记录图像数据（移动摄像头至不同位置）</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">source /opt/ros/noetic/setup.bash</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">rosbag record image_combine_raw</span><br></span></code></pre></div></div>
<h6 class="anchor anchorWithStickyNavbar_LWe7" id="iii-调用标定程序进行标定需指定记录的bag包路径以及标定配置文件的路径">iii. 调用标定程序进行标定（需指定记录的bag包路径以及标定配置文件的路径）<a href="#iii-调用标定程序进行标定需指定记录的bag包路径以及标定配置文件的路径" class="hash-link" aria-label="iii. 调用标定程序进行标定（需指定记录的bag包路径以及标定配置文件的路径）的直接链接" title="iii. 调用标定程序进行标定（需指定记录的bag包路径以及标定配置文件的路径）的直接链接">​</a></h6>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$1=path_to_bag</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$2=path_to_calib_yaml(checkbord.yaml or aprilgrid.yaml)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">rosrun kalibr kalibr_calibrate_cameras --bag $1 --topics /camera/left/image_raw /camera/right/image_raw --models pinhole-radtan pinhole-radtan --target $2 --show-extraction</span><br></span></code></pre></div></div>
<h6 class="anchor anchorWithStickyNavbar_LWe7" id="iv-标定完成后标定文件如下">iv. 标定完成后，标定文件如下<a href="#iv-标定完成后标定文件如下" class="hash-link" aria-label="iv. 标定完成后，标定 文件如下的直接链接" title="iv. 标定完成后，标定文件如下的直接链接">​</a></h6>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">cam0</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">cam_overlaps</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">camera_model</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> pinhole</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">distortion_coeffs</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">-0.30512368344314034</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0.06869074995752597</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">-0.0007768971335288749</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">-0.0018077365618742228</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">distortion_model</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> radtan</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">intrinsics</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">874.7756769752957</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">876.9016366753913</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">988.9147013767086</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">574.9147170323885</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">resolution</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">1920</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1080</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">rostopic</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> /camera/left/image_raw</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">cam1</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">T_cn_cnm1</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0.9998783828690954</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">-0.0007967376839525958</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0.015575130180209843</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">-0.06826569753821157</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0.0008025928358794327</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0.9999996095896897</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">-0.0003696825565397285</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">8.695548926243514e-05</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">-0.01557482955949466</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0.0003821380847083855</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0.9998786319622305</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0.0011080079883866683</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0.0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0.0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0.0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1.0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">cam_overlaps</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">camera_model</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> pinhole</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">distortion_coeffs</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">-0.30647450034075296</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0.06904546877578269</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">-0.0015178028297652521</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">-0.00016199661118514476</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">distortion_model</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> radtan</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">intrinsics</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">875.6405166670517</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">877.1839943792446</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">963.0392879775055</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">519.3086364230766</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">resolution</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">1920</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1080</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">rostopic</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> /camera/right/image_raw</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="353-单目摄像头内参标定用于后续imu与rgb_cam的外参标定若使用模组已提供内参则忽略此步骤">3.5.3 单目摄像头内参标定（用于后续imu与rgb_cam的外参标定，若使用模组已提供内参，则忽略此步骤）<a href="#353-单目摄像头内参标定用于后续imu与rgb_cam的外参标定若使用模组已提供内参则忽略此步骤" class="hash-link" aria-label="3.5.3 单目摄像头内参标定（用于后续imu与rgb_cam的外参标定，若使用模组已提供内参，则忽略此步骤）的直接链接" title="3.5.3 单目摄像头内参标定（用于后续imu与rgb_cam的外参标定，若使用模组已提供内参，则忽略此步骤）的直接链接">​</a></h4>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="1-运行摄像头请根据实际使用的模组运行指令执行">1. 运行摄像头（请根据实际使用的模组运行指令执行）<a href="#1-运行摄像头请根据实际使用的模组运行指令执行" class="hash-link" aria-label="1. 运行摄像头（请根据实际使用的模组运行指令执行）的直接链接" title="1. 运行摄像头（请根据实际使用的模组运行指令执行）的直接链接">​</a></h5>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="2-记录为ros1的bag包ros1与ros2的转换可参考双目内参标定">2. 记录为ros1的bag包（ros1与ros2的转换可参考双目内参标定）<a href="#2-记录为ros1的bag包ros1与ros2的转换可参考双目内参标定" class="hash-link" aria-label="2. 记录为ros1的bag包（ros1与ros2的转换可参考双目内参标定）的直接链接" title="2. 记录为ros1的bag包（ros1与ros2的转换可参考双目内参标定）的直接链接">​</a></h5>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="3-运行标定指令docker镜像中">3. 运行标定指令（docker镜像中）<a href="#3-运行标定指令docker镜像中" class="hash-link" aria-label="3. 运行标定指令（docker镜像中）的直接链接" title="3. 运行标定指令（docker镜像中）的直接链接">​</a></h5>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">#cam.bag记录的bag文件  /image相机话题  pinhole-radtan相机模型  checkborad.yaml标定板描述文件</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">rosrun kalibr kalibr_calibrate_cameras --bag cam.bag --topic /image --model pinhole-radtan --target checkboard.yaml</span><br></span></code></pre></div></div>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="4-标定完成后内容如下distortion_coeffs畸变系数-----intrinsics内参">4. 标定完成后内容如下（distortion_coeffs：畸变系数     intrinsics：内参）<a href="#4-标定完成后内容如下distortion_coeffs畸变系数-----intrinsics内参" class="hash-link" aria-label="4. 标定完成后内容如下（distortion_coeffs：畸变系数     intrinsics：内参）的直接链接" title="4. 标定完成后内容如下（distortion_coeffs：畸变系数     intrinsics：内参）的直接链接">​</a></h5>
<p><img decoding="async" loading="lazy" src="https://rdk-doc.oss-cn-beijing.aliyuncs.com/doc/img/06_Application_case/amr/mipi_int.jpg" alt="" class="img_ev3q"></p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="354-imu参数标定用于imu与rgb_cam的外参标定">3.5.4 IMU参数标定（用于imu与rgb_cam的外参标定）<a href="#354-imu参数标定用于imu与rgb_cam的外参标定" class="hash-link" aria-label="3.5.4 IMU参数标定（用于imu与rgb_cam的外参标定）的直接链接" title="3.5.4 IMU参数标定（用于imu与rgb_cam的外参标定）的直接链接">​</a></h4>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="1-数据采集">1. 数据采集<a href="#1-数据采集" class="hash-link" aria-label="1. 数据采集的直接链接" title="1. 数据采集的直接链接">​</a></h5>
<h6 class="anchor anchorWithStickyNavbar_LWe7" id="i-运行imu">i. 运行imu<a href="#i-运行imu" class="hash-link" aria-label="i. 运行imu的直接链接" title="i. 运行imu的直接链接">​</a></h6>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">source ~/amr_ws/install/setup.bash </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ros2 launch imu_sensor imu_sensor.launch.py</span><br></span></code></pre></div></div>
<h6 class="anchor anchorWithStickyNavbar_LWe7" id="ii-ros1与ros2消息转换并保存图像数据集ubuntu2004系统已安装ros1与ros2-1">ii. ros1与ros2消息转换并保存图像数据集（ubuntu20.04系统，已安装ros1与ros2）<a href="#ii-ros1与ros2消息转换并保存图像数据集ubuntu2004系统已安装ros1与ros2-1" class="hash-link" aria-label="ii. ros1与ros2消息转换并保存图像数据集（ubuntu20.04系统，已安装ros1与ros2）的直接链接" title="ii. ros1与ros2消息转换并保存图像数据集（ubuntu20.04系统，已安装ros1与ros2）的直接链接">​</a></h6>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">#启动终端</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">source /opt/ros/noetic/setup.bash</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">roscore</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#启动新终端</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">source /opt/ros/noetic/setup.bash</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">source /opt/ros/foxy/setup.bash</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ros2 run ros1_bridge dynamic_bridge --bridge-all-topics=false --bridge-topic sensor_msgs/msg/Imu /imu_data</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#启动新终端 记录imu数据（imu需静置30min以上，存储数据）</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">source /opt/ros/noetic/setup.bash</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">rosbag record imu_data</span><br></span></code></pre></div></div>
<h6 class="anchor anchorWithStickyNavbar_LWe7" id="iii-修改脚本文件参数docker环境中">iii. 修改脚本文件参数（docker环境中）<a href="#iii-修改脚本文件参数docker环境中" class="hash-link" aria-label="iii. 修改脚本文件参数（docker环境中）的直接链接" title="iii. 修改脚本文件参数（docker环境中）的直接链接">​</a></h6>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">vim /root/catkin_ws/src/imu_utils/launch/oal.launch</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#imu_topic         imu的topic</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#data_save_path    标定文件的保存路径</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#max_time_min      采集imu数据的时间长短</span><br></span></code></pre></div></div>
<h6 class="anchor anchorWithStickyNavbar_LWe7" id="iv-运行标定脚本待imu-bag数据播放完毕会打印标定结果">iv. 运行标定脚本（待imu bag数据播放完毕会打印标定结果）<a href="#iv-运行标定脚本待imu-bag数据播放完毕会打印标定结果" class="hash-link" aria-label="iv. 运行标定脚本（待imu bag数据播放完毕会打印标定结果）的直接链接" title="iv. 运行标定脚本（待imu bag数据播放完毕会打印标定结果）的直接链接">​</a></h6>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">roslaunch imu_utils oal.lauch</span><br></span></code></pre></div></div>
<p><img decoding="async" loading="lazy" src="https://rdk-doc.oss-cn-beijing.aliyuncs.com/doc/img/06_Application_case/amr/imu_output.jpg" alt="" class="img_ev3q"></p>
<h6 class="anchor anchorWithStickyNavbar_LWe7" id="v播放imu的bag数据">v.播放imu的bag数据<a href="#v播放imu的bag数据" class="hash-link" aria-label="v.播放imu的bag数据的直接链接" title="v.播放imu的bag数据的直接链接">​</a></h6>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">rosbag play imu.bag</span><br></span></code></pre></div></div>
<h6 class="anchor anchorWithStickyNavbar_LWe7" id="vi-修改imu的参数配置文件">vi. 修改IMU的参数配置文件<a href="#vi-修改imu的参数配置文件" class="hash-link" aria-label="vi. 修改IMU的参数配置文件的直接链接" title="vi. 修改IMU的参数配置文件的直接链接">​</a></h6>
<p><img decoding="async" loading="lazy" src="https://rdk-doc.oss-cn-beijing.aliyuncs.com/doc/img/06_Application_case/amr/cal_product.jpg" alt="" class="img_ev3q"></p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># 将上文生成的 BMI088_imu_param.yaml文件重新复制一份，作为备份，后续需要使用，执行如下命令：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cp -r BMI088_imu_param.yaml imu.yaml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">vim imu.yaml</span><br></span></code></pre></div></div>
<p>配置文件打开后，如下图所示：
<img decoding="async" loading="lazy" src="https://rdk-doc.oss-cn-beijing.aliyuncs.com/doc/img/06_Application_case/amr/imu_config.jpg" alt="" class="img_ev3q"></p>
<p>将原始的 BMI088_imu_param.yaml 文件内容重写，修改为如下格式：</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">#Accelerometers</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">accelerometer_noise_density</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">3.0219972277096316e-02</span><span class="token plain">   </span><span class="token comment" style="color:#999988;font-style:italic">#Noise density (continuous-time)对应上述截图中的 Acc-&gt;avg-axis-&gt;acc_n</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">accelerometer_random_walk</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">   </span><span class="token number" style="color:#36acaa">1.9955401630133244e-04</span><span class="token plain">   </span><span class="token comment" style="color:#999988;font-style:italic">#Bias random walk 对应上述截图中的 Acc-&gt;avg-axis-&gt;acc_w</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">#Gyroscopes</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">gyroscope_noise_density</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">     </span><span class="token number" style="color:#36acaa">2.8131368978892658e-03</span><span class="token plain">   </span><span class="token comment" style="color:#999988;font-style:italic">#Noise density (continuous-time)对应上述截图中的 Gyr-&gt;avg-axis-&gt;gyr_n</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">gyroscope_random_walk</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">       </span><span class="token number" style="color:#36acaa">1.9705283783356781e-05</span><span class="token plain">   </span><span class="token comment" style="color:#999988;font-style:italic">#Bias random walk 对应上述截图中的 Gyr-&gt;avg-axis-&gt;gyr_w</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">rostopic</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">                    /imu_data     </span><span class="token comment" style="color:#999988;font-style:italic">#the IMU ROS topic 对应上文生成rosbag格式数据章节数据bag中topic里面的/imu_data</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">update_rate</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">                 </span><span class="token number" style="color:#36acaa">400.0</span><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic">#Hz (for discretization of the values above)对应真实使用的IMU频率</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="355-rgb_cam-imu外参标定用于获取tof_cam-imu的变换">3.5.5 rgb_cam-imu外参标定（用于获取tof_cam-imu的变换）<a href="#355-rgb_cam-imu外参标定用于获取tof_cam-imu的变换" class="hash-link" aria-label="3.5.5 rgb_cam-imu外参标定（用于获取tof_cam-imu的变换）的直接链接" title="3.5.5 rgb_cam-imu外参标定（用于获取tof_cam-imu的变换）的直接链接">​</a></h4>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="1-启动双目摄像头">1. 启动双目摄像头<a href="#1-启动双目摄像头" class="hash-link" aria-label="1. 启动双目摄像头的直接链接" title="1. 启动双目摄像头的直接链接">​</a></h5>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">source /opt/tros/humble/setup.bash</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ros2 run mipi_cam mipi_cam --ros-args -p device_mode:=&quot;dual&quot; -p out_format:=&quot;nv12&quot; -p dual_combine:=2 -p framerate:=10.0 --log-level warn</span><br></span></code></pre></div></div>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="2-启动imu">2. 启动imu<a href="#2-启动imu" class="hash-link" aria-label="2. 启动imu的直接链接" title="2. 启动imu的直接链接">​</a></h5>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">source ~/amr_ws/install/setup.bash </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ros2 launch imu_sensor imu_sensor.launch.py</span><br></span></code></pre></div></div>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="3-ros1与ros2消息转换并保存图像数据集ubuntu2004系统已安装ros1与ros2">3. ros1与ros2消息转换并保存图像数据集（ubuntu20.04系统，已安装ros1与ros2）<a href="#3-ros1与ros2消息转换并保存图像数据集ubuntu2004系统已安装ros1与ros2" class="hash-link" aria-label="3. ros1与ros2消息转换并保存图像数据集（ubuntu20.04系统，已安装ros1与ros2）的直接链接" title="3. ros1与ros2消息转换并保存图像数据集（ubuntu20.04系统，已安装ros1与ros2）的直接链接">​</a></h5>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">#安装ros1_bridge</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sudo apt update</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sudo apt install ros-foxy-ros1-bridge</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#启动终端</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">source /opt/ros/noetic/setup.bash</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">roscore</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#启动新终端</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">source /opt/ros/noetic/setup.bash</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">source /opt/ros/foxy/setup.bash</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ros2 run ros1_bridge dynamic_bridge --bridge-all-topics</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#启动新终端 记录图像数据（移动摄像头至不同位置）</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">source /opt/ros/noetic/setup.bash</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">rosbag record /image_combine_raw /imu_data</span><br></span></code></pre></div></div>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="4-运行标定程序">4. 运行标定程序<a href="#4-运行标定程序" class="hash-link" aria-label="4. 运行标定程序的直接链接" title="4. 运行标定程序的直接链接">​</a></h5>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">rosrun kalibr kalibr_calibrate_imu_camera --bag cam_imu.bag --target april.yaml --cam cam.yaml --imu imu.yaml</span><br></span></code></pre></div></div>
<p><img decoding="async" loading="lazy" src="https://rdk-doc.oss-cn-beijing.aliyuncs.com/doc/img/06_Application_case/amr/imu_cam_cal.jpg" alt="" class="img_ev3q"></p>
<p>标定结束后，查看标定结果(当dJ收敛,降低到0.1以下时,表示标定准确)</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># storage-results-imucam.txt </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">vim storage-results-imucam.txt</span><br></span></code></pre></div></div>
<p>外参结果如下：
<img decoding="async" loading="lazy" src="https://rdk-doc.oss-cn-beijing.aliyuncs.com/doc/img/06_Application_case/amr/imu_cam_trans.jpg" alt="" class="img_ev3q"></p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="356-其他">3.5.6 其他<a href="#356-其他" class="hash-link" aria-label="3.5.6 其他的直接链接" title="3.5.6 其他的直接链接">​</a></h4>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="1-rgb_cam-tof_cam变换由模组给出tof_cam-bask_link变换由设备装配图纸给出">1. rgb_cam-tof_cam变换由模组给出，tof_cam-bask_link变换由设备装配图纸给出。<a href="#1-rgb_cam-tof_cam变换由模组给出tof_cam-bask_link变换由设备装配图纸给出" class="hash-link" aria-label="1. rgb_cam-tof_cam变换由模组给出，tof_cam-bask_link变换由设备装配图纸给出。的直接链接" title="1. rgb_cam-tof_cam变换由模组给出，tof_cam-bask_link变换由设备装配图纸给出。的直接链接">​</a></h5>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="2-tof_cam-imu的变换用于tofslam可通过rgb_cam-imu与rgb_cam-tof_cam变化得到变换矩阵相乘">2. tof_cam-imu的变换（用于tofSLAM），可通过rgb_cam-imu与rgb_cam-tof_cam变化得到（变换矩阵相乘）<a href="#2-tof_cam-imu的变换用于tofslam可通过rgb_cam-imu与rgb_cam-tof_cam变化得到变换矩阵相乘" class="hash-link" aria-label="2. tof_cam-imu的变换（用于tofSLAM），可通过rgb_cam-imu与rgb_cam-tof_cam变化得到（变换矩阵相乘）的直接链接" title="2. tof_cam-imu的变换（用于tofSLAM），可通过rgb_cam-imu与rgb_cam-tof_cam变化得到（变换矩阵相乘）的直接链接">​</a></h5>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="3-bask_link-imu的变换用于tofslam可通过tof_cam-imu与tof_cam-bask_link变化得到变换矩阵相乘">3. bask_link-imu的变换（用于tofSLAM），可通过tof_cam-imu与tof_cam-bask_link变化得到（变换矩阵相乘）<a href="#3-bask_link-imu的变换用于tofslam可通过tof_cam-imu与tof_cam-bask_link变化得到变换矩阵相乘" class="hash-link" aria-label="3. bask_link-imu的变换（用于tofSLAM），可通过tof_cam-imu与tof_cam-bask_link变化得到（变换矩阵相乘）的直接链接" title="3. bask_link-imu的变换（用于tofSLAM）  ，可通过tof_cam-imu与tof_cam-bask_link变化得到（变换矩阵相乘）的直接链接">​</a></h5>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="36-更改配置文件用于tofslam">3.6 更改配置文件（用于tofSLAM）<a href="#36-更改配置文件用于tofslam" class="hash-link" aria-label="3.6 更改配置文件（用于tofSLAM）的直接链接" title="3.6 更改配置文件（用于tofSLAM）的直接链接">​</a></h3>
<p>修改config文件夹下mapping.yaml文件，关注带有说明的参数：</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">YAML</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1.0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">preprocess</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">point_filter_num</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">3</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">#点云下采样</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">lidar_type</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">7</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># 1-AVIA 2-velodyne 3-ouster  4-robosense 5-pandar 6-dtof 7-mtof</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">blind</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0.01</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">common</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">imu_topic</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> /imu </span><span class="token comment" style="color:#999988;font-style:italic">#imu消息名称</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">lid_topic</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> /nebula/mtof_points2 </span><span class="token comment" style="color:#999988;font-style:italic">#点云或雷达消息名称</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">odom_topic</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> /odom  </span><span class="token comment" style="color:#999988;font-style:italic">#里程计消息</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">img_topic</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> /camera/color/image_raw/compressed </span><span class="token comment" style="color:#999988;font-style:italic">#rgb图像消息，可使用压缩消息也可用原图</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">Localization_mode</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#36acaa">False</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">#是否进行定位，否则为建图</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">output_path</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> /home/slam_ws_2/output </span><span class="token comment" style="color:#999988;font-style:italic">#存放建图产物的路径</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">model_path</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> /home/slam_ws_2/output/hfnet.onnx </span><span class="token comment" style="color:#999988;font-style:italic">#指定hfnet模型路径</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">imuhz</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">400</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">#imu的频率</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">mapping</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">extrinsic_est_en</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#36acaa">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">#tof到imu的变化，获取方式请查看标定说明</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">tof2imu_extrinsic_T</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">-0.0039799203111821468</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">-0.027189542185995823831</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">-0.14001955020902342461</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">tof2imu_extrinsic_R</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">-0.993063627638373553564</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">0.052518963674774226572</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">-0.01498737732389914978</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        </span><span class="token number" style="color:#36acaa">-0.033814436045461613632</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">-0.016796566829113524293</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">-0.99928717438014507495</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        </span><span class="token number" style="color:#36acaa">-0.00801808196977665167</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">-0.99847864521832871386</span><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">0.03465425204866725379</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">#bask_link到imu的变化，获取方式请查看标定说明</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">robot2imu_extrinsic_T</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0.12588064308116462841</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0.008162559660163853708</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0.20705414746130172184</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">robot2imu_extrinsic_R</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0.052268869631951098023</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">-0.93852017660344945467</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0.033846560965168889575</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                          </span><span class="token number" style="color:#36acaa">0.93808656435923075909</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">-0.051737213472478319612</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0.015014368436287678477</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                          </span><span class="token number" style="color:#36acaa">0.033019704102458273174</span><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0.01675474093936925155</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0.99931446977489903968</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">delay_time</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0.3</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">odometry</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">wheelmode</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">#0-relativepose 1-velocity</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">max_trans_diff</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0.1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">max_drift_num</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">15</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">surf_res</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0.1</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">#0.4</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">log_print</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#36acaa">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">max_num_iteration</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">5</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># ct_icp</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">icpmodel</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> CT_POINT_TO_PLANE  </span><span class="token comment" style="color:#999988;font-style:italic"># CT_POINT_TO_PLANE  #CT_POINT_TO_PLANE                    # Options: [CT_POINT_TO_PLANE, POINT_TO_PLANE]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">size_voxel_map</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0.1</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">#0.4                         # The voxel size of in the voxel map</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">min_distance_points</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0.05</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">max_num_points_in_voxel</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">20</span><span class="token plain">                 </span><span class="token comment" style="color:#999988;font-style:italic"># The maximum number of points per voxel of the map</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">max_distance</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">50.0</span><span class="token plain">                        </span><span class="token comment" style="color:#999988;font-style:italic"># The threshold of the distance to suppress voxels from the map</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">weight_alpha</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0.9</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">weight_neighborhood</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0.1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">max_dist_to_plane_icp</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0.1</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">#0.3</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">init_num_frames</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">20</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">voxel_neighborhood</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">max_number_neighbors</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">20</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">threshold_voxel_occupancy</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">estimate_normal_from_neighborhood</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#36acaa">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">min_number_neighbors</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">20</span><span class="token plain">                    </span><span class="token comment" style="color:#999988;font-style:italic"># The minimum number of neighbor points to define a valid neighborhood</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">power_planarity</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2.0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">num_closest_neighbors</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">sampling_rate</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1.0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">ratio_of_nonground</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># max_num_residuals: 1000</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">max_num_residuals</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2000</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">min_num_residuals</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">100</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">motion_compensation</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> CONSTANT_VELOCITY </span><span class="token comment" style="color:#999988;font-style:italic">#NONE #CONSTANT_VELOCITY  #CONTINUOUS #NONE, CONSTANT_VELOCITY, ITERATIVE, CONTINUOUS</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">beta_location_consistency</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1.0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">beta_orientation_consistency</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1.0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">beta_constant_velocity</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1.0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">beta_small_velocity</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0.0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">thres_translation_norm</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0.03</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">thres_orientation_norm</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0.05</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">use_ground_constraint</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">#以下为定位功能参数</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">reloc</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">mapfile</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> /home/slam_ws_2/output/final</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">voxel.pcd </span><span class="token comment" style="color:#999988;font-style:italic">#pcd点云地图路径，建图完成的产物</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">reloc_mode</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">#0-scancontext 1-hfnet  2-no   #重定位检测方式，0为点云检测，1为特征点检测</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">scancontext_dbfile</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> /home/slam_ws_2/output/ScanContext.bin </span><span class="token comment" style="color:#999988;font-style:italic">#点云检测模型路径</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">hfnet_dbfile</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> /home/slam_ws_2/output/HFNet.bin </span><span class="token comment" style="color:#999988;font-style:italic">#特征点检测模型路径</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">icp_threshold</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0.03</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="4-功能体验">4. 功能体验<a href="#4-功能体验" class="hash-link" aria-label="4. 功能体验的直接链接" title="4. 功能体验的直接链接">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="41-tofslam建立三维地图">4.1 tofSLAM建立三维地图<a href="#41-tofslam建立三维地图" class="hash-link" aria-label="4.1 tofSLAM建立三维地图的直接链接" title="4.1 tofSLAM建立三维地图的直接链接">​</a></h3>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">#确保完成运行环境准备中提及的各项内容</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#确保建图开始时请确保摄像头可以看到完整的apriltag，且各类话题参数匹配，运行后会在output文件夹下生成map坐标系到apriltag的变换</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">source ~/amr_ws/install/setup.bash</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ros2 run demo demo --ros-args -p build_map:=true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#config配置文件中Localization_mode参数设置为False，且各类话题参数匹配</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">source ~/amr_ws/install/setup.bash</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ros2 run ct_lio ct_lio_eskf</span><br></span></code></pre></div></div>
<p>启动之后需静置3~4秒，让imu初始化成功，随后可移动机器人进行建图，建立完成后关闭程序。运行完成后如 下图所示：
<img decoding="async" loading="lazy" src="https://rdk-doc.oss-cn-beijing.aliyuncs.com/doc/img/06_Application_case/amr/buld_map_output.jpg" alt="" class="img_ev3q">
在mapping.yaml文件中指定的路径会生成以下产物
<img decoding="async" loading="lazy" src="https://rdk-doc.oss-cn-beijing.aliyuncs.com/doc/img/06_Application_case/amr/build_map_product.jpg" alt="" class="img_ev3q"></p>
<p>使用pcl_viewer工具查看点云地图：</p>
<p><img decoding="async" loading="lazy" src="https://rdk-doc.oss-cn-beijing.aliyuncs.com/doc/img/06_Application_case/amr/pcl_viewer.jpg" alt="" class="img_ev3q"></p>
<p>建图效果视频：
Video: <a href="https://www.bilibili.com/video/BV1T4tKeoEsH" target="_blank" rel="noopener noreferrer">https://www.bilibili.com/video/BV1T4tKeoEsH</a></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="42-tofslam定位">4.2 tofSLAM定位<a href="#42-tofslam定位" class="hash-link" aria-label="4.2 tofSLAM定位的直接链接" title="4.2 tofSLAM定位的直接链接">​</a></h3>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">#确保完成运行环境准备中提及的各项内容，config配置文件中Localization_mode参数设置为True，且各类话题参数匹配</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">source ~/amr_ws/install/setup.bash</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ros2 run ct_lio ct_lio_eskf</span><br></span></code></pre></div></div>
<p>启动后，当显示帧序号一直为1，说明还未重定位成功
<img decoding="async" loading="lazy" src="https://rdk-doc.oss-cn-beijing.aliyuncs.com/doc/img/06_Application_case/amr/reloc_fail.jpg" alt="" class="img_ev3q">
当帧序号大于1，说明重定位成功，可开启rviz2查看路径
<img decoding="async" loading="lazy" src="https://rdk-doc.oss-cn-beijing.aliyuncs.com/doc/img/06_Application_case/amr/reloc_success.png" alt="" class="img_ev3q">
<img decoding="async" loading="lazy" src="https://rdk-doc.oss-cn-beijing.aliyuncs.com/doc/img/06_Application_case/amr/path.png" alt="" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="43-三维点云地图转二维栅格地图">4.3 三维点云地图转二维栅格地图<a href="#43-三维点云地图转二维栅格地图" class="hash-link" aria-label="4.3 三维点云地图转二维栅格地图的直接链接" title="4.3 三维点云地图转二维栅格地图的直接链接">​</a></h3>
<p>该功能包为开源功能包，为ros1的功能包，请在已安装ros1的环境下使用，使用方法如下：</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="1-源码下载与编译">1. 源码下载与编译<a href="#1-源码下载与编译" class="hash-link" aria-label="1. 源码下载与编译的直接链接" title="1. 源码下载与编译的直接链接">​</a></h4>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">mkdir -p ~/pcd3d-2d/src &amp;&amp; cd ~/pcd3d-2d/src</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">git clone https://github.com/Hinson-A/pcd2pgm_package</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cd ..</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">source /opt/ros/noetic/setup.bash</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">catkin_make</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="2-运行功能">2. 运行功能<a href="#2-运行功能" class="hash-link" aria-label="2. 运行功能的直接链接" title="2. 运行功能的直接链接">​</a></h4>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">source /opt/ros/noetic/setup.bash</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">source ~/pcd3d-2d/devel/setup.bash</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#将launch文件中的pcd文件路径更换为实际路径</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">roslaunch pcd2pgm run.launch</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="3-保存地图">3. 保存地图<a href="#3-保存地图" class="hash-link" aria-label="3. 保存地图的直接链接" title="3. 保存地图的直接链接">​</a></h4>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">#开启新的终端（需安装ros-noetic-map-server）</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">source /opt/ros/noetic/setup.bash</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">rosrun map_server map_saver</span><br></span></code></pre></div></div>
<p>执行后会在当前路径下生成map.pgm和map.yaml文件，这两个文件可用于nav2，使用时需更换hobot_nav2的maps文件夹中的文件，一般路径为/opt/tros/humble/share/hobot_nav2/maps，点云地图以及栅格地图效果如下：
<img decoding="async" loading="lazy" src="https://rdk-doc.oss-cn-beijing.aliyuncs.com/doc/img/06_Application_case/amr/map.jpg" alt="" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="44-定点位置导航">4.4 定点位置导航<a href="#44-定点位置导航" class="hash-link" aria-label="4.4 定点位置导航的直接链接" title="4.4 定点位置导航的直接链接">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="1-启动tof摄像头激光雷达底盘imu">1. 启动tof摄像头，激光雷达，底盘，imu<a href="#1-启动tof摄像头激光雷达底盘imu" class="hash-link" aria-label="1. 启动tof摄像头，激光雷达，底盘，imu的直接链接" title="1. 启动tof摄像头，激光雷达，底盘，imu的直接链接">​</a></h4>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">#各传感器启动请根据实际的设备运行相应指令，此处仅给出imu启动指令</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">source /opt/tros/humble/setup.bash</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ros2 launch imu_sensor imu_sensor.launch.py</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#打开新终端，启动点云过滤</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ros2 run point_cloud_processing point_cloud_sparsification</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="2-启动nav2导航功能">2. 启动nav2导航功能<a href="#2-启动nav2导航功能" class="hash-link" aria-label="2. 启动nav2导航功能的直接链接" title="2. 启动nav2导航功能的直接链接">​</a></h4>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">source /opt/tros/humble/setup.bash</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ros2 launch hobot_nav2 hobot_nav2_bringup.launch.py</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="3-启动定点位置导航功能确保启动后摄像头图像中能看到完整的apriltag">3. 启动定点位置导航功能（确保启动后摄像头图像中能看到完整的AprilTag）<a href="#3-启动定点位置导航功能确保启动后摄像头图像中能看到完整的apriltag" class="hash-link" aria-label="3. 启动定点位置导航功能（确保启动后摄像头图像中能看到完整的AprilTag）的直接链接" title="3. 启动定点位置导航功能（确保启动后摄像头图像中能看到完整的AprilTag）的直接链接">​</a></h4>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">source ~/amr_ws/install/setup.bash</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ros2 run demo demo</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="4-pc端打开rviz查看导航效果">4. PC端打开rviz查看导航效果<a href="#4-pc端打开rviz查看导航效果" class="hash-link" aria-label="4. PC端打开rviz查看导航效果的直接链接" title="4. PC端打开rviz查看导航效果的直接链接">​</a></h4>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ros2 launch nav2_bringup rviz_launch.py</span><br></span></code></pre></div></div>
<p>Video: <a href="https://www.bilibili.com/video/BV1t4tKeoEgh" target="_blank" rel="noopener noreferrer">https://www.bilibili.com/video/BV1t4tKeoEgh</a></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="45-目标检测与分割">4.5 目标检测与分割<a href="#45-目标检测与分割" class="hash-link" aria-label="4.5 目标检测与分割的直接链接" title="4.5 目标检测与分割的直接链接">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="1-复制该launch脚本到板端更改对应参数">1. 复制该launch脚本到板端，更改对应参数：<a href="#1-复制该launch脚本到板端更改对应参数" class="hash-link" aria-label="1. 复制该launch脚本到板端，更改对应参数：的直接链接" title="1. 复制该launch脚本到板端，更改对应参数：的直接链接">​</a></h4>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">import os</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from launch import LaunchDescription</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from launch_ros.actions import Node</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from launch.actions import IncludeLaunchDescription</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from launch.launch_description_sources import PythonLaunchDescriptionSource, AnyLaunchDescriptionSource</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from ament_index_python import get_package_share_directory</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">def generate_launch_description():</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    #将tof摄像头发布的bgr8图像编码为jpeg，用于web端展示</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    bgr2jpeg =  Node(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        package=&#x27;hobot_codec&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        executable=&#x27;hobot_codec_republish&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        output=&#x27;screen&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        parameters=[{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &#x27;in_mode&#x27;: &#x27;ros&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &#x27;in_format&#x27;: &#x27;bgr8&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &#x27;out_mode&#x27;: &#x27;ros&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &#x27;out_format&#x27;: &#x27;jpeg&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &#x27;sub_topic&#x27;: &#x27;/nebula200/stof_rgb/image_raw&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &#x27;dump_output&#x27;: False</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        arguments=[&#x27;--ros-args&#x27;, &#x27;--log-level&#x27;, &#x27;warn&#x27;]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    #将jpeg图像解码为nv12，用于yolov8推理</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    jpeg2nv12 =  Node(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        package=&#x27;hobot_codec&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        executable=&#x27;hobot_codec_republish&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        output=&#x27;screen&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        parameters=[{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &#x27;in_mode&#x27;: &#x27;ros&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &#x27;in_format&#x27;: &#x27;jpeg&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &#x27;out_mode&#x27;: &#x27;ros&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &#x27;out_format&#x27;: &#x27;nv12&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &#x27;channel&#x27;: 1,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &#x27;sub_topic&#x27;: &#x27;/image_raw/compressed&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &#x27;dump_output&#x27;: False,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &#x27;pub_topic&#x27;: &#x27;/image&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        arguments=[&#x27;--ros-args&#x27;, &#x27;--log-level&#x27;, &#x27;warn&#x27;]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    #运行yolov8检测分割</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    yolov8 =  Node(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        package=&#x27;dnn_node_example&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        executable=&#x27;example&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        output=&#x27;screen&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        parameters=[{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &#x27;feed_type&#x27;: 1,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &#x27;is_shared_mem_sub&#x27;: 0,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &#x27;config_file&#x27;: &#x27;config/yolov8segworkconfig.json&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        arguments=[&#x27;--ros-args&#x27;, &#x27;--log-level&#x27;, &#x27;warn&#x27;]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    #启动web端展示功能</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    web_node = IncludeLaunchDescription(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        PythonLaunchDescriptionSource(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            os.path.join(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                get_package_share_directory(&#x27;websocket&#x27;),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                &#x27;launch/websocket.launch.py&#x27;)),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        launch_arguments={</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &#x27;websocket_image_topic&#x27;: &#x27;/image_raw/compressed&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &#x27;websocket_image_type&#x27;: &#x27;mjpeg&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &#x27;websocket_smart_topic&#x27;: &#x27;/hobot_dnn_detection&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }.items()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return LaunchDescription([</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        bgr2jpeg,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        jpeg2nv12,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        yolov8,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        web_node</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ])</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="2-将命令中path_of_launch_file更换为自己的launch文件路径运行命令">2. 将命令中path_of_launch_file更换为自己的launch文件路径，运行命令<a href="#2-将命令中path_of_launch_file更换为自己的launch文件路径运行命令" class="hash-link" aria-label="2. 将命令中path_of_launch_file更换为自己的launch文件路径，运行命令的直接链接" title="2. 将命令中path_of_launch_file更换为自己的launch文件路径，运行命令的直接链接">​</a></h4>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">source /opt/tros/humble/setup.bash</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ros2 launch &lt;path_of_launch_file&gt;</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="3-同一局域网下的pc打开浏览器在网址处输入板子ip8000即可查看识别效果">3. 同一局域网下的PC打开浏览器，在网址处输入：板子ip:8000，即可查看识别效果<a href="#3-同一局域网下的pc打开浏览器在网址处输入板子ip8000即可查看识别效果" class="hash-link" aria-label="3. 同一局域网下的PC打开浏览器，在网址处输入：板子ip:8000，即可查看识别效果的直接链接" title="3. 同一局域网下的PC打开浏览器，在网址处输入：板子ip:8000，即可查看识别效果的直接链接">​</a></h4>
<p><img decoding="async" loading="lazy" src="https://rdk-doc.oss-cn-beijing.aliyuncs.com/doc/img/06_Application_case/amr/yolov8seg_web.jpg" alt="" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="5-代码介绍">5. 代码介绍<a href="#5-代码介绍" class="hash-link" aria-label="5. 代码介绍的直接链接" title="5. 代码介绍的直接链接">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="51-tofslam">5.1 tofSLAM<a href="#51-tofslam" class="hash-link" aria-label="5.1 tofSLAM的直接链 接" title="5.1 tofSLAM的直接链接">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="511-代码仓库">5.1.1 代码仓库：<a href="#511-代码仓库" class="hash-link" aria-label="5.1.1 代码仓库：的直接链接" title="5.1.1 代码仓库：的直接链接">​</a></h4>
<p><a href="https://github.com/wunuo1/TofSLAM_ros2" target="_blank" rel="noopener noreferrer">https://github.com/wunuo1/TofSLAM_ros2</a></p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="512-工程框架逻辑">5.1.2 工程框架逻辑：<a href="#512-工程框架逻辑" class="hash-link" aria-label="5.1.2 工程框架逻辑：的直接链接" title="5.1.2 工程框架逻辑：的直接链接">​</a></h4>
<p><img decoding="async" loading="lazy" src="https://rdk-doc.oss-cn-beijing.aliyuncs.com/doc/img/06_Application_case/amr/tofslam_framework.jpg" alt="" class="img_ev3q"></p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="513-详细说明">5.1.3 详细说明：<a href="#513-详细说明" class="hash-link" aria-label="5.1.3 详细说明：的直接链接" title="5.1.3 详细说明：的直接链接">​</a></h4>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="1-eskferror-state-kalman-filter">1. ESKF（Error State Kalman Filter）<a href="#1-eskferror-state-kalman-filter" class="hash-link" aria-label="1. ESKF（Error State Kalman Filter）的直接链接" title="1. ESKF（Error State Kalman Filter）的直接链接">​</a></h5>
<p>误差状态卡尔曼滤波器，是一种传感器融合的算法。它基于经典的卡尔曼滤波器（Kalman Filter, KF）原理，并对其进行改进，以更好地处理非线性系统中的误差传播</p>
<p><em>状态量</em>：p、R、v、bg、ba、g</p>
<p><em>预测模型</em>：IMU
<img decoding="async" loading="lazy" src="https://rdk-doc.oss-cn-beijing.aliyuncs.com/doc/img/06_Application_case/amr/imu_model.png" alt="" class="img_ev3q"></p>
<p><em>观测（更新）模型 1</em>：底盘轮速&amp;底盘imu通过EKF计算的位姿——松耦合（R、p更新）</p>
<p><em>观测（更新）模型 2</em>：点云ICP计算得到的位姿——松耦合（R、p更新）
<img decoding="async" loading="lazy" src="https://rdk-doc.oss-cn-beijing.aliyuncs.com/doc/img/06_Application_case/amr/model2.png" alt="" class="img_ev3q"></p>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="2-imu静态初始化">2. IMU静态初始化<a href="#2-imu静态初始化" class="hash-link" aria-label="2. IMU静态初始化的直接链接" title="2. IMU静态初始化的直接链接">​</a></h5>
<p>imu初始化保持静态，根据加速度计估计出重力方向、陀螺仪零偏、加速度计零偏，设置初始位姿为原点，初始速度为0</p>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="3-地图格式哈系体素地图">3. 地图格式：哈系体素地图<a href="#3-地图格式哈系体素地图" class="hash-link" aria-label="3. 地图格式：哈系体素地图的直接链接" title="3. 地图格式：哈系体素地图的直接链接">​</a></h5>
<p>用一个哈系列表来保存体素地图，每个体素（0.1×0.1×0.1）里面保存若干个点，点与点之间保持一定距离（0.05）。
<img decoding="async" loading="lazy" src="https://rdk-doc.oss-cn-beijing.aliyuncs.com/doc/img/06_Application_case/amr/voxel.png" alt="" class="img_ev3q"></p>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="4-点云icp">4. 点云ICP<a href="#4-点云icp" class="hash-link" aria-label="4. 点云ICP的直接链接" title="4. 点云ICP的直接链接">​</a></h5>
<h6 class="anchor anchorWithStickyNavbar_LWe7" id="1-关键点提取对每一帧的点云采用gridsample的方法进行降采样提取关键点">1. 关键点提取：对每一帧的点云采用gridsample的方法进行降采样，提取关键点。<a href="#1-关键点提取对每一帧的点云采用gridsample的方法进行降采样提取关键点" class="hash-link" aria-label="1. 关键点提取：对每一帧的点云采用gridsample的方法进行降采样，提取关键点。的直接链接" title="1. 关键点提取：对每一帧的点云采用gridsample的方法进行降采样，提取关键点。的直接链接">​</a></h6>
<p>对于每个关键点：</p>
<ol>
<li>寻找最近邻：通过voxelmap，在相邻的voxel中寻找距离最近的N个点qi作为邻居点。</li>
<li>计算邻居点的法向n、协方差矩阵和平滑度权重a</li>
<li>计算关键点到邻居点所在平面的距离，满足距离小于阈值的点对，加入icp优化。
<img decoding="async" loading="lazy" src="https://rdk-doc.oss-cn-beijing.aliyuncs.com/doc/img/06_Application_case/amr/point_icp.jpg" alt="" class="img_ev3q"></li>
</ol>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="5-ct_icp算法ct-icp-real-time-elastic-lidar-odometry-with-loop-closure">5. CT_ICP算法（CT-ICP: Real-time Elastic LiDAR Odometry with Loop Closure）<a href="#5-ct_icp算法ct-icp-real-time-elastic-lidar-odometry-with-loop-closure" class="hash-link" aria-label="5. CT_ICP算法（CT-ICP: Real-time Elastic LiDAR Odometry with Loop Closure）的直接链接" title="5. CT_ICP算法（CT-ICP: Real-time Elastic LiDAR Odometry with Loop Closure）的直接链接">​</a></h5>
<h6 class="anchor anchorWithStickyNavbar_LWe7" id="1-前端位姿估计">1. 前端位姿估计<a href="#1-前端位姿估计" class="hash-link" aria-label="1. 前端位姿估计的直接链接" title="1. 前端位姿估计的直接链接">​</a></h6>
<p>CTICP算法前端部分整体框架对于每一帧使用了两个pose来描述：
<img decoding="async" loading="lazy" src="https://rdk-doc.oss-cn-beijing.aliyuncs.com/doc/img/06_Application_case/amr/ct_icp_pose.jpg" alt="" class="img_ev3q">
不需要再提前对每一帧点云单独去运动畸变了，而是直接在优化过程中去畸变，该算法对于高速运动更鲁棒。</p>
<p>优化方程：
<img decoding="async" loading="lazy" src="https://rdk-doc.oss-cn-beijing.aliyuncs.com/doc/img/06_Application_case/amr/equation.jpg" alt="" class="img_ev3q"></p>
<h6 class="anchor anchorWithStickyNavbar_LWe7" id="2-后端回环优化">2. 后端回环优化<a href="#2-后端回环优化" class="hash-link" aria-label="2. 后端回环优化的直接链接" title="2. 后端回环优化的直接链接">​</a></h6>
<p>每次取Nmap帧scan拼成点云，把每个点插入到一个2D高程网格中。再由2D高程网格生成2D高程图，每个像素对应Z轴最大的点。对2D高程图进行特征提取，提取的特征与2D高程网格一起随着关键帧保存在内存中。当每次提取完高程图特征后都与内存中的特征进行匹配；对匹配成功的高程图对先用Ransac估计一次2D变换矩阵，根据内点个数来验证匹配可信度；再用2D变换矩阵作为初值，对2D高程网格中的点云进行ICP，最终为成功匹配的关键帧添加一条边，使用g2o进行姿态图优化。（该方法只适用于平面运动）
<img decoding="async" loading="lazy" src="https://rdk-doc.oss-cn-beijing.aliyuncs.com/doc/img/06_Application_case/amr/loop_optimization.jpg" alt="" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="52-双目深度">5.2 双目深度<a href="#52-双目深度" class="hash-link" aria-label="5.2 双目深度的直接链接" title="5.2 双目深度的直接链接">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="521-代码仓库">5.2.1 代码仓库:<a href="#521-代码仓库" class="hash-link" aria-label="5.2.1 代码仓库:的直接链接" title="5.2.1 代码仓库:的直接链接">​</a></h4>
<p><a href="https://github.com/D-Robotics/hobot_stereonet.git" target="_blank" rel="noopener noreferrer">https://github.com/D-Robotics/hobot_stereonet.git</a></p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="522-工程逻辑框架">5.2.2 工程逻辑框架:<a href="#522-工程逻辑框架" class="hash-link" aria-label="5.2.2 工程逻辑框架:的直接链接" title="5.2.2 工程逻辑框架:的直接链接">​</a></h4>
<p><img decoding="async" loading="lazy" src="https://rdk-doc.oss-cn-beijing.aliyuncs.com/doc/img/06_Application_case/amr/stereonet_framework.jpg" alt="" class="img_ev3q"></p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="523-详细说明">5.2.3 详细说明：<a href="#523-详细说明" class="hash-link" aria-label="5.2.3 详细说明：的直接链接" title="5.2.3 详细说明：的直接链接">​</a></h4>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="1-双目深度感知原理">1. 双目深度感知原理：<a href="#1-双目深度感知原理" class="hash-link" aria-label="1. 双目深度感知原理：的直接链接" title="1. 双目深度感知原理：的直接链接">​</a></h5>
<p><img decoding="async" loading="lazy" src="https://rdk-doc.oss-cn-beijing.aliyuncs.com/doc/img/06_Application_case/amr/perception_principle.jpg" alt="" class="img_ev3q"></p>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="2-双目立体匹配算法步骤">2. 双目立体匹配算法步骤:<a href="#2-双目立体匹配算法步骤" class="hash-link" aria-label="2. 双目立体匹配算法步骤:的直接链接" title="2. 双目立体匹配算法步骤:的直接链接">​</a></h5>
<p><img decoding="async" loading="lazy" src="https://rdk-doc.oss-cn-beijing.aliyuncs.com/doc/img/06_Application_case/amr/stereonet_step.jpg" alt="" class="img_ev3q"></p>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="3-模型介绍">3. 模型介绍<a href="#3-模型介绍" class="hash-link" aria-label="3. 模型介绍的直接链接" title="3. 模型介绍的直接链接">​</a></h5>
<ol>
<li>Backbone：MixVarGENet+UNet。针对X5优化的高效backbone+UNet恢复细节；</li>
<li>Cost Volume：Groupwise Correlation Cost Volume。计算左右图特征相关性构建cost volume；</li>
<li>Cost Aggregation：UNet。通过UNet对cost volume进行aggregation，更精细化的整合cost volume；</li>
<li>Refinement：GRU。采用GRU模块带来边缘细节的性能提升。</li>
<li>Spatial Upsampling：使用Conv代替Unfold操作进行张量的切分，通过加权组合来生成完整分辨率的视差图</li>
</ol>
<p><img decoding="async" loading="lazy" src="https://rdk-doc.oss-cn-beijing.aliyuncs.com/doc/img/06_Application_case/amr/stereonet_model.jpg" alt="" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="53-目标检测与分割">5.3 目标检测与分割<a href="#53-目标检测与分割" class="hash-link" aria-label="5.3 目标检测与分割的直接链接" title="5.3 目标检测与分割的直接链接">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="531-代码仓库">5.3.1 代码仓库:<a href="#531-代码仓库" class="hash-link" aria-label="5.3.1 代码仓库:的直接链接" title="5.3.1 代码仓库:的直接链接">​</a></h4>
<p><a href="https://github.com/D-Robotics/hobot_dnn/tree/" target="_blank" rel="noopener noreferrer">https://github.com/D-Robotics/hobot_dnn/tree/</a></p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="532-工程逻辑框架">5.3.2 工程逻辑框架:<a href="#532-工程逻辑框架" class="hash-link" aria-label="5.3.2 工程逻辑框架:的直接链接" title="5.3.2 工程逻辑框架:的直接链接">​</a></h4>
<p><img decoding="async" loading="lazy" src="https://rdk-doc.oss-cn-beijing.aliyuncs.com/doc/img/06_Application_case/amr/detection_framework.jpg" alt="" class="img_ev3q"></p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="533-详细说明">5.3.3 详细说明：<a href="#533-详细说明" class="hash-link" aria-label="5.3.3 详细说明：的直接链接" title="5.3.3 详细说明：的直接链接">​</a></h4>
<ol>
<li>使用模型为官版yolov8-seg，源码仓库链接<a href="https://github.com/ultralytics/ultralytics" target="_blank" rel="noopener noreferrer">https://github.com/ultralytics/ultralytics</a></li>
<li>编解码功能使用RDK X5上的硬件单元加速，大幅降低CPU占用的同时提升格式转换效率</li>
<li>工程使用代码为tros的hobot_dnn_example，除yolov8-seg外，同时支持多种模型的推理使用</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="54-导航以及任务调度">5.4 导航以及任务调度<a href="#54-导 航以及任务调度" class="hash-link" aria-label="5.4 导航以及任务调度的直接链接" title="5.4 导航以及任务调度的直接链接">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="541-代码仓库">5.4.1 代码仓库:<a href="#541-代码仓库" class="hash-link" aria-label="5.4.1 代码仓库:的直接链接" title="5.4.1 代码仓库:的直接链接">​</a></h4>
<p><a href="https://github.com/wunuo1/pose_setter.git" target="_blank" rel="noopener noreferrer">https://github.com/wunuo1/pose_setter.git</a></p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="542-工程逻辑框架">5.4.2 工程逻辑框架:<a href="#542-工程逻辑框架" class="hash-link" aria-label="5.4.2 工程逻辑框架:的直接链接" title="5.4.2 工程逻辑框架:的直接链接">​</a></h4>
<p><img decoding="async" loading="lazy" src="https://rdk-doc.oss-cn-beijing.aliyuncs.com/doc/img/06_Application_case/amr/pose_setter.jpg" alt="" class="img_ev3q"></p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="543-详细说明">5.4.3 详细说明：<a href="#543-详细说明" class="hash-link" aria-label="5.4.3 详细说明：的直接链接" title="5.4.3 详细说明：的直接链接">​</a></h4>
<ol>
<li>程序在启动进行AprilTag检测，检测成功后，会缓存十帧的变换并取平均值。以此得到rgb到AprilTag的变换，读取建图时记录的map到AprilTag的变换，计算出rgb到map的变换。而前期的标定过程中，已经可以计算出rgb到robot的变换，所以可以得到robot到map的变换，以此发布机器人在map坐标系下的初始位置。</li>
<li>初始位置发布完成之后，激活线程开始请求导航到目标位置，若请求被拒绝，则说明姿态初始化失败，重新发布初始位置。</li>
<li>请求导航到多个目标位置，只有前一个目标位置导航成功之后，才会激活线程进行下一个请求</li>
<li>当初始位置之后，会进行AprilTag的检测，并重复循环进行之前的步骤</li>
<li>nav2导  航插件中，在障碍物层增加了点云信息做，用于避开高度低于激光雷达的障碍物，但因原生点云数据会有噪声，并且点云数据量过多，所以增加点云筛选节点对点云进行稀疏化以及过滤。</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="6-附件">6. 附件<a href="#6-附件" class="hash-link" aria-label="6. 附件的直接链接" title="6. 附件的直接链接">​</a></h2>
<p>链接：<a href="https://pan.baidu.com/s/14A4mqJvqzfp-MZaQkGpvLg?pwd=8VpL" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/14A4mqJvqzfp-MZaQkGpvLg?pwd=8VpL</a>
提取码：8VpL</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"></div><div class="col lastUpdated_JAkA"><span class="theme-last-updated">最后<!-- -->于 <b><time datetime="2025-10-27T03:14:13.000Z" itemprop="dateModified">2025年10月27日</time></b> <!-- -->更新</span></div></div></footer></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="文件选项卡"><a class="pagination-nav__link pagination-nav__link--prev" href="/rdk_doc/Application_case/line_follower"><div class="pagination-nav__sublabel">上一页</div><div class="pagination-nav__label">6.1 深度学习巡线小车</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/rdk_doc/Advanced_development"><div class="pagination-nav__sublabel">下一页</div><div class="pagination-nav__label">7. 进阶开发</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#1--样例介绍" class="table-of-contents__link toc-highlight">1.  样例介绍</a><ul><li><a href="#11-外观效果" class="table-of-contents__link toc-highlight">1.1 外观效果</a></li><li><a href="#12-功能框架" class="table-of-contents__link toc-highlight">1.2 功能框架</a></li></ul></li><li><a href="#2-样例组装" class="table-of-contents__link toc-highlight">2. 样例组装</a><ul><li><a href="#21-组件清单" class="table-of-contents__link toc-highlight">2.1 组件清单</a></li><li><a href="#22-组装步骤讲解" class="table-of-contents__link toc-highlight">2.2 组装步骤讲解</a><ul><li><a href="#221-底盘上装安装" class="table-of-contents__link toc-highlight">2.2.1 底盘上装安装</a></li><li><a href="#222-rdk-x5接线" class="table-of-contents__link toc-highlight">2.2.2 RDK X5接线</a></li><li><a href="#223-盖板安装" class="table-of-contents__link toc-highlight">2.2.3 盖板安装</a></li><li><a href="#224-激光雷达模块接入" class="table-of-contents__link toc-highlight">2.2.4 激光雷达模块接入</a></li><li><a href="#225-摄像头安装" class="table-of-contents__link toc-highlight">2.2.5 摄像头安装</a><ul><li><a href="#1-tof摄像头安装" class="table-of-contents__link toc-highlight">1. tof摄像头安装</a></li><li><a href="#2-双目摄像头安装" class="table-of-contents__link toc-highlight">2. 双目摄像头安装</a></li></ul></li><li><a href="#226-电源说明" class="table-of-contents__link toc-highlight">2.2.6 电源说明</a></li><li><a href="#227-其他部件安装" class="table-of-contents__link toc-highlight">2.2.7 其他部件安装</a></li></ul></li></ul></li><li><a href="#3-运行环境准备" class="table-of-contents__link toc-highlight">3. 运行环境准备</a><ul><li><a href="#31-传感器检查" class="table-of-contents__link toc-highlight">3.1 传感器检查</a><ul><li><a href="#311-双目摄像头" class="table-of-contents__link toc-highlight">3.1.1 双目摄像头</a></li><li><a href="#312-雷达" class="table-of-contents__link toc-highlight">3.1.2 雷达</a></li><li><a href="#313-底盘" class="table-of-contents__link toc-highlight">3.1.3 底盘</a></li><li><a href="#314-imu" class="table-of-contents__link toc-highlight">3.1.4 IMU</a></li></ul></li><li><a href="#32-功能安装" class="table-of-contents__link toc-highlight">3.2 功能  安装</a></li><li><a href="#33-源码获取无安装包的功能需编译源码" class="table-of-contents__link toc-highlight">3.3 源码获取（无安装包的功能，需编译源码）</a></li><li><a href="#34-代码编译" class="table-of-contents__link toc-highlight">3.4 代码编译</a></li><li><a href="#35-传感器标定" class="table-of-contents__link toc-highlight">3.5 传感器标定</a><ul><li><a href="#351-标定前准备" class="table-of-contents__link toc-highlight">3.5.1 标定前准备</a><ul><li><a href="#1-标定环境准备标定工具为kalibr此处提供包含kalibr以及其他标定脚本的dokcer" class="table-of-contents__link toc-highlight">1. 标定环境准备（标定工具为kalibr，此处提供包含kalibr以及其他标定脚本的dokcer）</a></li><li><a href="#2-准备标定板并配置参数" class="table-of-contents__link toc-highlight">2. 准备标定板并配置参数</a></li></ul></li><li><a href="#352-双目摄像头内参标定双目深度算法使用" class="table-of-contents__link toc-highlight">3.5.2 双目摄像头内参标定（双目深度算法使用）</a><ul><li><a href="#1-标定数据采集" class="table-of-contents__link toc-highlight">1. 标定数据采集</a></li></ul></li><li><a href="#353-单目摄像头内参标定用于后续imu与rgb_cam的外参标定若使用模组已提供内参则忽略此步骤" class="table-of-contents__link toc-highlight">3.5.3 单目摄像头内参标定（用于后续imu与rgb_cam的外参标定，若使用模组已提供内参，则忽略此步骤）</a><ul><li><a href="#1-运行摄像头请根据实际使用的模组运行指令执行" class="table-of-contents__link toc-highlight">1. 运行摄像头（请根据实际使用的模组运行指令执行）</a></li><li><a href="#2-记录为ros1的bag包ros1与ros2的转换可参考双目内参标定" class="table-of-contents__link toc-highlight">2. 记录为ros1的bag包（ros1与ros2的转换可参考双目内参标定）</a></li><li><a href="#3-运行标定指令docker镜像  中" class="table-of-contents__link toc-highlight">3. 运行标定指令（docker镜像中）</a></li><li><a href="#4-标定完成后内容如下distortion_coeffs畸变系数-----intrinsics内参" class="table-of-contents__link toc-highlight">4. 标定完成后内容如下（distortion_coeffs：畸变系数     intrinsics：内参）</a></li></ul></li><li><a href="#354-imu参数标定用于imu与rgb_cam的外参标定" class="table-of-contents__link toc-highlight">3.5.4 IMU参数标定（用于imu与rgb_cam的外参标定）</a><ul><li><a href="#1-数据采集" class="table-of-contents__link toc-highlight">1. 数据采集</a></li></ul></li><li><a href="#355-rgb_cam-imu外参标定用于获取tof_cam-imu的变换" class="table-of-contents__link toc-highlight">3.5.5 rgb_cam-imu外参标定（用于获取tof_cam-imu的变换）</a><ul><li><a href="#1-启动双目摄像头" class="table-of-contents__link toc-highlight">1. 启动双目摄像头</a></li><li><a href="#2-启动imu" class="table-of-contents__link toc-highlight">2. 启动imu</a></li><li><a href="#3-ros1与ros2消息转换并保存图像数据集ubuntu2004系统已安装ros1与ros2" class="table-of-contents__link toc-highlight">3. ros1与ros2消息转换并保存图像数据集（ubuntu20.04系统，已安装ros1与ros2）</a></li><li><a href="#4-运行标定程序" class="table-of-contents__link toc-highlight">4. 运行标定程序</a></li></ul></li><li><a href="#356-其他" class="table-of-contents__link toc-highlight">3.5.6 其他</a><ul><li><a href="#1-rgb_cam-tof_cam变换由模组给出tof_cam-bask_link变换由设备装配图纸给出" class="table-of-contents__link toc-highlight">1. rgb_cam-tof_cam变换由模组给出，tof_cam-bask_link变换由设备装配图纸给出。</a></li><li><a href="#2-tof_cam-imu的变换用于tofslam可通过rgb_cam-imu与rgb_cam-tof_cam变化得到变换矩阵相乘" class="table-of-contents__link toc-highlight">2. tof_cam-imu的变换（用于tofSLAM），可通过rgb_cam-imu与rgb_cam-tof_cam变化得到（变换矩阵相乘）</a></li><li><a href="#3-bask_link-imu的变换用于tofslam可通过tof_cam-imu与tof_cam-bask_link变化得到变换矩阵相乘" class="table-of-contents__link toc-highlight">3. bask_link-imu的变换（用于tofSLAM），可通过tof_cam-imu与tof_cam-bask_link变化得到（变换矩阵相乘）</a></li></ul></li></ul></li><li><a href="#36-更改配置文件用于tofslam" class="table-of-contents__link toc-highlight">3.6 更改配置文件（用于tofSLAM）</a></li></ul></li><li><a href="#4-功能体验" class="table-of-contents__link toc-highlight">4. 功能体验</a><ul><li><a href="#41-tofslam建立三维地图" class="table-of-contents__link toc-highlight">4.1 tofSLAM建立三维地图</a></li><li><a href="#42-tofslam定位" class="table-of-contents__link toc-highlight">4.2 tofSLAM定位</a></li><li><a href="#43-三维点云地图转二维栅格地图" class="table-of-contents__link toc-highlight">4.3 三维点云地图转二维栅格地图</a><ul><li><a href="#1-源码下载与编译" class="table-of-contents__link toc-highlight">1. 源码下载与编译</a></li><li><a href="#2-运行功能" class="table-of-contents__link toc-highlight">2. 运行功能</a></li><li><a href="#3-保存地图" class="table-of-contents__link toc-highlight">3. 保存地图</a></li></ul></li><li><a href="#44-定点位置导航" class="table-of-contents__link toc-highlight">4.4 定点位置导航</a><ul><li><a href="#1-启动tof摄像头激光雷达底盘imu" class="table-of-contents__link toc-highlight">1. 启动tof摄像头，激光雷达，底盘，imu</a></li><li><a href="#2-启动nav2导航功能" class="table-of-contents__link toc-highlight">2. 启动nav2导航功能</a></li><li><a href="#3-启动定点位置导航功能确保启动后摄像头图像中能看到完整的apriltag" class="table-of-contents__link toc-highlight">3. 启动定点位置导航功能（确保启动后摄像头图像中能看到完整的AprilTag）</a></li><li><a href="#4-pc端打开rviz查看导航效果" class="table-of-contents__link toc-highlight">4. PC端打开rviz查看导航效果</a></li></ul></li><li><a href="#45-目标检测与分割" class="table-of-contents__link toc-highlight">4.5 目标检测与分割</a><ul><li><a href="#1-复制该launch脚本到板端更改对应参数" class="table-of-contents__link toc-highlight">1. 复制该launch脚本到板端，更改对应参数：</a></li><li><a href="#2-将命令中path_of_launch_file更换为自己的launch文件路径运行命令" class="table-of-contents__link toc-highlight">2. 将命令中path_of_launch_file更换为自己的launch文件路径，运行命令</a></li><li><a href="#3-同一局域网下的pc打开浏览器在网址处输入板子ip8000即可查看识别效果" class="table-of-contents__link toc-highlight">3. 同一局域网下的PC打开浏览器，在网址处输入：板子ip:8000，即可查看识别效果</a></li></ul></li></ul></li><li><a href="#5-代码介绍" class="table-of-contents__link toc-highlight">5. 代码介绍</a><ul><li><a href="#51-tofslam" class="table-of-contents__link toc-highlight">5.1 tofSLAM</a><ul><li><a href="#511-代码仓库" class="table-of-contents__link toc-highlight">5.1.1 代码仓库：</a></li><li><a href="#512-工程框架逻辑" class="table-of-contents__link toc-highlight">5.1.2 工程框架逻辑：</a></li><li><a href="#513-详细说明" class="table-of-contents__link toc-highlight">5.1.3 详细说明：</a><ul><li><a href="#1-eskferror-state-kalman-filter" class="table-of-contents__link toc-highlight">1. ESKF（Error State Kalman Filter）</a></li><li><a href="#2-imu静态初始化" class="table-of-contents__link toc-highlight">2. IMU静态初始化</a></li><li><a href="#3-地图格式哈系体素地图" class="table-of-contents__link toc-highlight">3. 地图格式：哈系体素地图</a></li><li><a href="#4-点云icp" class="table-of-contents__link toc-highlight">4. 点云ICP</a></li><li><a href="#5-ct_icp算法ct-icp-real-time-elastic-lidar-odometry-with-loop-closure" class="table-of-contents__link toc-highlight">5. CT_ICP算法（CT-ICP: Real-time Elastic LiDAR Odometry with Loop Closure）</a></li></ul></li></ul></li><li><a href="#52-双目深度" class="table-of-contents__link toc-highlight">5.2 双目深度</a><ul><li><a href="#521-代码仓库" class="table-of-contents__link toc-highlight">5.2.1 代码仓库:</a></li><li><a href="#522-工程逻辑框架" class="table-of-contents__link toc-highlight">5.2.2 工程逻辑框架:</a></li><li><a href="#523-详细说明" class="table-of-contents__link toc-highlight">5.2.3 详细说明：</a><ul><li><a href="#1-双目深度感知原理" class="table-of-contents__link toc-highlight">1. 双目深度感知原理：</a></li><li><a href="#2-双目立体匹配算法步骤" class="table-of-contents__link toc-highlight">2. 双目立体匹配算法步骤:</a></li><li><a href="#3-模型介绍" class="table-of-contents__link toc-highlight">3. 模型介绍</a></li></ul></li></ul></li><li><a href="#53-目标检测与分割" class="table-of-contents__link toc-highlight">5.3 目标检测与分割</a><ul><li><a href="#531-代码仓库" class="table-of-contents__link toc-highlight">5.3.1 代码仓库:</a></li><li><a href="#532-工程逻辑框架" class="table-of-contents__link toc-highlight">5.3.2 工程逻辑框架:</a></li><li><a href="#533-详细说明" class="table-of-contents__link toc-highlight">5.3.3 详细说明：</a></li></ul></li><li><a href="#54-导航以及任务调度" class="table-of-contents__link toc-highlight">5.4 导航以及任务调度</a><ul><li><a href="#541-代码仓库" class="table-of-contents__link toc-highlight">5.4.1 代码仓库:</a></li><li><a href="#542-工程逻辑框架" class="table-of-contents__link toc-highlight">5.4.2 工程逻辑框架:</a></li><li><a href="#543-详细说明" class="table-of-contents__link toc-highlight">5.4.3 详细说明：</a></li></ul></li></ul></li><li><a href="#6-附件" class="table-of-contents__link toc-highlight">6. 附件</a></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class="footer__title">友情链接</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://www.guyuehome.com/" target="_blank" rel="noopener noreferrer" class="footer__link-item">古月居<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">联系我们</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/D-Robotics" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://space.bilibili.com/437998606" target="_blank" rel="noopener noreferrer" class="footer__link-item">BiLiBiLi<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 D-Robotics.</div></div></div></footer></div>
</body>
</html>